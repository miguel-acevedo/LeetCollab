function Paginator(e, t) {
    this.ref = e, this.pageNumber = 0, this.limit = t, this.lastPageNumber = null, this.currentSet = {}, this.snap = null, this.lastKey = null, this.allData = []
}

function getLastPriority(e) {
    var t = void 0;
    return null == e || e.forEach(function(e) {
        null == t && (t = e.getPriority()), e.getPriority() > t && (t = e.getPriority())
    }), t
}

function getLastKey(e) {
    var t = void 0,
        n = void 0;
    return null == e ? t : (e.forEach(function(e) {
        null == t && (t = e.getPriority(), n = e.key), e.getPriority() > t && (n = e.key)
    }), n)
}

function each(e, t) {
    if (e)
        for (k in e) {
            if (e.hasOwnProperty(k))
                if (!0 === t(e[k], k)) break
        }
}! function(p, _) {
    var t, n, v = typeof _,
        m = p.document,
        e = p.location,
        r = p.jQuery,
        i = p.$,
        o = {},
        h = [],
        s = "1.9.1",
        y = h.concat,
        a = h.push,
        u = h.slice,
        l = h.indexOf,
        c = o.toString,
        g = o.hasOwnProperty,
        d = s.trim,
        ge = function(e, t) {
            return new ge.fn.init(e, t, n)
        },
        f = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
        C = /\S+/g,
        b = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        x = /^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,
        w = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
        k = /^[\],:{}\s]*$/,
        S = /(?:^|:|,)(?:\s*\[)+/g,
        T = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,
        M = /"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,
        A = /^-ms-/,
        L = /-([\da-z])/gi,
        E = function(e, t) {
            return t.toUpperCase()
        },
        N = function(e) {
            (m.addEventListener || "load" === e.type || "complete" === m.readyState) && (I(), ge.ready())
        },
        I = function() {
            m.addEventListener ? (m.removeEventListener("DOMContentLoaded", N, !1), p.removeEventListener("load", N, !1)) : (m.detachEvent("onreadystatechange", N), p.detachEvent("onload", N))
        };

    function O(e) {
        var t = e.length,
            n = ge.type(e);
        return !ge.isWindow(e) && (!(1 !== e.nodeType || !t) || ("array" === n || "function" !== n && (0 === t || "number" == typeof t && 0 < t && t - 1 in e)))
    }
    ge.fn = ge.prototype = {
        jquery: s,
        constructor: ge,
        init: function(e, t, n) {
            var r, i;
            if (!e) return this;
            if ("string" != typeof e) return e.nodeType ? (this.context = this[0] = e, this.length = 1, this) : ge.isFunction(e) ? n.ready(e) : (e.selector !== _ && (this.selector = e.selector, this.context = e.context), ge.makeArray(e, this));
            if (!(r = "<" === e.charAt(0) && ">" === e.charAt(e.length - 1) && 3 <= e.length ? [null, e, null] : x.exec(e)) || !r[1] && t) return !t || t.jquery ? (t || n).find(e) : this.constructor(t).find(e);
            if (r[1]) {
                if (t = t instanceof ge ? t[0] : t, ge.merge(this, ge.parseHTML(r[1], t && t.nodeType ? t.ownerDocument || t : m, !0)), w.test(r[1]) && ge.isPlainObject(t))
                    for (r in t) ge.isFunction(this[r]) ? this[r](t[r]) : this.attr(r, t[r]);
                return this
            }
            if ((i = m.getElementById(r[2])) && i.parentNode) {
                if (i.id !== r[2]) return n.find(e);
                this.length = 1, this[0] = i
            }
            return this.context = m, this.selector = e, this
        },
        selector: "",
        length: 0,
        size: function() {
            return this.length
        },
        toArray: function() {
            return u.call(this)
        },
        get: function(e) {
            return null == e ? this.toArray() : e < 0 ? this[this.length + e] : this[e]
        },
        pushStack: function(e) {
            var t = ge.merge(this.constructor(), e);
            return t.prevObject = this, t.context = this.context, t
        },
        each: function(e, t) {
            return ge.each(this, e, t)
        },
        ready: function(e) {
            return ge.ready.promise().done(e), this
        },
        slice: function() {
            return this.pushStack(u.apply(this, arguments))
        },
        first: function() {
            return this.eq(0)
        },
        last: function() {
            return this.eq(-1)
        },
        eq: function(e) {
            var t = this.length,
                n = +e + (e < 0 ? t : 0);
            return this.pushStack(0 <= n && n < t ? [this[n]] : [])
        },
        map: function(n) {
            return this.pushStack(ge.map(this, function(e, t) {
                return n.call(e, t, e)
            }))
        },
        end: function() {
            return this.prevObject || this.constructor(null)
        },
        push: a,
        sort: [].sort,
        splice: [].splice
    }, ge.fn.init.prototype = ge.fn, ge.extend = ge.fn.extend = function() {
        var e, t, n, r, i, o, s = arguments[0] || {},
            a = 1,
            l = arguments.length,
            c = !1;
        for ("boolean" == typeof s && (c = s, s = arguments[1] || {}, a = 2), "object" == typeof s || ge.isFunction(s) || (s = {}), l === a && (s = this, --a); a < l; a++)
            if (null != (i = arguments[a]))
                for (r in i) e = s[r], s !== (n = i[r]) && (c && n && (ge.isPlainObject(n) || (t = ge.isArray(n))) ? (o = t ? (t = !1, e && ge.isArray(e) ? e : []) : e && ge.isPlainObject(e) ? e : {}, s[r] = ge.extend(c, o, n)) : n !== _ && (s[r] = n));
        return s
    }, ge.extend({
        noConflict: function(e) {
            return p.$ === ge && (p.$ = i), e && p.jQuery === ge && (p.jQuery = r), ge
        },
        isReady: !1,
        readyWait: 1,
        holdReady: function(e) {
            e ? ge.readyWait++ : ge.ready(!0)
        },
        ready: function(e) {
            if (!0 === e ? !--ge.readyWait : !ge.isReady) {
                if (!m.body) return setTimeout(ge.ready);
                (ge.isReady = !0) !== e && 0 < --ge.readyWait || (t.resolveWith(m, [ge]), ge.fn.trigger && ge(m).trigger("ready").off("ready"))
            }
        },
        isFunction: function(e) {
            return "function" === ge.type(e)
        },
        isArray: Array.isArray || function(e) {
            return "array" === ge.type(e)
        },
        isWindow: function(e) {
            return null != e && e == e.window
        },
        isNumeric: function(e) {
            return !isNaN(parseFloat(e)) && isFinite(e)
        },
        type: function(e) {
            return null == e ? String(e) : "object" == typeof e || "function" == typeof e ? o[c.call(e)] || "object" : typeof e
        },
        isPlainObject: function(e) {
            if (!e || "object" !== ge.type(e) || e.nodeType || ge.isWindow(e)) return !1;
            try {
                if (e.constructor && !g.call(e, "constructor") && !g.call(e.constructor.prototype, "isPrototypeOf")) return !1
            } catch (e) {
                return !1
            }
            var t;
            for (t in e);
            return t === _ || g.call(e, t)
        },
        isEmptyObject: function(e) {
            var t;
            for (t in e) return !1;
            return !0
        },
        error: function(e) {
            throw new Error(e)
        },
        parseHTML: function(e, t, n) {
            if (!e || "string" != typeof e) return null;
            "boolean" == typeof t && (n = t, t = !1), t = t || m;
            var r = w.exec(e),
                i = !n && [];
            return r ? [t.createElement(r[1])] : (r = ge.buildFragment([e], t, i), i && ge(i).remove(), ge.merge([], r.childNodes))
        },
        parseJSON: function(e) {
            return p.JSON && p.JSON.parse ? p.JSON.parse(e) : null === e ? e : "string" == typeof e && (e = ge.trim(e)) && k.test(e.replace(T, "@").replace(M, "]").replace(S, "")) ? new Function("return " + e)() : void ge.error("Invalid JSON: " + e)
        },
        parseXML: function(e) {
            var t;
            if (!e || "string" != typeof e) return null;
            try {
                p.DOMParser ? t = (new DOMParser).parseFromString(e, "text/xml") : ((t = new ActiveXObject("Microsoft.XMLDOM")).async = "false", t.loadXML(e))
            } catch (e) {
                t = _
            }
            return t && t.documentElement && !t.getElementsByTagName("parsererror").length || ge.error("Invalid XML: " + e), t
        },
        noop: function() {},
        globalEval: function(e) {
            e && ge.trim(e) && (p.execScript || function(e) {
                p.eval.call(p, e)
            })(e)
        },
        camelCase: function(e) {
            return e.replace(A, "ms-").replace(L, E)
        },
        nodeName: function(e, t) {
            return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
        },
        each: function(e, t, n) {
            var r = 0,
                i = e.length,
                o = O(e);
            if (n) {
                if (o)
                    for (; r < i && !1 !== t.apply(e[r], n); r++);
                else
                    for (r in e)
                        if (!1 === t.apply(e[r], n)) break
            } else if (o)
                for (; r < i && !1 !== t.call(e[r], r, e[r]); r++);
            else
                for (r in e)
                    if (!1 === t.call(e[r], r, e[r])) break;
            return e
        },
        trim: d && !d.call("\ufeffÂ ") ? function(e) {
            return null == e ? "" : d.call(e)
        } : function(e) {
            return null == e ? "" : (e + "").replace(b, "")
        },
        makeArray: function(e, t) {
            var n = t || [];
            return null != e && (O(Object(e)) ? ge.merge(n, "string" == typeof e ? [e] : e) : a.call(n, e)), n
        },
        inArray: function(e, t, n) {
            var r;
            if (t) {
                if (l) return l.call(t, e, n);
                for (r = t.length, n = n ? n < 0 ? Math.max(0, r + n) : n : 0; n < r; n++)
                    if (n in t && t[n] === e) return n
            }
            return -1
        },
        merge: function(e, t) {
            var n = t.length,
                r = e.length,
                i = 0;
            if ("number" == typeof n)
                for (; i < n; i++) e[r++] = t[i];
            else
                for (; t[i] !== _;) e[r++] = t[i++];
            return e.length = r, e
        },
        grep: function(e, t, n) {
            var r = [],
                i = 0,
                o = e.length;
            for (n = !!n; i < o; i++) n !== !!t(e[i], i) && r.push(e[i]);
            return r
        },
        map: function(e, t, n) {
            var r, i = 0,
                o = e.length,
                s = [];
            if (O(e))
                for (; i < o; i++) null != (r = t(e[i], i, n)) && (s[s.length] = r);
            else
                for (i in e) null != (r = t(e[i], i, n)) && (s[s.length] = r);
            return y.apply([], s)
        },
        guid: 1,
        proxy: function(e, t) {
            var n, r, i;
            return "string" == typeof t && (i = e[t], t = e, e = i), ge.isFunction(e) ? (n = u.call(arguments, 2), (r = function() {
                return e.apply(t || this, n.concat(u.call(arguments)))
            }).guid = e.guid = e.guid || ge.guid++, r) : _
        },
        access: function(e, t, n, r, i, o, s) {
            var a = 0,
                l = e.length,
                c = null == n;
            if ("object" === ge.type(n))
                for (a in i = !0, n) ge.access(e, t, a, n[a], !0, o, s);
            else if (r !== _ && (i = !0, ge.isFunction(r) || (s = !0), c && (t = s ? (t.call(e, r), null) : (c = t, function(e, t, n) {
                    return c.call(ge(e), n)
                })), t))
                for (; a < l; a++) t(e[a], n, s ? r : r.call(e[a], a, t(e[a], n)));
            return i ? e : c ? t.call(e) : l ? t(e[0], n) : o
        },
        now: function() {
            return (new Date).getTime()
        }
    }), ge.ready.promise = function(e) {
        if (!t)
            if (t = ge.Deferred(), "complete" === m.readyState) setTimeout(ge.ready);
            else if (m.addEventListener) m.addEventListener("DOMContentLoaded", N, !1), p.addEventListener("load", N, !1);
        else {
            m.attachEvent("onreadystatechange", N), p.attachEvent("onload", N);
            var n = !1;
            try {
                n = null == p.frameElement && m.documentElement
            } catch (e) {}
            n && n.doScroll && function t() {
                if (!ge.isReady) {
                    try {
                        n.doScroll("left")
                    } catch (e) {
                        return setTimeout(t, 50)
                    }
                    I(), ge.ready()
                }
            }()
        }
        return t.promise(e)
    }, ge.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(e, t) {
        o["[object " + t + "]"] = t.toLowerCase()
    }), n = ge(m);
    var R = {};
    ge.Callbacks = function(i) {
        var e, n;
        i = "string" == typeof i ? R[i] || (n = R[e = i] = {}, ge.each(e.match(C) || [], function(e, t) {
            n[t] = !0
        }), n) : ge.extend({}, i);
        var r, t, o, s, a, l, c = [],
            u = !i.once && [],
            h = function(e) {
                for (t = i.memory && e, o = !0, a = l || 0, l = 0, s = c.length, r = !0; c && a < s; a++)
                    if (!1 === c[a].apply(e[0], e[1]) && i.stopOnFalse) {
                        t = !1;
                        break
                    } r = !1, c && (u ? u.length && h(u.shift()) : t ? c = [] : d.disable())
            },
            d = {
                add: function() {
                    if (c) {
                        var e = c.length;
                        ! function r(e) {
                            ge.each(e, function(e, t) {
                                var n = ge.type(t);
                                "function" === n ? i.unique && d.has(t) || c.push(t) : t && t.length && "string" !== n && r(t)
                            })
                        }(arguments), r ? s = c.length : t && (l = e, h(t))
                    }
                    return this
                },
                remove: function() {
                    return c && ge.each(arguments, function(e, t) {
                        for (var n; - 1 < (n = ge.inArray(t, c, n));) c.splice(n, 1), r && (n <= s && s--, n <= a && a--)
                    }), this
                },
                has: function(e) {
                    return e ? -1 < ge.inArray(e, c) : !(!c || !c.length)
                },
                empty: function() {
                    return c = [], this
                },
                disable: function() {
                    return c = u = t = _, this
                },
                disabled: function() {
                    return !c
                },
                lock: function() {
                    return u = _, t || d.disable(), this
                },
                locked: function() {
                    return !u
                },
                fireWith: function(e, t) {
                    return t = [e, (t = t || []).slice ? t.slice() : t], !c || o && !u || (r ? u.push(t) : h(t)), this
                },
                fire: function() {
                    return d.fireWith(this, arguments), this
                },
                fired: function() {
                    return !!o
                }
            };
        return d
    }, ge.extend({
        Deferred: function(e) {
            var s = [
                    ["resolve", "done", ge.Callbacks("once memory"), "resolved"],
                    ["reject", "fail", ge.Callbacks("once memory"), "rejected"],
                    ["notify", "progress", ge.Callbacks("memory")]
                ],
                i = "pending",
                a = {
                    state: function() {
                        return i
                    },
                    always: function() {
                        return l.done(arguments).fail(arguments), this
                    },
                    then: function() {
                        var o = arguments;
                        return ge.Deferred(function(i) {
                            ge.each(s, function(e, t) {
                                var n = t[0],
                                    r = ge.isFunction(o[e]) && o[e];
                                l[t[1]](function() {
                                    var e = r && r.apply(this, arguments);
                                    e && ge.isFunction(e.promise) ? e.promise().done(i.resolve).fail(i.reject).progress(i.notify) : i[n + "With"](this === a ? i.promise() : this, r ? [e] : arguments)
                                })
                            }), o = null
                        }).promise()
                    },
                    promise: function(e) {
                        return null != e ? ge.extend(e, a) : a
                    }
                },
                l = {};
            return a.pipe = a.then, ge.each(s, function(e, t) {
                var n = t[2],
                    r = t[3];
                a[t[1]] = n.add, r && n.add(function() {
                    i = r
                }, s[1 ^ e][2].disable, s[2][2].lock), l[t[0]] = function() {
                    return l[t[0] + "With"](this === l ? a : this, arguments), this
                }, l[t[0] + "With"] = n.fireWith
            }), a.promise(l), e && e.call(l, l), l
        },
        when: function(e) {
            var i, t, n, r = 0,
                o = u.call(arguments),
                s = o.length,
                a = 1 !== s || e && ge.isFunction(e.promise) ? s : 0,
                l = 1 === a ? e : ge.Deferred(),
                c = function(t, n, r) {
                    return function(e) {
                        n[t] = this, r[t] = 1 < arguments.length ? u.call(arguments) : e, r === i ? l.notifyWith(n, r) : --a || l.resolveWith(n, r)
                    }
                };
            if (1 < s)
                for (i = new Array(s), t = new Array(s), n = new Array(s); r < s; r++) o[r] && ge.isFunction(o[r].promise) ? o[r].promise().done(c(r, n, o)).fail(l.reject).progress(c(r, t, i)) : --a;
            return a || l.resolveWith(n, o), l.promise()
        }
    }), ge.support = function() {
        var o, e, t, n, r, i, s, a, l, c, u = m.createElement("div");
        if (u.setAttribute("className", "t"), u.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", e = u.getElementsByTagName("*"), t = u.getElementsByTagName("a")[0], !e || !t || !e.length) return {};
        s = (r = m.createElement("select")).appendChild(m.createElement("option")), n = u.getElementsByTagName("input")[0], t.style.cssText = "top:1px;float:left;opacity:.5", o = {
            getSetAttribute: "t" !== u.className,
            leadingWhitespace: 3 === u.firstChild.nodeType,
            tbody: !u.getElementsByTagName("tbody").length,
            htmlSerialize: !!u.getElementsByTagName("link").length,
            style: /top/.test(t.getAttribute("style")),
            hrefNormalized: "/a" === t.getAttribute("href"),
            opacity: /^0.5/.test(t.style.opacity),
            cssFloat: !!t.style.cssFloat,
            checkOn: !!n.value,
            optSelected: s.selected,
            enctype: !!m.createElement("form").enctype,
            html5Clone: "<:nav></:nav>" !== m.createElement("nav").cloneNode(!0).outerHTML,
            boxModel: "CSS1Compat" === m.compatMode,
            deleteExpando: !0,
            noCloneEvent: !0,
            inlineBlockNeedsLayout: !1,
            shrinkWrapBlocks: !1,
            reliableMarginRight: !0,
            boxSizingReliable: !0,
            pixelPosition: !1
        }, n.checked = !0, o.noCloneChecked = n.cloneNode(!0).checked, r.disabled = !0, o.optDisabled = !s.disabled;
        try {
            delete u.test
        } catch (e) {
            o.deleteExpando = !1
        }
        for (c in (n = m.createElement("input")).setAttribute("value", ""), o.input = "" === n.getAttribute("value"), n.value = "t", n.setAttribute("type", "radio"), o.radioValue = "t" === n.value, n.setAttribute("checked", "t"), n.setAttribute("name", "t"), (i = m.createDocumentFragment()).appendChild(n), o.appendChecked = n.checked, o.checkClone = i.cloneNode(!0).cloneNode(!0).lastChild.checked, u.attachEvent && (u.attachEvent("onclick", function() {
                o.noCloneEvent = !1
            }), u.cloneNode(!0).click()), {
                submit: !0,
                change: !0,
                focusin: !0
            }) u.setAttribute(a = "on" + c, "t"), o[c + "Bubbles"] = a in p || !1 === u.attributes[a].expando;
        return u.style.backgroundClip = "content-box", u.cloneNode(!0).style.backgroundClip = "", o.clearCloneStyle = "content-box" === u.style.backgroundClip, ge(function() {
            var e, t, n, r = "padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",
                i = m.getElementsByTagName("body")[0];
            i && ((e = m.createElement("div")).style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px", i.appendChild(e).appendChild(u), u.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", (n = u.getElementsByTagName("td"))[0].style.cssText = "padding:0;margin:0;border:0;display:none", l = 0 === n[0].offsetHeight, n[0].style.display = "", n[1].style.display = "none", o.reliableHiddenOffsets = l && 0 === n[0].offsetHeight, u.innerHTML = "", u.style.cssText = "box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;", o.boxSizing = 4 === u.offsetWidth, o.doesNotIncludeMarginInBodyOffset = 1 !== i.offsetTop, p.getComputedStyle && (o.pixelPosition = "1%" !== (p.getComputedStyle(u, null) || {}).top, o.boxSizingReliable = "4px" === (p.getComputedStyle(u, null) || {
                width: "4px"
            }).width, (t = u.appendChild(m.createElement("div"))).style.cssText = u.style.cssText = r, t.style.marginRight = t.style.width = "0", u.style.width = "1px", o.reliableMarginRight = !parseFloat((p.getComputedStyle(t, null) || {}).marginRight)), typeof u.style.zoom !== v && (u.innerHTML = "", u.style.cssText = r + "width:1px;padding:1px;display:inline;zoom:1", o.inlineBlockNeedsLayout = 3 === u.offsetWidth, u.style.display = "block", u.innerHTML = "<div></div>", u.firstChild.style.width = "5px", o.shrinkWrapBlocks = 3 !== u.offsetWidth, o.inlineBlockNeedsLayout && (i.style.zoom = 1)), i.removeChild(e), e = u = n = t = null)
        }), e = r = i = s = t = n = null, o
    }();
    var D = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
        P = /([A-Z])/g;

    function $(e, t, n, r) {
        if (ge.acceptData(e)) {
            var i, o, s = ge.expando,
                a = "string" == typeof t,
                l = e.nodeType,
                c = l ? ge.cache : e,
                u = l ? e[s] : e[s] && s;
            if (u && c[u] && (r || c[u].data) || !a || n !== _) return u || (l ? e[s] = u = h.pop() || ge.guid++ : u = s), c[u] || (c[u] = {}, l || (c[u].toJSON = ge.noop)), "object" != typeof t && "function" != typeof t || (r ? c[u] = ge.extend(c[u], t) : c[u].data = ge.extend(c[u].data, t)), i = c[u], r || (i.data || (i.data = {}), i = i.data), n !== _ && (i[ge.camelCase(t)] = n), a ? null == (o = i[t]) && (o = i[ge.camelCase(t)]) : o = i, o
        }
    }

    function H(e, t, n) {
        if (ge.acceptData(e)) {
            var r, i, o, s = e.nodeType,
                a = s ? ge.cache : e,
                l = s ? e[ge.expando] : ge.expando;
            if (a[l]) {
                if (t && (o = n ? a[l] : a[l].data)) {
                    for ((r = 0, i = (t = ge.isArray(t) ? t.concat(ge.map(t, ge.camelCase)) : t in o ? [t] : (t = ge.camelCase(t)) in o ? [t] : t.split(" ")).length); r < i; r++) delete o[t[r]];
                    if (!(n ? B : ge.isEmptyObject)(o)) return
                }(n || (delete a[l].data, B(a[l]))) && (s ? ge.cleanData([e], !0) : ge.support.deleteExpando || a != a.window ? delete a[l] : a[l] = null)
            }
        }
    }

    function F(e, t, n) {
        if (n === _ && 1 === e.nodeType) {
            var r = "data-" + t.replace(P, "-$1").toLowerCase();
            if ("string" == typeof(n = e.getAttribute(r))) {
                try {
                    n = "true" === n || "false" !== n && ("null" === n ? null : +n + "" === n ? +n : D.test(n) ? ge.parseJSON(n) : n)
                } catch (e) {}
                ge.data(e, t, n)
            } else n = _
        }
        return n
    }

    function B(e) {
        var t;
        for (t in e)
            if (("data" !== t || !ge.isEmptyObject(e[t])) && "toJSON" !== t) return !1;
        return !0
    }
    ge.extend({
        cache: {},
        expando: "jQuery" + (s + Math.random()).replace(/\D/g, ""),
        noData: {
            embed: !0,
            object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
            applet: !0
        },
        hasData: function(e) {
            return !!(e = e.nodeType ? ge.cache[e[ge.expando]] : e[ge.expando]) && !B(e)
        },
        data: function(e, t, n) {
            return $(e, t, n)
        },
        removeData: function(e, t) {
            return H(e, t)
        },
        _data: function(e, t, n) {
            return $(e, t, n, !0)
        },
        _removeData: function(e, t) {
            return H(e, t, !0)
        },
        acceptData: function(e) {
            if (e.nodeType && 1 !== e.nodeType && 9 !== e.nodeType) return !1;
            var t = e.nodeName && ge.noData[e.nodeName.toLowerCase()];
            return !t || !0 !== t && e.getAttribute("classid") === t
        }
    }), ge.fn.extend({
        data: function(t, e) {
            var n, r, i = this[0],
                o = 0,
                s = null;
            if (t !== _) return "object" == typeof t ? this.each(function() {
                ge.data(this, t)
            }) : ge.access(this, function(e) {
                if (e === _) return i ? F(i, t, ge.data(i, t)) : null;
                this.each(function() {
                    ge.data(this, t, e)
                })
            }, null, e, 1 < arguments.length, null, !0);
            if (this.length && (s = ge.data(i), 1 === i.nodeType && !ge._data(i, "parsedAttrs"))) {
                for (n = i.attributes; o < n.length; o++)(r = n[o].name).indexOf("data-") || (r = ge.camelCase(r.slice(5)), F(i, r, s[r]));
                ge._data(i, "parsedAttrs", !0)
            }
            return s
        },
        removeData: function(e) {
            return this.each(function() {
                ge.removeData(this, e)
            })
        }
    }), ge.extend({
        queue: function(e, t, n) {
            var r;
            if (e) return t = (t || "fx") + "queue", r = ge._data(e, t), n && (!r || ge.isArray(n) ? r = ge._data(e, t, ge.makeArray(n)) : r.push(n)), r || []
        },
        dequeue: function(e, t) {
            t = t || "fx";
            var n = ge.queue(e, t),
                r = n.length,
                i = n.shift(),
                o = ge._queueHooks(e, t);
            "inprogress" === i && (i = n.shift(), r--), (o.cur = i) && ("fx" === t && n.unshift("inprogress"), delete o.stop, i.call(e, function() {
                ge.dequeue(e, t)
            }, o)), !r && o && o.empty.fire()
        },
        _queueHooks: function(e, t) {
            var n = t + "queueHooks";
            return ge._data(e, n) || ge._data(e, n, {
                empty: ge.Callbacks("once memory").add(function() {
                    ge._removeData(e, t + "queue"), ge._removeData(e, n)
                })
            })
        }
    }), ge.fn.extend({
        queue: function(t, n) {
            var e = 2;
            return "string" != typeof t && (n = t, t = "fx", e--), arguments.length < e ? ge.queue(this[0], t) : n === _ ? this : this.each(function() {
                var e = ge.queue(this, t, n);
                ge._queueHooks(this, t), "fx" === t && "inprogress" !== e[0] && ge.dequeue(this, t)
            })
        },
        dequeue: function(e) {
            return this.each(function() {
                ge.dequeue(this, e)
            })
        },
        delay: function(r, e) {
            return r = ge.fx && ge.fx.speeds[r] || r, e = e || "fx", this.queue(e, function(e, t) {
                var n = setTimeout(e, r);
                t.stop = function() {
                    clearTimeout(n)
                }
            })
        },
        clearQueue: function(e) {
            return this.queue(e || "fx", [])
        },
        promise: function(e, t) {
            var n, r = 1,
                i = ge.Deferred(),
                o = this,
                s = this.length,
                a = function() {
                    --r || i.resolveWith(o, [o])
                };
            for ("string" != typeof e && (t = e, e = _), e = e || "fx"; s--;)(n = ge._data(o[s], e + "queueHooks")) && n.empty && (r++, n.empty.add(a));
            return a(), i.promise(t)
        }
    });
    var z, q, j = /[\t\r\n]/g,
        W = /\r/g,
        U = /^(?:input|select|textarea|button|object)$/i,
        K = /^(?:a|area)$/i,
        V = /^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,
        G = /^(?:checked|selected)$/i,
        Y = ge.support.getSetAttribute,
        X = ge.support.input;
    ge.fn.extend({
        attr: function(e, t) {
            return ge.access(this, ge.attr, e, t, 1 < arguments.length)
        },
        removeAttr: function(e) {
            return this.each(function() {
                ge.removeAttr(this, e)
            })
        },
        prop: function(e, t) {
            return ge.access(this, ge.prop, e, t, 1 < arguments.length)
        },
        removeProp: function(e) {
            return e = ge.propFix[e] || e, this.each(function() {
                try {
                    this[e] = _, delete this[e]
                } catch (e) {}
            })
        },
        addClass: function(t) {
            var e, n, r, i, o, s = 0,
                a = this.length,
                l = "string" == typeof t && t;
            if (ge.isFunction(t)) return this.each(function(e) {
                ge(this).addClass(t.call(this, e, this.className))
            });
            if (l)
                for (e = (t || "").match(C) || []; s < a; s++)
                    if (r = 1 === (n = this[s]).nodeType && (n.className ? (" " + n.className + " ").replace(j, " ") : " ")) {
                        for (o = 0; i = e[o++];) r.indexOf(" " + i + " ") < 0 && (r += i + " ");
                        n.className = ge.trim(r)
                    } return this
        },
        removeClass: function(t) {
            var e, n, r, i, o, s = 0,
                a = this.length,
                l = 0 === arguments.length || "string" == typeof t && t;
            if (ge.isFunction(t)) return this.each(function(e) {
                ge(this).removeClass(t.call(this, e, this.className))
            });
            if (l)
                for (e = (t || "").match(C) || []; s < a; s++)
                    if (r = 1 === (n = this[s]).nodeType && (n.className ? (" " + n.className + " ").replace(j, " ") : "")) {
                        for (o = 0; i = e[o++];)
                            for (; 0 <= r.indexOf(" " + i + " ");) r = r.replace(" " + i + " ", " ");
                        n.className = t ? ge.trim(r) : ""
                    } return this
        },
        toggleClass: function(o, s) {
            var a = typeof o,
                l = "boolean" == typeof s;
            return ge.isFunction(o) ? this.each(function(e) {
                ge(this).toggleClass(o.call(this, e, this.className, s), s)
            }) : this.each(function() {
                if ("string" === a)
                    for (var e, t = 0, n = ge(this), r = s, i = o.match(C) || []; e = i[t++];) r = l ? r : !n.hasClass(e), n[r ? "addClass" : "removeClass"](e);
                else a !== v && "boolean" !== a || (this.className && ge._data(this, "__className__", this.className), this.className = this.className || !1 === o ? "" : ge._data(this, "__className__") || "")
            })
        },
        hasClass: function(e) {
            for (var t = " " + e + " ", n = 0, r = this.length; n < r; n++)
                if (1 === this[n].nodeType && 0 <= (" " + this[n].className + " ").replace(j, " ").indexOf(t)) return !0;
            return !1
        },
        val: function(r) {
            var e, i, o, t = this[0];
            return arguments.length ? (o = ge.isFunction(r), this.each(function(e) {
                var t, n = ge(this);
                1 === this.nodeType && (null == (t = o ? r.call(this, e, n.val()) : r) ? t = "" : "number" == typeof t ? t += "" : ge.isArray(t) && (t = ge.map(t, function(e) {
                    return null == e ? "" : e + ""
                })), (i = ge.valHooks[this.type] || ge.valHooks[this.nodeName.toLowerCase()]) && "set" in i && i.set(this, t, "value") !== _ || (this.value = t))
            })) : t ? (i = ge.valHooks[t.type] || ge.valHooks[t.nodeName.toLowerCase()]) && "get" in i && (e = i.get(t, "value")) !== _ ? e : "string" == typeof(e = t.value) ? e.replace(W, "") : null == e ? "" : e : void 0
        }
    }), ge.extend({
        valHooks: {
            option: {
                get: function(e) {
                    var t = e.attributes.value;
                    return !t || t.specified ? e.value : e.text
                }
            },
            select: {
                get: function(e) {
                    for (var t, n, r = e.options, i = e.selectedIndex, o = "select-one" === e.type || i < 0, s = o ? null : [], a = o ? i + 1 : r.length, l = i < 0 ? a : o ? i : 0; l < a; l++)
                        if (((n = r[l]).selected || l === i) && (ge.support.optDisabled ? !n.disabled : null === n.getAttribute("disabled")) && (!n.parentNode.disabled || !ge.nodeName(n.parentNode, "optgroup"))) {
                            if (t = ge(n).val(), o) return t;
                            s.push(t)
                        } return s
                },
                set: function(e, t) {
                    var n = ge.makeArray(t);
                    return ge(e).find("option").each(function() {
                        this.selected = 0 <= ge.inArray(ge(this).val(), n)
                    }), n.length || (e.selectedIndex = -1), n
                }
            }
        },
        attr: function(e, t, n) {
            var r, i, o, s = e.nodeType;
            if (e && 3 !== s && 8 !== s && 2 !== s) return typeof e.getAttribute === v ? ge.prop(e, t, n) : ((i = 1 !== s || !ge.isXMLDoc(e)) && (t = t.toLowerCase(), r = ge.attrHooks[t] || (V.test(t) ? q : z)), n === _ ? r && i && "get" in r && null !== (o = r.get(e, t)) ? o : (typeof e.getAttribute !== v && (o = e.getAttribute(t)), null == o ? _ : o) : null !== n ? r && i && "set" in r && (o = r.set(e, n, t)) !== _ ? o : (e.setAttribute(t, n + ""), n) : void ge.removeAttr(e, t))
        },
        removeAttr: function(e, t) {
            var n, r, i = 0,
                o = t && t.match(C);
            if (o && 1 === e.nodeType)
                for (; n = o[i++];) r = ge.propFix[n] || n, V.test(n) ? !Y && G.test(n) ? e[ge.camelCase("default-" + n)] = e[r] = !1 : e[r] = !1 : ge.attr(e, n, ""), e.removeAttribute(Y ? n : r)
        },
        attrHooks: {
            type: {
                set: function(e, t) {
                    if (!ge.support.radioValue && "radio" === t && ge.nodeName(e, "input")) {
                        var n = e.value;
                        return e.setAttribute("type", t), n && (e.value = n), t
                    }
                }
            }
        },
        propFix: {
            tabindex: "tabIndex",
            readonly: "readOnly",
            for: "htmlFor",
            class: "className",
            maxlength: "maxLength",
            cellspacing: "cellSpacing",
            cellpadding: "cellPadding",
            rowspan: "rowSpan",
            colspan: "colSpan",
            usemap: "useMap",
            frameborder: "frameBorder",
            contenteditable: "contentEditable"
        },
        prop: function(e, t, n) {
            var r, i, o = e.nodeType;
            if (e && 3 !== o && 8 !== o && 2 !== o) return (1 !== o || !ge.isXMLDoc(e)) && (t = ge.propFix[t] || t, i = ge.propHooks[t]), n !== _ ? i && "set" in i && (r = i.set(e, n, t)) !== _ ? r : e[t] = n : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t]
        },
        propHooks: {
            tabIndex: {
                get: function(e) {
                    var t = e.getAttributeNode("tabindex");
                    return t && t.specified ? parseInt(t.value, 10) : U.test(e.nodeName) || K.test(e.nodeName) && e.href ? 0 : _
                }
            }
        }
    }), q = {
        get: function(e, t) {
            var n = ge.prop(e, t),
                r = "boolean" == typeof n && e.getAttribute(t),
                i = "boolean" == typeof n ? X && Y ? null != r : G.test(t) ? e[ge.camelCase("default-" + t)] : !!r : e.getAttributeNode(t);
            return i && !1 !== i.value ? t.toLowerCase() : _
        },
        set: function(e, t, n) {
            return !1 === t ? ge.removeAttr(e, n) : X && Y || !G.test(n) ? e.setAttribute(!Y && ge.propFix[n] || n, n) : e[ge.camelCase("default-" + n)] = e[n] = !0, n
        }
    }, X && Y || (ge.attrHooks.value = {
        get: function(e, t) {
            var n = e.getAttributeNode(t);
            return ge.nodeName(e, "input") ? e.defaultValue : n && n.specified ? n.value : _
        },
        set: function(e, t, n) {
            if (!ge.nodeName(e, "input")) return z && z.set(e, t, n);
            e.defaultValue = t
        }
    }), Y || (z = ge.valHooks.button = {
        get: function(e, t) {
            var n = e.getAttributeNode(t);
            return n && ("id" === t || "name" === t || "coords" === t ? "" !== n.value : n.specified) ? n.value : _
        },
        set: function(e, t, n) {
            var r = e.getAttributeNode(n);
            return r || e.setAttributeNode(r = e.ownerDocument.createAttribute(n)), r.value = t += "", "value" === n || t === e.getAttribute(n) ? t : _
        }
    }, ge.attrHooks.contenteditable = {
        get: z.get,
        set: function(e, t, n) {
            z.set(e, "" !== t && t, n)
        }
    }, ge.each(["width", "height"], function(e, n) {
        ge.attrHooks[n] = ge.extend(ge.attrHooks[n], {
            set: function(e, t) {
                if ("" === t) return e.setAttribute(n, "auto"), t
            }
        })
    })), ge.support.hrefNormalized || (ge.each(["href", "src", "width", "height"], function(e, n) {
        ge.attrHooks[n] = ge.extend(ge.attrHooks[n], {
            get: function(e) {
                var t = e.getAttribute(n, 2);
                return null == t ? _ : t
            }
        })
    }), ge.each(["href", "src"], function(e, t) {
        ge.propHooks[t] = {
            get: function(e) {
                return e.getAttribute(t, 4)
            }
        }
    })), ge.support.style || (ge.attrHooks.style = {
        get: function(e) {
            return e.style.cssText || _
        },
        set: function(e, t) {
            return e.style.cssText = t + ""
        }
    }), ge.support.optSelected || (ge.propHooks.selected = ge.extend(ge.propHooks.selected, {
        get: function(e) {
            var t = e.parentNode;
            return t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex), null
        }
    })), ge.support.enctype || (ge.propFix.enctype = "encoding"), ge.support.checkOn || ge.each(["radio", "checkbox"], function() {
        ge.valHooks[this] = {
            get: function(e) {
                return null === e.getAttribute("value") ? "on" : e.value
            }
        }
    }), ge.each(["radio", "checkbox"], function() {
        ge.valHooks[this] = ge.extend(ge.valHooks[this], {
            set: function(e, t) {
                if (ge.isArray(t)) return e.checked = 0 <= ge.inArray(ge(e).val(), t)
            }
        })
    });
    var Q = /^(?:input|select|textarea)$/i,
        J = /^key/,
        Z = /^(?:mouse|contextmenu)|click/,
        ee = /^(?:focusinfocus|focusoutblur)$/,
        te = /^([^.]*)(?:\.(.+)|)$/;

    function ne() {
        return !0
    }

    function re() {
        return !1
    }
    ge.event = {
            global: {},
            add: function(e, t, n, r, i) {
                var o, s, a, l, c, u, h, d, f, p, m, g = ge._data(e);
                if (g) {
                    for (n.handler && (n = (l = n).handler, i = l.selector), n.guid || (n.guid = ge.guid++), (s = g.events) || (s = g.events = {}), (u = g.handle) || ((u = g.handle = function(e) {
                            return typeof ge === v || e && ge.event.triggered === e.type ? _ : ge.event.dispatch.apply(u.elem, arguments)
                        }).elem = e), a = (t = (t || "").match(C) || [""]).length; a--;) f = m = (o = te.exec(t[a]) || [])[1], p = (o[2] || "").split(".").sort(), c = ge.event.special[f] || {}, f = (i ? c.delegateType : c.bindType) || f, c = ge.event.special[f] || {}, h = ge.extend({
                        type: f,
                        origType: m,
                        data: r,
                        handler: n,
                        guid: n.guid,
                        selector: i,
                        needsContext: i && ge.expr.match.needsContext.test(i),
                        namespace: p.join(".")
                    }, l), (d = s[f]) || ((d = s[f] = []).delegateCount = 0, c.setup && !1 !== c.setup.call(e, r, p, u) || (e.addEventListener ? e.addEventListener(f, u, !1) : e.attachEvent && e.attachEvent("on" + f, u))), c.add && (c.add.call(e, h), h.handler.guid || (h.handler.guid = n.guid)), i ? d.splice(d.delegateCount++, 0, h) : d.push(h), ge.event.global[f] = !0;
                    e = null
                }
            },
            remove: function(e, t, n, r, i) {
                var o, s, a, l, c, u, h, d, f, p, m, g = ge.hasData(e) && ge._data(e);
                if (g && (u = g.events)) {
                    for (c = (t = (t || "").match(C) || [""]).length; c--;)
                        if (f = m = (a = te.exec(t[c]) || [])[1], p = (a[2] || "").split(".").sort(), f) {
                            for (h = ge.event.special[f] || {}, d = u[f = (r ? h.delegateType : h.bindType) || f] || [], a = a[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)"), l = o = d.length; o--;) s = d[o], !i && m !== s.origType || n && n.guid !== s.guid || a && !a.test(s.namespace) || r && r !== s.selector && ("**" !== r || !s.selector) || (d.splice(o, 1), s.selector && d.delegateCount--, h.remove && h.remove.call(e, s));
                            l && !d.length && (h.teardown && !1 !== h.teardown.call(e, p, g.handle) || ge.removeEvent(e, f, g.handle), delete u[f])
                        } else
                            for (f in u) ge.event.remove(e, f + t[c], n, r, !0);
                    ge.isEmptyObject(u) && (delete g.handle, ge._removeData(e, "events"))
                }
            },
            trigger: function(e, t, n, r) {
                var i, o, s, a, l, c, u, h = [n || m],
                    d = g.call(e, "type") ? e.type : e,
                    f = g.call(e, "namespace") ? e.namespace.split(".") : [];
                if (s = c = n = n || m, 3 !== n.nodeType && 8 !== n.nodeType && !ee.test(d + ge.event.triggered) && (0 <= d.indexOf(".") && (d = (f = d.split(".")).shift(), f.sort()), o = d.indexOf(":") < 0 && "on" + d, (e = e[ge.expando] ? e : new ge.Event(d, "object" == typeof e && e)).isTrigger = !0, e.namespace = f.join("."), e.namespace_re = e.namespace ? new RegExp("(^|\\.)" + f.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, e.result = _, e.target || (e.target = n), t = null == t ? [e] : ge.makeArray(t, [e]), l = ge.event.special[d] || {}, r || !l.trigger || !1 !== l.trigger.apply(n, t))) {
                    if (!r && !l.noBubble && !ge.isWindow(n)) {
                        for (a = l.delegateType || d, ee.test(a + d) || (s = s.parentNode); s; s = s.parentNode) h.push(s), c = s;
                        c === (n.ownerDocument || m) && h.push(c.defaultView || c.parentWindow || p)
                    }
                    for (u = 0;
                        (s = h[u++]) && !e.isPropagationStopped();) e.type = 1 < u ? a : l.bindType || d, (i = (ge._data(s, "events") || {})[e.type] && ge._data(s, "handle")) && i.apply(s, t), (i = o && s[o]) && ge.acceptData(s) && i.apply && !1 === i.apply(s, t) && e.preventDefault();
                    if (e.type = d, !r && !e.isDefaultPrevented() && (!l._default || !1 === l._default.apply(n.ownerDocument, t)) && ("click" !== d || !ge.nodeName(n, "a")) && ge.acceptData(n) && o && n[d] && !ge.isWindow(n)) {
                        (c = n[o]) && (n[o] = null), ge.event.triggered = d;
                        try {
                            n[d]()
                        } catch (e) {}
                        ge.event.triggered = _, c && (n[o] = c)
                    }
                    return e.result
                }
            },
            dispatch: function(e) {
                e = ge.event.fix(e);
                var t, n, r, i, o, s, a = u.call(arguments),
                    l = (ge._data(this, "events") || {})[e.type] || [],
                    c = ge.event.special[e.type] || {};
                if ((a[0] = e).delegateTarget = this, !c.preDispatch || !1 !== c.preDispatch.call(this, e)) {
                    for (s = ge.event.handlers.call(this, e, l), t = 0;
                        (i = s[t++]) && !e.isPropagationStopped();)
                        for (e.currentTarget = i.elem, o = 0;
                            (r = i.handlers[o++]) && !e.isImmediatePropagationStopped();) e.namespace_re && !e.namespace_re.test(r.namespace) || (e.handleObj = r, e.data = r.data, (n = ((ge.event.special[r.origType] || {}).handle || r.handler).apply(i.elem, a)) !== _ && !1 === (e.result = n) && (e.preventDefault(), e.stopPropagation()));
                    return c.postDispatch && c.postDispatch.call(this, e), e.result
                }
            },
            handlers: function(e, t) {
                var n, r, i, o, s = [],
                    a = t.delegateCount,
                    l = e.target;
                if (a && l.nodeType && (!e.button || "click" !== e.type))
                    for (; l != this; l = l.parentNode || this)
                        if (1 === l.nodeType && (!0 !== l.disabled || "click" !== e.type)) {
                            for (i = [], o = 0; o < a; o++) i[n = (r = t[o]).selector + " "] === _ && (i[n] = r.needsContext ? 0 <= ge(n, this).index(l) : ge.find(n, this, null, [l]).length), i[n] && i.push(r);
                            i.length && s.push({
                                elem: l,
                                handlers: i
                            })
                        } return a < t.length && s.push({
                    elem: this,
                    handlers: t.slice(a)
                }), s
            },
            fix: function(e) {
                if (e[ge.expando]) return e;
                var t, n, r, i = e.type,
                    o = e,
                    s = this.fixHooks[i];
                for (s || (this.fixHooks[i] = s = Z.test(i) ? this.mouseHooks : J.test(i) ? this.keyHooks : {}), r = s.props ? this.props.concat(s.props) : this.props, e = new ge.Event(o), t = r.length; t--;) e[n = r[t]] = o[n];
                return e.target || (e.target = o.srcElement || m), 3 === e.target.nodeType && (e.target = e.target.parentNode), e.metaKey = !!e.metaKey, s.filter ? s.filter(e, o) : e
            },
            props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
            fixHooks: {},
            keyHooks: {
                props: "char charCode key keyCode".split(" "),
                filter: function(e, t) {
                    return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e
                }
            },
            mouseHooks: {
                props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
                filter: function(e, t) {
                    var n, r, i, o = t.button,
                        s = t.fromElement;
                    return null == e.pageX && null != t.clientX && (i = (r = e.target.ownerDocument || m).documentElement, n = r.body, e.pageX = t.clientX + (i && i.scrollLeft || n && n.scrollLeft || 0) - (i && i.clientLeft || n && n.clientLeft || 0), e.pageY = t.clientY + (i && i.scrollTop || n && n.scrollTop || 0) - (i && i.clientTop || n && n.clientTop || 0)), !e.relatedTarget && s && (e.relatedTarget = s === e.target ? t.toElement : s), e.which || o === _ || (e.which = 1 & o ? 1 : 2 & o ? 3 : 4 & o ? 2 : 0), e
                }
            },
            special: {
                load: {
                    noBubble: !0
                },
                click: {
                    trigger: function() {
                        if (ge.nodeName(this, "input") && "checkbox" === this.type && this.click) return this.click(), !1
                    }
                },
                focus: {
                    trigger: function() {
                        if (this !== m.activeElement && this.focus) try {
                            return this.focus(), !1
                        } catch (e) {}
                    },
                    delegateType: "focusin"
                },
                blur: {
                    trigger: function() {
                        if (this === m.activeElement && this.blur) return this.blur(), !1
                    },
                    delegateType: "focusout"
                },
                beforeunload: {
                    postDispatch: function(e) {
                        e.result !== _ && (e.originalEvent.returnValue = e.result)
                    }
                }
            },
            simulate: function(e, t, n, r) {
                var i = ge.extend(new ge.Event, n, {
                    type: e,
                    isSimulated: !0,
                    originalEvent: {}
                });
                r ? ge.event.trigger(i, null, t) : ge.event.dispatch.call(t, i), i.isDefaultPrevented() && n.preventDefault()
            }
        }, ge.removeEvent = m.removeEventListener ? function(e, t, n) {
            e.removeEventListener && e.removeEventListener(t, n, !1)
        } : function(e, t, n) {
            var r = "on" + t;
            e.detachEvent && (typeof e[r] === v && (e[r] = null), e.detachEvent(r, n))
        }, ge.Event = function(e, t) {
            if (!(this instanceof ge.Event)) return new ge.Event(e, t);
            e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || !1 === e.returnValue || e.getPreventDefault && e.getPreventDefault() ? ne : re) : this.type = e, t && ge.extend(this, t), this.timeStamp = e && e.timeStamp || ge.now(), this[ge.expando] = !0
        }, ge.Event.prototype = {
            isDefaultPrevented: re,
            isPropagationStopped: re,
            isImmediatePropagationStopped: re,
            preventDefault: function() {
                var e = this.originalEvent;
                this.isDefaultPrevented = ne, e && (e.preventDefault ? e.preventDefault() : e.returnValue = !1)
            },
            stopPropagation: function() {
                var e = this.originalEvent;
                this.isPropagationStopped = ne, e && (e.stopPropagation && e.stopPropagation(), e.cancelBubble = !0)
            },
            stopImmediatePropagation: function() {
                this.isImmediatePropagationStopped = ne, this.stopPropagation()
            }
        }, ge.each({
            mouseenter: "mouseover",
            mouseleave: "mouseout"
        }, function(e, i) {
            ge.event.special[e] = {
                delegateType: i,
                bindType: i,
                handle: function(e) {
                    var t, n = e.relatedTarget,
                        r = e.handleObj;
                    return n && (n === this || ge.contains(this, n)) || (e.type = r.origType, t = r.handler.apply(this, arguments), e.type = i), t
                }
            }
        }), ge.support.submitBubbles || (ge.event.special.submit = {
            setup: function() {
                if (ge.nodeName(this, "form")) return !1;
                ge.event.add(this, "click._submit keypress._submit", function(e) {
                    var t = e.target,
                        n = ge.nodeName(t, "input") || ge.nodeName(t, "button") ? t.form : _;
                    n && !ge._data(n, "submitBubbles") && (ge.event.add(n, "submit._submit", function(e) {
                        e._submit_bubble = !0
                    }), ge._data(n, "submitBubbles", !0))
                })
            },
            postDispatch: function(e) {
                e._submit_bubble && (delete e._submit_bubble, this.parentNode && !e.isTrigger && ge.event.simulate("submit", this.parentNode, e, !0))
            },
            teardown: function() {
                if (ge.nodeName(this, "form")) return !1;
                ge.event.remove(this, "._submit")
            }
        }), ge.support.changeBubbles || (ge.event.special.change = {
            setup: function() {
                if (Q.test(this.nodeName)) return "checkbox" !== this.type && "radio" !== this.type || (ge.event.add(this, "propertychange._change", function(e) {
                    "checked" === e.originalEvent.propertyName && (this._just_changed = !0)
                }), ge.event.add(this, "click._change", function(e) {
                    this._just_changed && !e.isTrigger && (this._just_changed = !1), ge.event.simulate("change", this, e, !0)
                })), !1;
                ge.event.add(this, "beforeactivate._change", function(e) {
                    var t = e.target;
                    Q.test(t.nodeName) && !ge._data(t, "changeBubbles") && (ge.event.add(t, "change._change", function(e) {
                        !this.parentNode || e.isSimulated || e.isTrigger || ge.event.simulate("change", this.parentNode, e, !0)
                    }), ge._data(t, "changeBubbles", !0))
                })
            },
            handle: function(e) {
                var t = e.target;
                if (this !== t || e.isSimulated || e.isTrigger || "radio" !== t.type && "checkbox" !== t.type) return e.handleObj.handler.apply(this, arguments)
            },
            teardown: function() {
                return ge.event.remove(this, "._change"), !Q.test(this.nodeName)
            }
        }), ge.support.focusinBubbles || ge.each({
            focus: "focusin",
            blur: "focusout"
        }, function(e, t) {
            var n = 0,
                r = function(e) {
                    ge.event.simulate(t, e.target, ge.event.fix(e), !0)
                };
            ge.event.special[t] = {
                setup: function() {
                    0 == n++ && m.addEventListener(e, r, !0)
                },
                teardown: function() {
                    0 == --n && m.removeEventListener(e, r, !0)
                }
            }
        }), ge.fn.extend({
            on: function(e, t, n, r, i) {
                var o, s;
                if ("object" == typeof e) {
                    for (o in "string" != typeof t && (n = n || t, t = _), e) this.on(o, t, n, e[o], i);
                    return this
                }
                if (null == n && null == r ? (r = t, n = t = _) : null == r && ("string" == typeof t ? (r = n, n = _) : (r = n, n = t, t = _)), !1 === r) r = re;
                else if (!r) return this;
                return 1 === i && (s = r, (r = function(e) {
                    return ge().off(e), s.apply(this, arguments)
                }).guid = s.guid || (s.guid = ge.guid++)), this.each(function() {
                    ge.event.add(this, e, r, n, t)
                })
            },
            one: function(e, t, n, r) {
                return this.on(e, t, n, r, 1)
            },
            off: function(e, t, n) {
                var r, i;
                if (e && e.preventDefault && e.handleObj) return r = e.handleObj, ge(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this;
                if ("object" != typeof e) return !1 !== t && "function" != typeof t || (n = t, t = _), !1 === n && (n = re), this.each(function() {
                    ge.event.remove(this, e, n, t)
                });
                for (i in e) this.off(i, t, e[i]);
                return this
            },
            bind: function(e, t, n) {
                return this.on(e, null, t, n)
            },
            unbind: function(e, t) {
                return this.off(e, null, t)
            },
            delegate: function(e, t, n, r) {
                return this.on(t, e, n, r)
            },
            undelegate: function(e, t, n) {
                return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n)
            },
            trigger: function(e, t) {
                return this.each(function() {
                    ge.event.trigger(e, t, this)
                })
            },
            triggerHandler: function(e, t) {
                var n = this[0];
                if (n) return ge.event.trigger(e, t, n, !0)
            }
        }),
        function(n, e) {
            var t, w, k, o, r, p, c, _, m, C, i, g, v, s, a, y, u, S = "sizzle" + -new Date,
                b = n.document,
                x = {},
                T = 0,
                h = 0,
                l = ee(),
                d = ee(),
                f = ee(),
                M = "undefined",
                A = [],
                L = A.pop,
                E = A.push,
                N = A.slice,
                I = A.indexOf || function(e) {
                    for (var t = 0, n = this.length; t < n; t++)
                        if (this[t] === e) return t;
                    return -1
                },
                O = "[\\x20\\t\\r\\n\\f]",
                R = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
                D = R.replace("w", "w#"),
                P = "\\[" + O + "*(" + R + ")" + O + "*(?:([*^$|!~]?=)" + O + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + D + ")|)|)" + O + "*\\]",
                $ = ":(" + R + ")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" + P.replace(3, 8) + ")*)|.*)\\)|)",
                H = new RegExp("^" + O + "+|((?:^|[^\\\\])(?:\\\\.)*)" + O + "+$", "g"),
                F = new RegExp("^" + O + "*," + O + "*"),
                B = new RegExp("^" + O + "*([\\x20\\t\\r\\n\\f>+~])" + O + "*"),
                z = new RegExp($),
                q = new RegExp("^" + D + "$"),
                j = {
                    ID: new RegExp("^#(" + R + ")"),
                    CLASS: new RegExp("^\\.(" + R + ")"),
                    NAME: new RegExp("^\\[name=['\"]?(" + R + ")['\"]?\\]"),
                    TAG: new RegExp("^(" + R.replace("w", "w*") + ")"),
                    ATTR: new RegExp("^" + P),
                    PSEUDO: new RegExp("^" + $),
                    CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + O + "*(even|odd|(([+-]|)(\\d*)n|)" + O + "*(?:([+-]|)" + O + "*(\\d+)|))" + O + "*\\)|)", "i"),
                    needsContext: new RegExp("^" + O + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + O + "*((?:-\\d)?\\d*)" + O + "*\\)|)(?=[^-]|$)", "i")
                },
                W = /[\x20\t\r\n\f]*[+~]/,
                U = /^[^{]+\{\s*\[native code/,
                K = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
                V = /^(?:input|select|textarea|button)$/i,
                G = /^h\d$/i,
                Y = /'|\\/g,
                X = /\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,
                Q = /\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,
                J = function(e, t) {
                    var n = "0x" + t - 65536;
                    return n != n ? t : n < 0 ? String.fromCharCode(n + 65536) : String.fromCharCode(n >> 10 | 55296, 1023 & n | 56320)
                };
            try {
                N.call(b.documentElement.childNodes, 0)[0].nodeType
            } catch (e) {
                N = function(e) {
                    for (var t, n = []; t = this[e++];) n.push(t);
                    return n
                }
            }

            function Z(e) {
                return U.test(e + "")
            }

            function ee() {
                var n, r = [];
                return n = function(e, t) {
                    return r.push(e += " ") > k.cacheLength && delete n[r.shift()], n[e] = t
                }
            }

            function te(e) {
                return e[S] = !0, e
            }

            function ne(e) {
                var t = C.createElement("div");
                try {
                    return e(t)
                } catch (e) {
                    return !1
                } finally {
                    t = null
                }
            }

            function re(e, t, n, r) {
                var i, o, s, a, l, c, u, h, d, f;
                if ((t ? t.ownerDocument || t : b) !== C && m(t), n = n || [], !e || "string" != typeof e) return n;
                if (1 !== (a = (t = t || C).nodeType) && 9 !== a) return [];
                if (!g && !r) {
                    if (i = K.exec(e))
                        if (s = i[1]) {
                            if (9 === a) {
                                if (!(o = t.getElementById(s)) || !o.parentNode) return n;
                                if (o.id === s) return n.push(o), n
                            } else if (t.ownerDocument && (o = t.ownerDocument.getElementById(s)) && y(t, o) && o.id === s) return n.push(o), n
                        } else {
                            if (i[2]) return E.apply(n, N.call(t.getElementsByTagName(e), 0)), n;
                            if ((s = i[3]) && x.getByClassName && t.getElementsByClassName) return E.apply(n, N.call(t.getElementsByClassName(s), 0)), n
                        } if (x.qsa && !v.test(e)) {
                        if (u = !0, h = S, d = t, f = 9 === a && e, 1 === a && "object" !== t.nodeName.toLowerCase()) {
                            for (c = le(e), (u = t.getAttribute("id")) ? h = u.replace(Y, "\\$&") : t.setAttribute("id", h), h = "[id='" + h + "'] ", l = c.length; l--;) c[l] = h + ce(c[l]);
                            d = W.test(e) && t.parentNode || t, f = c.join(",")
                        }
                        if (f) try {
                            return E.apply(n, N.call(d.querySelectorAll(f), 0)), n
                        } catch (e) {} finally {
                            u || t.removeAttribute("id")
                        }
                    }
                }
                return function(e, t, n, r) {
                    var i, o, s, a, l, c = le(e);
                    if (!r && 1 === c.length) {
                        if (2 < (o = c[0] = c[0].slice(0)).length && "ID" === (s = o[0]).type && 9 === t.nodeType && !g && k.relative[o[1].type]) {
                            if (!(t = k.find.ID(s.matches[0].replace(Q, J), t)[0])) return n;
                            e = e.slice(o.shift().value.length)
                        }
                        for (i = j.needsContext.test(e) ? 0 : o.length; i-- && (s = o[i], !k.relative[a = s.type]);)
                            if ((l = k.find[a]) && (r = l(s.matches[0].replace(Q, J), W.test(o[0].type) && t.parentNode || t))) {
                                if (o.splice(i, 1), !(e = r.length && ce(o))) return E.apply(n, N.call(r, 0)), n;
                                break
                            }
                    }
                    return p(e, c)(r, t, g, n, W.test(e)), n
                }(e.replace(H, "$1"), t, n, r)
            }

            function ie(e, t) {
                var n = t && e,
                    r = n && (~t.sourceIndex || 1 << 31) - (~e.sourceIndex || 1 << 31);
                if (r) return r;
                if (n)
                    for (; n = n.nextSibling;)
                        if (n === t) return -1;
                return e ? 1 : -1
            }

            function oe(t) {
                return function(e) {
                    return "input" === e.nodeName.toLowerCase() && e.type === t
                }
            }

            function se(n) {
                return function(e) {
                    var t = e.nodeName.toLowerCase();
                    return ("input" === t || "button" === t) && e.type === n
                }
            }

            function ae(s) {
                return te(function(o) {
                    return o = +o, te(function(e, t) {
                        for (var n, r = s([], e.length, o), i = r.length; i--;) e[n = r[i]] && (e[n] = !(t[n] = e[n]))
                    })
                })
            }
            for (t in r = re.isXML = function(e) {
                    var t = e && (e.ownerDocument || e).documentElement;
                    return !!t && "HTML" !== t.nodeName
                }, m = re.setDocument = function(e) {
                    var l = e ? e.ownerDocument || e : b;
                    return l !== C && 9 === l.nodeType && l.documentElement && (i = (C = l).documentElement, g = r(l), x.tagNameNoComments = ne(function(e) {
                        return e.appendChild(l.createComment("")), !e.getElementsByTagName("*").length
                    }), x.attributes = ne(function(e) {
                        e.innerHTML = "<select></select>";
                        var t = typeof e.lastChild.getAttribute("multiple");
                        return "boolean" !== t && "string" !== t
                    }), x.getByClassName = ne(function(e) {
                        return e.innerHTML = "<div class='hidden e'></div><div class='hidden'></div>", !(!e.getElementsByClassName || !e.getElementsByClassName("e").length) && (e.lastChild.className = "e", 2 === e.getElementsByClassName("e").length)
                    }), x.getByName = ne(function(e) {
                        e.id = S + 0, e.innerHTML = "<a name='" + S + "'></a><div name='" + S + "'></div>", i.insertBefore(e, i.firstChild);
                        var t = l.getElementsByName && l.getElementsByName(S).length === 2 + l.getElementsByName(S + 0).length;
                        return x.getIdNotName = !l.getElementById(S), i.removeChild(e), t
                    }), k.attrHandle = ne(function(e) {
                        return e.innerHTML = "<a href='#'></a>", e.firstChild && typeof e.firstChild.getAttribute !== M && "#" === e.firstChild.getAttribute("href")
                    }) ? {} : {
                        href: function(e) {
                            return e.getAttribute("href", 2)
                        },
                        type: function(e) {
                            return e.getAttribute("type")
                        }
                    }, x.getIdNotName ? (k.find.ID = function(e, t) {
                        if (typeof t.getElementById !== M && !g) {
                            var n = t.getElementById(e);
                            return n && n.parentNode ? [n] : []
                        }
                    }, k.filter.ID = function(e) {
                        var t = e.replace(Q, J);
                        return function(e) {
                            return e.getAttribute("id") === t
                        }
                    }) : (k.find.ID = function(e, t) {
                        if (typeof t.getElementById !== M && !g) {
                            var n = t.getElementById(e);
                            return n ? n.id === e || typeof n.getAttributeNode !== M && n.getAttributeNode("id").value === e ? [n] : void 0 : []
                        }
                    }, k.filter.ID = function(e) {
                        var n = e.replace(Q, J);
                        return function(e) {
                            var t = typeof e.getAttributeNode !== M && e.getAttributeNode("id");
                            return t && t.value === n
                        }
                    }), k.find.TAG = x.tagNameNoComments ? function(e, t) {
                        if (typeof t.getElementsByTagName !== M) return t.getElementsByTagName(e)
                    } : function(e, t) {
                        var n, r = [],
                            i = 0,
                            o = t.getElementsByTagName(e);
                        if ("*" !== e) return o;
                        for (; n = o[i++];) 1 === n.nodeType && r.push(n);
                        return r
                    }, k.find.NAME = x.getByName && function(e, t) {
                        if (typeof t.getElementsByName !== M) return t.getElementsByName(name)
                    }, k.find.CLASS = x.getByClassName && function(e, t) {
                        if (typeof t.getElementsByClassName !== M && !g) return t.getElementsByClassName(e)
                    }, s = [], v = [":focus"], (x.qsa = Z(l.querySelectorAll)) && (ne(function(e) {
                        e.innerHTML = "<select><option selected=''></option></select>", e.querySelectorAll("[selected]").length || v.push("\\[" + O + "*(?:checked|disabled|ismap|multiple|readonly|selected|value)"), e.querySelectorAll(":checked").length || v.push(":checked")
                    }), ne(function(e) {
                        e.innerHTML = "<input type='hidden' i=''/>", e.querySelectorAll("[i^='']").length && v.push("[*^$]=" + O + "*(?:\"\"|'')"), e.querySelectorAll(":enabled").length || v.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), v.push(",.*:")
                    })), (x.matchesSelector = Z(a = i.matchesSelector || i.mozMatchesSelector || i.webkitMatchesSelector || i.oMatchesSelector || i.msMatchesSelector)) && ne(function(e) {
                        x.disconnectedMatch = a.call(e, "div"), a.call(e, "[s!='']:x"), s.push("!=", $)
                    }), v = new RegExp(v.join("|")), s = new RegExp(s.join("|")), y = Z(i.contains) || i.compareDocumentPosition ? function(e, t) {
                        var n = 9 === e.nodeType ? e.documentElement : e,
                            r = t && t.parentNode;
                        return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r)))
                    } : function(e, t) {
                        if (t)
                            for (; t = t.parentNode;)
                                if (t === e) return !0;
                        return !1
                    }, u = i.compareDocumentPosition ? function(e, t) {
                        var n;
                        return e === t ? (c = !0, 0) : (n = t.compareDocumentPosition && e.compareDocumentPosition && e.compareDocumentPosition(t)) ? 1 & n || e.parentNode && 11 === e.parentNode.nodeType ? e === l || y(b, e) ? -1 : t === l || y(b, t) ? 1 : 0 : 4 & n ? -1 : 1 : e.compareDocumentPosition ? -1 : 1
                    } : function(e, t) {
                        var n, r = 0,
                            i = e.parentNode,
                            o = t.parentNode,
                            s = [e],
                            a = [t];
                        if (e === t) return c = !0, 0;
                        if (!i || !o) return e === l ? -1 : t === l ? 1 : i ? -1 : o ? 1 : 0;
                        if (i === o) return ie(e, t);
                        for (n = e; n = n.parentNode;) s.unshift(n);
                        for (n = t; n = n.parentNode;) a.unshift(n);
                        for (; s[r] === a[r];) r++;
                        return r ? ie(s[r], a[r]) : s[r] === b ? -1 : a[r] === b ? 1 : 0
                    }, c = !1, [0, 0].sort(u), x.detectDuplicates = c), C
                }, re.matches = function(e, t) {
                    return re(e, null, null, t)
                }, re.matchesSelector = function(e, t) {
                    if ((e.ownerDocument || e) !== C && m(e), t = t.replace(X, "='$1']"), x.matchesSelector && !g && (!s || !s.test(t)) && !v.test(t)) try {
                        var n = a.call(e, t);
                        if (n || x.disconnectedMatch || e.document && 11 !== e.document.nodeType) return n
                    } catch (e) {}
                    return 0 < re(t, C, null, [e]).length
                }, re.contains = function(e, t) {
                    return (e.ownerDocument || e) !== C && m(e), y(e, t)
                }, re.attr = function(e, t) {
                    var n;
                    return (e.ownerDocument || e) !== C && m(e), g || (t = t.toLowerCase()), (n = k.attrHandle[t]) ? n(e) : g || x.attributes ? e.getAttribute(t) : ((n = e.getAttributeNode(t)) || e.getAttribute(t)) && !0 === e[t] ? t : n && n.specified ? n.value : null
                }, re.error = function(e) {
                    throw new Error("Syntax error, unrecognized expression: " + e)
                }, re.uniqueSort = function(e) {
                    var t, n = [],
                        r = 1,
                        i = 0;
                    if (c = !x.detectDuplicates, e.sort(u), c) {
                        for (; t = e[r]; r++) t === e[r - 1] && (i = n.push(r));
                        for (; i--;) e.splice(n[i], 1)
                    }
                    return e
                }, o = re.getText = function(e) {
                    var t, n = "",
                        r = 0,
                        i = e.nodeType;
                    if (i) {
                        if (1 === i || 9 === i || 11 === i) {
                            if ("string" == typeof e.textContent) return e.textContent;
                            for (e = e.firstChild; e; e = e.nextSibling) n += o(e)
                        } else if (3 === i || 4 === i) return e.nodeValue
                    } else
                        for (; t = e[r]; r++) n += o(t);
                    return n
                }, k = re.selectors = {
                    cacheLength: 50,
                    createPseudo: te,
                    match: j,
                    find: {},
                    relative: {
                        ">": {
                            dir: "parentNode",
                            first: !0
                        },
                        " ": {
                            dir: "parentNode"
                        },
                        "+": {
                            dir: "previousSibling",
                            first: !0
                        },
                        "~": {
                            dir: "previousSibling"
                        }
                    },
                    preFilter: {
                        ATTR: function(e) {
                            return e[1] = e[1].replace(Q, J), e[3] = (e[4] || e[5] || "").replace(Q, J), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4)
                        },
                        CHILD: function(e) {
                            return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || re.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && re.error(e[0]), e
                        },
                        PSEUDO: function(e) {
                            var t, n = !e[5] && e[2];
                            return j.CHILD.test(e[0]) ? null : (e[4] ? e[2] = e[4] : n && z.test(n) && (t = le(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3))
                        }
                    },
                    filter: {
                        TAG: function(t) {
                            return "*" === t ? function() {
                                return !0
                            } : (t = t.replace(Q, J).toLowerCase(), function(e) {
                                return e.nodeName && e.nodeName.toLowerCase() === t
                            })
                        },
                        CLASS: function(e) {
                            var t = l[e + " "];
                            return t || (t = new RegExp("(^|" + O + ")" + e + "(" + O + "|$)")) && l(e, function(e) {
                                return t.test(e.className || typeof e.getAttribute !== M && e.getAttribute("class") || "")
                            })
                        },
                        ATTR: function(n, r, i) {
                            return function(e) {
                                var t = re.attr(e, n);
                                return null == t ? "!=" === r : !r || (t += "", "=" === r ? t === i : "!=" === r ? t !== i : "^=" === r ? i && 0 === t.indexOf(i) : "*=" === r ? i && -1 < t.indexOf(i) : "$=" === r ? i && t.slice(-i.length) === i : "~=" === r ? -1 < (" " + t + " ").indexOf(i) : "|=" === r && (t === i || t.slice(0, i.length + 1) === i + "-"))
                            }
                        },
                        CHILD: function(f, e, t, p, m) {
                            var g = "nth" !== f.slice(0, 3),
                                v = "last" !== f.slice(-4),
                                y = "of-type" === e;
                            return 1 === p && 0 === m ? function(e) {
                                return !!e.parentNode
                            } : function(e, t, n) {
                                var r, i, o, s, a, l, c = g !== v ? "nextSibling" : "previousSibling",
                                    u = e.parentNode,
                                    h = y && e.nodeName.toLowerCase(),
                                    d = !n && !y;
                                if (u) {
                                    if (g) {
                                        for (; c;) {
                                            for (o = e; o = o[c];)
                                                if (y ? o.nodeName.toLowerCase() === h : 1 === o.nodeType) return !1;
                                            l = c = "only" === f && !l && "nextSibling"
                                        }
                                        return !0
                                    }
                                    if (l = [v ? u.firstChild : u.lastChild], v && d) {
                                        for (a = (r = (i = u[S] || (u[S] = {}))[f] || [])[0] === T && r[1], s = r[0] === T && r[2], o = a && u.childNodes[a]; o = ++a && o && o[c] || (s = a = 0) || l.pop();)
                                            if (1 === o.nodeType && ++s && o === e) {
                                                i[f] = [T, a, s];
                                                break
                                            }
                                    } else if (d && (r = (e[S] || (e[S] = {}))[f]) && r[0] === T) s = r[1];
                                    else
                                        for (;
                                            (o = ++a && o && o[c] || (s = a = 0) || l.pop()) && ((y ? o.nodeName.toLowerCase() !== h : 1 !== o.nodeType) || !++s || (d && ((o[S] || (o[S] = {}))[f] = [T, s]), o !== e)););
                                    return (s -= m) === p || s % p == 0 && 0 <= s / p
                                }
                            }
                        },
                        PSEUDO: function(e, o) {
                            var t, s = k.pseudos[e] || k.setFilters[e.toLowerCase()] || re.error("unsupported pseudo: " + e);
                            return s[S] ? s(o) : 1 < s.length ? (t = [e, e, "", o], k.setFilters.hasOwnProperty(e.toLowerCase()) ? te(function(e, t) {
                                for (var n, r = s(e, o), i = r.length; i--;) e[n = I.call(e, r[i])] = !(t[n] = r[i])
                            }) : function(e) {
                                return s(e, 0, t)
                            }) : s
                        }
                    },
                    pseudos: {
                        not: te(function(e) {
                            var r = [],
                                i = [],
                                a = p(e.replace(H, "$1"));
                            return a[S] ? te(function(e, t, n, r) {
                                for (var i, o = a(e, null, r, []), s = e.length; s--;)(i = o[s]) && (e[s] = !(t[s] = i))
                            }) : function(e, t, n) {
                                return r[0] = e, a(r, null, n, i), !i.pop()
                            }
                        }),
                        has: te(function(t) {
                            return function(e) {
                                return 0 < re(t, e).length
                            }
                        }),
                        contains: te(function(t) {
                            return function(e) {
                                return -1 < (e.textContent || e.innerText || o(e)).indexOf(t)
                            }
                        }),
                        lang: te(function(n) {
                            return q.test(n || "") || re.error("unsupported lang: " + n), n = n.replace(Q, J).toLowerCase(),
                                function(e) {
                                    var t;
                                    do {
                                        if (t = g ? e.getAttribute("xml:lang") || e.getAttribute("lang") : e.lang) return (t = t.toLowerCase()) === n || 0 === t.indexOf(n + "-")
                                    } while ((e = e.parentNode) && 1 === e.nodeType);
                                    return !1
                                }
                        }),
                        target: function(e) {
                            var t = n.location && n.location.hash;
                            return t && t.slice(1) === e.id
                        },
                        root: function(e) {
                            return e === i
                        },
                        focus: function(e) {
                            return e === C.activeElement && (!C.hasFocus || C.hasFocus()) && !!(e.type || e.href || ~e.tabIndex)
                        },
                        enabled: function(e) {
                            return !1 === e.disabled
                        },
                        disabled: function(e) {
                            return !0 === e.disabled
                        },
                        checked: function(e) {
                            var t = e.nodeName.toLowerCase();
                            return "input" === t && !!e.checked || "option" === t && !!e.selected
                        },
                        selected: function(e) {
                            return e.parentNode && e.parentNode.selectedIndex, !0 === e.selected
                        },
                        empty: function(e) {
                            for (e = e.firstChild; e; e = e.nextSibling)
                                if ("@" < e.nodeName || 3 === e.nodeType || 4 === e.nodeType) return !1;
                            return !0
                        },
                        parent: function(e) {
                            return !k.pseudos.empty(e)
                        },
                        header: function(e) {
                            return G.test(e.nodeName)
                        },
                        input: function(e) {
                            return V.test(e.nodeName)
                        },
                        button: function(e) {
                            var t = e.nodeName.toLowerCase();
                            return "input" === t && "button" === e.type || "button" === t
                        },
                        text: function(e) {
                            var t;
                            return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || t.toLowerCase() === e.type)
                        },
                        first: ae(function() {
                            return [0]
                        }),
                        last: ae(function(e, t) {
                            return [t - 1]
                        }),
                        eq: ae(function(e, t, n) {
                            return [n < 0 ? n + t : n]
                        }),
                        even: ae(function(e, t) {
                            for (var n = 0; n < t; n += 2) e.push(n);
                            return e
                        }),
                        odd: ae(function(e, t) {
                            for (var n = 1; n < t; n += 2) e.push(n);
                            return e
                        }),
                        lt: ae(function(e, t, n) {
                            for (var r = n < 0 ? n + t : n; 0 <= --r;) e.push(r);
                            return e
                        }),
                        gt: ae(function(e, t, n) {
                            for (var r = n < 0 ? n + t : n; ++r < t;) e.push(r);
                            return e
                        })
                    }
                }, {
                    radio: !0,
                    checkbox: !0,
                    file: !0,
                    password: !0,
                    image: !0
                }) k.pseudos[t] = oe(t);
            for (t in {
                    submit: !0,
                    reset: !0
                }) k.pseudos[t] = se(t);

            function le(e, t) {
                var n, r, i, o, s, a, l, c = d[e + " "];
                if (c) return t ? 0 : c.slice(0);
                for (s = e, a = [], l = k.preFilter; s;) {
                    for (o in n && !(r = F.exec(s)) || (r && (s = s.slice(r[0].length) || s), a.push(i = [])), n = !1, (r = B.exec(s)) && (n = r.shift(), i.push({
                            value: n,
                            type: r[0].replace(H, " ")
                        }), s = s.slice(n.length)), k.filter) !(r = j[o].exec(s)) || l[o] && !(r = l[o](r)) || (n = r.shift(), i.push({
                        value: n,
                        type: o,
                        matches: r
                    }), s = s.slice(n.length));
                    if (!n) break
                }
                return t ? s.length : s ? re.error(e) : d(e, a).slice(0)
            }

            function ce(e) {
                for (var t = 0, n = e.length, r = ""; t < n; t++) r += e[t].value;
                return r
            }

            function ue(a, e, t) {
                var l = e.dir,
                    c = t && "parentNode" === l,
                    u = h++;
                return e.first ? function(e, t, n) {
                    for (; e = e[l];)
                        if (1 === e.nodeType || c) return a(e, t, n)
                } : function(e, t, n) {
                    var r, i, o, s = T + " " + u;
                    if (n) {
                        for (; e = e[l];)
                            if ((1 === e.nodeType || c) && a(e, t, n)) return !0
                    } else
                        for (; e = e[l];)
                            if (1 === e.nodeType || c)
                                if ((i = (o = e[S] || (e[S] = {}))[l]) && i[0] === s) {
                                    if (!0 === (r = i[1]) || r === w) return !0 === r
                                } else if ((i = o[l] = [s])[1] = a(e, t, n) || w, !0 === i[1]) return !0
                }
            }

            function he(i) {
                return 1 < i.length ? function(e, t, n) {
                    for (var r = i.length; r--;)
                        if (!i[r](e, t, n)) return !1;
                    return !0
                } : i[0]
            }

            function de(e, t, n, r, i) {
                for (var o, s = [], a = 0, l = e.length, c = null != t; a < l; a++)(o = e[a]) && (n && !n(o, r, i) || (s.push(o), c && t.push(a)));
                return s
            }

            function fe(f, p, m, g, v, e) {
                return g && !g[S] && (g = fe(g)), v && !v[S] && (v = fe(v, e)), te(function(e, t, n, r) {
                    var i, o, s, a = [],
                        l = [],
                        c = t.length,
                        u = e || function(e, t, n) {
                            for (var r = 0, i = t.length; r < i; r++) re(e, t[r], n);
                            return n
                        }(p || "*", n.nodeType ? [n] : n, []),
                        h = !f || !e && p ? u : de(u, a, f, n, r),
                        d = m ? v || (e ? f : c || g) ? [] : t : h;
                    if (m && m(h, d, n, r), g)
                        for (i = de(d, l), g(i, [], n, r), o = i.length; o--;)(s = i[o]) && (d[l[o]] = !(h[l[o]] = s));
                    if (e) {
                        if (v || f) {
                            if (v) {
                                for (i = [], o = d.length; o--;)(s = d[o]) && i.push(h[o] = s);
                                v(null, d = [], i, r)
                            }
                            for (o = d.length; o--;)(s = d[o]) && -1 < (i = v ? I.call(e, s) : a[o]) && (e[i] = !(t[i] = s))
                        }
                    } else d = de(d === t ? d.splice(c, d.length) : d), v ? v(null, t, d, r) : E.apply(t, d)
                })
            }

            function pe(e) {
                for (var r, t, n, i = e.length, o = k.relative[e[0].type], s = o || k.relative[" "], a = o ? 1 : 0, l = ue(function(e) {
                        return e === r
                    }, s, !0), c = ue(function(e) {
                        return -1 < I.call(r, e)
                    }, s, !0), u = [function(e, t, n) {
                        return !o && (n || t !== _) || ((r = t).nodeType ? l(e, t, n) : c(e, t, n))
                    }]; a < i; a++)
                    if (t = k.relative[e[a].type]) u = [ue(he(u), t)];
                    else {
                        if ((t = k.filter[e[a].type].apply(null, e[a].matches))[S]) {
                            for (n = ++a; n < i && !k.relative[e[n].type]; n++);
                            return fe(1 < a && he(u), 1 < a && ce(e.slice(0, a - 1)).replace(H, "$1"), t, a < n && pe(e.slice(a, n)), n < i && pe(e = e.slice(n)), n < i && ce(e))
                        }
                        u.push(t)
                    } return he(u)
            }

            function me() {}
            p = re.compile = function(e, t) {
                var n, g, v, y, b, x, r, i = [],
                    o = [],
                    s = f[e + " "];
                if (!s) {
                    for (t || (t = le(e)), n = t.length; n--;)(s = pe(t[n]))[S] ? i.push(s) : o.push(s);
                    s = f(e, (g = o, b = (y = 0) < (v = i).length, x = 0 < g.length, r = function(e, t, n, r, i) {
                        var o, s, a, l = [],
                            c = 0,
                            u = "0",
                            h = e && [],
                            d = null != i,
                            f = _,
                            p = e || x && k.find.TAG("*", i && t.parentNode || t),
                            m = T += null == f ? 1 : Math.random() || .1;
                        for (d && (_ = t !== C && t, w = y); null != (o = p[u]); u++) {
                            if (x && o) {
                                for (s = 0; a = g[s++];)
                                    if (a(o, t, n)) {
                                        r.push(o);
                                        break
                                    } d && (T = m, w = ++y)
                            }
                            b && ((o = !a && o) && c--, e && h.push(o))
                        }
                        if (c += u, b && u !== c) {
                            for (s = 0; a = v[s++];) a(h, l, t, n);
                            if (e) {
                                if (0 < c)
                                    for (; u--;) h[u] || l[u] || (l[u] = L.call(r));
                                l = de(l)
                            }
                            E.apply(r, l), d && !e && 0 < l.length && 1 < c + v.length && re.uniqueSort(r)
                        }
                        return d && (T = m, _ = f), h
                    }, b ? te(r) : r))
                }
                return s
            }, k.pseudos.nth = k.pseudos.eq, k.filters = me.prototype = k.pseudos, k.setFilters = new me, m(), re.attr = ge.attr, ge.find = re, ge.expr = re.selectors, ge.expr[":"] = ge.expr.pseudos, ge.unique = re.uniqueSort, ge.text = re.getText, ge.isXMLDoc = re.isXML, ge.contains = re.contains
        }(p);
    var ie = /Until$/,
        oe = /^(?:parents|prev(?:Until|All))/,
        se = /^.[^:#\[\.,]*$/,
        ae = ge.expr.match.needsContext,
        le = {
            children: !0,
            contents: !0,
            next: !0,
            prev: !0
        };

    function ce(e, t) {
        for (;
            (e = e[t]) && 1 !== e.nodeType;);
        return e
    }

    function ue(e, n, r) {
        if (n = n || 0, ge.isFunction(n)) return ge.grep(e, function(e, t) {
            return !!n.call(e, t, e) === r
        });
        if (n.nodeType) return ge.grep(e, function(e) {
            return e === n === r
        });
        if ("string" == typeof n) {
            var t = ge.grep(e, function(e) {
                return 1 === e.nodeType
            });
            if (se.test(n)) return ge.filter(n, t, !r);
            n = ge.filter(n, t)
        }
        return ge.grep(e, function(e) {
            return 0 <= ge.inArray(e, n) === r
        })
    }

    function he(e) {
        var t = de.split("|"),
            n = e.createDocumentFragment();
        if (n.createElement)
            for (; t.length;) n.createElement(t.pop());
        return n
    }
    ge.fn.extend({
        find: function(e) {
            var t, n, r, i = this.length;
            if ("string" != typeof e) return (r = this).pushStack(ge(e).filter(function() {
                for (t = 0; t < i; t++)
                    if (ge.contains(r[t], this)) return !0
            }));
            for (n = [], t = 0; t < i; t++) ge.find(e, this[t], n);
            return (n = this.pushStack(1 < i ? ge.unique(n) : n)).selector = (this.selector ? this.selector + " " : "") + e, n
        },
        has: function(e) {
            var t, n = ge(e, this),
                r = n.length;
            return this.filter(function() {
                for (t = 0; t < r; t++)
                    if (ge.contains(this, n[t])) return !0
            })
        },
        not: function(e) {
            return this.pushStack(ue(this, e, !1))
        },
        filter: function(e) {
            return this.pushStack(ue(this, e, !0))
        },
        is: function(e) {
            return !!e && ("string" == typeof e ? ae.test(e) ? 0 <= ge(e, this.context).index(this[0]) : 0 < ge.filter(e, this).length : 0 < this.filter(e).length)
        },
        closest: function(e, t) {
            for (var n, r = 0, i = this.length, o = [], s = ae.test(e) || "string" != typeof e ? ge(e, t || this.context) : 0; r < i; r++)
                for (n = this[r]; n && n.ownerDocument && n !== t && 11 !== n.nodeType;) {
                    if (s ? -1 < s.index(n) : ge.find.matchesSelector(n, e)) {
                        o.push(n);
                        break
                    }
                    n = n.parentNode
                }
            return this.pushStack(1 < o.length ? ge.unique(o) : o)
        },
        index: function(e) {
            return e ? "string" == typeof e ? ge.inArray(this[0], ge(e)) : ge.inArray(e.jquery ? e[0] : e, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
        },
        add: function(e, t) {
            var n = "string" == typeof e ? ge(e, t) : ge.makeArray(e && e.nodeType ? [e] : e),
                r = ge.merge(this.get(), n);
            return this.pushStack(ge.unique(r))
        },
        addBack: function(e) {
            return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
        }
    }), ge.fn.andSelf = ge.fn.addBack, ge.each({
        parent: function(e) {
            var t = e.parentNode;
            return t && 11 !== t.nodeType ? t : null
        },
        parents: function(e) {
            return ge.dir(e, "parentNode")
        },
        parentsUntil: function(e, t, n) {
            return ge.dir(e, "parentNode", n)
        },
        next: function(e) {
            return ce(e, "nextSibling")
        },
        prev: function(e) {
            return ce(e, "previousSibling")
        },
        nextAll: function(e) {
            return ge.dir(e, "nextSibling")
        },
        prevAll: function(e) {
            return ge.dir(e, "previousSibling")
        },
        nextUntil: function(e, t, n) {
            return ge.dir(e, "nextSibling", n)
        },
        prevUntil: function(e, t, n) {
            return ge.dir(e, "previousSibling", n)
        },
        siblings: function(e) {
            return ge.sibling((e.parentNode || {}).firstChild, e)
        },
        children: function(e) {
            return ge.sibling(e.firstChild)
        },
        contents: function(e) {
            return ge.nodeName(e, "iframe") ? e.contentDocument || e.contentWindow.document : ge.merge([], e.childNodes)
        }
    }, function(r, i) {
        ge.fn[r] = function(e, t) {
            var n = ge.map(this, i, e);
            return ie.test(r) || (t = e), t && "string" == typeof t && (n = ge.filter(t, n)), n = 1 < this.length && !le[r] ? ge.unique(n) : n, 1 < this.length && oe.test(r) && (n = n.reverse()), this.pushStack(n)
        }
    }), ge.extend({
        filter: function(e, t, n) {
            return n && (e = ":not(" + e + ")"), 1 === t.length ? ge.find.matchesSelector(t[0], e) ? [t[0]] : [] : ge.find.matches(e, t)
        },
        dir: function(e, t, n) {
            for (var r = [], i = e[t]; i && 9 !== i.nodeType && (n === _ || 1 !== i.nodeType || !ge(i).is(n));) 1 === i.nodeType && r.push(i), i = i[t];
            return r
        },
        sibling: function(e, t) {
            for (var n = []; e; e = e.nextSibling) 1 === e.nodeType && e !== t && n.push(e);
            return n
        }
    });
    var de = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
        fe = / jQuery\d+="(?:null|\d+)"/g,
        pe = new RegExp("<(?:" + de + ")[\\s/>]", "i"),
        me = /^\s+/,
        ve = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
        ye = /<([\w:]+)/,
        be = /<tbody/i,
        xe = /<|&#?\w+;/,
        we = /<(?:script|style|link)/i,
        ke = /^(?:checkbox|radio)$/i,
        _e = /checked\s*(?:[^=]|=\s*.checked.)/i,
        Ce = /^$|\/(?:java|ecma)script/i,
        Se = /^true\/(.*)/,
        Te = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
        Me = {
            option: [1, "<select multiple='multiple'>", "</select>"],
            legend: [1, "<fieldset>", "</fieldset>"],
            area: [1, "<map>", "</map>"],
            param: [1, "<object>", "</object>"],
            thead: [1, "<table>", "</table>"],
            tr: [2, "<table><tbody>", "</tbody></table>"],
            col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
            td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
            _default: ge.support.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
        },
        Ae = he(m).appendChild(m.createElement("div"));

    function Le(e) {
        var t = e.getAttributeNode("type");
        return e.type = (t && t.specified) + "/" + e.type, e
    }

    function Ee(e) {
        var t = Se.exec(e.type);
        return t ? e.type = t[1] : e.removeAttribute("type"), e
    }

    function Ne(e, t) {
        for (var n, r = 0; null != (n = e[r]); r++) ge._data(n, "globalEval", !t || ge._data(t[r], "globalEval"))
    }

    function Ie(e, t) {
        if (1 === t.nodeType && ge.hasData(e)) {
            var n, r, i, o = ge._data(e),
                s = ge._data(t, o),
                a = o.events;
            if (a)
                for (n in delete s.handle, s.events = {}, a)
                    for (r = 0, i = a[n].length; r < i; r++) ge.event.add(t, n, a[n][r]);
            s.data && (s.data = ge.extend({}, s.data))
        }
    }

    function Oe(e, t) {
        var n, r, i;
        if (1 === t.nodeType) {
            if (n = t.nodeName.toLowerCase(), !ge.support.noCloneEvent && t[ge.expando]) {
                for (r in (i = ge._data(t)).events) ge.removeEvent(t, r, i.handle);
                t.removeAttribute(ge.expando)
            }
            "script" === n && t.text !== e.text ? (Le(t).text = e.text, Ee(t)) : "object" === n ? (t.parentNode && (t.outerHTML = e.outerHTML), ge.support.html5Clone && e.innerHTML && !ge.trim(t.innerHTML) && (t.innerHTML = e.innerHTML)) : "input" === n && ke.test(e.type) ? (t.defaultChecked = t.checked = e.checked, t.value !== e.value && (t.value = e.value)) : "option" === n ? t.defaultSelected = t.selected = e.defaultSelected : "input" !== n && "textarea" !== n || (t.defaultValue = e.defaultValue)
        }
    }

    function Re(e, t) {
        var n, r, i = 0,
            o = typeof e.getElementsByTagName !== v ? e.getElementsByTagName(t || "*") : typeof e.querySelectorAll !== v ? e.querySelectorAll(t || "*") : _;
        if (!o)
            for (o = [], n = e.childNodes || e; null != (r = n[i]); i++) !t || ge.nodeName(r, t) ? o.push(r) : ge.merge(o, Re(r, t));
        return t === _ || t && ge.nodeName(e, t) ? ge.merge([e], o) : o
    }

    function De(e) {
        ke.test(e.type) && (e.defaultChecked = e.checked)
    }
    Me.optgroup = Me.option, Me.tbody = Me.tfoot = Me.colgroup = Me.caption = Me.thead, Me.th = Me.td, ge.fn.extend({
        text: function(e) {
            return ge.access(this, function(e) {
                return e === _ ? ge.text(this) : this.empty().append((this[0] && this[0].ownerDocument || m).createTextNode(e))
            }, null, e, arguments.length)
        },
        wrapAll: function(t) {
            if (ge.isFunction(t)) return this.each(function(e) {
                ge(this).wrapAll(t.call(this, e))
            });
            if (this[0]) {
                var e = ge(t, this[0].ownerDocument).eq(0).clone(!0);
                this[0].parentNode && e.insertBefore(this[0]), e.map(function() {
                    for (var e = this; e.firstChild && 1 === e.firstChild.nodeType;) e = e.firstChild;
                    return e
                }).append(this)
            }
            return this
        },
        wrapInner: function(n) {
            return ge.isFunction(n) ? this.each(function(e) {
                ge(this).wrapInner(n.call(this, e))
            }) : this.each(function() {
                var e = ge(this),
                    t = e.contents();
                t.length ? t.wrapAll(n) : e.append(n)
            })
        },
        wrap: function(t) {
            var n = ge.isFunction(t);
            return this.each(function(e) {
                ge(this).wrapAll(n ? t.call(this, e) : t)
            })
        },
        unwrap: function() {
            return this.parent().each(function() {
                ge.nodeName(this, "body") || ge(this).replaceWith(this.childNodes)
            }).end()
        },
        append: function() {
            return this.domManip(arguments, !0, function(e) {
                1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || this.appendChild(e)
            })
        },
        prepend: function() {
            return this.domManip(arguments, !0, function(e) {
                1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || this.insertBefore(e, this.firstChild)
            })
        },
        before: function() {
            return this.domManip(arguments, !1, function(e) {
                this.parentNode && this.parentNode.insertBefore(e, this)
            })
        },
        after: function() {
            return this.domManip(arguments, !1, function(e) {
                this.parentNode && this.parentNode.insertBefore(e, this.nextSibling)
            })
        },
        remove: function(e, t) {
            for (var n, r = 0; null != (n = this[r]); r++)(!e || 0 < ge.filter(e, [n]).length) && (t || 1 !== n.nodeType || ge.cleanData(Re(n)), n.parentNode && (t && ge.contains(n.ownerDocument, n) && Ne(Re(n, "script")), n.parentNode.removeChild(n)));
            return this
        },
        empty: function() {
            for (var e, t = 0; null != (e = this[t]); t++) {
                for (1 === e.nodeType && ge.cleanData(Re(e, !1)); e.firstChild;) e.removeChild(e.firstChild);
                e.options && ge.nodeName(e, "select") && (e.options.length = 0)
            }
            return this
        },
        clone: function(e, t) {
            return e = null != e && e, t = null == t ? e : t, this.map(function() {
                return ge.clone(this, e, t)
            })
        },
        html: function(e) {
            return ge.access(this, function(e) {
                var t = this[0] || {},
                    n = 0,
                    r = this.length;
                if (e === _) return 1 === t.nodeType ? t.innerHTML.replace(fe, "") : _;
                if ("string" == typeof e && !we.test(e) && (ge.support.htmlSerialize || !pe.test(e)) && (ge.support.leadingWhitespace || !me.test(e)) && !Me[(ye.exec(e) || ["", ""])[1].toLowerCase()]) {
                    e = e.replace(ve, "<$1></$2>");
                    try {
                        for (; n < r; n++) 1 === (t = this[n] || {}).nodeType && (ge.cleanData(Re(t, !1)), t.innerHTML = e);
                        t = 0
                    } catch (e) {}
                }
                t && this.empty().append(e)
            }, null, e, arguments.length)
        },
        replaceWith: function(e) {
            return ge.isFunction(e) || "string" == typeof e || (e = ge(e).not(this).detach()), this.domManip([e], !0, function(e) {
                var t = this.nextSibling,
                    n = this.parentNode;
                n && (ge(this).remove(), n.insertBefore(e, t))
            })
        },
        detach: function(e) {
            return this.remove(e, !0)
        },
        domManip: function(n, r, i) {
            n = y.apply([], n);
            var e, t, o, s, a, l, c, u, h = 0,
                d = this.length,
                f = this,
                p = d - 1,
                m = n[0],
                g = ge.isFunction(m);
            if (g || !(d <= 1 || "string" != typeof m || ge.support.checkClone) && _e.test(m)) return this.each(function(e) {
                var t = f.eq(e);
                g && (n[0] = m.call(this, e, r ? t.html() : _)), t.domManip(n, r, i)
            });
            if (d && (e = (l = ge.buildFragment(n, this[0].ownerDocument, !1, this)).firstChild, 1 === l.childNodes.length && (l = e), e)) {
                for (r = r && ge.nodeName(e, "tr"), o = (s = ge.map(Re(l, "script"), Le)).length; h < d; h++) t = l, h !== p && (t = ge.clone(t, !0, !0), o && ge.merge(s, Re(t, "script"))), i.call(r && ge.nodeName(this[h], "table") ? (c = this[h], u = "tbody", c.getElementsByTagName(u)[0] || c.appendChild(c.ownerDocument.createElement(u))) : this[h], t, h);
                if (o)
                    for (a = s[s.length - 1].ownerDocument, ge.map(s, Ee), h = 0; h < o; h++) t = s[h], Ce.test(t.type || "") && !ge._data(t, "globalEval") && ge.contains(a, t) && (t.src ? ge.ajax({
                        url: t.src,
                        type: "GET",
                        dataType: "script",
                        async: !1,
                        global: !1,
                        throws: !0
                    }) : ge.globalEval((t.text || t.textContent || t.innerHTML || "").replace(Te, "")));
                l = e = null
            }
            return this
        }
    }), ge.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function(e, s) {
        ge.fn[e] = function(e) {
            for (var t, n = 0, r = [], i = ge(e), o = i.length - 1; n <= o; n++) t = n === o ? this : this.clone(!0), ge(i[n])[s](t), a.apply(r, t.get());
            return this.pushStack(r)
        }
    }), ge.extend({
        clone: function(e, t, n) {
            var r, i, o, s, a, l = ge.contains(e.ownerDocument, e);
            if (ge.support.html5Clone || ge.isXMLDoc(e) || !pe.test("<" + e.nodeName + ">") ? o = e.cloneNode(!0) : (Ae.innerHTML = e.outerHTML, Ae.removeChild(o = Ae.firstChild)), !(ge.support.noCloneEvent && ge.support.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || ge.isXMLDoc(e)))
                for (r = Re(o), a = Re(e), s = 0; null != (i = a[s]); ++s) r[s] && Oe(i, r[s]);
            if (t)
                if (n)
                    for (a = a || Re(e), r = r || Re(o), s = 0; null != (i = a[s]); s++) Ie(i, r[s]);
                else Ie(e, o);
            return 0 < (r = Re(o, "script")).length && Ne(r, !l && Re(e, "script")), r = a = i = null, o
        },
        buildFragment: function(e, t, n, r) {
            for (var i, o, s, a, l, c, u, h = e.length, d = he(t), f = [], p = 0; p < h; p++)
                if ((o = e[p]) || 0 === o)
                    if ("object" === ge.type(o)) ge.merge(f, o.nodeType ? [o] : o);
                    else if (xe.test(o)) {
                for (a = a || d.appendChild(t.createElement("div")), l = (ye.exec(o) || ["", ""])[1].toLowerCase(), u = Me[l] || Me._default, a.innerHTML = u[1] + o.replace(ve, "<$1></$2>") + u[2], i = u[0]; i--;) a = a.lastChild;
                if (!ge.support.leadingWhitespace && me.test(o) && f.push(t.createTextNode(me.exec(o)[0])), !ge.support.tbody)
                    for (i = (o = "table" !== l || be.test(o) ? "<table>" !== u[1] || be.test(o) ? 0 : a : a.firstChild) && o.childNodes.length; i--;) ge.nodeName(c = o.childNodes[i], "tbody") && !c.childNodes.length && o.removeChild(c);
                for (ge.merge(f, a.childNodes), a.textContent = ""; a.firstChild;) a.removeChild(a.firstChild);
                a = d.lastChild
            } else f.push(t.createTextNode(o));
            for (a && d.removeChild(a), ge.support.appendChecked || ge.grep(Re(f, "input"), De), p = 0; o = f[p++];)
                if ((!r || -1 === ge.inArray(o, r)) && (s = ge.contains(o.ownerDocument, o), a = Re(d.appendChild(o), "script"), s && Ne(a), n))
                    for (i = 0; o = a[i++];) Ce.test(o.type || "") && n.push(o);
            return a = null, d
        },
        cleanData: function(e, t) {
            for (var n, r, i, o, s = 0, a = ge.expando, l = ge.cache, c = ge.support.deleteExpando, u = ge.event.special; null != (n = e[s]); s++)
                if ((t || ge.acceptData(n)) && (o = (i = n[a]) && l[i])) {
                    if (o.events)
                        for (r in o.events) u[r] ? ge.event.remove(n, r) : ge.removeEvent(n, r, o.handle);
                    l[i] && (delete l[i], c ? delete n[a] : typeof n.removeAttribute !== v ? n.removeAttribute(a) : n[a] = null, h.push(i))
                }
        }
    });
    var Pe, $e, He, Fe = /alpha\([^)]*\)/i,
        Be = /opacity\s*=\s*([^)]*)/,
        ze = /^(top|right|bottom|left)$/,
        qe = /^(none|table(?!-c[ea]).+)/,
        je = /^margin/,
        We = new RegExp("^(" + f + ")(.*)$", "i"),
        Ue = new RegExp("^(" + f + ")(?!px)[a-z%]+$", "i"),
        Ke = new RegExp("^([+-])=(" + f + ")", "i"),
        Ve = {
            BODY: "block"
        },
        Ge = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        Ye = {
            letterSpacing: 0,
            fontWeight: 400
        },
        Xe = ["Top", "Right", "Bottom", "Left"],
        Qe = ["Webkit", "O", "Moz", "ms"];

    function Je(e, t) {
        if (t in e) return t;
        for (var n = t.charAt(0).toUpperCase() + t.slice(1), r = t, i = Qe.length; i--;)
            if ((t = Qe[i] + n) in e) return t;
        return r
    }

    function Ze(e, t) {
        return e = t || e, "none" === ge.css(e, "display") || !ge.contains(e.ownerDocument, e)
    }

    function et(e, t) {
        for (var n, r, i, o = [], s = 0, a = e.length; s < a; s++)(r = e[s]).style && (o[s] = ge._data(r, "olddisplay"), n = r.style.display, t ? (o[s] || "none" !== n || (r.style.display = ""), "" === r.style.display && Ze(r) && (o[s] = ge._data(r, "olddisplay", it(r.nodeName)))) : o[s] || (i = Ze(r), (n && "none" !== n || !i) && ge._data(r, "olddisplay", i ? n : ge.css(r, "display"))));
        for (s = 0; s < a; s++)(r = e[s]).style && (t && "none" !== r.style.display && "" !== r.style.display || (r.style.display = t ? o[s] || "" : "none"));
        return e
    }

    function tt(e, t, n) {
        var r = We.exec(t);
        return r ? Math.max(0, r[1] - (n || 0)) + (r[2] || "px") : t
    }

    function nt(e, t, n, r, i) {
        for (var o = n === (r ? "border" : "content") ? 4 : "width" === t ? 1 : 0, s = 0; o < 4; o += 2) "margin" === n && (s += ge.css(e, n + Xe[o], !0, i)), r ? ("content" === n && (s -= ge.css(e, "padding" + Xe[o], !0, i)), "margin" !== n && (s -= ge.css(e, "border" + Xe[o] + "Width", !0, i))) : (s += ge.css(e, "padding" + Xe[o], !0, i), "padding" !== n && (s += ge.css(e, "border" + Xe[o] + "Width", !0, i)));
        return s
    }

    function rt(e, t, n) {
        var r = !0,
            i = "width" === t ? e.offsetWidth : e.offsetHeight,
            o = $e(e),
            s = ge.support.boxSizing && "border-box" === ge.css(e, "boxSizing", !1, o);
        if (i <= 0 || null == i) {
            if (((i = He(e, t, o)) < 0 || null == i) && (i = e.style[t]), Ue.test(i)) return i;
            r = s && (ge.support.boxSizingReliable || i === e.style[t]), i = parseFloat(i) || 0
        }
        return i + nt(e, t, n || (s ? "border" : "content"), r, o) + "px"
    }

    function it(e) {
        var t = m,
            n = Ve[e];
        return n || ("none" !== (n = ot(e, t)) && n || ((t = ((Pe = (Pe || ge("<iframe frameborder='0' width='0' height='0'/>").css("cssText", "display:block !important")).appendTo(t.documentElement))[0].contentWindow || Pe[0].contentDocument).document).write("<!doctype html><html><body>"), t.close(), n = ot(e, t), Pe.detach()), Ve[e] = n), n
    }

    function ot(e, t) {
        var n = ge(t.createElement(e)).appendTo(t.body),
            r = ge.css(n[0], "display");
        return n.remove(), r
    }
    ge.fn.extend({
        css: function(e, t) {
            return ge.access(this, function(e, t, n) {
                var r, i, o = {},
                    s = 0;
                if (ge.isArray(t)) {
                    for (i = $e(e), r = t.length; s < r; s++) o[t[s]] = ge.css(e, t[s], !1, i);
                    return o
                }
                return n !== _ ? ge.style(e, t, n) : ge.css(e, t)
            }, e, t, 1 < arguments.length)
        },
        show: function() {
            return et(this, !0)
        },
        hide: function() {
            return et(this)
        },
        toggle: function(e) {
            var t = "boolean" == typeof e;
            return this.each(function() {
                (t ? e : Ze(this)) ? ge(this).show(): ge(this).hide()
            })
        }
    }), ge.extend({
        cssHooks: {
            opacity: {
                get: function(e, t) {
                    if (t) {
                        var n = He(e, "opacity");
                        return "" === n ? "1" : n
                    }
                }
            }
        },
        cssNumber: {
            columnCount: !0,
            fillOpacity: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {
            float: ge.support.cssFloat ? "cssFloat" : "styleFloat"
        },
        style: function(e, t, n, r) {
            if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
                var i, o, s, a = ge.camelCase(t),
                    l = e.style;
                if (t = ge.cssProps[a] || (ge.cssProps[a] = Je(l, a)), s = ge.cssHooks[t] || ge.cssHooks[a], n === _) return s && "get" in s && (i = s.get(e, !1, r)) !== _ ? i : l[t];
                if (!("string" === (o = typeof n) && (i = Ke.exec(n)) && (n = (i[1] + 1) * i[2] + parseFloat(ge.css(e, t)), o = "number"), null == n || "number" === o && isNaN(n) || ("number" !== o || ge.cssNumber[a] || (n += "px"), ge.support.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (l[t] = "inherit"), s && "set" in s && (n = s.set(e, n, r)) === _))) try {
                    l[t] = n
                } catch (e) {}
            }
        },
        css: function(e, t, n, r) {
            var i, o, s, a = ge.camelCase(t);
            return t = ge.cssProps[a] || (ge.cssProps[a] = Je(e.style, a)), (s = ge.cssHooks[t] || ge.cssHooks[a]) && "get" in s && (o = s.get(e, !0, n)), o === _ && (o = He(e, t, r)), "normal" === o && t in Ye && (o = Ye[t]), "" === n || n ? (i = parseFloat(o), !0 === n || ge.isNumeric(i) ? i || 0 : o) : o
        },
        swap: function(e, t, n, r) {
            var i, o, s = {};
            for (o in t) s[o] = e.style[o], e.style[o] = t[o];
            for (o in i = n.apply(e, r || []), t) e.style[o] = s[o];
            return i
        }
    }), p.getComputedStyle ? ($e = function(e) {
        return p.getComputedStyle(e, null)
    }, He = function(e, t, n) {
        var r, i, o, s = n || $e(e),
            a = s ? s.getPropertyValue(t) || s[t] : _,
            l = e.style;
        return s && ("" !== a || ge.contains(e.ownerDocument, e) || (a = ge.style(e, t)), Ue.test(a) && je.test(t) && (r = l.width, i = l.minWidth, o = l.maxWidth, l.minWidth = l.maxWidth = l.width = a, a = s.width, l.width = r, l.minWidth = i, l.maxWidth = o)), a
    }) : m.documentElement.currentStyle && ($e = function(e) {
        return e.currentStyle
    }, He = function(e, t, n) {
        var r, i, o, s = n || $e(e),
            a = s ? s[t] : _,
            l = e.style;
        return null == a && l && l[t] && (a = l[t]), Ue.test(a) && !ze.test(t) && (r = l.left, (o = (i = e.runtimeStyle) && i.left) && (i.left = e.currentStyle.left), l.left = "fontSize" === t ? "1em" : a, a = l.pixelLeft + "px", l.left = r, o && (i.left = o)), "" === a ? "auto" : a
    }), ge.each(["height", "width"], function(e, i) {
        ge.cssHooks[i] = {
            get: function(e, t, n) {
                if (t) return 0 === e.offsetWidth && qe.test(ge.css(e, "display")) ? ge.swap(e, Ge, function() {
                    return rt(e, i, n)
                }) : rt(e, i, n)
            },
            set: function(e, t, n) {
                var r = n && $e(e);
                return tt(0, t, n ? nt(e, i, n, ge.support.boxSizing && "border-box" === ge.css(e, "boxSizing", !1, r), r) : 0)
            }
        }
    }), ge.support.opacity || (ge.cssHooks.opacity = {
        get: function(e, t) {
            return Be.test((t && e.currentStyle ? e.currentStyle.filter : e.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "" : t ? "1" : ""
        },
        set: function(e, t) {
            var n = e.style,
                r = e.currentStyle,
                i = ge.isNumeric(t) ? "alpha(opacity=" + 100 * t + ")" : "",
                o = r && r.filter || n.filter || "";
            ((n.zoom = 1) <= t || "" === t) && "" === ge.trim(o.replace(Fe, "")) && n.removeAttribute && (n.removeAttribute("filter"), "" === t || r && !r.filter) || (n.filter = Fe.test(o) ? o.replace(Fe, i) : o + " " + i)
        }
    }), ge(function() {
        ge.support.reliableMarginRight || (ge.cssHooks.marginRight = {
            get: function(e, t) {
                if (t) return ge.swap(e, {
                    display: "inline-block"
                }, He, [e, "marginRight"])
            }
        }), !ge.support.pixelPosition && ge.fn.position && ge.each(["top", "left"], function(e, n) {
            ge.cssHooks[n] = {
                get: function(e, t) {
                    if (t) return t = He(e, n), Ue.test(t) ? ge(e).position()[n] + "px" : t
                }
            }
        })
    }), ge.expr && ge.expr.filters && (ge.expr.filters.hidden = function(e) {
        return e.offsetWidth <= 0 && e.offsetHeight <= 0 || !ge.support.reliableHiddenOffsets && "none" === (e.style && e.style.display || ge.css(e, "display"))
    }, ge.expr.filters.visible = function(e) {
        return !ge.expr.filters.hidden(e)
    }), ge.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function(i, o) {
        ge.cssHooks[i + o] = {
            expand: function(e) {
                for (var t = 0, n = {}, r = "string" == typeof e ? e.split(" ") : [e]; t < 4; t++) n[i + Xe[t] + o] = r[t] || r[t - 2] || r[0];
                return n
            }
        }, je.test(i) || (ge.cssHooks[i + o].set = tt)
    });
    var st = /%20/g,
        at = /\[\]$/,
        lt = /\r?\n/g,
        ct = /^(?:submit|button|image|reset|file)$/i,
        ut = /^(?:input|select|textarea|keygen)/i;

    function ht(n, e, r, i) {
        var t;
        if (ge.isArray(e)) ge.each(e, function(e, t) {
            r || at.test(n) ? i(n, t) : ht(n + "[" + ("object" == typeof t ? e : "") + "]", t, r, i)
        });
        else if (r || "object" !== ge.type(e)) i(n, e);
        else
            for (t in e) ht(n + "[" + t + "]", e[t], r, i)
    }
    ge.fn.extend({
        serialize: function() {
            return ge.param(this.serializeArray())
        },
        serializeArray: function() {
            return this.map(function() {
                var e = ge.prop(this, "elements");
                return e ? ge.makeArray(e) : this
            }).filter(function() {
                var e = this.type;
                return this.name && !ge(this).is(":disabled") && ut.test(this.nodeName) && !ct.test(e) && (this.checked || !ke.test(e))
            }).map(function(e, t) {
                var n = ge(this).val();
                return null == n ? null : ge.isArray(n) ? ge.map(n, function(e) {
                    return {
                        name: t.name,
                        value: e.replace(lt, "\r\n")
                    }
                }) : {
                    name: t.name,
                    value: n.replace(lt, "\r\n")
                }
            }).get()
        }
    }), ge.param = function(e, t) {
        var n, r = [],
            i = function(e, t) {
                t = ge.isFunction(t) ? t() : null == t ? "" : t, r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t)
            };
        if (t === _ && (t = ge.ajaxSettings && ge.ajaxSettings.traditional), ge.isArray(e) || e.jquery && !ge.isPlainObject(e)) ge.each(e, function() {
            i(this.name, this.value)
        });
        else
            for (n in e) ht(n, e[n], t, i);
        return r.join("&").replace(st, "+")
    }, ge.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(e, n) {
        ge.fn[n] = function(e, t) {
            return 0 < arguments.length ? this.on(n, null, e, t) : this.trigger(n)
        }
    }), ge.fn.hover = function(e, t) {
        return this.mouseenter(e).mouseleave(t || e)
    };
    var dt, ft, pt = ge.now(),
        mt = /\?/,
        gt = /#.*$/,
        vt = /([?&])_=[^&]*/,
        yt = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
        bt = /^(?:GET|HEAD)$/,
        xt = /^\/\//,
        wt = /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
        kt = ge.fn.load,
        _t = {},
        Ct = {},
        St = "*/".concat("*");
    try {
        ft = e.href
    } catch (e) {
        (ft = m.createElement("a")).href = "", ft = ft.href
    }

    function Tt(o) {
        return function(e, t) {
            "string" != typeof e && (t = e, e = "*");
            var n, r = 0,
                i = e.toLowerCase().match(C) || [];
            if (ge.isFunction(t))
                for (; n = i[r++];) "+" === n[0] ? (n = n.slice(1) || "*", (o[n] = o[n] || []).unshift(t)) : (o[n] = o[n] || []).push(t)
        }
    }

    function Mt(t, i, o, s) {
        var a = {},
            l = t === Ct;

        function c(e) {
            var r;
            return a[e] = !0, ge.each(t[e] || [], function(e, t) {
                var n = t(i, o, s);
                return "string" != typeof n || l || a[n] ? l ? !(r = n) : void 0 : (i.dataTypes.unshift(n), c(n), !1)
            }), r
        }
        return c(i.dataTypes[0]) || !a["*"] && c("*")
    }

    function At(e, t) {
        var n, r, i = ge.ajaxSettings.flatOptions || {};
        for (r in t) t[r] !== _ && ((i[r] ? e : n || (n = {}))[r] = t[r]);
        return n && ge.extend(!0, e, n), e
    }
    dt = wt.exec(ft.toLowerCase()) || [], ge.fn.load = function(e, t, n) {
        if ("string" != typeof e && kt) return kt.apply(this, arguments);
        var r, i, o, s = this,
            a = e.indexOf(" ");
        return 0 <= a && (r = e.slice(a, e.length), e = e.slice(0, a)), ge.isFunction(t) ? (n = t, t = _) : t && "object" == typeof t && (o = "POST"), 0 < s.length && ge.ajax({
            url: e,
            type: o,
            dataType: "html",
            data: t
        }).done(function(e) {
            i = arguments, s.html(r ? ge("<div>").append(ge.parseHTML(e)).find(r) : e)
        }).complete(n && function(e, t) {
            s.each(n, i || [e.responseText, t, e])
        }), this
    }, ge.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(e, t) {
        ge.fn[t] = function(e) {
            return this.on(t, e)
        }
    }), ge.each(["get", "post"], function(e, i) {
        ge[i] = function(e, t, n, r) {
            return ge.isFunction(t) && (r = r || n, n = t, t = _), ge.ajax({
                url: e,
                type: i,
                dataType: r,
                data: t,
                success: n
            })
        }
    }), ge.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: ft,
            type: "GET",
            isLocal: /^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(dt[1]),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": St,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {
                xml: /xml/,
                html: /html/,
                json: /json/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText"
            },
            converters: {
                "* text": p.String,
                "text html": !0,
                "text json": ge.parseJSON,
                "text xml": ge.parseXML
            },
            flatOptions: {
                url: !0,
                context: !0
            }
        },
        ajaxSetup: function(e, t) {
            return t ? At(At(e, ge.ajaxSettings), t) : At(ge.ajaxSettings, e)
        },
        ajaxPrefilter: Tt(_t),
        ajaxTransport: Tt(Ct),
        ajax: function(e, t) {
            "object" == typeof e && (t = e, e = _), t = t || {};
            var n, r, u, h, d, f, p, i, m = ge.ajaxSetup({}, t),
                g = m.context || m,
                v = m.context && (g.nodeType || g.jquery) ? ge(g) : ge.event,
                y = ge.Deferred(),
                b = ge.Callbacks("once memory"),
                x = m.statusCode || {},
                o = {},
                s = {},
                w = 0,
                a = "canceled",
                k = {
                    readyState: 0,
                    getResponseHeader: function(e) {
                        var t;
                        if (2 === w) {
                            if (!i)
                                for (i = {}; t = yt.exec(h);) i[t[1].toLowerCase()] = t[2];
                            t = i[e.toLowerCase()]
                        }
                        return null == t ? null : t
                    },
                    getAllResponseHeaders: function() {
                        return 2 === w ? h : null
                    },
                    setRequestHeader: function(e, t) {
                        var n = e.toLowerCase();
                        return w || (e = s[n] = s[n] || e, o[e] = t), this
                    },
                    overrideMimeType: function(e) {
                        return w || (m.mimeType = e), this
                    },
                    statusCode: function(e) {
                        var t;
                        if (e)
                            if (w < 2)
                                for (t in e) x[t] = [x[t], e[t]];
                            else k.always(e[k.status]);
                        return this
                    },
                    abort: function(e) {
                        var t = e || a;
                        return p && p.abort(t), l(0, t), this
                    }
                };
            if (y.promise(k).complete = b.add, k.success = k.done, k.error = k.fail, m.url = ((e || m.url || ft) + "").replace(gt, "").replace(xt, dt[1] + "//"), m.type = t.method || t.type || m.method || m.type, m.dataTypes = ge.trim(m.dataType || "*").toLowerCase().match(C) || [""], null == m.crossDomain && (n = wt.exec(m.url.toLowerCase()), m.crossDomain = !(!n || n[1] === dt[1] && n[2] === dt[2] && (n[3] || ("http:" === n[1] ? 80 : 443)) == (dt[3] || ("http:" === dt[1] ? 80 : 443)))), m.data && m.processData && "string" != typeof m.data && (m.data = ge.param(m.data, m.traditional)), Mt(_t, m, t, k), 2 === w) return k;
            for (r in (f = m.global) && 0 == ge.active++ && ge.event.trigger("ajaxStart"), m.type = m.type.toUpperCase(), m.hasContent = !bt.test(m.type), u = m.url, m.hasContent || (m.data && (u = m.url += (mt.test(u) ? "&" : "?") + m.data, delete m.data), !1 === m.cache && (m.url = vt.test(u) ? u.replace(vt, "$1_=" + pt++) : u + (mt.test(u) ? "&" : "?") + "_=" + pt++)), m.ifModified && (ge.lastModified[u] && k.setRequestHeader("If-Modified-Since", ge.lastModified[u]), ge.etag[u] && k.setRequestHeader("If-None-Match", ge.etag[u])), (m.data && m.hasContent && !1 !== m.contentType || t.contentType) && k.setRequestHeader("Content-Type", m.contentType), k.setRequestHeader("Accept", m.dataTypes[0] && m.accepts[m.dataTypes[0]] ? m.accepts[m.dataTypes[0]] + ("*" !== m.dataTypes[0] ? ", " + St + "; q=0.01" : "") : m.accepts["*"]), m.headers) k.setRequestHeader(r, m.headers[r]);
            if (m.beforeSend && (!1 === m.beforeSend.call(g, k, m) || 2 === w)) return k.abort();
            for (r in a = "abort", {
                    success: 1,
                    error: 1,
                    complete: 1
                }) k[r](m[r]);
            if (p = Mt(Ct, m, t, k)) {
                k.readyState = 1, f && v.trigger("ajaxSend", [k, m]), m.async && 0 < m.timeout && (d = setTimeout(function() {
                    k.abort("timeout")
                }, m.timeout));
                try {
                    w = 1, p.send(o, l)
                } catch (e) {
                    if (!(w < 2)) throw e;
                    l(-1, e)
                }
            } else l(-1, "No Transport");

            function l(e, t, n, r) {
                var i, o, s, a, l, c = t;
                2 !== w && (w = 2, d && clearTimeout(d), p = _, h = r || "", k.readyState = 0 < e ? 4 : 0, n && (a = function(e, t, n) {
                    var r, i, o, s, a = e.contents,
                        l = e.dataTypes,
                        c = e.responseFields;
                    for (s in c) s in n && (t[c[s]] = n[s]);
                    for (;
                        "*" === l[0];) l.shift(), i === _ && (i = e.mimeType || t.getResponseHeader("Content-Type"));
                    if (i)
                        for (s in a)
                            if (a[s] && a[s].test(i)) {
                                l.unshift(s);
                                break
                            } if (l[0] in n) o = l[0];
                    else {
                        for (s in n) {
                            if (!l[0] || e.converters[s + " " + l[0]]) {
                                o = s;
                                break
                            }
                            r || (r = s)
                        }
                        o = o || r
                    }
                    if (o) return o !== l[0] && l.unshift(o), n[o]
                }(m, k, n)), 200 <= e && e < 300 || 304 === e ? (m.ifModified && ((l = k.getResponseHeader("Last-Modified")) && (ge.lastModified[u] = l), (l = k.getResponseHeader("etag")) && (ge.etag[u] = l)), 204 === e ? (i = !0, c = "nocontent") : 304 === e ? (i = !0, c = "notmodified") : (c = (i = function(e, t) {
                    var n, r, i, o, s = {},
                        a = 0,
                        l = e.dataTypes.slice(),
                        c = l[0];
                    e.dataFilter && (t = e.dataFilter(t, e.dataType));
                    if (l[1])
                        for (i in e.converters) s[i.toLowerCase()] = e.converters[i];
                    for (; r = l[++a];)
                        if ("*" !== r) {
                            if ("*" !== c && c !== r) {
                                if (!(i = s[c + " " + r] || s["* " + r]))
                                    for (n in s)
                                        if ((o = n.split(" "))[1] === r && (i = s[c + " " + o[0]] || s["* " + o[0]])) {
                                            !0 === i ? i = s[n] : !0 !== s[n] && (r = o[0], l.splice(a--, 0, r));
                                            break
                                        } if (!0 !== i)
                                    if (i && e.throws) t = i(t);
                                    else try {
                                        t = i(t)
                                    } catch (e) {
                                        return {
                                            state: "parsererror",
                                            error: i ? e : "No conversion from " + c + " to " + r
                                        }
                                    }
                            }
                            c = r
                        } return {
                        state: "success",
                        data: t
                    }
                }(m, a)).state, o = i.data, i = !(s = i.error))) : (s = c, !e && c || (c = "error", e < 0 && (e = 0))), k.status = e, k.statusText = (t || c) + "", i ? y.resolveWith(g, [o, c, k]) : y.rejectWith(g, [k, c, s]), k.statusCode(x), x = _, f && v.trigger(i ? "ajaxSuccess" : "ajaxError", [k, m, i ? o : s]), b.fireWith(g, [k, c]), f && (v.trigger("ajaxComplete", [k, m]), --ge.active || ge.event.trigger("ajaxStop")))
            }
            return k
        },
        getScript: function(e, t) {
            return ge.get(e, _, t, "script")
        },
        getJSON: function(e, t, n) {
            return ge.get(e, t, n, "json")
        }
    }), ge.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /(?:java|ecma)script/
        },
        converters: {
            "text script": function(e) {
                return ge.globalEval(e), e
            }
        }
    }), ge.ajaxPrefilter("script", function(e) {
        e.cache === _ && (e.cache = !1), e.crossDomain && (e.type = "GET", e.global = !1)
    }), ge.ajaxTransport("script", function(t) {
        if (t.crossDomain) {
            var r, i = m.head || ge("head")[0] || m.documentElement;
            return {
                send: function(e, n) {
                    (r = m.createElement("script")).async = !0, t.scriptCharset && (r.charset = t.scriptCharset), r.src = t.url, r.onload = r.onreadystatechange = function(e, t) {
                        (t || !r.readyState || /loaded|complete/.test(r.readyState)) && (r.onload = r.onreadystatechange = null, r.parentNode && r.parentNode.removeChild(r), r = null, t || n(200, "success"))
                    }, i.insertBefore(r, i.firstChild)
                },
                abort: function() {
                    r && r.onload(_, !0)
                }
            }
        }
    });
    var Lt = [],
        Et = /(=)\?(?=&|$)|\?\?/;
    ge.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var e = Lt.pop() || ge.expando + "_" + pt++;
            return this[e] = !0, e
        }
    }), ge.ajaxPrefilter("json jsonp", function(e, t, n) {
        var r, i, o, s = !1 !== e.jsonp && (Et.test(e.url) ? "url" : "string" == typeof e.data && !(e.contentType || "").indexOf("application/x-www-form-urlencoded") && Et.test(e.data) && "data");
        if (s || "jsonp" === e.dataTypes[0]) return r = e.jsonpCallback = ge.isFunction(e.jsonpCallback) ? e.jsonpCallback() : e.jsonpCallback, s ? e[s] = e[s].replace(Et, "$1" + r) : !1 !== e.jsonp && (e.url += (mt.test(e.url) ? "&" : "?") + e.jsonp + "=" + r), e.converters["script json"] = function() {
            return o || ge.error(r + " was not called"), o[0]
        }, e.dataTypes[0] = "json", i = p[r], p[r] = function() {
            o = arguments
        }, n.always(function() {
            p[r] = i, e[r] && (e.jsonpCallback = t.jsonpCallback, Lt.push(r)), o && ge.isFunction(i) && i(o[0]), o = i = _
        }), "script"
    });
    var Nt, It, Ot = 0,
        Rt = p.ActiveXObject && function() {
            var e;
            for (e in Nt) Nt[e](_, !0)
        };

    function Dt() {
        try {
            return new p.XMLHttpRequest
        } catch (e) {}
    }
    ge.ajaxSettings.xhr = p.ActiveXObject ? function() {
        return !this.isLocal && Dt() || function() {
            try {
                return new p.ActiveXObject("Microsoft.XMLHTTP")
            } catch (e) {}
        }()
    } : Dt, It = ge.ajaxSettings.xhr(), ge.support.cors = !!It && "withCredentials" in It, (It = ge.support.ajax = !!It) && ge.ajaxTransport(function(c) {
        var u;
        if (!c.crossDomain || ge.support.cors) return {
            send: function(e, s) {
                var a, t, l = c.xhr();
                if (c.username ? l.open(c.type, c.url, c.async, c.username, c.password) : l.open(c.type, c.url, c.async), c.xhrFields)
                    for (t in c.xhrFields) l[t] = c.xhrFields[t];
                c.mimeType && l.overrideMimeType && l.overrideMimeType(c.mimeType), c.crossDomain || e["X-Requested-With"] || (e["X-Requested-With"] = "XMLHttpRequest");
                try {
                    for (t in e) l.setRequestHeader(t, e[t])
                } catch (e) {}
                l.send(c.hasContent && c.data || null), u = function(e, t) {
                    var n, r, i, o;
                    try {
                        if (u && (t || 4 === l.readyState))
                            if (u = _, a && (l.onreadystatechange = ge.noop, Rt && delete Nt[a]), t) 4 !== l.readyState && l.abort();
                            else {
                                o = {}, n = l.status, r = l.getAllResponseHeaders(), "string" == typeof l.responseText && (o.text = l.responseText);
                                try {
                                    i = l.statusText
                                } catch (e) {
                                    i = ""
                                }
                                n || !c.isLocal || c.crossDomain ? 1223 === n && (n = 204) : n = o.text ? 200 : 404
                            }
                    } catch (e) {
                        t || s(-1, e)
                    }
                    o && s(n, i, o, r)
                }, c.async ? 4 === l.readyState ? setTimeout(u) : (a = ++Ot, Rt && (Nt || (Nt = {}, ge(p).unload(Rt)), Nt[a] = u), l.onreadystatechange = u) : u()
            },
            abort: function() {
                u && u(_, !0)
            }
        }
    });
    var Pt, $t, Ht = /^(?:toggle|show|hide)$/,
        Ft = new RegExp("^(?:([+-])=|)(" + f + ")([a-z%]*)$", "i"),
        Bt = /queueHooks$/,
        zt = [function(t, e, n) {
            var r, i, o, s, a, l, c, u, h, d = this,
                f = t.style,
                p = {},
                m = [],
                g = t.nodeType && Ze(t);
            n.queue || (null == (u = ge._queueHooks(t, "fx")).unqueued && (u.unqueued = 0, h = u.empty.fire, u.empty.fire = function() {
                u.unqueued || h()
            }), u.unqueued++, d.always(function() {
                d.always(function() {
                    u.unqueued--, ge.queue(t, "fx").length || u.empty.fire()
                })
            }));
            1 === t.nodeType && ("height" in e || "width" in e) && (n.overflow = [f.overflow, f.overflowX, f.overflowY], "inline" === ge.css(t, "display") && "none" === ge.css(t, "float") && (ge.support.inlineBlockNeedsLayout && "inline" !== it(t.nodeName) ? f.zoom = 1 : f.display = "inline-block"));
            n.overflow && (f.overflow = "hidden", ge.support.shrinkWrapBlocks || d.always(function() {
                f.overflow = n.overflow[0], f.overflowX = n.overflow[1], f.overflowY = n.overflow[2]
            }));
            for (i in e)
                if (s = e[i], Ht.exec(s)) {
                    if (delete e[i], l = l || "toggle" === s, s === (g ? "hide" : "show")) continue;
                    m.push(i)
                } if (o = m.length) {
                "hidden" in (a = ge._data(t, "fxshow") || ge._data(t, "fxshow", {})) && (g = a.hidden), l && (a.hidden = !g), g ? ge(t).show() : d.done(function() {
                    ge(t).hide()
                }), d.done(function() {
                    var e;
                    for (e in ge._removeData(t, "fxshow"), p) ge.style(t, e, p[e])
                });
                for (i = 0; i < o; i++) r = m[i], c = d.createTween(r, g ? a[r] : 0), p[r] = a[r] || ge.style(t, r), r in a || (a[r] = c.start, g && (c.end = c.start, c.start = "width" === r || "height" === r ? 1 : 0))
            }
        }],
        qt = {
            "*": [function(e, t) {
                var n, r, i = this.createTween(e, t),
                    o = Ft.exec(t),
                    s = i.cur(),
                    a = +s || 0,
                    l = 1,
                    c = 20;
                if (o) {
                    if (n = +o[2], "px" !== (r = o[3] || (ge.cssNumber[e] ? "" : "px")) && a)
                        for (a = ge.css(i.elem, e, !0) || n || 1; a /= l = l || ".5", ge.style(i.elem, e, a + r), l !== (l = i.cur() / s) && 1 !== l && --c;);
                    i.unit = r, i.start = a, i.end = o[1] ? a + (o[1] + 1) * n : n
                }
                return i
            }]
        };

    function jt() {
        return setTimeout(function() {
            Pt = _
        }), Pt = ge.now()
    }

    function Wt(o, e, t) {
        var n, s, a, r, i = 0,
            l = zt.length,
            c = ge.Deferred().always(function() {
                delete u.elem
            }),
            u = function() {
                if (s) return !1;
                for (var e = Pt || jt(), t = Math.max(0, h.startTime + h.duration - e), n = 1 - (t / h.duration || 0), r = 0, i = h.tweens.length; r < i; r++) h.tweens[r].run(n);
                return c.notifyWith(o, [h, n, t]), n < 1 && i ? t : (c.resolveWith(o, [h]), !1)
            },
            h = c.promise({
                elem: o,
                props: ge.extend({}, e),
                opts: ge.extend(!0, {
                    specialEasing: {}
                }, t),
                originalProperties: e,
                originalOptions: t,
                startTime: Pt || jt(),
                duration: t.duration,
                tweens: [],
                createTween: function(e, t) {
                    var n = ge.Tween(o, h.opts, e, t, h.opts.specialEasing[e] || h.opts.easing);
                    return h.tweens.push(n), n
                },
                stop: function(e) {
                    var t = 0,
                        n = e ? h.tweens.length : 0;
                    if (s) return this;
                    for (s = !0; t < n; t++) h.tweens[t].run(1);
                    return e ? c.resolveWith(o, [h, e]) : c.rejectWith(o, [h, e]), this
                }
            }),
            d = h.props;
        for (! function(e, t) {
                var n, r, i, o, s;
                for (i in e)
                    if (r = ge.camelCase(i), o = t[r], n = e[i], ge.isArray(n) && (o = n[1], n = e[i] = n[0]), i !== r && (e[r] = n, delete e[i]), (s = ge.cssHooks[r]) && "expand" in s)
                        for (i in n = s.expand(n), delete e[r], n) i in e || (e[i] = n[i], t[i] = o);
                    else t[r] = o
            }(d, h.opts.specialEasing); i < l; i++)
            if (n = zt[i].call(h, o, d, h.opts)) return n;
        return a = h, r = d, ge.each(r, function(e, t) {
            for (var n = (qt[e] || []).concat(qt["*"]), r = 0, i = n.length; r < i; r++)
                if (n[r].call(a, e, t)) return
        }), ge.isFunction(h.opts.start) && h.opts.start.call(o, h), ge.fx.timer(ge.extend(u, {
            elem: o,
            anim: h,
            queue: h.opts.queue
        })), h.progress(h.opts.progress).done(h.opts.done, h.opts.complete).fail(h.opts.fail).always(h.opts.always)
    }

    function Ut(e, t, n, r, i) {
        return new Ut.prototype.init(e, t, n, r, i)
    }

    function Kt(e, t) {
        var n, r = {
                height: e
            },
            i = 0;
        for (t = t ? 1 : 0; i < 4; i += 2 - t) r["margin" + (n = Xe[i])] = r["padding" + n] = e;
        return t && (r.opacity = r.width = e), r
    }

    function Vt(e) {
        return ge.isWindow(e) ? e : 9 === e.nodeType && (e.defaultView || e.parentWindow)
    }
    ge.Animation = ge.extend(Wt, {
        tweener: function(e, t) {
            for (var n, r = 0, i = (e = ge.isFunction(e) ? (t = e, ["*"]) : e.split(" ")).length; r < i; r++) n = e[r], qt[n] = qt[n] || [], qt[n].unshift(t)
        },
        prefilter: function(e, t) {
            t ? zt.unshift(e) : zt.push(e)
        }
    }), ((ge.Tween = Ut).prototype = {
        constructor: Ut,
        init: function(e, t, n, r, i, o) {
            this.elem = e, this.prop = n, this.easing = i || "swing", this.options = t, this.start = this.now = this.cur(), this.end = r, this.unit = o || (ge.cssNumber[n] ? "" : "px")
        },
        cur: function() {
            var e = Ut.propHooks[this.prop];
            return e && e.get ? e.get(this) : Ut.propHooks._default.get(this)
        },
        run: function(e) {
            var t, n = Ut.propHooks[this.prop];
            return this.options.duration ? this.pos = t = ge.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : this.pos = t = e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), n && n.set ? n.set(this) : Ut.propHooks._default.set(this), this
        }
    }).init.prototype = Ut.prototype, (Ut.propHooks = {
        _default: {
            get: function(e) {
                var t;
                return null == e.elem[e.prop] || e.elem.style && null != e.elem.style[e.prop] ? (t = ge.css(e.elem, e.prop, "")) && "auto" !== t ? t : 0 : e.elem[e.prop]
            },
            set: function(e) {
                ge.fx.step[e.prop] ? ge.fx.step[e.prop](e) : e.elem.style && (null != e.elem.style[ge.cssProps[e.prop]] || ge.cssHooks[e.prop]) ? ge.style(e.elem, e.prop, e.now + e.unit) : e.elem[e.prop] = e.now
            }
        }
    }).scrollTop = Ut.propHooks.scrollLeft = {
        set: function(e) {
            e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now)
        }
    }, ge.each(["toggle", "show", "hide"], function(e, r) {
        var i = ge.fn[r];
        ge.fn[r] = function(e, t, n) {
            return null == e || "boolean" == typeof e ? i.apply(this, arguments) : this.animate(Kt(r, !0), e, t, n)
        }
    }), ge.fn.extend({
        fadeTo: function(e, t, n, r) {
            return this.filter(Ze).css("opacity", 0).show().end().animate({
                opacity: t
            }, e, n, r)
        },
        animate: function(t, e, n, r) {
            var i = ge.isEmptyObject(t),
                o = ge.speed(e, n, r),
                s = function() {
                    var e = Wt(this, ge.extend({}, t), o);
                    s.finish = function() {
                        e.stop(!0)
                    }, (i || ge._data(this, "finish")) && e.stop(!0)
                };
            return s.finish = s, i || !1 === o.queue ? this.each(s) : this.queue(o.queue, s)
        },
        stop: function(i, e, o) {
            var s = function(e) {
                var t = e.stop;
                delete e.stop, t(o)
            };
            return "string" != typeof i && (o = e, e = i, i = _), e && !1 !== i && this.queue(i || "fx", []), this.each(function() {
                var e = !0,
                    t = null != i && i + "queueHooks",
                    n = ge.timers,
                    r = ge._data(this);
                if (t) r[t] && r[t].stop && s(r[t]);
                else
                    for (t in r) r[t] && r[t].stop && Bt.test(t) && s(r[t]);
                for (t = n.length; t--;) n[t].elem !== this || null != i && n[t].queue !== i || (n[t].anim.stop(o), e = !1, n.splice(t, 1));
                !e && o || ge.dequeue(this, i)
            })
        },
        finish: function(s) {
            return !1 !== s && (s = s || "fx"), this.each(function() {
                var e, t = ge._data(this),
                    n = t[s + "queue"],
                    r = t[s + "queueHooks"],
                    i = ge.timers,
                    o = n ? n.length : 0;
                for (t.finish = !0, ge.queue(this, s, []), r && r.cur && r.cur.finish && r.cur.finish.call(this), e = i.length; e--;) i[e].elem === this && i[e].queue === s && (i[e].anim.stop(!0), i.splice(e, 1));
                for (e = 0; e < o; e++) n[e] && n[e].finish && n[e].finish.call(this);
                delete t.finish
            })
        }
    }), ge.each({
        slideDown: Kt("show"),
        slideUp: Kt("hide"),
        slideToggle: Kt("toggle"),
        fadeIn: {
            opacity: "show"
        },
        fadeOut: {
            opacity: "hide"
        },
        fadeToggle: {
            opacity: "toggle"
        }
    }, function(e, r) {
        ge.fn[e] = function(e, t, n) {
            return this.animate(r, e, t, n)
        }
    }), ge.speed = function(e, t, n) {
        var r = e && "object" == typeof e ? ge.extend({}, e) : {
            complete: n || !n && t || ge.isFunction(e) && e,
            duration: e,
            easing: n && t || t && !ge.isFunction(t) && t
        };
        return r.duration = ge.fx.off ? 0 : "number" == typeof r.duration ? r.duration : r.duration in ge.fx.speeds ? ge.fx.speeds[r.duration] : ge.fx.speeds._default, null != r.queue && !0 !== r.queue || (r.queue = "fx"), r.old = r.complete, r.complete = function() {
            ge.isFunction(r.old) && r.old.call(this), r.queue && ge.dequeue(this, r.queue)
        }, r
    }, ge.easing = {
        linear: function(e) {
            return e
        },
        swing: function(e) {
            return .5 - Math.cos(e * Math.PI) / 2
        }
    }, ge.timers = [], ge.fx = Ut.prototype.init, ge.fx.tick = function() {
        var e, t = ge.timers,
            n = 0;
        for (Pt = ge.now(); n < t.length; n++)(e = t[n])() || t[n] !== e || t.splice(n--, 1);
        t.length || ge.fx.stop(), Pt = _
    }, ge.fx.timer = function(e) {
        e() && ge.timers.push(e) && ge.fx.start()
    }, ge.fx.interval = 13, ge.fx.start = function() {
        $t || ($t = setInterval(ge.fx.tick, ge.fx.interval))
    }, ge.fx.stop = function() {
        clearInterval($t), $t = null
    }, ge.fx.speeds = {
        slow: 600,
        fast: 200,
        _default: 400
    }, ge.fx.step = {}, ge.expr && ge.expr.filters && (ge.expr.filters.animated = function(t) {
        return ge.grep(ge.timers, function(e) {
            return t === e.elem
        }).length
    }), ge.fn.offset = function(t) {
        if (arguments.length) return t === _ ? this : this.each(function(e) {
            ge.offset.setOffset(this, t, e)
        });
        var e, n, r = {
                top: 0,
                left: 0
            },
            i = this[0],
            o = i && i.ownerDocument;
        return o ? (e = o.documentElement, ge.contains(e, i) ? (typeof i.getBoundingClientRect !== v && (r = i.getBoundingClientRect()), n = Vt(o), {
            top: r.top + (n.pageYOffset || e.scrollTop) - (e.clientTop || 0),
            left: r.left + (n.pageXOffset || e.scrollLeft) - (e.clientLeft || 0)
        }) : r) : void 0
    }, ge.offset = {
        setOffset: function(e, t, n) {
            var r = ge.css(e, "position");
            "static" === r && (e.style.position = "relative");
            var i, o, s = ge(e),
                a = s.offset(),
                l = ge.css(e, "top"),
                c = ge.css(e, "left"),
                u = {},
                h = {};
            o = ("absolute" === r || "fixed" === r) && -1 < ge.inArray("auto", [l, c]) ? (i = (h = s.position()).top, h.left) : (i = parseFloat(l) || 0, parseFloat(c) || 0), ge.isFunction(t) && (t = t.call(e, n, a)), null != t.top && (u.top = t.top - a.top + i), null != t.left && (u.left = t.left - a.left + o), "using" in t ? t.using.call(e, u) : s.css(u)
        }
    }, ge.fn.extend({
        position: function() {
            if (this[0]) {
                var e, t, n = {
                        top: 0,
                        left: 0
                    },
                    r = this[0];
                return "fixed" === ge.css(r, "position") ? t = r.getBoundingClientRect() : (e = this.offsetParent(), t = this.offset(), ge.nodeName(e[0], "html") || (n = e.offset()), n.top += ge.css(e[0], "borderTopWidth", !0), n.left += ge.css(e[0], "borderLeftWidth", !0)), {
                    top: t.top - n.top - ge.css(r, "marginTop", !0),
                    left: t.left - n.left - ge.css(r, "marginLeft", !0)
                }
            }
        },
        offsetParent: function() {
            return this.map(function() {
                for (var e = this.offsetParent || m.documentElement; e && !ge.nodeName(e, "html") && "static" === ge.css(e, "position");) e = e.offsetParent;
                return e || m.documentElement
            })
        }
    }), ge.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function(t, i) {
        var o = /Y/.test(i);
        ge.fn[t] = function(e) {
            return ge.access(this, function(e, t, n) {
                var r = Vt(e);
                if (n === _) return r ? i in r ? r[i] : r.document.documentElement[t] : e[t];
                r ? r.scrollTo(o ? ge(r).scrollLeft() : n, o ? n : ge(r).scrollTop()) : e[t] = n
            }, t, e, arguments.length, null)
        }
    }), ge.each({
        Height: "height",
        Width: "width"
    }, function(o, s) {
        ge.each({
            padding: "inner" + o,
            content: s,
            "": "outer" + o
        }, function(r, e) {
            ge.fn[e] = function(e, t) {
                var n = arguments.length && (r || "boolean" != typeof e),
                    i = r || (!0 === e || !0 === t ? "margin" : "border");
                return ge.access(this, function(e, t, n) {
                    var r;
                    return ge.isWindow(e) ? e.document.documentElement["client" + o] : 9 === e.nodeType ? (r = e.documentElement, Math.max(e.body["scroll" + o], r["scroll" + o], e.body["offset" + o], r["offset" + o], r["client" + o])) : n === _ ? ge.css(e, t, i) : ge.style(e, t, n, i)
                }, s, n ? e : _, n, null)
            }
        })
    }), p.jQuery = p.$ = ge, "function" == typeof define && define.amd && define.amd.jQuery && define("jquery", [], function() {
        return ge
    })
}(window),
function() {
    var t = function(e) {
        var t = e.options.databaseURL,
            n = new URL(t);
        return this.app = e, this.namespace = n.host.split(".")[0], this.storageKey = "firebase:session::" + this.namespace, this
    };
    firebase.INTERNAL.registerService("authMigrator", function(e) {
        return new t(e)
    }), t.prototype.getLegacyToken = function() {
        var e = localStorage.getItem(this.storageKey);
        if (!e) return null;
        try {
            return JSON.parse(e).token
        } catch (e) {
            return this.clearLegacyAuth(), null
        }
    }, t.prototype.hasLegacyAuth = function() {
        return !!this.getLegacyToken()
    }, t.prototype.clearLegacyAuth = function() {
        localStorage.removeItem(this.storageKey)
    }, t.prototype.exchangeToken = function(e) {
        var i = this,
            o = "https://auth.firebase.com/v2/" + this.namespace + "/sessions";
        return new firebase.Promise(function(t, n) {
            var r = new XMLHttpRequest;
            r.responseType = "json", r.onreadystatechange = function() {
                if (r.readyState === r.DONE) {
                    if (200 !== r.status) return 400 !== r.status && 403 !== r.status || i.clearLegacyAuth(), void n(new firebase.auth.Error("invalid-user-token", "Invalid auth token."));
                    var e = r.response.token;
                    e ? t(e) : n(new firebase.auth.Error("network-request-failed", "Invalid response from Firebase."))
                }
            }, r.onerror = function() {
                n(new firebase.auth.Error("network-request-failed", "Unable to verify auth token."))
            }, r.open("POST", o, !0), r.setRequestHeader("Content-Type", "application/json"), r.send(JSON.stringify({
                token: e
            }))
        })
    }, t.prototype.migrate = function() {
        if (this.app.auth().currentUser) return this.clearLegacyAuth(), Promise.resolve(this.app.auth().currentUser);
        var e = this.getLegacyToken();
        if (!e) return Promise.resolve(null);
        var t = this;
        return this.exchangeToken(e).then(function(e) {
            return t.app.auth().signInWithCustomToken(e)
        }).then(function(e) {
            return t.clearLegacyAuth(), e
        })
    }
}(),
function() {
    function e(a) {
        return function(e, t, n, r) {
            t = b(t, r, 4);
            var i = !T(e) && y.keys(e),
                o = (i || e).length,
                s = 0 < a ? 0 : o - 1;
            return arguments.length < 3 && (n = e[i ? i[s] : s], s += a),
                function(e, t, n, r, i, o) {
                    for (; 0 <= i && i < o; i += a) {
                        var s = r ? r[i] : i;
                        n = t(n, e[s], s, e)
                    }
                    return n
                }(e, t, n, i, s, o)
        }
    }

    function t(o) {
        return function(e, t, n) {
            t = x(t, n);
            for (var r = S(e), i = 0 < o ? 0 : r - 1; 0 <= i && i < r; i += o)
                if (t(e[i], i, e)) return i;
            return -1
        }
    }

    function n(o, s, a) {
        return function(e, t, n) {
            var r = 0,
                i = S(e);
            if ("number" == typeof n) 0 < o ? r = 0 <= n ? n : Math.max(n + i, r) : i = 0 <= n ? Math.min(n + 1, i) : n + i + 1;
            else if (a && n && i) return e[n = a(e, t)] === t ? n : -1;
            if (t != t) return 0 <= (n = s(u.call(e, r, i), y.isNaN)) ? n + r : -1;
            for (n = 0 < o ? r : i - 1; 0 <= n && n < i; n += o)
                if (e[n] === t) return n;
            return -1
        }
    }

    function r(e, t) {
        var n = N.length,
            r = e.constructor,
            i = y.isFunction(r) && r.prototype || a,
            o = "constructor";
        for (y.has(e, o) && !y.contains(t, o) && t.push(o); n--;)(o = N[n]) in e && e[o] !== i[o] && !y.contains(t, o) && t.push(o)
    }
    var i = this,
        o = i._,
        s = Array.prototype,
        a = Object.prototype,
        l = Function.prototype,
        c = s.push,
        u = s.slice,
        h = a.toString,
        d = a.hasOwnProperty,
        f = Array.isArray,
        p = Object.keys,
        m = l.bind,
        g = Object.create,
        v = function() {},
        y = function(e) {
            return e instanceof y ? e : this instanceof y ? void(this._wrapped = e) : new y(e)
        };
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = y), exports._ = y) : i._ = y, y.VERSION = "1.8.3";
    var b = function(i, o, e) {
            if (void 0 === o) return i;
            switch (null == e ? 3 : e) {
                case 1:
                    return function(e) {
                        return i.call(o, e)
                    };
                case 2:
                    return function(e, t) {
                        return i.call(o, e, t)
                    };
                case 3:
                    return function(e, t, n) {
                        return i.call(o, e, t, n)
                    };
                case 4:
                    return function(e, t, n, r) {
                        return i.call(o, e, t, n, r)
                    }
            }
            return function() {
                return i.apply(o, arguments)
            }
        },
        x = function(e, t, n) {
            return null == e ? y.identity : y.isFunction(e) ? b(e, t, n) : y.isObject(e) ? y.matcher(e) : y.property(e)
        };
    y.iteratee = function(e, t) {
        return x(e, t, 1 / 0)
    };
    var w = function(l, c) {
            return function(e) {
                var t = arguments.length;
                if (t < 2 || null == e) return e;
                for (var n = 1; n < t; n++)
                    for (var r = arguments[n], i = l(r), o = i.length, s = 0; s < o; s++) {
                        var a = i[s];
                        c && void 0 !== e[a] || (e[a] = r[a])
                    }
                return e
            }
        },
        k = function(e) {
            if (!y.isObject(e)) return {};
            if (g) return g(e);
            v.prototype = e;
            var t = new v;
            return v.prototype = null, t
        },
        _ = function(t) {
            return function(e) {
                return null == e ? void 0 : e[t]
            }
        },
        C = Math.pow(2, 53) - 1,
        S = _("length"),
        T = function(e) {
            var t = S(e);
            return "number" == typeof t && 0 <= t && t <= C
        };
    y.each = y.forEach = function(e, t, n) {
        var r, i;
        if (t = b(t, n), T(e))
            for (r = 0, i = e.length; r < i; r++) t(e[r], r, e);
        else {
            var o = y.keys(e);
            for (r = 0, i = o.length; r < i; r++) t(e[o[r]], o[r], e)
        }
        return e
    }, y.map = y.collect = function(e, t, n) {
        t = x(t, n);
        for (var r = !T(e) && y.keys(e), i = (r || e).length, o = Array(i), s = 0; s < i; s++) {
            var a = r ? r[s] : s;
            o[s] = t(e[a], a, e)
        }
        return o
    }, y.reduce = y.foldl = y.inject = e(1), y.reduceRight = y.foldr = e(-1), y.find = y.detect = function(e, t, n) {
        var r;
        return void 0 !== (r = T(e) ? y.findIndex(e, t, n) : y.findKey(e, t, n)) && -1 !== r ? e[r] : void 0
    }, y.filter = y.select = function(e, r, t) {
        var i = [];
        return r = x(r, t), y.each(e, function(e, t, n) {
            r(e, t, n) && i.push(e)
        }), i
    }, y.reject = function(e, t, n) {
        return y.filter(e, y.negate(x(t)), n)
    }, y.every = y.all = function(e, t, n) {
        t = x(t, n);
        for (var r = !T(e) && y.keys(e), i = (r || e).length, o = 0; o < i; o++) {
            var s = r ? r[o] : o;
            if (!t(e[s], s, e)) return !1
        }
        return !0
    }, y.some = y.any = function(e, t, n) {
        t = x(t, n);
        for (var r = !T(e) && y.keys(e), i = (r || e).length, o = 0; o < i; o++) {
            var s = r ? r[o] : o;
            if (t(e[s], s, e)) return !0
        }
        return !1
    }, y.contains = y.includes = y.include = function(e, t, n, r) {
        return T(e) || (e = y.values(e)), ("number" != typeof n || r) && (n = 0), 0 <= y.indexOf(e, t, n)
    }, y.invoke = function(e, n) {
        var r = u.call(arguments, 2),
            i = y.isFunction(n);
        return y.map(e, function(e) {
            var t = i ? n : e[n];
            return null == t ? t : t.apply(e, r)
        })
    }, y.pluck = function(e, t) {
        return y.map(e, y.property(t))
    }, y.where = function(e, t) {
        return y.filter(e, y.matcher(t))
    }, y.findWhere = function(e, t) {
        return y.find(e, y.matcher(t))
    }, y.max = function(e, r, t) {
        var n, i, o = -1 / 0,
            s = -1 / 0;
        if (null == r && null != e)
            for (var a = 0, l = (e = T(e) ? e : y.values(e)).length; a < l; a++) n = e[a], o < n && (o = n);
        else r = x(r, t), y.each(e, function(e, t, n) {
            i = r(e, t, n), (s < i || i === -1 / 0 && o === -1 / 0) && (o = e, s = i)
        });
        return o
    }, y.min = function(e, r, t) {
        var n, i, o = 1 / 0,
            s = 1 / 0;
        if (null == r && null != e)
            for (var a = 0, l = (e = T(e) ? e : y.values(e)).length; a < l; a++)(n = e[a]) < o && (o = n);
        else r = x(r, t), y.each(e, function(e, t, n) {
            ((i = r(e, t, n)) < s || 1 / 0 === i && 1 / 0 === o) && (o = e, s = i)
        });
        return o
    }, y.shuffle = function(e) {
        for (var t, n = T(e) ? e : y.values(e), r = n.length, i = Array(r), o = 0; o < r; o++)(t = y.random(0, o)) !== o && (i[o] = i[t]), i[t] = n[o];
        return i
    }, y.sample = function(e, t, n) {
        return null == t || n ? (T(e) || (e = y.values(e)), e[y.random(e.length - 1)]) : y.shuffle(e).slice(0, Math.max(0, t))
    }, y.sortBy = function(e, r, t) {
        return r = x(r, t), y.pluck(y.map(e, function(e, t, n) {
            return {
                value: e,
                index: t,
                criteria: r(e, t, n)
            }
        }).sort(function(e, t) {
            var n = e.criteria,
                r = t.criteria;
            if (n !== r) {
                if (r < n || void 0 === n) return 1;
                if (n < r || void 0 === r) return -1
            }
            return e.index - t.index
        }), "value")
    };
    var M = function(s) {
        return function(r, i, e) {
            var o = {};
            return i = x(i, e), y.each(r, function(e, t) {
                var n = i(e, t, r);
                s(o, e, n)
            }), o
        }
    };
    y.groupBy = M(function(e, t, n) {
        y.has(e, n) ? e[n].push(t) : e[n] = [t]
    }), y.indexBy = M(function(e, t, n) {
        e[n] = t
    }), y.countBy = M(function(e, t, n) {
        y.has(e, n) ? e[n]++ : e[n] = 1
    }), y.toArray = function(e) {
        return e ? y.isArray(e) ? u.call(e) : T(e) ? y.map(e, y.identity) : y.values(e) : []
    }, y.size = function(e) {
        return null == e ? 0 : T(e) ? e.length : y.keys(e).length
    }, y.partition = function(e, r, t) {
        r = x(r, t);
        var i = [],
            o = [];
        return y.each(e, function(e, t, n) {
            (r(e, t, n) ? i : o).push(e)
        }), [i, o]
    }, y.first = y.head = y.take = function(e, t, n) {
        return null == e ? void 0 : null == t || n ? e[0] : y.initial(e, e.length - t)
    }, y.initial = function(e, t, n) {
        return u.call(e, 0, Math.max(0, e.length - (null == t || n ? 1 : t)))
    }, y.last = function(e, t, n) {
        return null == e ? void 0 : null == t || n ? e[e.length - 1] : y.rest(e, Math.max(0, e.length - t))
    }, y.rest = y.tail = y.drop = function(e, t, n) {
        return u.call(e, null == t || n ? 1 : t)
    }, y.compact = function(e) {
        return y.filter(e, y.identity)
    };
    var A = function(e, t, n, r) {
        for (var i = [], o = 0, s = r || 0, a = S(e); s < a; s++) {
            var l = e[s];
            if (T(l) && (y.isArray(l) || y.isArguments(l))) {
                t || (l = A(l, t, n));
                var c = 0,
                    u = l.length;
                for (i.length += u; c < u;) i[o++] = l[c++]
            } else n || (i[o++] = l)
        }
        return i
    };
    y.flatten = function(e, t) {
        return A(e, t, !1)
    }, y.without = function(e) {
        return y.difference(e, u.call(arguments, 1))
    }, y.uniq = y.unique = function(e, t, n, r) {
        y.isBoolean(t) || (r = n, n = t, t = !1), null != n && (n = x(n, r));
        for (var i = [], o = [], s = 0, a = S(e); s < a; s++) {
            var l = e[s],
                c = n ? n(l, s, e) : l;
            t ? (s && o === c || i.push(l), o = c) : n ? y.contains(o, c) || (o.push(c), i.push(l)) : y.contains(i, l) || i.push(l)
        }
        return i
    }, y.union = function() {
        return y.uniq(A(arguments, !0, !0))
    }, y.intersection = function(e) {
        for (var t = [], n = arguments.length, r = 0, i = S(e); r < i; r++) {
            var o = e[r];
            if (!y.contains(t, o)) {
                for (var s = 1; s < n && y.contains(arguments[s], o); s++);
                s === n && t.push(o)
            }
        }
        return t
    }, y.difference = function(e) {
        var t = A(arguments, !0, !0, 1);
        return y.filter(e, function(e) {
            return !y.contains(t, e)
        })
    }, y.zip = function() {
        return y.unzip(arguments)
    }, y.unzip = function(e) {
        for (var t = e && y.max(e, S).length || 0, n = Array(t), r = 0; r < t; r++) n[r] = y.pluck(e, r);
        return n
    }, y.object = function(e, t) {
        for (var n = {}, r = 0, i = S(e); r < i; r++) t ? n[e[r]] = t[r] : n[e[r][0]] = e[r][1];
        return n
    }, y.findIndex = t(1), y.findLastIndex = t(-1), y.sortedIndex = function(e, t, n, r) {
        for (var i = (n = x(n, r, 1))(t), o = 0, s = S(e); o < s;) {
            var a = Math.floor((o + s) / 2);
            n(e[a]) < i ? o = a + 1 : s = a
        }
        return o
    }, y.indexOf = n(1, y.findIndex, y.sortedIndex), y.lastIndexOf = n(-1, y.findLastIndex), y.range = function(e, t, n) {
        null == t && (t = e || 0, e = 0), n = n || 1;
        for (var r = Math.max(Math.ceil((t - e) / n), 0), i = Array(r), o = 0; o < r; o++, e += n) i[o] = e;
        return i
    };
    var L = function(e, t, n, r, i) {
        if (!(r instanceof t)) return e.apply(n, i);
        var o = k(e.prototype),
            s = e.apply(o, i);
        return y.isObject(s) ? s : o
    };
    y.bind = function(e, t) {
        if (m && e.bind === m) return m.apply(e, u.call(arguments, 1));
        if (!y.isFunction(e)) throw new TypeError("Bind must be called on a function");
        var n = u.call(arguments, 2),
            r = function() {
                return L(e, r, t, this, n.concat(u.call(arguments)))
            };
        return r
    }, y.partial = function(i) {
        var o = u.call(arguments, 1),
            s = function() {
                for (var e = 0, t = o.length, n = Array(t), r = 0; r < t; r++) n[r] = o[r] === y ? arguments[e++] : o[r];
                for (; e < arguments.length;) n.push(arguments[e++]);
                return L(i, s, this, this, n)
            };
        return s
    }, y.bindAll = function(e) {
        var t, n, r = arguments.length;
        if (r <= 1) throw new Error("bindAll must be passed function names");
        for (t = 1; t < r; t++) e[n = arguments[t]] = y.bind(e[n], e);
        return e
    }, y.memoize = function(r, i) {
        var o = function(e) {
            var t = o.cache,
                n = "" + (i ? i.apply(this, arguments) : e);
            return y.has(t, n) || (t[n] = r.apply(this, arguments)), t[n]
        };
        return o.cache = {}, o
    }, y.delay = function(e, t) {
        var n = u.call(arguments, 2);
        return setTimeout(function() {
            return e.apply(null, n)
        }, t)
    }, y.defer = y.partial(y.delay, y, 1), y.throttle = function(n, r, i) {
        var o, s, a, l = null,
            c = 0;
        i || (i = {});
        var u = function() {
            c = !1 === i.leading ? 0 : y.now(), l = null, a = n.apply(o, s), l || (o = s = null)
        };
        return function() {
            var e = y.now();
            c || !1 !== i.leading || (c = e);
            var t = r - (e - c);
            return o = this, s = arguments, t <= 0 || r < t ? (l && (clearTimeout(l), l = null), c = e, a = n.apply(o, s), l || (o = s = null)) : l || !1 === i.trailing || (l = setTimeout(u, t)), a
        }
    }, y.debounce = function(t, n, r) {
        var i, o, s, a, l, c = function() {
            var e = y.now() - a;
            e < n && 0 <= e ? i = setTimeout(c, n - e) : (i = null, r || (l = t.apply(s, o), i || (s = o = null)))
        };
        return function() {
            s = this, o = arguments, a = y.now();
            var e = r && !i;
            return i || (i = setTimeout(c, n)), e && (l = t.apply(s, o), s = o = null), l
        }
    }, y.wrap = function(e, t) {
        return y.partial(t, e)
    }, y.negate = function(e) {
        return function() {
            return !e.apply(this, arguments)
        }
    }, y.compose = function() {
        var n = arguments,
            r = n.length - 1;
        return function() {
            for (var e = r, t = n[r].apply(this, arguments); e--;) t = n[e].call(this, t);
            return t
        }
    }, y.after = function(e, t) {
        return function() {
            return --e < 1 ? t.apply(this, arguments) : void 0
        }
    }, y.before = function(e, t) {
        var n;
        return function() {
            return 0 < --e && (n = t.apply(this, arguments)), e <= 1 && (t = null), n
        }
    }, y.once = y.partial(y.before, 2);
    var E = !{
            toString: null
        }.propertyIsEnumerable("toString"),
        N = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
    y.keys = function(e) {
        if (!y.isObject(e)) return [];
        if (p) return p(e);
        var t = [];
        for (var n in e) y.has(e, n) && t.push(n);
        return E && r(e, t), t
    }, y.allKeys = function(e) {
        if (!y.isObject(e)) return [];
        var t = [];
        for (var n in e) t.push(n);
        return E && r(e, t), t
    }, y.values = function(e) {
        for (var t = y.keys(e), n = t.length, r = Array(n), i = 0; i < n; i++) r[i] = e[t[i]];
        return r
    }, y.mapObject = function(e, t, n) {
        t = x(t, n);
        for (var r, i = y.keys(e), o = i.length, s = {}, a = 0; a < o; a++) s[r = i[a]] = t(e[r], r, e);
        return s
    }, y.pairs = function(e) {
        for (var t = y.keys(e), n = t.length, r = Array(n), i = 0; i < n; i++) r[i] = [t[i], e[t[i]]];
        return r
    }, y.invert = function(e) {
        for (var t = {}, n = y.keys(e), r = 0, i = n.length; r < i; r++) t[e[n[r]]] = n[r];
        return t
    }, y.functions = y.methods = function(e) {
        var t = [];
        for (var n in e) y.isFunction(e[n]) && t.push(n);
        return t.sort()
    }, y.extend = w(y.allKeys), y.extendOwn = y.assign = w(y.keys), y.findKey = function(e, t, n) {
        t = x(t, n);
        for (var r, i = y.keys(e), o = 0, s = i.length; o < s; o++)
            if (t(e[r = i[o]], r, e)) return r
    }, y.pick = function(e, t, n) {
        var r, i, o = {},
            s = e;
        if (null == s) return o;
        y.isFunction(t) ? (i = y.allKeys(s), r = b(t, n)) : (i = A(arguments, !1, !1, 1), r = function(e, t, n) {
            return t in n
        }, s = Object(s));
        for (var a = 0, l = i.length; a < l; a++) {
            var c = i[a],
                u = s[c];
            r(u, c, s) && (o[c] = u)
        }
        return o
    }, y.omit = function(e, t, n) {
        if (y.isFunction(t)) t = y.negate(t);
        else {
            var r = y.map(A(arguments, !1, !1, 1), String);
            t = function(e, t) {
                return !y.contains(r, t)
            }
        }
        return y.pick(e, t, n)
    }, y.defaults = w(y.allKeys, !0), y.create = function(e, t) {
        var n = k(e);
        return t && y.extendOwn(n, t), n
    }, y.clone = function(e) {
        return y.isObject(e) ? y.isArray(e) ? e.slice() : y.extend({}, e) : e
    }, y.tap = function(e, t) {
        return t(e), e
    }, y.isMatch = function(e, t) {
        var n = y.keys(t),
            r = n.length;
        if (null == e) return !r;
        for (var i = Object(e), o = 0; o < r; o++) {
            var s = n[o];
            if (t[s] !== i[s] || !(s in i)) return !1
        }
        return !0
    };
    var I = function(e, t, n, r) {
        if (e === t) return 0 !== e || 1 / e == 1 / t;
        if (null == e || null == t) return e === t;
        e instanceof y && (e = e._wrapped), t instanceof y && (t = t._wrapped);
        var i = h.call(e);
        if (i !== h.call(t)) return !1;
        switch (i) {
            case "[object RegExp]":
            case "[object String]":
                return "" + e == "" + t;
            case "[object Number]":
                return +e != +e ? +t != +t : 0 == +e ? 1 / +e == 1 / t : +e == +t;
            case "[object Date]":
            case "[object Boolean]":
                return +e == +t
        }
        var o = "[object Array]" === i;
        if (!o) {
            if ("object" != typeof e || "object" != typeof t) return !1;
            var s = e.constructor,
                a = t.constructor;
            if (s !== a && !(y.isFunction(s) && s instanceof s && y.isFunction(a) && a instanceof a) && "constructor" in e && "constructor" in t) return !1
        }
        r = r || [];
        for (var l = (n = n || []).length; l--;)
            if (n[l] === e) return r[l] === t;
        if (n.push(e), r.push(t), o) {
            if ((l = e.length) !== t.length) return !1;
            for (; l--;)
                if (!I(e[l], t[l], n, r)) return !1
        } else {
            var c, u = y.keys(e);
            if (l = u.length, y.keys(t).length !== l) return !1;
            for (; l--;)
                if (c = u[l], !y.has(t, c) || !I(e[c], t[c], n, r)) return !1
        }
        return n.pop(), r.pop(), !0
    };
    y.isEqual = function(e, t) {
        return I(e, t)
    }, y.isEmpty = function(e) {
        return null == e || (T(e) && (y.isArray(e) || y.isString(e) || y.isArguments(e)) ? 0 === e.length : 0 === y.keys(e).length)
    }, y.isElement = function(e) {
        return !(!e || 1 !== e.nodeType)
    }, y.isArray = f || function(e) {
        return "[object Array]" === h.call(e)
    }, y.isObject = function(e) {
        var t = typeof e;
        return "function" === t || "object" === t && !!e
    }, y.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function(t) {
        y["is" + t] = function(e) {
            return h.call(e) === "[object " + t + "]"
        }
    }), y.isArguments(arguments) || (y.isArguments = function(e) {
        return y.has(e, "callee")
    }), "function" != typeof /./ && "object" != typeof Int8Array && (y.isFunction = function(e) {
        return "function" == typeof e || !1
    }), y.isFinite = function(e) {
        return isFinite(e) && !isNaN(parseFloat(e))
    }, y.isNaN = function(e) {
        return y.isNumber(e) && e !== +e
    }, y.isBoolean = function(e) {
        return !0 === e || !1 === e || "[object Boolean]" === h.call(e)
    }, y.isNull = function(e) {
        return null === e
    }, y.isUndefined = function(e) {
        return void 0 === e
    }, y.has = function(e, t) {
        return null != e && d.call(e, t)
    }, y.noConflict = function() {
        return i._ = o, this
    }, y.identity = function(e) {
        return e
    }, y.constant = function(e) {
        return function() {
            return e
        }
    }, y.noop = function() {}, y.property = _, y.propertyOf = function(t) {
        return null == t ? function() {} : function(e) {
            return t[e]
        }
    }, y.matcher = y.matches = function(t) {
        return t = y.extendOwn({}, t),
            function(e) {
                return y.isMatch(e, t)
            }
    }, y.times = function(e, t, n) {
        var r = Array(Math.max(0, e));
        t = b(t, n, 1);
        for (var i = 0; i < e; i++) r[i] = t(i);
        return r
    }, y.random = function(e, t) {
        return null == t && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
    }, y.now = Date.now || function() {
        return (new Date).getTime()
    };
    var O = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#x27;",
            "`": "&#x60;"
        },
        R = y.invert(O),
        D = function(t) {
            var n = function(e) {
                    return t[e]
                },
                e = "(?:" + y.keys(t).join("|") + ")",
                r = RegExp(e),
                i = RegExp(e, "g");
            return function(e) {
                return e = null == e ? "" : "" + e, r.test(e) ? e.replace(i, n) : e
            }
        };
    y.escape = D(O), y.unescape = D(R), y.result = function(e, t, n) {
        var r = null == e ? void 0 : e[t];
        return void 0 === r && (r = n), y.isFunction(r) ? r.call(e) : r
    };
    var P = 0;
    y.uniqueId = function(e) {
        var t = ++P + "";
        return e ? e + t : t
    }, y.templateSettings = {
        evaluate: /<%([\s\S]+?)%>/g,
        interpolate: /<%=([\s\S]+?)%>/g,
        escape: /<%-([\s\S]+?)%>/g
    };
    var $ = /(.)^/,
        H = {
            "'": "'",
            "\\": "\\",
            "\r": "r",
            "\n": "n",
            "\u2028": "u2028",
            "\u2029": "u2029"
        },
        F = /\\|'|\r|\n|\u2028|\u2029/g,
        B = function(e) {
            return "\\" + H[e]
        };
    y.template = function(o, e, t) {
        !e && t && (e = t), e = y.defaults({}, e, y.templateSettings);
        var n = RegExp([(e.escape || $).source, (e.interpolate || $).source, (e.evaluate || $).source].join("|") + "|$", "g"),
            s = 0,
            a = "__p+='";
        o.replace(n, function(e, t, n, r, i) {
            return a += o.slice(s, i).replace(F, B), s = i + e.length, t ? a += "'+\n((__t=(" + t + "))==null?'':_.escape(__t))+\n'" : n ? a += "'+\n((__t=(" + n + "))==null?'':__t)+\n'" : r && (a += "';\n" + r + "\n__p+='"), e
        }), a += "';\n", e.variable || (a = "with(obj||{}){\n" + a + "}\n"), a = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + a + "return __p;\n";
        try {
            var r = new Function(e.variable || "obj", "_", a)
        } catch (e) {
            throw e.source = a, e
        }
        var i = function(e) {
                return r.call(this, e, y)
            },
            l = e.variable || "obj";
        return i.source = "function(" + l + "){\n" + a + "}", i
    }, y.chain = function(e) {
        var t = y(e);
        return t._chain = !0, t
    };
    var z = function(e, t) {
        return e._chain ? y(t).chain() : t
    };
    y.mixin = function(n) {
        y.each(y.functions(n), function(e) {
            var t = y[e] = n[e];
            y.prototype[e] = function() {
                var e = [this._wrapped];
                return c.apply(e, arguments), z(this, t.apply(y, e))
            }
        })
    }, y.mixin(y), y.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(t) {
        var n = s[t];
        y.prototype[t] = function() {
            var e = this._wrapped;
            return n.apply(e, arguments), "shift" !== t && "splice" !== t || 0 !== e.length || delete e[0], z(this, e)
        }
    }), y.each(["concat", "join", "slice"], function(e) {
        var t = s[e];
        y.prototype[e] = function() {
            return z(this, t.apply(this._wrapped, arguments))
        }
    }), y.prototype.value = function() {
        return this._wrapped
    }, y.prototype.valueOf = y.prototype.toJSON = y.prototype.value, y.prototype.toString = function() {
        return "" + this._wrapped
    }, "function" == typeof define && define.amd && define("underscore", [], function() {
        return y
    })
}.call(this),
    function(t) {
        "use strict";
        t(function() {
            var e;
            t.support.transition = (e = function() {
                var e, t = document.createElement("bootstrap"),
                    n = {
                        WebkitTransition: "webkitTransitionEnd",
                        MozTransition: "transitionend",
                        OTransition: "oTransitionEnd otransitionend",
                        transition: "transitionend"
                    };
                for (e in n)
                    if (void 0 !== t.style[e]) return n[e]
            }()) && {
                end: e
            }
        })
    }(window.jQuery),
    function(o) {
        "use strict";
        var t = '[data-dismiss="alert"]',
            r = function(e) {
                o(e).on("click", t, this.close)
            };
        r.prototype.close = function(e) {
            function t() {
                n.trigger("closed").remove()
            }
            var n, r = o(this),
                i = r.attr("data-target");
            i || (i = (i = r.attr("href")) && i.replace(/.*(?=#[^\s]*$)/, "")), n = o(i), e && e.preventDefault(), n.length || (n = r.hasClass("alert") ? r : r.parent()), n.trigger(e = o.Event("close")), e.isDefaultPrevented() || (n.removeClass("in"), o.support.transition && n.hasClass("fade") ? n.on(o.support.transition.end, t) : t())
        };
        var e = o.fn.alert;
        o.fn.alert = function(n) {
            return this.each(function() {
                var e = o(this),
                    t = e.data("alert");
                t || e.data("alert", t = new r(this)), "string" == typeof n && t[n].call(e)
            })
        }, o.fn.alert.Constructor = r, o.fn.alert.noConflict = function() {
            return o.fn.alert = e, this
        }, o(document).on("click.alert.data-api", t, r.prototype.close)
    }(window.jQuery),
    function(i) {
        "use strict";
        var o = function(e, t) {
            this.$element = i(e), this.options = i.extend({}, i.fn.button.defaults, t)
        };
        o.prototype.setState = function(e) {
            var t = "disabled",
                n = this.$element,
                r = n.data(),
                i = n.is("input") ? "val" : "html";
            e += "Text", r.resetText || n.data("resetText", n[i]()), n[i](r[e] || this.options[e]), setTimeout(function() {
                "loadingText" == e ? n.addClass(t).attr(t, t) : n.removeClass(t).removeAttr(t)
            }, 0)
        }, o.prototype.toggle = function() {
            var e = this.$element.closest('[data-toggle="buttons-radio"]');
            e && e.find(".active").removeClass("active"), this.$element.toggleClass("active")
        };
        var e = i.fn.button;
        i.fn.button = function(r) {
            return this.each(function() {
                var e = i(this),
                    t = e.data("button"),
                    n = "object" == typeof r && r;
                t || e.data("button", t = new o(this, n)), "toggle" == r ? t.toggle() : r && t.setState(r)
            })
        }, i.fn.button.defaults = {
            loadingText: "loading..."
        }, i.fn.button.Constructor = o, i.fn.button.noConflict = function() {
            return i.fn.button = e, this
        }, i(document).on("click.button.data-api", "[data-toggle^=button]", function(e) {
            var t = i(e.target);
            t.hasClass("btn") || (t = t.closest(".btn")), t.button("toggle")
        })
    }(window.jQuery),
    function(c) {
        "use strict";
        var o = function(e, t) {
            this.$element = c(e), this.$indicators = this.$element.find(".carousel-indicators"), this.options = t, "hover" == this.options.pause && this.$element.on("mouseenter", c.proxy(this.pause, this)).on("mouseleave", c.proxy(this.cycle, this))
        };
        o.prototype = {
            cycle: function(e) {
                return e || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(c.proxy(this.next, this), this.options.interval)), this
            },
            getActiveIndex: function() {
                return this.$active = this.$element.find(".item.active"), this.$items = this.$active.parent().children(), this.$items.index(this.$active)
            },
            to: function(e) {
                var t = this.getActiveIndex(),
                    n = this;
                if (!(e > this.$items.length - 1 || e < 0)) return this.sliding ? this.$element.one("slid", function() {
                    n.to(e)
                }) : t == e ? this.pause().cycle() : this.slide(t < e ? "next" : "prev", c(this.$items[e]))
            },
            pause: function(e) {
                return e || (this.paused = !0), this.$element.find(".next, .prev").length && c.support.transition.end && (this.$element.trigger(c.support.transition.end), this.cycle(!0)), clearInterval(this.interval), this.interval = null, this
            },
            next: function() {
                if (!this.sliding) return this.slide("next")
            },
            prev: function() {
                if (!this.sliding) return this.slide("prev")
            },
            slide: function(e, t) {
                var n, r = this.$element.find(".item.active"),
                    i = t || r[e](),
                    o = this.interval,
                    s = "next" == e ? "left" : "right",
                    a = "next" == e ? "first" : "last",
                    l = this;
                if (this.sliding = !0, o && this.pause(), i = i.length ? i : this.$element.find(".item")[a](), n = c.Event("slide", {
                        relatedTarget: i[0],
                        direction: s
                    }), !i.hasClass("active")) {
                    if (this.$indicators.length && (this.$indicators.find(".active").removeClass("active"), this.$element.one("slid", function() {
                            var e = c(l.$indicators.children()[l.getActiveIndex()]);
                            e && e.addClass("active")
                        })), c.support.transition && this.$element.hasClass("slide")) {
                        if (this.$element.trigger(n), n.isDefaultPrevented()) return;
                        i.addClass(e), i[0].offsetWidth, r.addClass(s), i.addClass(s), this.$element.one(c.support.transition.end, function() {
                            i.removeClass([e, s].join(" ")).addClass("active"), r.removeClass(["active", s].join(" ")), l.sliding = !1, setTimeout(function() {
                                l.$element.trigger("slid")
                            }, 0)
                        })
                    } else {
                        if (this.$element.trigger(n), n.isDefaultPrevented()) return;
                        r.removeClass("active"), i.addClass("active"), this.sliding = !1, this.$element.trigger("slid")
                    }
                    return o && this.cycle(), this
                }
            }
        };
        var e = c.fn.carousel;
        c.fn.carousel = function(i) {
            return this.each(function() {
                var e = c(this),
                    t = e.data("carousel"),
                    n = c.extend({}, c.fn.carousel.defaults, "object" == typeof i && i),
                    r = "string" == typeof i ? i : n.slide;
                t || e.data("carousel", t = new o(this, n)), "number" == typeof i ? t.to(i) : r ? t[r]() : n.interval && t.pause().cycle()
            })
        }, c.fn.carousel.defaults = {
            interval: 5e3,
            pause: "hover"
        }, c.fn.carousel.Constructor = o, c.fn.carousel.noConflict = function() {
            return c.fn.carousel = e, this
        }, c(document).on("click.carousel.data-api", "[data-slide], [data-slide-to]", function(e) {
            var t, n, r = c(this),
                i = c(r.attr("data-target") || (t = r.attr("href")) && t.replace(/.*(?=#[^\s]+$)/, "")),
                o = c.extend({}, i.data(), r.data());
            i.carousel(o), (n = r.attr("data-slide-to")) && i.data("carousel").pause().to(n).cycle(), e.preventDefault()
        })
    }(window.jQuery),
    function(o) {
        "use strict";
        var i = function(e, t) {
            this.$element = o(e), this.options = o.extend({}, o.fn.collapse.defaults, t), this.options.parent && (this.$parent = o(this.options.parent)), this.options.toggle && this.toggle()
        };
        i.prototype = {
            constructor: i,
            dimension: function() {
                return this.$element.hasClass("width") ? "width" : "height"
            },
            show: function() {
                var e, t, n, r;
                if (!this.transitioning && !this.$element.hasClass("in")) {
                    if (e = this.dimension(), t = o.camelCase(["scroll", e].join("-")), (n = this.$parent && this.$parent.find("> .accordion-group > .in")) && n.length) {
                        if ((r = n.data("collapse")) && r.transitioning) return;
                        n.collapse("hide"), r || n.data("collapse", null)
                    }
                    this.$element[e](0), this.transition("addClass", o.Event("show"), "shown"), o.support.transition && this.$element[e](this.$element[0][t])
                }
            },
            hide: function() {
                var e;
                !this.transitioning && this.$element.hasClass("in") && (e = this.dimension(), this.reset(this.$element[e]()), this.transition("removeClass", o.Event("hide"), "hidden"), this.$element[e](0))
            },
            reset: function(e) {
                var t = this.dimension();
                return this.$element.removeClass("collapse")[t](e || "auto")[0].offsetWidth, this.$element[null !== e ? "addClass" : "removeClass"]("collapse"), this
            },
            transition: function(e, t, n) {
                var r = this,
                    i = function() {
                        "show" == t.type && r.reset(), r.transitioning = 0, r.$element.trigger(n)
                    };
                this.$element.trigger(t), t.isDefaultPrevented() || (this.transitioning = 1, this.$element[e]("in"), o.support.transition && this.$element.hasClass("collapse") ? this.$element.one(o.support.transition.end, i) : i())
            },
            toggle: function() {
                this[this.$element.hasClass("in") ? "hide" : "show"]()
            }
        };
        var e = o.fn.collapse;
        o.fn.collapse = function(r) {
            return this.each(function() {
                var e = o(this),
                    t = e.data("collapse"),
                    n = o.extend({}, o.fn.collapse.defaults, e.data(), "object" == typeof r && r);
                t || e.data("collapse", t = new i(this, n)), "string" == typeof r && t[r]()
            })
        }, o.fn.collapse.defaults = {
            toggle: !0
        }, o.fn.collapse.Constructor = i, o.fn.collapse.noConflict = function() {
            return o.fn.collapse = e, this
        }, o(document).on("click.collapse.data-api", "[data-toggle=collapse]", function(e) {
            var t, n = o(this),
                r = n.attr("data-target") || e.preventDefault() || (t = n.attr("href")) && t.replace(/.*(?=#[^\s]+$)/, ""),
                i = o(r).data("collapse") ? "toggle" : n.data();
            n[o(r).hasClass("in") ? "addClass" : "removeClass"]("collapsed"), o(r).collapse(i)
        })
    }(window.jQuery),
    function(s) {
        "use strict";

        function i() {
            s(l).each(function() {
                a(s(this)).removeClass("open")
            })
        }

        function a(e) {
            var t, n = e.attr("data-target");
            return n || (n = (n = e.attr("href")) && /#/.test(n) && n.replace(/.*(?=#[^\s]*$)/, "")), (t = n && s(n)) && t.length || (t = e.parent()), t
        }
        var l = "[data-toggle=dropdown]",
            r = function(e) {
                var t = s(e).on("click.dropdown.data-api", this.toggle);
                s("html").on("click.dropdown.data-api", function() {
                    t.parent().removeClass("open")
                })
            };
        r.prototype = {
            constructor: r,
            toggle: function(e) {
                var t, n, r = s(this);
                if (!r.is(".disabled, :disabled")) return n = (t = a(r)).hasClass("open"), i(), n || t.toggleClass("open"), r.focus(), !1
            },
            keydown: function(e) {
                var t, n, r, i, o;
                if (/(38|40|27)/.test(e.keyCode) && (t = s(this), e.preventDefault(), e.stopPropagation(), !t.is(".disabled, :disabled"))) {
                    if (!(i = (r = a(t)).hasClass("open")) || i && 27 == e.keyCode) return 27 == e.which && r.find(l).focus(), t.click();
                    (n = s("[role=menu] li:not(.divider):visible a", r)).length && (o = n.index(n.filter(":focus")), 38 == e.keyCode && 0 < o && o--, 40 == e.keyCode && o < n.length - 1 && o++, ~o || (o = 0), n.eq(o).focus())
                }
            }
        };
        var e = s.fn.dropdown;
        s.fn.dropdown = function(n) {
            return this.each(function() {
                var e = s(this),
                    t = e.data("dropdown");
                t || e.data("dropdown", t = new r(this)), "string" == typeof n && t[n].call(e)
            })
        }, s.fn.dropdown.Constructor = r, s.fn.dropdown.noConflict = function() {
            return s.fn.dropdown = e, this
        }, s(document).on("click.dropdown.data-api", i).on("click.dropdown.data-api", ".dropdown form", function(e) {
            e.stopPropagation()
        }).on("click.dropdown-menu", function(e) {
            e.stopPropagation()
        }).on("click.dropdown.data-api", l, r.prototype.toggle).on("keydown.dropdown.data-api", l + ", [role=menu]", r.prototype.keydown)
    }(window.jQuery),
    function(o) {
        "use strict";
        var i = function(e, t) {
            this.options = t, this.$element = o(e).delegate('[data-dismiss="modal"]', "click.dismiss.modal", o.proxy(this.hide, this)), this.options.remote && this.$element.find(".modal-body").load(this.options.remote)
        };
        i.prototype = {
            constructor: i,
            toggle: function() {
                return this[this.isShown ? "hide" : "show"]()
            },
            show: function() {
                var t = this,
                    e = o.Event("show");
                this.$element.trigger(e), this.isShown || e.isDefaultPrevented() || (this.isShown = !0, this.escape(), this.backdrop(function() {
                    var e = o.support.transition && t.$element.hasClass("fade");
                    t.$element.parent().length || t.$element.appendTo(document.body), t.$element.show(), e && t.$element[0].offsetWidth, t.$element.addClass("in").attr("aria-hidden", !1), t.enforceFocus(), e ? t.$element.one(o.support.transition.end, function() {
                        t.$element.focus().trigger("shown")
                    }) : t.$element.focus().trigger("shown")
                }))
            },
            hide: function(e) {
                e && e.preventDefault();
                e = o.Event("hide"), this.$element.trigger(e), this.isShown && !e.isDefaultPrevented() && (this.isShown = !1, this.escape(), o(document).off("focusin.modal"), this.$element.removeClass("in").attr("aria-hidden", !0), o.support.transition && this.$element.hasClass("fade") ? this.hideWithTransition() : this.hideModal())
            },
            enforceFocus: function() {
                var t = this;
                o(document).on("focusin.modal", function(e) {
                    t.$element[0] !== e.target && !t.$element.has(e.target).length && t.$element.focus()
                })
            },
            escape: function() {
                var t = this;
                this.isShown && this.options.keyboard ? this.$element.on("keyup.dismiss.modal", function(e) {
                    27 == e.which && t.hide()
                }) : this.isShown || this.$element.off("keyup.dismiss.modal")
            },
            hideWithTransition: function() {
                var e = this,
                    t = setTimeout(function() {
                        e.$element.off(o.support.transition.end), e.hideModal()
                    }, 500);
                this.$element.one(o.support.transition.end, function() {
                    clearTimeout(t), e.hideModal()
                })
            },
            hideModal: function() {
                var e = this;
                this.$element.hide(), this.backdrop(function() {
                    e.removeBackdrop(), e.$element.trigger("hidden")
                })
            },
            removeBackdrop: function() {
                this.$backdrop && this.$backdrop.remove(), this.$backdrop = null
            },
            backdrop: function(e) {
                var t = this.$element.hasClass("fade") ? "fade" : "";
                if (this.isShown && this.options.backdrop) {
                    var n = o.support.transition && t;
                    if (this.$backdrop = o('<div class="modal-backdrop ' + t + '" />').appendTo(document.body), this.$backdrop.click("static" == this.options.backdrop ? o.proxy(this.$element[0].focus, this.$element[0]) : o.proxy(this.hide, this)), n && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), !e) return;
                    n ? this.$backdrop.one(o.support.transition.end, e) : e()
                } else !this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), o.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one(o.support.transition.end, e) : e()) : e && e()
            }
        };
        var e = o.fn.modal;
        o.fn.modal = function(r) {
            return this.each(function() {
                var e = o(this),
                    t = e.data("modal"),
                    n = o.extend({}, o.fn.modal.defaults, e.data(), "object" == typeof r && r);
                t || e.data("modal", t = new i(this, n)), "string" == typeof r ? t[r]() : n.show && t.show()
            })
        }, o.fn.modal.defaults = {
            backdrop: !0,
            keyboard: !0,
            show: !0
        }, o.fn.modal.Constructor = i, o.fn.modal.noConflict = function() {
            return o.fn.modal = e, this
        }, o(document).on("click.modal.data-api", '[data-toggle="modal"]', function(e) {
            var t = o(this),
                n = t.attr("href"),
                r = o(t.attr("data-target") || n && n.replace(/.*(?=#[^\s]+$)/, "")),
                i = r.data("modal") ? "toggle" : o.extend({
                    remote: !/#/.test(n) && n
                }, r.data(), t.data());
            e.preventDefault(), r.modal(i).one("hide", function() {
                t.focus()
            })
        })
    }(window.jQuery),
    function(l) {
        "use strict";
        var i = function(e, t) {
            this.init("tooltip", e, t)
        };
        i.prototype = {
            constructor: i,
            init: function(e, t, n) {
                var r, i, o, s, a;
                for (this.type = e, this.$element = l(t), this.options = this.getOptions(n), this.enabled = !0, a = (o = this.options.trigger.split(" ")).length; a--;) "click" == (s = o[a]) ? this.$element.on("click." + this.type, this.options.selector, l.proxy(this.toggle, this)) : "manual" != s && (r = "hover" == s ? "mouseenter" : "focus", i = "hover" == s ? "mouseleave" : "blur", this.$element.on(r + "." + this.type, this.options.selector, l.proxy(this.enter, this)), this.$element.on(i + "." + this.type, this.options.selector, l.proxy(this.leave, this)));
                this.options.selector ? this._options = l.extend({}, this.options, {
                    trigger: "manual",
                    selector: ""
                }) : this.fixTitle()
            },
            getOptions: function(e) {
                return (e = l.extend({}, l.fn[this.type].defaults, this.$element.data(), e)).delay && "number" == typeof e.delay && (e.delay = {
                    show: e.delay,
                    hide: e.delay
                }), e
            },
            enter: function(e) {
                var t, n = l.fn[this.type].defaults,
                    r = {};
                if (this._options && l.each(this._options, function(e, t) {
                        n[e] != t && (r[e] = t)
                    }, this), !(t = l(e.currentTarget)[this.type](r).data(this.type)).options.delay || !t.options.delay.show) return t.show();
                clearTimeout(this.timeout), t.hoverState = "in", this.timeout = setTimeout(function() {
                    "in" == t.hoverState && t.show()
                }, t.options.delay.show)
            },
            leave: function(e) {
                var t = l(e.currentTarget)[this.type](this._options).data(this.type);
                if (this.timeout && clearTimeout(this.timeout), !t.options.delay || !t.options.delay.hide) return t.hide();
                t.hoverState = "out", this.timeout = setTimeout(function() {
                    "out" == t.hoverState && t.hide()
                }, t.options.delay.hide)
            },
            show: function() {
                var e, t, n, r, i, o, s = l.Event("show");
                if (this.hasContent() && this.enabled) {
                    if (this.$element.trigger(s), s.isDefaultPrevented()) return;
                    switch (e = this.tip(), this.setContent(), this.options.animation && e.addClass("fade"), i = "function" == typeof this.options.placement ? this.options.placement.call(this, e[0], this.$element[0]) : this.options.placement, e.detach().css({
                        top: 0,
                        left: 0,
                        display: "block"
                    }), this.options.container ? e.appendTo(this.options.container) : e.insertAfter(this.$element), t = this.getPosition(), n = e[0].offsetWidth, r = e[0].offsetHeight, i) {
                        case "bottom":
                            o = {
                                top: t.top + t.height,
                                left: t.left + t.width / 2 - n / 2
                            };
                            break;
                        case "top":
                            o = {
                                top: t.top - r,
                                left: t.left + t.width / 2 - n / 2
                            };
                            break;
                        case "left":
                            o = {
                                top: t.top + t.height / 2 - r / 2,
                                left: t.left - n
                            };
                            break;
                        case "right":
                            o = {
                                top: t.top + t.height / 2 - r / 2,
                                left: t.left + t.width
                            }
                    }
                    this.applyPlacement(o, i), this.$element.trigger("shown")
                }
            },
            applyPlacement: function(e, t) {
                var n, r, i, o, s = this.tip(),
                    a = s[0].offsetWidth,
                    l = s[0].offsetHeight;
                s.offset(e).addClass(t).addClass("in"), n = s[0].offsetWidth, r = s[0].offsetHeight, "top" == t && r != l && (e.top = e.top + l - r, o = !0), "bottom" == t || "top" == t ? (i = 0, e.left < 0 && (i = -2 * e.left, e.left = 0, s.offset(e), n = s[0].offsetWidth, r = s[0].offsetHeight), this.replaceArrow(i - a + n, n, "left")) : this.replaceArrow(r - l, r, "top"), o && s.offset(e)
            },
            replaceArrow: function(e, t, n) {
                this.arrow().css(n, e ? 50 * (1 - e / t) + "%" : "")
            },
            setContent: function() {
                var e = this.tip(),
                    t = this.getTitle();
                e.find(".tooltip-inner")[this.options.html ? "html" : "text"](t), e.removeClass("fade in top bottom left right")
            },
            hide: function() {
                var e, t = this.tip(),
                    n = l.Event("hide");
                if (this.$element.trigger(n), !n.isDefaultPrevented()) return t.removeClass("in"), l.support.transition && this.$tip.hasClass("fade") ? (e = setTimeout(function() {
                    t.off(l.support.transition.end).detach()
                }, 500), t.one(l.support.transition.end, function() {
                    clearTimeout(e), t.detach()
                })) : t.detach(), this.$element.trigger("hidden"), this
            },
            fixTitle: function() {
                var e = this.$element;
                (e.attr("title") || "string" != typeof e.attr("data-original-title")) && e.attr("data-original-title", e.attr("title") || "").attr("title", "")
            },
            hasContent: function() {
                return this.getTitle()
            },
            getPosition: function() {
                var e = this.$element[0];
                return l.extend({}, "function" == typeof e.getBoundingClientRect ? e.getBoundingClientRect() : {
                    width: e.offsetWidth,
                    height: e.offsetHeight
                }, this.$element.offset())
            },
            getTitle: function() {
                var e = this.$element,
                    t = this.options;
                return e.attr("data-original-title") || ("function" == typeof t.title ? t.title.call(e[0]) : t.title)
            },
            tip: function() {
                return this.$tip = this.$tip || l(this.options.template)
            },
            arrow: function() {
                return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
            },
            validate: function() {
                this.$element[0].parentNode || (this.hide(), this.$element = null, this.options = null)
            },
            enable: function() {
                this.enabled = !0
            },
            disable: function() {
                this.enabled = !1
            },
            toggleEnabled: function() {
                this.enabled = !this.enabled
            },
            toggle: function(e) {
                var t = e ? l(e.currentTarget)[this.type](this._options).data(this.type) : this;
                t.tip().hasClass("in") ? t.hide() : t.show()
            },
            destroy: function() {
                this.hide().$element.off("." + this.type).removeData(this.type)
            }
        };
        var e = l.fn.tooltip;
        l.fn.tooltip = function(r) {
            return this.each(function() {
                var e = l(this),
                    t = e.data("tooltip"),
                    n = "object" == typeof r && r;
                t || e.data("tooltip", t = new i(this, n)), "string" == typeof r && t[r]()
            })
        }, l.fn.tooltip.Constructor = i, l.fn.tooltip.defaults = {
            animation: !0,
            placement: "top",
            selector: !1,
            template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
            trigger: "hover focus",
            title: "",
            delay: 0,
            html: !1,
            container: !1
        }, l.fn.tooltip.noConflict = function() {
            return l.fn.tooltip = e, this
        }
    }(window.jQuery),
    function(i) {
        "use strict";
        var o = function(e, t) {
            this.init("popover", e, t)
        };
        o.prototype = i.extend({}, i.fn.tooltip.Constructor.prototype, {
            constructor: o,
            setContent: function() {
                var e = this.tip(),
                    t = this.getTitle(),
                    n = this.getContent();
                e.find(".popover-title")[this.options.html ? "html" : "text"](t), e.find(".popover-content")[this.options.html ? "html" : "text"](n), e.removeClass("fade top bottom left right in")
            },
            hasContent: function() {
                return this.getTitle() || this.getContent()
            },
            getContent: function() {
                var e = this.$element,
                    t = this.options;
                return ("function" == typeof t.content ? t.content.call(e[0]) : t.content) || e.attr("data-content")
            },
            tip: function() {
                return this.$tip || (this.$tip = i(this.options.template)), this.$tip
            },
            destroy: function() {
                this.hide().$element.off("." + this.type).removeData(this.type)
            }
        });
        var e = i.fn.popover;
        i.fn.popover = function(r) {
            return this.each(function() {
                var e = i(this),
                    t = e.data("popover"),
                    n = "object" == typeof r && r;
                t || e.data("popover", t = new o(this, n)), "string" == typeof r && t[r]()
            })
        }, i.fn.popover.Constructor = o, i.fn.popover.defaults = i.extend({}, i.fn.tooltip.defaults, {
            placement: "right",
            trigger: "click",
            content: "",
            template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
        }), i.fn.popover.noConflict = function() {
            return i.fn.popover = e, this
        }
    }(window.jQuery),
    function(o) {
        "use strict";

        function i(e, t) {
            var n, r = o.proxy(this.process, this),
                i = o(e).is("body") ? o(window) : o(e);
            this.options = o.extend({}, o.fn.scrollspy.defaults, t), this.$scrollElement = i.on("scroll.scroll-spy.data-api", r), this.selector = (this.options.target || (n = o(e).attr("href")) && n.replace(/.*(?=#[^\s]+$)/, "") || "") + " .nav li > a", this.$body = o("body"), this.refresh(), this.process()
        }
        i.prototype = {
            constructor: i,
            refresh: function() {
                var r = this;
                this.offsets = o([]), this.targets = o([]), this.$body.find(this.selector).map(function() {
                    var e = o(this),
                        t = e.data("target") || e.attr("href"),
                        n = /^#\w/.test(t) && o(t);
                    return n && n.length && [
                        [n.position().top + (!o.isWindow(r.$scrollElement.get(0)) && r.$scrollElement.scrollTop()), t]
                    ] || null
                }).sort(function(e, t) {
                    return e[0] - t[0]
                }).each(function() {
                    r.offsets.push(this[0]), r.targets.push(this[1])
                })
            },
            process: function() {
                var e, t = this.$scrollElement.scrollTop() + this.options.offset,
                    n = (this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight) - this.$scrollElement.height(),
                    r = this.offsets,
                    i = this.targets,
                    o = this.activeTarget;
                if (n <= t) return o != (e = i.last()[0]) && this.activate(e);
                for (e = r.length; e--;) o != i[e] && t >= r[e] && (!r[e + 1] || t <= r[e + 1]) && this.activate(i[e])
            },
            activate: function(e) {
                var t, n;
                this.activeTarget = e, o(this.selector).parent(".active").removeClass("active"), n = this.selector + '[data-target="' + e + '"],' + this.selector + '[href="' + e + '"]', (t = o(n).parent("li").addClass("active")).parent(".dropdown-menu").length && (t = t.closest("li.dropdown").addClass("active")), t.trigger("activate")
            }
        };
        var e = o.fn.scrollspy;
        o.fn.scrollspy = function(r) {
            return this.each(function() {
                var e = o(this),
                    t = e.data("scrollspy"),
                    n = "object" == typeof r && r;
                t || e.data("scrollspy", t = new i(this, n)), "string" == typeof r && t[r]()
            })
        }, o.fn.scrollspy.Constructor = i, o.fn.scrollspy.defaults = {
            offset: 10
        }, o.fn.scrollspy.noConflict = function() {
            return o.fn.scrollspy = e, this
        }, o(window).on("load", function() {
            o('[data-spy="scroll"]').each(function() {
                var e = o(this);
                e.scrollspy(e.data())
            })
        })
    }(window.jQuery),
    function(s) {
        "use strict";
        var r = function(e) {
            this.element = s(e)
        };
        r.prototype = {
            constructor: r,
            show: function() {
                var e, t, n, r = this.element,
                    i = r.closest("ul:not(.dropdown-menu)"),
                    o = r.attr("data-target");
                o || (o = (o = r.attr("href")) && o.replace(/.*(?=#[^\s]*$)/, "")), r.parent("li").hasClass("active") || (e = i.find(".active:last a")[0], n = s.Event("show", {
                    relatedTarget: e
                }), r.trigger(n), n.isDefaultPrevented() || (t = s(o), this.activate(r.parent("li"), i), this.activate(t, t.parent(), function() {
                    r.trigger({
                        type: "shown",
                        relatedTarget: e
                    })
                })))
            },
            activate: function(e, t, n) {
                function r() {
                    i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"), e.addClass("active"), o ? (e[0].offsetWidth, e.addClass("in")) : e.removeClass("fade"), e.parent(".dropdown-menu") && e.closest("li.dropdown").addClass("active"), n && n()
                }
                var i = t.find("> .active"),
                    o = n && s.support.transition && i.hasClass("fade");
                o ? i.one(s.support.transition.end, r) : r(), i.removeClass("in")
            }
        };
        var e = s.fn.tab;
        s.fn.tab = function(n) {
            return this.each(function() {
                var e = s(this),
                    t = e.data("tab");
                t || e.data("tab", t = new r(this)), "string" == typeof n && t[n]()
            })
        }, s.fn.tab.Constructor = r, s.fn.tab.noConflict = function() {
            return s.fn.tab = e, this
        }, s(document).on("click.tab.data-api", '[data-toggle="tab"], [data-toggle="pill"]', function(e) {
            e.preventDefault(), s(this).tab("show")
        })
    }(window.jQuery),
    function(i) {
        "use strict";
        var o = function(e, t) {
            this.$element = i(e), this.options = i.extend({}, i.fn.typeahead.defaults, t), this.matcher = this.options.matcher || this.matcher, this.sorter = this.options.sorter || this.sorter, this.highlighter = this.options.highlighter || this.highlighter, this.updater = this.options.updater || this.updater, this.source = this.options.source, this.$menu = i(this.options.menu), this.shown = !1, this.listen()
        };
        o.prototype = {
            constructor: o,
            select: function() {
                var e = this.$menu.find(".active").attr("data-value");
                return this.$element.val(this.updater(e)).change(), this.hide()
            },
            updater: function(e) {
                return e
            },
            show: function() {
                var e = i.extend({}, this.$element.position(), {
                    height: this.$element[0].offsetHeight
                });
                return this.$menu.insertAfter(this.$element).css({
                    top: e.top + e.height,
                    left: e.left
                }).show(), this.shown = !0, this
            },
            hide: function() {
                return this.$menu.hide(), this.shown = !1, this
            },
            lookup: function(e) {
                var t;
                return this.query = this.$element.val(), !this.query || this.query.length < this.options.minLength ? this.shown ? this.hide() : this : (t = i.isFunction(this.source) ? this.source(this.query, i.proxy(this.process, this)) : this.source) ? this.process(t) : this
            },
            process: function(e) {
                var t = this;
                return e = i.grep(e, function(e) {
                    return t.matcher(e)
                }), (e = this.sorter(e)).length ? this.render(e.slice(0, this.options.items)).show() : this.shown ? this.hide() : this
            },
            matcher: function(e) {
                return ~e.toLowerCase().indexOf(this.query.toLowerCase())
            },
            sorter: function(e) {
                for (var t, n = [], r = [], i = []; t = e.shift();) t.toLowerCase().indexOf(this.query.toLowerCase()) ? ~t.indexOf(this.query) ? r.push(t) : i.push(t) : n.push(t);
                return n.concat(r, i)
            },
            highlighter: function(e) {
                var t = this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
                return e.replace(new RegExp("(" + t + ")", "ig"), function(e, t) {
                    return "<strong>" + t + "</strong>"
                })
            },
            render: function(e) {
                var n = this;
                return (e = i(e).map(function(e, t) {
                    return (e = i(n.options.item).attr("data-value", t)).find("a").html(n.highlighter(t)), e[0]
                })).first().addClass("active"), this.$menu.html(e), this
            },
            next: function(e) {
                var t = this.$menu.find(".active").removeClass("active").next();
                t.length || (t = i(this.$menu.find("li")[0])), t.addClass("active")
            },
            prev: function(e) {
                var t = this.$menu.find(".active").removeClass("active").prev();
                t.length || (t = this.$menu.find("li").last()), t.addClass("active")
            },
            listen: function() {
                this.$element.on("focus", i.proxy(this.focus, this)).on("blur", i.proxy(this.blur, this)).on("keypress", i.proxy(this.keypress, this)).on("keyup", i.proxy(this.keyup, this)), this.eventSupported("keydown") && this.$element.on("keydown", i.proxy(this.keydown, this)), this.$menu.on("click", i.proxy(this.click, this)).on("mouseenter", "li", i.proxy(this.mouseenter, this)).on("mouseleave", "li", i.proxy(this.mouseleave, this))
            },
            eventSupported: function(e) {
                var t = e in this.$element;
                return t || (this.$element.setAttribute(e, "return;"), t = "function" == typeof this.$element[e]), t
            },
            move: function(e) {
                if (this.shown) {
                    switch (e.keyCode) {
                        case 9:
                        case 13:
                        case 27:
                            e.preventDefault();
                            break;
                        case 38:
                            e.preventDefault(), this.prev();
                            break;
                        case 40:
                            e.preventDefault(), this.next()
                    }
                    e.stopPropagation()
                }
            },
            keydown: function(e) {
                this.suppressKeyPressRepeat = ~i.inArray(e.keyCode, [40, 38, 9, 13, 27]), this.move(e)
            },
            keypress: function(e) {
                this.suppressKeyPressRepeat || this.move(e)
            },
            keyup: function(e) {
                switch (e.keyCode) {
                    case 40:
                    case 38:
                    case 16:
                    case 17:
                    case 18:
                        break;
                    case 9:
                    case 13:
                        if (!this.shown) return;
                        this.select();
                        break;
                    case 27:
                        if (!this.shown) return;
                        this.hide();
                        break;
                    default:
                        this.lookup()
                }
                e.stopPropagation(), e.preventDefault()
            },
            focus: function(e) {
                this.focused = !0
            },
            blur: function(e) {
                this.focused = !1, !this.mousedover && this.shown && this.hide()
            },
            click: function(e) {
                e.stopPropagation(), e.preventDefault(), this.select(), this.$element.focus()
            },
            mouseenter: function(e) {
                this.mousedover = !0, this.$menu.find(".active").removeClass("active"), i(e.currentTarget).addClass("active")
            },
            mouseleave: function(e) {
                this.mousedover = !1, !this.focused && this.shown && this.hide()
            }
        };
        var e = i.fn.typeahead;
        i.fn.typeahead = function(r) {
            return this.each(function() {
                var e = i(this),
                    t = e.data("typeahead"),
                    n = "object" == typeof r && r;
                t || e.data("typeahead", t = new o(this, n)), "string" == typeof r && t[r]()
            })
        }, i.fn.typeahead.defaults = {
            source: [],
            items: 8,
            menu: '<ul class="typeahead dropdown-menu"></ul>',
            item: '<li><a href="#"></a></li>',
            minLength: 1
        }, i.fn.typeahead.Constructor = o, i.fn.typeahead.noConflict = function() {
            return i.fn.typeahead = e, this
        }, i(document).on("focus.typeahead.data-api", '[data-provide="typeahead"]', function(e) {
            var t = i(this);
            t.data("typeahead") || t.typeahead(t.data())
        })
    }(window.jQuery),
    function(a) {
        "use strict";
        var i = function(e, t) {
            this.options = a.extend({}, a.fn.affix.defaults, t), this.$window = a(window).on("scroll.affix.data-api", a.proxy(this.checkPosition, this)).on("click.affix.data-api", a.proxy(function() {
                setTimeout(a.proxy(this.checkPosition, this), 1)
            }, this)), this.$element = a(e), this.checkPosition()
        };
        i.prototype.checkPosition = function() {
            if (this.$element.is(":visible")) {
                var e, t = a(document).height(),
                    n = this.$window.scrollTop(),
                    r = this.$element.offset(),
                    i = this.options.offset,
                    o = i.bottom,
                    s = i.top;
                "object" != typeof i && (o = s = i), "function" == typeof s && (s = i.top()), "function" == typeof o && (o = i.bottom()), e = !(null != this.unpin && n + this.unpin <= r.top) && (null != o && r.top + this.$element.height() >= t - o ? "bottom" : null != s && n <= s && "top"), this.affixed !== e && (this.affixed = e, this.unpin = "bottom" == e ? r.top - n : null, this.$element.removeClass("affix affix-top affix-bottom").addClass("affix" + (e ? "-" + e : "")))
            }
        };
        var e = a.fn.affix;
        a.fn.affix = function(r) {
            return this.each(function() {
                var e = a(this),
                    t = e.data("affix"),
                    n = "object" == typeof r && r;
                t || e.data("affix", t = new i(this, n)), "string" == typeof r && t[r]()
            })
        }, a.fn.affix.Constructor = i, a.fn.affix.defaults = {
            offset: 0
        }, a.fn.affix.noConflict = function() {
            return a.fn.affix = e, this
        }, a(window).on("load", function() {
            a('[data-spy="affix"]').each(function() {
                var e = a(this),
                    t = e.data();
                t.offset = t.offset || {}, t.offsetBottom && (t.offset.bottom = t.offsetBottom), t.offsetTop && (t.offset.top = t.offsetTop), e.affix(t)
            })
        })
    }(window.jQuery),
    function(l) {
        var i = {
                formatInvalidInputErrorMsg: function(e) {
                    return "Invalid input value '" + e + "' passed in"
                },
                callingContextNotSliderInstance: "Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"
            },
            o = function(e, n) {
                var r = this.element = l(e).hide(),
                    t = l(e)[0].style.width,
                    i = !1,
                    o = this.element.parent();
                !0 === o.hasClass("slider") ? (i = !0, this.picker = o) : this.picker = l('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div id="tooltip" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><div id="tooltip_min" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><div id="tooltip_max" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element), this.id = this.element.data("slider-id") || n.id, this.id && (this.picker[0].id = this.id), "undefined" != typeof Modernizr && Modernizr.touch && (this.touchCapable = !0);
                var s = this.element.data("slider-tooltip") || n.tooltip;
                switch (this.tooltip = this.picker.find("#tooltip"), this.tooltipInner = this.tooltip.find("div.tooltip-inner"), this.tooltip_min = this.picker.find("#tooltip_min"), this.tooltipInner_min = this.tooltip_min.find("div.tooltip-inner"), this.tooltip_max = this.picker.find("#tooltip_max"), this.tooltipInner_max = this.tooltip_max.find("div.tooltip-inner"), !0 === i && (this.picker.removeClass("slider-horizontal"), this.picker.removeClass("slider-vertical"), this.tooltip.removeClass("hide"), this.tooltip_min.removeClass("hide"), this.tooltip_max.removeClass("hide")), this.orientation = this.element.data("slider-orientation") || n.orientation, this.orientation) {
                    case "vertical":
                        this.picker.addClass("slider-vertical"), this.stylePos = "top", this.mousePos = "pageY", this.sizePos = "offsetHeight", this.tooltip.addClass("right")[0].style.left = "100%", this.tooltip_min.addClass("right")[0].style.left = "100%", this.tooltip_max.addClass("right")[0].style.left = "100%";
                        break;
                    default:
                        this.picker.addClass("slider-horizontal").css("width", t), this.orientation = "horizontal", this.stylePos = "left", this.mousePos = "pageX", this.sizePos = "offsetWidth", this.tooltip.addClass("top")[0].style.top = -this.tooltip.outerHeight() - 14 + "px", this.tooltip_min.addClass("top")[0].style.top = -this.tooltip_min.outerHeight() - 14 + "px", this.tooltip_max.addClass("top")[0].style.top = -this.tooltip_max.outerHeight() - 14 + "px"
                }
                var a = this;
                switch (l.each(["min", "max", "step", "value"], function(e, t) {
                    void 0 !== r.data("slider-" + t) ? a[t] = r.data("slider-" + t) : void 0 !== n[t] ? a[t] = n[t] : void 0 !== r.prop(t) ? a[t] = r.prop(t) : a[t] = 0
                }), this.value instanceof Array ? i && !this.range ? this.value = this.value[0] : this.range = !0 : this.range && (this.value = [this.value, this.max]), this.selection = this.element.data("slider-selection") || n.selection, this.selectionEl = this.picker.find(".slider-selection"), "none" === this.selection && this.selectionEl.addClass("hide"), this.selectionElStyle = this.selectionEl[0].style, this.handle1 = this.picker.find(".slider-handle:first"), this.handle1Stype = this.handle1[0].style, this.handle2 = this.picker.find(".slider-handle:last"), this.handle2Stype = this.handle2[0].style, !0 === i && (this.handle1.removeClass("round triangle"), this.handle2.removeClass("round triangle hide")), this.element.data("slider-handle") || n.handle) {
                    case "round":
                        this.handle1.addClass("round"), this.handle2.addClass("round");
                        break;
                    case "triangle":
                        this.handle1.addClass("triangle"), this.handle2.addClass("triangle")
                }
                this.range ? (this.value[0] = Math.max(this.min, Math.min(this.max, this.value[0])), this.value[1] = Math.max(this.min, Math.min(this.max, this.value[1]))) : (this.value = [Math.max(this.min, Math.min(this.max, this.value))], this.handle2.addClass("hide"), "after" === this.selection ? this.value[1] = this.max : this.value[1] = this.min), this.diff = this.max - this.min, this.percentage = [100 * (this.value[0] - this.min) / this.diff, 100 * (this.value[1] - this.min) / this.diff, 100 * this.step / this.diff], this.offset = this.picker.offset(), this.size = this.picker[0][this.sizePos], this.formater = n.formater, this.tooltip_separator = n.tooltip_separator, this.tooltip_split = n.tooltip_split, this.reversed = this.element.data("slider-reversed") || n.reversed, this.layout(), this.layout(), this.handle1.on({
                    keydown: l.proxy(this.keydown, this, 0)
                }), this.handle2.on({
                    keydown: l.proxy(this.keydown, this, 1)
                }), this.touchCapable ? this.picker.on({
                    touchstart: l.proxy(this.mousedown, this)
                }) : this.picker.on({
                    mousedown: l.proxy(this.mousedown, this)
                }), "hide" === s ? (this.tooltip.addClass("hide"), this.tooltip_min.addClass("hide"), this.tooltip_max.addClass("hide")) : "always" === s ? (this.showTooltip(), this.alwaysShowTooltip = !0) : (this.picker.on({
                    mouseenter: l.proxy(this.showTooltip, this),
                    mouseleave: l.proxy(this.hideTooltip, this)
                }), this.handle1.on({
                    focus: l.proxy(this.showTooltip, this),
                    blur: l.proxy(this.hideTooltip, this)
                }), this.handle2.on({
                    focus: l.proxy(this.showTooltip, this),
                    blur: l.proxy(this.hideTooltip, this)
                })), this.enabled = n.enabled && (void 0 === this.element.data("slider-enabled") || !0 === this.element.data("slider-enabled")), this.enabled ? this.enable() : this.disable()
            };
        o.prototype = {
            constructor: o,
            over: !1,
            inDrag: !1,
            showTooltip: function() {
                !1 === this.tooltip_split ? this.tooltip.addClass("in") : (this.tooltip_min.addClass("in"), this.tooltip_max.addClass("in")), this.over = !0
            },
            hideTooltip: function() {
                !1 === this.inDrag && !0 !== this.alwaysShowTooltip && (this.tooltip.removeClass("in"), this.tooltip_min.removeClass("in"), this.tooltip_max.removeClass("in")), this.over = !1
            },
            layout: function() {
                var e;
                if (e = this.reversed ? [100 - this.percentage[0], this.percentage[1]] : [this.percentage[0], this.percentage[1]], this.handle1Stype[this.stylePos] = e[0] + "%", this.handle2Stype[this.stylePos] = e[1] + "%", "vertical" === this.orientation) this.selectionElStyle.top = Math.min(e[0], e[1]) + "%", this.selectionElStyle.height = Math.abs(e[0] - e[1]) + "%";
                else {
                    this.selectionElStyle.left = Math.min(e[0], e[1]) + "%", this.selectionElStyle.width = Math.abs(e[0] - e[1]) + "%";
                    var t = this.tooltip_min[0].getBoundingClientRect(),
                        n = this.tooltip_max[0].getBoundingClientRect();
                    t.right > n.left ? (this.tooltip_max.removeClass("top"), this.tooltip_max.addClass("bottom")[0].style.top = "18px") : (this.tooltip_max.removeClass("bottom"), this.tooltip_max.addClass("top")[0].style.top = "-30px")
                }
                this.range ? (this.tooltipInner.text(this.formater(this.value[0]) + this.tooltip_separator + this.formater(this.value[1])), this.tooltip[0].style[this.stylePos] = this.size * (e[0] + (e[1] - e[0]) / 2) / 100 - ("vertical" === this.orientation ? this.tooltip.outerHeight() / 2 : this.tooltip.outerWidth() / 2) + "px", this.tooltipInner_min.text(this.formater(this.value[0])), this.tooltipInner_max.text(this.formater(this.value[1])), this.tooltip_min[0].style[this.stylePos] = this.size * (e[0] / 100) - ("vertical" === this.orientation ? this.tooltip_min.outerHeight() / 2 : this.tooltip_min.outerWidth() / 2) + "px", this.tooltip_max[0].style[this.stylePos] = this.size * (e[1] / 100) - ("vertical" === this.orientation ? this.tooltip_max.outerHeight() / 2 : this.tooltip_max.outerWidth() / 2) + "px") : (this.tooltipInner.text(this.formater(this.value[0])), this.tooltip[0].style[this.stylePos] = this.size * e[0] / 100 - ("vertical" === this.orientation ? this.tooltip.outerHeight() / 2 : this.tooltip.outerWidth() / 2) + "px")
            },
            mousedown: function(e) {
                if (!this.isEnabled()) return !1;
                this.touchCapable && "touchstart" === e.type && (e = e.originalEvent), this.triggerFocusOnHandle(), this.offset = this.picker.offset(), this.size = this.picker[0][this.sizePos];
                var t = this.getPercentage(e);
                if (this.range) {
                    var n = Math.abs(this.percentage[0] - t),
                        r = Math.abs(this.percentage[1] - t);
                    this.dragged = n < r ? 0 : 1
                } else this.dragged = 0;
                this.percentage[this.dragged] = this.reversed ? 100 - t : t, this.layout(), this.touchCapable ? l(document).on({
                    touchmove: l.proxy(this.mousemove, this),
                    touchend: l.proxy(this.mouseup, this)
                }) : l(document).on({
                    mousemove: l.proxy(this.mousemove, this),
                    mouseup: l.proxy(this.mouseup, this)
                }), this.inDrag = !0;
                var i = this.calculateValue();
                return this.setValue(i), this.element.trigger({
                    type: "slideStart",
                    value: i
                }).trigger({
                    type: "slide",
                    value: i
                }), !0
            },
            triggerFocusOnHandle: function(e) {
                0 === e && this.handle1.focus(), 1 === e && this.handle2.focus()
            },
            keydown: function(e, t) {
                if (!this.isEnabled()) return !1;
                var n;
                switch (t.which) {
                    case 37:
                    case 40:
                        n = -1;
                        break;
                    case 39:
                    case 38:
                        n = 1
                }
                if (n) {
                    var r = n * this.percentage[2],
                        i = this.percentage[e] + r;
                    100 < i ? i = 100 : i < 0 && (i = 0), this.dragged = e, this.adjustPercentageForRangeSliders(i), this.percentage[this.dragged] = i, this.layout();
                    var o = this.calculateValue();
                    return this.setValue(o), this.element.trigger({
                        type: "slide",
                        value: o
                    }).trigger({
                        type: "slideStop",
                        value: o
                    }).data("value", o).prop("value", o), !1
                }
            },
            mousemove: function(e) {
                if (!this.isEnabled()) return !1;
                this.touchCapable && "touchmove" === e.type && (e = e.originalEvent);
                var t = this.getPercentage(e);
                this.adjustPercentageForRangeSliders(t), this.percentage[this.dragged] = this.reversed ? 100 - t : t, this.layout();
                var n = this.calculateValue();
                return this.setValue(n), this.element.trigger({
                    type: "slide",
                    value: n
                }).data("value", n).prop("value", n), !1
            },
            adjustPercentageForRangeSliders: function(e) {
                this.range && (0 === this.dragged && this.percentage[1] < e ? (this.percentage[0] = this.percentage[1], this.dragged = 1) : 1 === this.dragged && this.percentage[0] > e && (this.percentage[1] = this.percentage[0], this.dragged = 0))
            },
            mouseup: function() {
                if (!this.isEnabled()) return !1;
                this.touchCapable ? l(document).off({
                    touchmove: this.mousemove,
                    touchend: this.mouseup
                }) : l(document).off({
                    mousemove: this.mousemove,
                    mouseup: this.mouseup
                }), (this.inDrag = !1) === this.over && this.hideTooltip();
                var e = this.calculateValue();
                return this.layout(), this.element.data("value", e).prop("value", e).trigger({
                    type: "slideStop",
                    value: e
                }), !1
            },
            calculateValue: function() {
                var e;
                return this.range ? (e = [this.min, this.max], 0 !== this.percentage[0] && (e[0] = Math.max(this.min, this.min + Math.round(this.diff * this.percentage[0] / 100 / this.step) * this.step)), 100 !== this.percentage[1] && (e[1] = Math.min(this.max, this.min + Math.round(this.diff * this.percentage[1] / 100 / this.step) * this.step)), this.value = e) : ((e = this.min + Math.round(this.diff * this.percentage[0] / 100 / this.step) * this.step) < this.min ? e = this.min : e > this.max && (e = this.max), e = parseFloat(e), this.value = [e, this.value[1]]), e
            },
            getPercentage: function(e) {
                this.touchCapable && (e = e.touches[0]);
                var t = 100 * (e[this.mousePos] - this.offset[this.stylePos]) / this.size;
                return t = Math.round(t / this.percentage[2]) * this.percentage[2], Math.max(0, Math.min(100, t))
            },
            getValue: function() {
                return this.range ? this.value : this.value[0]
            },
            setValue: function(e) {
                this.value = this.validateInputValue(e), this.range ? (this.value[0] = Math.max(this.min, Math.min(this.max, this.value[0])), this.value[1] = Math.max(this.min, Math.min(this.max, this.value[1]))) : (this.value = [Math.max(this.min, Math.min(this.max, this.value))], this.handle2.addClass("hide"), "after" === this.selection ? this.value[1] = this.max : this.value[1] = this.min), this.diff = this.max - this.min, this.percentage = [100 * (this.value[0] - this.min) / this.diff, 100 * (this.value[1] - this.min) / this.diff, 100 * this.step / this.diff], this.layout(), this.element.trigger({
                    type: "slide",
                    value: this.value
                }).data("value", this.value).prop("value", this.value)
            },
            validateInputValue: function(e) {
                if ("number" == typeof e) return e;
                if (e instanceof Array) return l.each(e, function(e, t) {
                    if ("number" != typeof t) throw new Error(i.formatInvalidInputErrorMsg(t))
                }), e;
                throw new Error(i.formatInvalidInputErrorMsg(e))
            },
            destroy: function() {
                this.handle1.off(), this.handle2.off(), this.element.off().show().insertBefore(this.picker), this.picker.off().remove(), l(this.element).removeData("slider")
            },
            disable: function() {
                this.enabled = !1, this.handle1.removeAttr("tabindex"), this.handle2.removeAttr("tabindex"), this.picker.addClass("slider-disabled"), this.element.trigger("slideDisabled")
            },
            enable: function() {
                this.enabled = !0, this.handle1.attr("tabindex", 0), this.handle2.attr("tabindex", 0), this.picker.removeClass("slider-disabled"), this.element.trigger("slideEnabled")
            },
            toggle: function() {
                this.enabled ? this.disable() : this.enable()
            },
            isEnabled: function() {
                return this.enabled
            },
            setAttribute: function(e, t) {
                this[e] = t
            }
        };
        var s = {
            getValue: o.prototype.getValue,
            setValue: o.prototype.setValue,
            setAttribute: o.prototype.setAttribute,
            destroy: o.prototype.destroy,
            disable: o.prototype.disable,
            enable: o.prototype.enable,
            toggle: o.prototype.toggle,
            isEnabled: o.prototype.isEnabled
        };
        l.fn.slider = function(e) {
            if ("string" != typeof e || "refresh" === e) return function(r) {
                var e = l(this);
                return e.each(function() {
                    var e = l(this),
                        t = e.data("slider"),
                        n = "object" == typeof r && r;
                    t && !n && (n = {}, l.each(l.fn.slider.defaults, function(e) {
                        n[e] = t[e]
                    })), e.data("slider", new o(this, l.extend({}, l.fn.slider.defaults, n)))
                }), e
            }.call(this, e);
            var t = Array.prototype.slice.call(arguments, 1);
            return function(e, t) {
                {
                    if (s[e]) {
                        var n = function(e) {
                                var t = l(e).data("slider"); {
                                    if (t && t instanceof o) return t;
                                    throw new Error(i.callingContextNotSliderInstance)
                                }
                            }(this),
                            r = s[e].apply(n, t);
                        return void 0 === r ? l(this) : r
                    }
                    throw new Error("method '" + e + "()' does not exist for slider.")
                }
            }.call(this, e, t)
        }, l.fn.slider.defaults = {
            min: 0,
            max: 10,
            step: 1,
            orientation: "horizontal",
            value: 5,
            range: !1,
            selection: "before",
            tooltip: "show",
            tooltip_separator: ":",
            tooltip_split: !1,
            handle: "round",
            reversed: !1,
            enabled: !0,
            formater: function(e) {
                return e
            }
        }, l.fn.slider.Constructor = o
    }(window.jQuery),
    function(e) {
        if ("object" == typeof exports && "object" == typeof module) module.exports = e();
        else {
            if ("function" == typeof define && define.amd) return define([], e);
            this.CodeMirror = e()
        }
    }(function() {
        "use strict";
        var f = /gecko\/\d/i.test(navigator.userAgent),
            e = /MSIE \d/.test(navigator.userAgent),
            t = /Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),
            x = e || t,
            w = x && (e ? document.documentMode || 6 : t[1]),
            p = /WebKit\//.test(navigator.userAgent),
            n = p && /Qt\/\d+\.\d+/.test(navigator.userAgent),
            r = /Chrome\//.test(navigator.userAgent),
            m = /Opera\//.test(navigator.userAgent),
            l = /Apple Computer/.test(navigator.vendor),
            i = /Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),
            c = /PhantomJS/.test(navigator.userAgent),
            s = /AppleWebKit/.test(navigator.userAgent) && /Mobile\/\w+/.test(navigator.userAgent),
            u = s || /Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),
            g = s || /Mac/.test(navigator.platform),
            o = /win/i.test(navigator.platform),
            a = m && navigator.userAgent.match(/Version\/(\d*\.\d*)/);
        a && (a = Number(a[1])), a && 15 <= a && (p = !(m = !1));
        var h = g && (n || m && (null == a || a < 12.11)),
            d = f || x && 9 <= w,
            v = !1,
            y = !1;

        function b(e, t) {
            if (!(this instanceof b)) return new b(e, t);
            this.options = t = t ? co(t) : {}, co(Wn, t, !1), O(t);
            var n = t.value;
            "string" == typeof n && (n = new ai(n, t.mode)), this.doc = n;
            var r = new b.inputStyles[t.inputStyle](this),
                i = this.display = new k(e, n, r);
            L(i.wrapper.CodeMirror = this), M(this), t.lineWrapping && (this.display.wrapper.className += " CodeMirror-wrap"), t.autofocus && !u && i.input.focus(), $(this), this.state = {
                keyMaps: [],
                overlays: [],
                modeGen: 0,
                overwrite: !1,
                delayingBlurEvent: !1,
                focused: !1,
                suppressEdits: !1,
                pasteIncoming: !1,
                cutIncoming: !1,
                draggingText: !1,
                highlight: new Ji,
                keySeq: null,
                specialChars: null
            };
            var o = this;
            for (var s in x && w < 11 && setTimeout(function() {
                        o.display.input.reset(!0)
                    }, 20),
                    function(i) {
                        var o = i.display;
                        $i(o.scroller, "mousedown", zt(i, tn)), $i(o.scroller, "dblclick", x && w < 11 ? zt(i, function(e) {
                            if (!ji(i, e)) {
                                var t = en(i, e);
                                if (t && !rn(i, e) && !Zt(i.display, e)) {
                                    Ni(e);
                                    var n = i.findWordAt(t);
                                    Pe(i.doc, n.anchor, n.head)
                                }
                            }
                        }) : function(e) {
                            ji(i, e) || Ni(e)
                        });
                        d || $i(o.scroller, "contextmenu", function(e) {
                            _n(i, e)
                        });
                        var n, r = {
                            end: 0
                        };

                        function s() {
                            o.activeTouch && (n = setTimeout(function() {
                                o.activeTouch = null
                            }, 1e3), (r = o.activeTouch).end = +new Date)
                        }

                        function a(e, t) {
                            if (null == t.left) return !0;
                            var n = t.left - e.left,
                                r = t.top - e.top;
                            return 400 < n * n + r * r
                        }

                        function e(e) {
                            ji(i, e) || Ri(e)
                        }
                        $i(o.scroller, "touchstart", function(e) {
                            if (! function(e) {
                                    if (1 != e.touches.length) return !1;
                                    var t = e.touches[0];
                                    return t.radiusX <= 1 && t.radiusY <= 1
                                }(e)) {
                                clearTimeout(n);
                                var t = +new Date;
                                o.activeTouch = {
                                    start: t,
                                    moved: !1,
                                    prev: t - r.end <= 300 ? r : null
                                }, 1 == e.touches.length && (o.activeTouch.left = e.touches[0].pageX, o.activeTouch.top = e.touches[0].pageY)
                            }
                        }), $i(o.scroller, "touchmove", function() {
                            o.activeTouch && (o.activeTouch.moved = !0)
                        }), $i(o.scroller, "touchend", function(e) {
                            var t = o.activeTouch;
                            if (t && !Zt(o, e) && null != t.left && !t.moved && new Date - t.start < 300) {
                                var n, r = i.coordsChar(o.activeTouch, "page");
                                n = !t.prev || a(t, t.prev) ? new Le(r, r) : !t.prev.prev || a(t, t.prev.prev) ? i.findWordAt(r) : new Le(ue(r.line, 0), Oe(i.doc, ue(r.line + 1, 0))), i.setSelection(n.anchor, n.head), i.focus(), Ni(e)
                            }
                            s()
                        }), $i(o.scroller, "touchcancel", s), $i(o.scroller, "scroll", function() {
                            o.scroller.clientHeight && (an(i, o.scroller.scrollTop), ln(i, o.scroller.scrollLeft, !0), Fi(i, "scroll", i))
                        }), $i(o.scroller, "mousewheel", function(e) {
                            dn(i, e)
                        }), $i(o.scroller, "DOMMouseScroll", function(e) {
                            dn(i, e)
                        }), $i(o.wrapper, "scroll", function() {
                            o.wrapper.scrollTop = o.wrapper.scrollLeft = 0
                        }), i.options.dragDrop && ($i(o.scroller, "dragstart", function(e) {
                            ! function(e, t) {
                                if (x && (!e.state.draggingText || +new Date - on < 100)) return Ri(t);
                                if (ji(e, t) || Zt(e.display, t)) return;
                                if (t.dataTransfer.setData("Text", e.getSelection()), t.dataTransfer.setDragImage && !l) {
                                    var n = bo("img", null, null, "position: fixed; left: 0; top: 0;");
                                    n.src = "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==", m && (n.width = n.height = 1, e.display.wrapper.appendChild(n), n._top = n.offsetTop), t.dataTransfer.setDragImage(n, 0, 0), m && n.parentNode.removeChild(n)
                                }
                            }(i, e)
                        }), $i(o.scroller, "dragenter", e), $i(o.scroller, "dragover", e), $i(o.scroller, "drop", zt(i, sn)));
                        var t = o.input.getField();
                        $i(t, "keyup", function(e) {
                            bn.call(i, e)
                        }), $i(t, "keydown", zt(i, yn)), $i(t, "keypress", zt(i, xn)), $i(t, "focus", uo(wn, i)), $i(t, "blur", uo(kn, i))
                    }(this),
                    function() {
                        if (Lo) return;
                        $i(window, "resize", function() {
                            null == e && (e = setTimeout(function() {
                                e = null, Ao(Jt)
                            }, 100))
                        }), $i(window, "blur", function() {
                            Ao(kn)
                        }), Lo = !0;
                        var e
                    }(), Rt(this), this.curOp.forceUpdate = !0, hi(this, n), t.autofocus && !u || o.hasFocus() ? setTimeout(uo(wn, this), 20) : kn(this), Un) Un.hasOwnProperty(s) && Un[s](this, t[s], Vn);
            q(this), t.finishInit && t.finishInit(this);
            for (var a = 0; a < Qn.length; ++a) Qn[a](this);
            Dt(this), p && t.lineWrapping && "optimizelegibility" == getComputedStyle(i.lineDiv).textRendering && (i.lineDiv.style.textRendering = "auto")
        }

        function k(e, t, n) {
            var r = this;
            this.input = n, r.scrollbarFiller = bo("div", null, "CodeMirror-scrollbar-filler"), r.scrollbarFiller.setAttribute("cm-not-content", "true"), r.gutterFiller = bo("div", null, "CodeMirror-gutter-filler"), r.gutterFiller.setAttribute("cm-not-content", "true"), r.lineDiv = bo("div", null, "CodeMirror-code"), r.selectionDiv = bo("div", null, null, "position: relative; z-index: 1"), r.cursorDiv = bo("div", null, "CodeMirror-cursors"), r.measure = bo("div", null, "CodeMirror-measure"), r.lineMeasure = bo("div", null, "CodeMirror-measure"), r.lineSpace = bo("div", [r.measure, r.lineMeasure, r.selectionDiv, r.cursorDiv, r.lineDiv], null, "position: relative; outline: none"), r.mover = bo("div", [bo("div", [r.lineSpace], "CodeMirror-lines")], null, "position: relative"), r.sizer = bo("div", [r.mover], "CodeMirror-sizer"), r.sizerWidth = null, r.heightForcer = bo("div", null, null, "position: absolute; height: " + Vi + "px; width: 1px;"), r.gutters = bo("div", null, "CodeMirror-gutters"), r.lineGutter = null, r.scroller = bo("div", [r.sizer, r.heightForcer, r.gutters], "CodeMirror-scroll"), r.scroller.setAttribute("tabIndex", "-1"), r.wrapper = bo("div", [r.scrollbarFiller, r.gutterFiller, r.scroller], "CodeMirror"), x && w < 8 && (r.gutters.style.zIndex = -1, r.scroller.style.paddingRight = 0), p || f && u || (r.scroller.draggable = !0), e && (e.appendChild ? e.appendChild(r.wrapper) : e(r.wrapper)), r.viewFrom = r.viewTo = t.first, r.reportedViewFrom = r.reportedViewTo = t.first, r.view = [], r.renderedView = null, r.externalMeasured = null, r.viewOffset = 0, r.lastWrapHeight = r.lastWrapWidth = 0, r.updateLineNumbers = null, r.nativeBarWidth = r.barHeight = r.barWidth = 0, r.scrollbarsClipped = !1, r.lineNumWidth = r.lineNumInnerWidth = r.lineNumChars = null, r.alignWidgets = !1, r.cachedCharWidth = r.cachedTextHeight = r.cachedPaddingH = null, r.maxLine = null, r.maxLineLength = 0, r.maxLineChanged = !1, r.wheelDX = r.wheelDY = r.wheelStartX = r.wheelStartY = null, r.shift = !1, r.selForContextMenu = null, r.activeTouch = null, n.init(r)
        }

        function _(e) {
            e.doc.mode = b.getMode(e.options, e.doc.modeOption), C(e)
        }

        function C(e) {
            e.doc.iter(function(e) {
                e.stateAfter && (e.stateAfter = null), e.styles && (e.styles = null)
            }), e.doc.frontier = e.doc.first, Je(e, 100), e.state.modeGen++, e.curOp && Kt(e)
        }

        function S(r) {
            var i = At(r.display),
                o = r.options.lineWrapping,
                s = o && Math.max(5, r.display.scroller.clientWidth / Lt(r.display) - 3);
            return function(e) {
                if (Or(r.doc, e)) return 0;
                var t = 0;
                if (e.widgets)
                    for (var n = 0; n < e.widgets.length; n++) e.widgets[n].height && (t += e.widgets[n].height);
                return o ? t + (Math.ceil(e.text.length / s) || 1) * i : t + i
            }
        }

        function T(e) {
            var t = e.doc,
                n = S(e);
            t.iter(function(e) {
                var t = n(e);
                t != e.height && mi(e, t)
            })
        }

        function M(e) {
            e.display.wrapper.className = e.display.wrapper.className.replace(/\s*cm-s-\S+/g, "") + e.options.theme.replace(/(^|\s)\s*/g, " cm-s-"), vt(e)
        }

        function A(e) {
            L(e), Kt(e), setTimeout(function() {
                z(e)
            }, 20)
        }

        function L(e) {
            var t = e.display.gutters,
                n = e.options.gutters;
            xo(t);
            for (var r = 0; r < n.length; ++r) {
                var i = n[r],
                    o = t.appendChild(bo("div", null, "CodeMirror-gutter " + i));
                "CodeMirror-linenumbers" == i && ((e.display.lineGutter = o).style.width = (e.display.lineNumWidth || 1) + "px")
            }
            t.style.display = r ? "" : "none", E(e)
        }

        function E(e) {
            var t = e.display.gutters.offsetWidth;
            e.display.sizer.style.marginLeft = t + "px"
        }

        function N(e) {
            if (0 == e.height) return 0;
            for (var t, n = e.text.length, r = e; t = Mr(r);) {
                r = (i = t.find(0, !0)).from.line, n += i.from.ch - i.to.ch
            }
            for (r = e; t = Ar(r);) {
                var i = t.find(0, !0);
                n -= r.text.length - i.from.ch, n += (r = i.to.line).text.length - i.to.ch
            }
            return n
        }

        function I(e) {
            var n = e.display,
                t = e.doc;
            n.maxLine = di(t, t.first), n.maxLineLength = N(n.maxLine), n.maxLineChanged = !0, t.iter(function(e) {
                var t = N(e);
                t > n.maxLineLength && (n.maxLineLength = t, n.maxLine = e)
            })
        }

        function O(e) {
            var t = oo(e.gutters, "CodeMirror-linenumbers"); - 1 == t && e.lineNumbers ? e.gutters = e.gutters.concat(["CodeMirror-linenumbers"]) : -1 < t && !e.lineNumbers && (e.gutters = e.gutters.slice(0), e.gutters.splice(t, 1))
        }

        function R(e) {
            var t = e.display,
                n = t.gutters.offsetWidth,
                r = Math.round(e.doc.height + nt(e.display));
            return {
                clientHeight: t.scroller.clientHeight,
                viewHeight: t.wrapper.clientHeight,
                scrollWidth: t.scroller.scrollWidth,
                clientWidth: t.scroller.clientWidth,
                viewWidth: t.wrapper.clientWidth,
                barLeft: e.options.fixedGutter ? n : 0,
                docHeight: r,
                scrollHeight: r + it(e) + t.barHeight,
                nativeBarWidth: t.nativeBarWidth,
                gutterWidth: n
            }
        }

        function D(e, t, n) {
            this.cm = n;
            var r = this.vert = bo("div", [bo("div", null, null, "min-width: 1px")], "CodeMirror-vscrollbar"),
                i = this.horiz = bo("div", [bo("div", null, null, "height: 100%; min-height: 1px")], "CodeMirror-hscrollbar");
            e(r), e(i), $i(r, "scroll", function() {
                r.clientHeight && t(r.scrollTop, "vertical")
            }), $i(i, "scroll", function() {
                i.clientWidth && t(i.scrollLeft, "horizontal")
            }), this.checkedOverlay = !1, x && w < 8 && (this.horiz.style.minHeight = this.vert.style.minWidth = "18px")
        }

        function P() {}

        function $(n) {
            n.display.scrollbars && (n.display.scrollbars.clear(), n.display.scrollbars.addClass && So(n.display.wrapper, n.display.scrollbars.addClass)), n.display.scrollbars = new b.scrollbarModel[n.options.scrollbarStyle](function(e) {
                n.display.wrapper.insertBefore(e, n.display.scrollbarFiller), $i(e, "mousedown", function() {
                    n.state.focused && setTimeout(function() {
                        n.display.input.focus()
                    }, 0)
                }), e.setAttribute("cm-not-content", "true")
            }, function(e, t) {
                "horizontal" == t ? ln(n, e) : an(n, e)
            }, n), n.display.scrollbars.addClass && To(n.display.wrapper, n.display.scrollbars.addClass)
        }

        function H(e, t) {
            t || (t = R(e));
            var n = e.display.barWidth,
                r = e.display.barHeight;
            F(e, t);
            for (var i = 0; i < 4 && n != e.display.barWidth || r != e.display.barHeight; i++) n != e.display.barWidth && e.options.lineWrapping && X(e), F(e, R(e)), n = e.display.barWidth, r = e.display.barHeight
        }

        function F(e, t) {
            var n = e.display,
                r = n.scrollbars.update(t);
            n.sizer.style.paddingRight = (n.barWidth = r.right) + "px", n.sizer.style.paddingBottom = (n.barHeight = r.bottom) + "px", r.right && r.bottom ? (n.scrollbarFiller.style.display = "block", n.scrollbarFiller.style.height = r.bottom + "px", n.scrollbarFiller.style.width = r.right + "px") : n.scrollbarFiller.style.display = "", r.bottom && e.options.coverGutterNextToScrollbar && e.options.fixedGutter ? (n.gutterFiller.style.display = "block", n.gutterFiller.style.height = r.bottom + "px", n.gutterFiller.style.width = t.gutterWidth + "px") : n.gutterFiller.style.display = ""
        }

        function B(e, t, n) {
            var r = n && null != n.top ? Math.max(0, n.top) : e.scroller.scrollTop;
            r = Math.floor(r - tt(e));
            var i = n && null != n.bottom ? n.bottom : r + e.wrapper.clientHeight,
                o = vi(t, r),
                s = vi(t, i);
            if (n && n.ensure) {
                var a = n.ensure.from.line,
                    l = n.ensure.to.line;
                a < o ? s = vi(t, yi(di(t, o = a)) + e.wrapper.clientHeight) : Math.min(l, t.lastLine()) >= s && (o = vi(t, yi(di(t, l)) - e.wrapper.clientHeight), s = l)
            }
            return {
                from: o,
                to: Math.max(s, o + 1)
            }
        }

        function z(e) {
            var t = e.display,
                n = t.view;
            if (t.alignWidgets || t.gutters.firstChild && e.options.fixedGutter) {
                for (var r = W(t) - t.scroller.scrollLeft + e.doc.scrollLeft, i = t.gutters.offsetWidth, o = r + "px", s = 0; s < n.length; s++)
                    if (!n[s].hidden) {
                        e.options.fixedGutter && n[s].gutter && (n[s].gutter.style.left = o);
                        var a = n[s].alignable;
                        if (a)
                            for (var l = 0; l < a.length; l++) a[l].style.left = o
                    } e.options.fixedGutter && (t.gutters.style.left = r + i + "px")
            }
        }

        function q(e) {
            if (!e.options.lineNumbers) return !1;
            var t = e.doc,
                n = j(e.options, t.first + t.size - 1),
                r = e.display;
            if (n.length == r.lineNumChars) return !1;
            var i = r.measure.appendChild(bo("div", [bo("div", n)], "CodeMirror-linenumber CodeMirror-gutter-elt")),
                o = i.firstChild.offsetWidth,
                s = i.offsetWidth - o;
            return r.lineGutter.style.width = "", r.lineNumInnerWidth = Math.max(o, r.lineGutter.offsetWidth - s) + 1, r.lineNumWidth = r.lineNumInnerWidth + s, r.lineNumChars = r.lineNumInnerWidth ? n.length : -1, r.lineGutter.style.width = r.lineNumWidth + "px", E(e), !0
        }

        function j(e, t) {
            return String(e.lineNumberFormatter(t + e.firstLineNumber))
        }

        function W(e) {
            return e.scroller.getBoundingClientRect().left - e.sizer.getBoundingClientRect().left
        }

        function U(e, t, n) {
            var r = e.display;
            this.viewport = t, this.visible = B(r, e.doc, t), this.editorIsHidden = !r.wrapper.offsetWidth, this.wrapperHeight = r.wrapper.clientHeight, this.wrapperWidth = r.wrapper.clientWidth, this.oldDisplayWidth = ot(e), this.force = n, this.dims = J(e), this.events = []
        }

        function K(e, t) {
            var n = e.display,
                r = e.doc;
            if (t.editorIsHidden) return Gt(e), !1;
            if (!t.force && t.visible.from >= n.viewFrom && t.visible.to <= n.viewTo && (null == n.updateLineNumbers || n.updateLineNumbers >= n.viewTo) && n.renderedView == n.view && 0 == Qt(e)) return !1;
            q(e) && (Gt(e), t.dims = J(e));
            var i = r.first + r.size,
                o = Math.max(t.visible.from - e.options.viewportMargin, r.first),
                s = Math.min(i, t.visible.to + e.options.viewportMargin);
            n.viewFrom < o && o - n.viewFrom < 20 && (o = Math.max(r.first, n.viewFrom)), n.viewTo > s && n.viewTo - s < 20 && (s = Math.min(i, n.viewTo)), y && (o = Nr(e.doc, o), s = Ir(e.doc, s));
            var a = o != n.viewFrom || s != n.viewTo || n.lastWrapHeight != t.wrapperHeight || n.lastWrapWidth != t.wrapperWidth;
            ! function(e, t, n) {
                var r = e.display;
                0 == r.view.length || t >= r.viewTo || n <= r.viewFrom ? (r.view = Ut(e, t, n), r.viewFrom = t) : (r.viewFrom > t ? r.view = Ut(e, t, r.viewFrom).concat(r.view) : r.viewFrom < t && (r.view = r.view.slice(Yt(e, t))), r.viewFrom = t, r.viewTo < n ? r.view = r.view.concat(Ut(e, r.viewTo, n)) : r.viewTo > n && (r.view = r.view.slice(0, Yt(e, n))));
                r.viewTo = n
            }(e, o, s), n.viewOffset = yi(di(e.doc, n.viewFrom)), e.display.mover.style.top = n.viewOffset + "px";
            var l = Qt(e);
            if (!a && 0 == l && !t.force && n.renderedView == n.view && (null == n.updateLineNumbers || n.updateLineNumbers >= n.viewTo)) return !1;
            var c = _o();
            return 4 < l && (n.lineDiv.style.display = "none"),
                function(n, e, t) {
                    var r = n.display,
                        i = n.options.lineNumbers,
                        o = r.lineDiv,
                        s = o.firstChild;

                    function a(e) {
                        var t = e.nextSibling;
                        return p && g && n.display.currentWheelTarget == e ? e.style.display = "none" : e.parentNode.removeChild(e), t
                    }
                    for (var l = r.view, c = r.viewFrom, u = 0; u < l.length; u++) {
                        var h = l[u];
                        if (h.hidden);
                        else if (h.node && h.node.parentNode == o) {
                            for (; s != h.node;) s = a(s);
                            var d = i && null != e && e <= c && h.lineNumber;
                            h.changes && (-1 < oo(h.changes, "gutter") && (d = !1), Z(n, h, c, t)), d && (xo(h.lineNumber), h.lineNumber.appendChild(document.createTextNode(j(n.options, c)))), s = h.node.nextSibling
                        } else {
                            var f = se(n, h, c, t);
                            o.insertBefore(f, s)
                        }
                        c += h.size
                    }
                    for (; s;) s = a(s)
                }(e, n.updateLineNumbers, t.dims), 4 < l && (n.lineDiv.style.display = ""), n.renderedView = n.view, c && _o() != c && c.offsetHeight && c.focus(), xo(n.cursorDiv), xo(n.selectionDiv), n.gutters.style.height = 0, a && (n.lastWrapHeight = t.wrapperHeight, n.lastWrapWidth = t.wrapperWidth, Je(e, 400)), !(n.updateLineNumbers = null)
        }

        function V(e, t) {
            t.force;
            for (var n = t.viewport, r = !0;; r = !1) {
                if (r && e.options.lineWrapping && t.oldDisplayWidth != ot(e)) !0;
                else if (!1, n && null != n.top && (n = {
                        top: Math.min(e.doc.height + nt(e.display) - st(e), n.top)
                    }), t.visible = B(e.display, e.doc, n), t.visible.from >= e.display.viewFrom && t.visible.to <= e.display.viewTo) break;
                if (!K(e, t)) break;
                X(e);
                var i = R(e);
                Ve(e), Y(e, i), H(e, i)
            }
            t.signal(e, "update", e), e.display.viewFrom == e.display.reportedViewFrom && e.display.viewTo == e.display.reportedViewTo || (t.signal(e, "viewportChange", e, e.display.viewFrom, e.display.viewTo), e.display.reportedViewFrom = e.display.viewFrom, e.display.reportedViewTo = e.display.viewTo)
        }

        function G(e, t) {
            var n = new U(e, t);
            if (K(e, n)) {
                X(e), V(e, n);
                var r = R(e);
                Ve(e), Y(e, r), H(e, r), n.finish()
            }
        }

        function Y(e, t) {
            e.display.sizer.style.minHeight = t.docHeight + "px";
            var n = t.docHeight + e.display.barHeight;
            e.display.heightForcer.style.top = n + "px", e.display.gutters.style.height = Math.max(n + it(e), t.clientHeight) + "px"
        }

        function X(e) {
            for (var t = e.display, n = t.lineDiv.offsetTop, r = 0; r < t.view.length; r++) {
                var i, o = t.view[r];
                if (!o.hidden) {
                    if (x && w < 8) {
                        var s = o.node.offsetTop + o.node.offsetHeight;
                        i = s - n, n = s
                    } else {
                        var a = o.node.getBoundingClientRect();
                        i = a.bottom - a.top
                    }
                    var l = o.line.height - i;
                    if (i < 2 && (i = At(t)), (.001 < l || l < -.001) && (mi(o.line, i), Q(o.line), o.rest))
                        for (var c = 0; c < o.rest.length; c++) Q(o.rest[c])
                }
            }
        }

        function Q(e) {
            if (e.widgets)
                for (var t = 0; t < e.widgets.length; ++t) e.widgets[t].height = e.widgets[t].node.offsetHeight
        }

        function J(e) {
            for (var t = e.display, n = {}, r = {}, i = t.gutters.clientLeft, o = t.gutters.firstChild, s = 0; o; o = o.nextSibling, ++s) n[e.options.gutters[s]] = o.offsetLeft + o.clientLeft + i, r[e.options.gutters[s]] = o.clientWidth;
            return {
                fixedPos: W(t),
                gutterTotalWidth: t.gutters.offsetWidth,
                gutterLeft: n,
                gutterWidth: r,
                wrapperWidth: t.wrapper.clientWidth
            }
        }

        function Z(e, t, n, r) {
            for (var i = 0; i < t.changes.length; i++) {
                var o = t.changes[i];
                "text" == o ? ne(e, t) : "gutter" == o ? ie(e, t, n, r) : "class" == o ? re(t) : "widget" == o && oe(e, t, r)
            }
            t.changes = null
        }

        function ee(e) {
            return e.node == e.text && (e.node = bo("div", null, null, "position: relative"), e.text.parentNode && e.text.parentNode.replaceChild(e.node, e.text), e.node.appendChild(e.text), x && w < 8 && (e.node.style.zIndex = 2)), e.node
        }

        function te(e, t) {
            var n = e.display.externalMeasured;
            return n && n.line == t.line ? (e.display.externalMeasured = null, t.measure = n.measure, n.built) : Xr(e, t)
        }

        function ne(e, t) {
            var n = t.text.className,
                r = te(e, t);
            t.text == t.node && (t.node = r.pre), t.text.parentNode.replaceChild(r.pre, t.text), t.text = r.pre, r.bgClass != t.bgClass || r.textClass != t.textClass ? (t.bgClass = r.bgClass, t.textClass = r.textClass, re(t)) : n && (t.text.className = n)
        }

        function re(e) {
            ! function(e) {
                var t = e.bgClass ? e.bgClass + " " + (e.line.bgClass || "") : e.line.bgClass;
                if (t && (t += " CodeMirror-linebackground"), e.background) t ? e.background.className = t : (e.background.parentNode.removeChild(e.background), e.background = null);
                else if (t) {
                    var n = ee(e);
                    e.background = n.insertBefore(bo("div", null, t), n.firstChild)
                }
            }(e), e.line.wrapClass ? ee(e).className = e.line.wrapClass : e.node != e.text && (e.node.className = "");
            var t = e.textClass ? e.textClass + " " + (e.line.textClass || "") : e.line.textClass;
            e.text.className = t || ""
        }

        function ie(e, t, n, r) {
            t.gutter && (t.node.removeChild(t.gutter), t.gutter = null);
            var i = t.line.gutterMarkers;
            if (e.options.lineNumbers || i) {
                var o = ee(t),
                    s = t.gutter = bo("div", null, "CodeMirror-gutter-wrapper", "left: " + (e.options.fixedGutter ? r.fixedPos : -r.gutterTotalWidth) + "px; width: " + r.gutterTotalWidth + "px");
                if (e.display.input.setUneditable(s), o.insertBefore(s, t.text), t.line.gutterClass && (s.className += " " + t.line.gutterClass), !e.options.lineNumbers || i && i["CodeMirror-linenumbers"] || (t.lineNumber = s.appendChild(bo("div", j(e.options, n), "CodeMirror-linenumber CodeMirror-gutter-elt", "left: " + r.gutterLeft["CodeMirror-linenumbers"] + "px; width: " + e.display.lineNumInnerWidth + "px"))), i)
                    for (var a = 0; a < e.options.gutters.length; ++a) {
                        var l = e.options.gutters[a],
                            c = i.hasOwnProperty(l) && i[l];
                        c && s.appendChild(bo("div", [c], "CodeMirror-gutter-elt", "left: " + r.gutterLeft[l] + "px; width: " + r.gutterWidth[l] + "px"))
                    }
            }
        }

        function oe(e, t, n) {
            t.alignable && (t.alignable = null);
            for (var r = t.node.firstChild; r; r = i) {
                var i = r.nextSibling;
                "CodeMirror-linewidget" == r.className && t.node.removeChild(r)
            }
            ae(e, t, n)
        }

        function se(e, t, n, r) {
            var i = te(e, t);
            return t.text = t.node = i.pre, i.bgClass && (t.bgClass = i.bgClass), i.textClass && (t.textClass = i.textClass), re(t), ie(e, t, n, r), ae(e, t, r), t.node
        }

        function ae(e, t, n) {
            if (le(e, t.line, t, n, !0), t.rest)
                for (var r = 0; r < t.rest.length; r++) le(e, t.rest[r], t, n, !1)
        }

        function le(e, t, n, r, i) {
            if (t.widgets)
                for (var o = ee(n), s = 0, a = t.widgets; s < a.length; ++s) {
                    var l = a[s],
                        c = bo("div", [l.node], "CodeMirror-linewidget");
                    l.handleMouseEvents || c.setAttribute("cm-ignore-events", "true"), ce(l, c, n, r), e.display.input.setUneditable(c), i && l.above ? o.insertBefore(c, n.gutter || n.text) : o.appendChild(c), zi(l, "redraw")
                }
        }

        function ce(e, t, n, r) {
            if (e.noHScroll) {
                (n.alignable || (n.alignable = [])).push(t);
                var i = r.wrapperWidth;
                t.style.left = r.fixedPos + "px", e.coverGutter || (i -= r.gutterTotalWidth, t.style.paddingLeft = r.gutterTotalWidth + "px"), t.style.width = i + "px"
            }
            e.coverGutter && (t.style.zIndex = 5, t.style.position = "relative", e.noHScroll || (t.style.marginLeft = -r.gutterTotalWidth + "px"))
        }
        D.prototype = co({
            update: function(e) {
                var t = e.scrollWidth > e.clientWidth + 1,
                    n = e.scrollHeight > e.clientHeight + 1,
                    r = e.nativeBarWidth;
                if (n) {
                    this.vert.style.display = "block", this.vert.style.bottom = t ? r + "px" : "0";
                    var i = e.viewHeight - (t ? r : 0);
                    this.vert.firstChild.style.height = Math.max(0, e.scrollHeight - e.clientHeight + i) + "px"
                } else this.vert.style.display = "", this.vert.firstChild.style.height = "0";
                if (t) {
                    this.horiz.style.display = "block", this.horiz.style.right = n ? r + "px" : "0", this.horiz.style.left = e.barLeft + "px";
                    var o = e.viewWidth - e.barLeft - (n ? r : 0);
                    this.horiz.firstChild.style.width = e.scrollWidth - e.clientWidth + o + "px"
                } else this.horiz.style.display = "", this.horiz.firstChild.style.width = "0";
                return !this.checkedOverlay && 0 < e.clientHeight && (0 == r && this.overlayHack(), this.checkedOverlay = !0), {
                    right: n ? r : 0,
                    bottom: t ? r : 0
                }
            },
            setScrollLeft: function(e) {
                this.horiz.scrollLeft != e && (this.horiz.scrollLeft = e)
            },
            setScrollTop: function(e) {
                this.vert.scrollTop != e && (this.vert.scrollTop = e)
            },
            overlayHack: function() {
                var e = g && !i ? "12px" : "18px";
                this.horiz.style.minHeight = this.vert.style.minWidth = e;
                var t = this,
                    n = function(e) {
                        Di(e) != t.vert && Di(e) != t.horiz && zt(t.cm, tn)(e)
                    };
                $i(this.vert, "mousedown", n), $i(this.horiz, "mousedown", n)
            },
            clear: function() {
                var e = this.horiz.parentNode;
                e.removeChild(this.horiz), e.removeChild(this.vert)
            }
        }, D.prototype), P.prototype = co({
            update: function() {
                return {
                    bottom: 0,
                    right: 0
                }
            },
            setScrollLeft: function() {},
            setScrollTop: function() {},
            clear: function() {}
        }, P.prototype), b.scrollbarModel = {
            native: D,
            null: P
        }, U.prototype.signal = function(e, t) {
            Ui(e, t) && this.events.push(arguments)
        }, U.prototype.finish = function() {
            for (var e = 0; e < this.events.length; e++) Fi.apply(null, this.events[e])
        };
        var ue = b.Pos = function(e, t) {
                if (!(this instanceof ue)) return new ue(e, t);
                this.line = e, this.ch = t
            },
            he = b.cmpPos = function(e, t) {
                return e.line - t.line || e.ch - t.ch
            };

        function de(e) {
            return ue(e.line, e.ch)
        }

        function fe(e, t) {
            return he(e, t) < 0 ? t : e
        }

        function pe(e, t) {
            return he(e, t) < 0 ? e : t
        }

        function me(e) {
            e.state.focused || (e.display.input.focus(), wn(e))
        }

        function ge(e) {
            return e.options.readOnly || e.doc.cantEdit
        }
        var ve = null;

        function ye(e, t, n, r) {
            var i = e.doc;
            e.display.shift = !1, r || (r = i.sel);
            var o = Po(t),
                s = null;
            e.state.pasteIncoming && 1 < r.ranges.length && (ve && ve.join("\n") == t ? s = r.ranges.length % ve.length == 0 && so(ve, Po) : o.length == r.ranges.length && (s = so(o, function(e) {
                return [e]
            })));
            for (var a = r.ranges.length - 1; 0 <= a; a--) {
                var l = r.ranges[a],
                    c = l.from(),
                    u = l.to();
                l.empty() && (n && 0 < n ? c = ue(c.line, c.ch - n) : e.state.overwrite && !e.state.pasteIncoming && (u = ue(u.line, Math.min(di(i, u.line).text.length, u.ch + ro(o).length))));
                var h = e.curOp.updateInput,
                    d = {
                        from: c,
                        to: u,
                        text: s ? s[a % s.length] : o,
                        origin: e.state.pasteIncoming ? "paste" : e.state.cutIncoming ? "cut" : "+input"
                    };
                if (Ln(e.doc, d), zi(e, "inputRead", e, d), t && !e.state.pasteIncoming && e.options.electricChars && e.options.smartIndent && l.head.ch < 100 && (!a || r.ranges[a - 1].head.line != l.head.line)) {
                    var f = e.getModeAt(l.head),
                        p = Cn(d);
                    if (f.electricChars) {
                        for (var m = 0; m < f.electricChars.length; m++)
                            if (-1 < t.indexOf(f.electricChars.charAt(m))) {
                                Fn(e, p.line, "smart");
                                break
                            }
                    } else f.electricInput && f.electricInput.test(di(i, p.line).text.slice(0, p.ch)) && Fn(e, p.line, "smart")
                }
            }
            $n(e), e.curOp.updateInput = h, e.curOp.typing = !0, e.state.pasteIncoming = e.state.cutIncoming = !1
        }

        function be(e) {
            for (var t = [], n = [], r = 0; r < e.doc.sel.ranges.length; r++) {
                var i = e.doc.sel.ranges[r].head.line,
                    o = {
                        anchor: ue(i, 0),
                        head: ue(i + 1, 0)
                    };
                n.push(o), t.push(e.getRange(o.anchor, o.head))
            }
            return {
                text: t,
                ranges: n
            }
        }

        function xe(e) {
            e.setAttribute("autocorrect", "off"), e.setAttribute("autocapitalize", "off"), e.setAttribute("spellcheck", "false")
        }

        function we(e) {
            this.cm = e, this.prevInput = "", this.pollingFast = !1, this.polling = new Ji, this.inaccurateSelection = !1, this.hasSelection = !1
        }

        function ke() {
            var e = bo("textarea", null, null, "position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),
                t = bo("div", [e], null, "overflow: hidden; position: relative; width: 3px; height: 0px;");
            return p ? e.style.width = "1000px" : e.setAttribute("wrap", "off"), s && (e.style.border = "1px solid black"), xe(e), t
        }

        function _e(e) {
            this.cm = e, this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null, this.polling = new Ji, this.gracePeriod = !1
        }

        function Ce(e, t) {
            var n = ct(e, t.line);
            if (!n || n.hidden) return null;
            var r = di(e.doc, t.line),
                i = at(n, r, t.line),
                o = bi(r);
            o && Go(o, t.ch);
            var s = pt(i.map, t.ch, "left");
            return s.offset = "right" == s.collapse ? s.end : s.start, s
        }

        function Se(e, t) {
            return t && (e.bad = !0), e
        }

        function Te(e, t, n) {
            var r;
            if (t == e.display.lineDiv) {
                if (!(r = e.display.lineDiv.childNodes[n])) return Se(e.clipPos(ue(e.display.viewTo - 1)), !0);
                t = null, n = 0
            } else
                for (r = t;; r = r.parentNode) {
                    if (!r || r == e.display.lineDiv) return null;
                    if (r.parentNode && r.parentNode == e.display.lineDiv) break
                }
            for (var i = 0; i < e.display.view.length; i++) {
                var o = e.display.view[i];
                if (o.node == r) return Me(o, t, n)
            }
        }

        function Me(c, e, t) {
            var n = c.text.firstChild,
                r = !1;
            if (!e || !ko(n, e)) return Se(ue(gi(c.line), 0), !0);
            if (e == n && (r = !0, e = n.childNodes[t], t = 0, !e)) {
                var i = c.rest ? ro(c.rest) : c.line;
                return Se(ue(gi(i), i.text.length), r)
            }
            var o = 3 == e.nodeType ? e : null,
                s = e;
            for (o || 1 != e.childNodes.length || 3 != e.firstChild.nodeType || (o = e.firstChild, t && (t = o.nodeValue.length)); s.parentNode != n;) s = s.parentNode;
            var u = c.measure,
                h = u.maps;

            function a(e, t, n) {
                for (var r = -1; r < (h ? h.length : 0); r++)
                    for (var i = r < 0 ? u.map : h[r], o = 0; o < i.length; o += 3) {
                        var s = i[o + 2];
                        if (s == e || s == t) {
                            var a = gi(r < 0 ? c.line : c.rest[r]),
                                l = i[o] + n;
                            return (n < 0 || s != e) && (l = i[o + (n ? 1 : 0)]), ue(a, l)
                        }
                    }
            }
            var l = a(o, s, t);
            if (l) return Se(l, r);
            for (var d = s.nextSibling, f = o ? o.nodeValue.length - t : 0; d; d = d.nextSibling) {
                if (l = a(d, d.firstChild, 0)) return Se(ue(l.line, l.ch - f), r);
                f += d.textContent.length
            }
            var p = s.previousSibling;
            for (f = t; p; p = p.previousSibling) {
                if (l = a(p, p.firstChild, -1)) return Se(ue(l.line, l.ch + f), r);
                f += d.textContent.length
            }
        }

        function Ae(e, t) {
            this.ranges = e, this.primIndex = t
        }

        function Le(e, t) {
            this.anchor = e, this.head = t
        }

        function Ee(e, t) {
            var n = e[t];
            e.sort(function(e, t) {
                return he(e.from(), t.from())
            }), t = oo(e, n);
            for (var r = 1; r < e.length; r++) {
                var i = e[r],
                    o = e[r - 1];
                if (0 <= he(o.to(), i.from())) {
                    var s = pe(o.from(), i.from()),
                        a = fe(o.to(), i.to()),
                        l = o.empty() ? i.from() == i.head : o.from() == o.head;
                    r <= t && --t, e.splice(--r, 2, new Le(l ? a : s, l ? s : a))
                }
            }
            return new Ae(e, t)
        }

        function Ne(e, t) {
            return new Ae([new Le(e, t || e)], 0)
        }

        function Ie(e, t) {
            return Math.max(e.first, Math.min(t, e.first + e.size - 1))
        }

        function Oe(e, t) {
            if (t.line < e.first) return ue(e.first, 0);
            var n, r, i, o = e.first + e.size - 1;
            return t.line > o ? ue(o, di(e, o).text.length) : (r = di(e, (n = t).line).text.length, null == (i = n.ch) || r < i ? ue(n.line, r) : i < 0 ? ue(n.line, 0) : n)
        }

        function Re(e, t) {
            return t >= e.first && t < e.first + e.size
        }

        function De(e, t, n, r) {
            if (e.cm && e.cm.display.shift || e.extend) {
                var i = t.anchor;
                if (r) {
                    var o = he(n, i) < 0;
                    o != he(r, i) < 0 ? (i = n, n = r) : o != he(n, r) < 0 && (n = r)
                }
                return new Le(i, n)
            }
            return new Le(r || n, n)
        }

        function Pe(e, t, n, r) {
            ze(e, new Ae([De(e, e.sel.primary(), t, n)], 0), r)
        }

        function $e(e, t, n) {
            for (var r = [], i = 0; i < e.sel.ranges.length; i++) r[i] = De(e, e.sel.ranges[i], t[i], null);
            ze(e, Ee(r, e.sel.primIndex), n)
        }

        function He(e, t, n, r) {
            var i = e.sel.ranges.slice(0);
            i[t] = n, ze(e, Ee(i, e.sel.primIndex), r)
        }

        function Fe(e, t, n, r) {
            ze(e, Ne(t, n), r)
        }

        function Be(e, t, n) {
            var r = e.history.done,
                i = ro(r);
            i && i.ranges ? qe(e, r[r.length - 1] = t, n) : ze(e, t, n)
        }

        function ze(e, t, n) {
            qe(e, t, n),
                function(e, t, n, r) {
                    var i = e.history,
                        o = r && r.origin;
                    n == i.lastSelOp || o && i.lastSelOrigin == o && (i.lastModTime == i.lastSelTime && i.lastOrigin == o || (s = e, a = o, l = ro(i.done), c = t, u = a.charAt(0), "*" == u || "+" == u && l.ranges.length == c.ranges.length && l.somethingSelected() == c.somethingSelected() && new Date - s.history.lastSelTime <= (s.cm ? s.cm.options.historyEventDelay : 500))) ? i.done[i.done.length - 1] = t : Ci(t, i.done);
                    var s, a, l, c, u;
                    i.lastSelTime = +new Date, i.lastSelOrigin = o, i.lastSelOp = n, r && !1 !== r.clearRedo && ki(i.undone)
                }(e, e.sel, e.cm ? e.cm.curOp.id : NaN, n)
        }

        function qe(e, t, n) {
            var r, i, o;
            (Ui(e, "beforeSelectionChange") || e.cm && Ui(e.cm, "beforeSelectionChange")) && (r = e, o = {
                ranges: (i = t).ranges,
                update: function(e) {
                    this.ranges = [];
                    for (var t = 0; t < e.length; t++) this.ranges[t] = new Le(Oe(r, e[t].anchor), Oe(r, e[t].head))
                }
            }, Fi(r, "beforeSelectionChange", r, o), r.cm && Fi(r.cm, "beforeSelectionChange", r.cm, o), t = o.ranges != i.ranges ? Ee(o.ranges, o.ranges.length - 1) : i), je(e, Ue(e, t, n && n.bias || (he(t.primary().head, e.sel.primary().head) < 0 ? -1 : 1), !0)), n && !1 === n.scroll || !e.cm || $n(e.cm)
        }

        function je(e, t) {
            t.equals(e.sel) || (e.sel = t, e.cm && (e.cm.curOp.updateInput = e.cm.curOp.selectionChanged = !0, Wi(e.cm)), zi(e, "cursorActivity", e))
        }

        function We(e) {
            je(e, Ue(e, e.sel, null, !1))
        }

        function Ue(e, t, n, r) {
            for (var i, o = 0; o < t.ranges.length; o++) {
                var s = t.ranges[o],
                    a = Ke(e, s.anchor, n, r),
                    l = Ke(e, s.head, n, r);
                (i || a != s.anchor || l != s.head) && (i || (i = t.ranges.slice(0, o)), i[o] = new Le(a, l))
            }
            return i ? Ee(i, t.primIndex) : t
        }

        function Ke(e, t, n, r) {
            var i = !1,
                o = t,
                s = n || 1;
            e.cantEdit = !1;
            e: for (;;) {
                var a = di(e, o.line);
                if (a.markedSpans)
                    for (var l = 0; l < a.markedSpans.length; ++l) {
                        var c = a.markedSpans[l],
                            u = c.marker;
                        if ((null == c.from || (u.inclusiveLeft ? c.from <= o.ch : c.from < o.ch)) && (null == c.to || (u.inclusiveRight ? c.to >= o.ch : c.to > o.ch))) {
                            if (r && (Fi(u, "beforeCursorEnter"), u.explicitlyCleared)) {
                                if (a.markedSpans) {
                                    --l;
                                    continue
                                }
                                break
                            }
                            if (!u.atomic) continue;
                            var h = u.find(s < 0 ? -1 : 1);
                            if (0 == he(h, o) && (h.ch += s, h.ch < 0 ? h = h.line > e.first ? Oe(e, ue(h.line - 1)) : null : h.ch > a.text.length && (h = h.line < e.first + e.size - 1 ? ue(h.line + 1, 0) : null), !h)) {
                                if (i) return r ? (e.cantEdit = !0, ue(e.first, 0)) : Ke(e, t, n, !0);
                                i = !0, h = t, s = -s
                            }
                            o = h;
                            continue e
                        }
                    }
                return o
            }
        }

        function Ve(e) {
            e.display.input.showSelection(e.display.input.prepareSelection())
        }

        function Ge(e, t) {
            for (var n = e.doc, r = {}, i = r.cursors = document.createDocumentFragment(), o = r.selection = document.createDocumentFragment(), s = 0; s < n.sel.ranges.length; s++)
                if (!1 !== t || s != n.sel.primIndex) {
                    var a = n.sel.ranges[s],
                        l = a.empty();
                    (l || e.options.showCursorWhenSelecting) && Ye(e, a, i), l || Xe(e, a, o)
                } return r
        }

        function Ye(e, t, n) {
            var r = _t(e, t.head, "div", null, null, !e.options.singleCursorHeightPerLine),
                i = n.appendChild(bo("div", "Â ", "CodeMirror-cursor"));
            if (i.style.left = r.left + "px", i.style.top = r.top + "px", i.style.height = Math.max(0, r.bottom - r.top) * e.options.cursorHeight + "px", r.other) {
                var o = n.appendChild(bo("div", "Â ", "CodeMirror-cursor CodeMirror-secondarycursor"));
                o.style.display = "", o.style.left = r.other.left + "px", o.style.top = r.other.top + "px", o.style.height = .85 * (r.other.bottom - r.other.top) + "px"
            }
        }

        function Xe(i, e, t) {
            var n = i.display,
                o = i.doc,
                s = document.createDocumentFragment(),
                r = rt(i.display),
                p = r.left,
                m = Math.max(n.sizerWidth, ot(i) - n.sizer.offsetLeft) - r.right;

            function g(e, t, n, r) {
                t < 0 && (t = 0), t = Math.round(t), r = Math.round(r), s.appendChild(bo("div", null, "CodeMirror-selected", "position: absolute; left: " + e + "px; top: " + t + "px; width: " + (null == n ? m - e : n) + "px; height: " + (r - t) + "px"))
            }

            function a(n, l, c) {
                var u, h, r = di(o, n),
                    d = r.text.length;

                function f(e, t) {
                    return kt(i, ue(n, e), "div", r, t)
                }
                return function(e, t, n, r) {
                    if (!e) return r(t, n, "ltr");
                    for (var i = !1, o = 0; o < e.length; ++o) {
                        var s = e[o];
                        (s.from < n && s.to > t || t == n && s.to == t) && (r(Math.max(s.from, t), Math.min(s.to, n), 1 == s.level ? "rtl" : "ltr"), i = !0)
                    }
                    i || r(t, n, "ltr")
                }(bi(r), l || 0, null == c ? d : c, function(e, t, n) {
                    var r, i, o, s = f(e, "left");
                    if (e == t) i = o = (r = s).left;
                    else {
                        if (r = f(t - 1, "right"), "rtl" == n) {
                            var a = s;
                            s = r, r = a
                        }
                        i = s.left, o = r.right
                    }
                    null == l && 0 == e && (i = p), 3 < r.top - s.top && (g(i, s.top, null, s.bottom), i = p, s.bottom < r.top && g(i, s.bottom, null, r.top)), null == c && t == d && (o = m), (!u || s.top < u.top || s.top == u.top && s.left < u.left) && (u = s), (!h || r.bottom > h.bottom || r.bottom == h.bottom && r.right > h.right) && (h = r), i < p + 1 && (i = p), g(i, r.top, o - i, r.bottom)
                }), {
                    start: u,
                    end: h
                }
            }
            var l = e.from(),
                c = e.to();
            if (l.line == c.line) a(l.line, l.ch, c.ch);
            else {
                var u = di(o, l.line),
                    h = di(o, c.line),
                    d = Er(u) == Er(h),
                    f = a(l.line, l.ch, d ? u.text.length + 1 : null).end,
                    v = a(c.line, d ? 0 : null, c.ch).start;
                d && (f.top < v.top - 2 ? (g(f.right, f.top, null, f.bottom), g(p, v.top, v.left, v.bottom)) : g(f.right, f.top, v.left - f.right, f.bottom)), f.bottom < v.top && g(p, f.bottom, null, v.top)
            }
            t.appendChild(s)
        }

        function Qe(e) {
            if (e.state.focused) {
                var t = e.display;
                clearInterval(t.blinker);
                var n = !0;
                t.cursorDiv.style.visibility = "", 0 < e.options.cursorBlinkRate ? t.blinker = setInterval(function() {
                    t.cursorDiv.style.visibility = (n = !n) ? "" : "hidden"
                }, e.options.cursorBlinkRate) : e.options.cursorBlinkRate < 0 && (t.cursorDiv.style.visibility = "hidden")
            }
        }

        function Je(e, t) {
            e.doc.mode.startState && e.doc.frontier < e.display.viewTo && e.state.highlight.set(t, uo(Ze, e))
        }

        function Ze(a) {
            var l = a.doc;
            if (l.frontier < l.first && (l.frontier = l.first), !(l.frontier >= a.display.viewTo)) {
                var c = +new Date + a.options.workTime,
                    u = Zn(l.mode, et(a, l.frontier)),
                    h = [];
                l.iter(l.frontier, Math.min(l.first + l.size, a.display.viewTo + 500), function(e) {
                    if (l.frontier >= a.display.viewFrom) {
                        var t = e.styles,
                            n = Wr(a, e, u, !0);
                        e.styles = n.styles;
                        var r = e.styleClasses,
                            i = n.classes;
                        i ? e.styleClasses = i : r && (e.styleClasses = null);
                        for (var o = !t || t.length != e.styles.length || r != i && (!r || !i || r.bgClass != i.bgClass || r.textClass != i.textClass), s = 0; !o && s < t.length; ++s) o = t[s] != e.styles[s];
                        o && h.push(l.frontier), e.stateAfter = Zn(l.mode, u)
                    } else Kr(a, e.text, u), e.stateAfter = l.frontier % 5 == 0 ? Zn(l.mode, u) : null;
                    if (++l.frontier, +new Date > c) return Je(a, a.options.workDelay), !0
                }), h.length && Bt(a, function() {
                    for (var e = 0; e < h.length; e++) Vt(a, h[e], "text")
                })
            }
        }

        function et(n, r, e) {
            var i = n.doc,
                o = n.display;
            if (!i.mode.startState) return !0;
            var s = function(e, t, n) {
                    for (var r, i, o = e.doc, s = n ? -1 : t - (e.doc.mode.innerMode ? 1e3 : 100), a = t; s < a; --a) {
                        if (a <= o.first) return o.first;
                        var l = di(o, a - 1);
                        if (l.stateAfter && (!n || a <= o.frontier)) return a;
                        var c = Zi(l.text, null, e.options.tabSize);
                        (null == i || c < r) && (i = a - 1, r = c)
                    }
                    return i
                }(n, r, e),
                a = s > i.first && di(i, s - 1).stateAfter;
            return a = a ? Zn(i.mode, a) : er(i.mode), i.iter(s, r, function(e) {
                Kr(n, e.text, a);
                var t = s == r - 1 || s % 5 == 0 || s >= o.viewFrom && s < o.viewTo;
                e.stateAfter = t ? Zn(i.mode, a) : null, ++s
            }), e && (i.frontier = s), a
        }

        function tt(e) {
            return e.lineSpace.offsetTop
        }

        function nt(e) {
            return e.mover.offsetHeight - e.lineSpace.offsetHeight
        }

        function rt(e) {
            if (e.cachedPaddingH) return e.cachedPaddingH;
            var t = wo(e.measure, bo("pre", "x")),
                n = window.getComputedStyle ? window.getComputedStyle(t) : t.currentStyle,
                r = {
                    left: parseInt(n.paddingLeft),
                    right: parseInt(n.paddingRight)
                };
            return isNaN(r.left) || isNaN(r.right) || (e.cachedPaddingH = r), r
        }

        function it(e) {
            return Vi - e.display.nativeBarWidth
        }

        function ot(e) {
            return e.display.scroller.clientWidth - it(e) - e.display.barWidth
        }

        function st(e) {
            return e.display.scroller.clientHeight - it(e) - e.display.barHeight
        }

        function at(e, t, n) {
            if (e.line == t) return {
                map: e.measure.map,
                cache: e.measure.cache
            };
            for (var r = 0; r < e.rest.length; r++)
                if (e.rest[r] == t) return {
                    map: e.measure.maps[r],
                    cache: e.measure.caches[r]
                };
            for (r = 0; r < e.rest.length; r++)
                if (gi(e.rest[r]) > n) return {
                    map: e.measure.maps[r],
                    cache: e.measure.caches[r],
                    before: !0
                }
        }

        function lt(e, t, n, r) {
            return ht(e, ut(e, t), n, r)
        }

        function ct(e, t) {
            if (t >= e.display.viewFrom && t < e.display.viewTo) return e.display.view[Yt(e, t)];
            var n = e.display.externalMeasured;
            return n && t >= n.lineN && t < n.lineN + n.size ? n : void 0
        }

        function ut(e, t) {
            var n = gi(t),
                r = ct(e, n);
            r && !r.text ? r = null : r && r.changes && Z(e, r, n, J(e)), r || (r = function(e, t) {
                var n = gi(t = Er(t)),
                    r = e.display.externalMeasured = new Wt(e.doc, t, n);
                r.lineN = n;
                var i = r.built = Xr(e, r);
                return r.text = i.pre, wo(e.display.lineMeasure, i.pre), r
            }(e, t));
            var i = at(r, t, n);
            return {
                line: t,
                view: r,
                rect: null,
                map: i.map,
                cache: i.cache,
                before: i.before,
                hasHeights: !1
            }
        }

        function ht(e, t, n, r, i) {
            t.before && (n = -1);
            var o, s = n + (r || "");
            return t.cache.hasOwnProperty(s) ? o = t.cache[s] : (t.rect || (t.rect = t.view.text.getBoundingClientRect()), t.hasHeights || (! function(e, t, n) {
                var r = e.options.lineWrapping,
                    i = r && ot(e);
                if (!t.measure.heights || r && t.measure.width != i) {
                    var o = t.measure.heights = [];
                    if (r) {
                        t.measure.width = i;
                        for (var s = t.text.firstChild.getClientRects(), a = 0; a < s.length - 1; a++) {
                            var l = s[a],
                                c = s[a + 1];
                            2 < Math.abs(l.bottom - c.bottom) && o.push((l.bottom + c.top) / 2 - n.top)
                        }
                    }
                    o.push(n.bottom - n.top)
                }
            }(e, t.view, t.rect), t.hasHeights = !0), (o = function(e, t, n, r) {
                var i, o = pt(t.map, n, r),
                    s = o.node,
                    a = o.start,
                    l = o.end,
                    c = o.collapse;
                if (3 == s.nodeType) {
                    for (var u = 0; u < 4; u++) {
                        for (; a && yo(t.line.text.charAt(o.coverStart + a));) --a;
                        for (; o.coverStart + l < o.coverEnd && yo(t.line.text.charAt(o.coverStart + l));) ++l;
                        if (x && w < 9 && 0 == a && l == o.coverEnd - o.coverStart) i = s.parentNode.getBoundingClientRect();
                        else if (x && e.options.lineWrapping) {
                            var h = go(s, a, l).getClientRects();
                            i = h.length ? h["right" == r ? h.length - 1 : 0] : ft
                        } else i = go(s, a, l).getBoundingClientRect() || ft;
                        if (i.left || i.right || 0 == a) break;
                        l = a, a -= 1, c = "right"
                    }
                    x && w < 11 && (i = function(e, t) {
                        if (!window.screen || null == screen.logicalXDPI || screen.logicalXDPI == screen.deviceXDPI || ! function(e) {
                                if (null != Fo) return Fo;
                                var t = wo(e, bo("span", "x")),
                                    n = t.getBoundingClientRect(),
                                    r = go(t, 0, 1).getBoundingClientRect();
                                return Fo = 1 < Math.abs(n.left - r.left)
                            }(e)) return t;
                        var n = screen.logicalXDPI / screen.deviceXDPI,
                            r = screen.logicalYDPI / screen.deviceYDPI;
                        return {
                            left: t.left * n,
                            right: t.right * n,
                            top: t.top * r,
                            bottom: t.bottom * r
                        }
                    }(e.display.measure, i))
                } else {
                    0 < a && (c = r = "right"), i = e.options.lineWrapping && 1 < (h = s.getClientRects()).length ? h["right" == r ? h.length - 1 : 0] : s.getBoundingClientRect()
                }
                if (x && w < 9 && !a && (!i || !i.left && !i.right)) {
                    var d = s.parentNode.getClientRects()[0];
                    i = d ? {
                        left: d.left,
                        right: d.left + Lt(e.display),
                        top: d.top,
                        bottom: d.bottom
                    } : ft
                }
                for (var f = i.top - t.rect.top, p = i.bottom - t.rect.top, m = (f + p) / 2, g = t.view.measure.heights, u = 0; u < g.length - 1 && !(m < g[u]); u++);
                var v = u ? g[u - 1] : 0,
                    y = g[u],
                    b = {
                        left: ("right" == c ? i.right : i.left) - t.rect.left,
                        right: ("left" == c ? i.left : i.right) - t.rect.left,
                        top: v,
                        bottom: y
                    };
                i.left || i.right || (b.bogus = !0);
                e.options.singleCursorHeightPerLine || (b.rtop = f, b.rbottom = p);
                return b
            }(e, t, n, r)).bogus || (t.cache[s] = o)), {
                left: o.left,
                right: o.right,
                top: i ? o.rtop : o.top,
                bottom: i ? o.rbottom : o.bottom
            }
        }
        we.prototype = co({
            init: function(t) {
                var n = this,
                    r = this.cm,
                    e = this.wrapper = ke(),
                    i = this.textarea = e.firstChild;

                function o(e) {
                    if (r.somethingSelected()) ve = r.getSelections(), n.inaccurateSelection && (n.prevInput = "", n.inaccurateSelection = !1, i.value = ve.join("\n"), io(i));
                    else {
                        var t = be(r);
                        ve = t.text, "cut" == e.type ? r.setSelections(t.ranges, null, Yi) : (n.prevInput = "", i.value = t.text.join("\n"), io(i))
                    }
                    "cut" == e.type && (r.state.cutIncoming = !0)
                }
                t.wrapper.insertBefore(e, t.wrapper.firstChild), s && (i.style.width = "0px"), $i(i, "input", function() {
                    x && 9 <= w && n.hasSelection && (n.hasSelection = null), n.poll()
                }), $i(i, "paste", function() {
                    if (p && !r.state.fakedLastChar && !(new Date - r.state.lastMiddleDown < 200)) {
                        var e = i.selectionStart,
                            t = i.selectionEnd;
                        i.value += "$", i.selectionEnd = t, i.selectionStart = e, r.state.fakedLastChar = !0
                    }
                    r.state.pasteIncoming = !0, n.fastPoll()
                }), $i(i, "cut", o), $i(i, "copy", o), $i(t.scroller, "paste", function(e) {
                    Zt(t, e) || (r.state.pasteIncoming = !0, n.focus())
                }), $i(t.lineSpace, "selectstart", function(e) {
                    Zt(t, e) || Ni(e)
                })
            },
            prepareSelection: function() {
                var e = this.cm,
                    t = e.display,
                    n = e.doc,
                    r = Ge(e);
                if (e.options.moveInputWithCursor) {
                    var i = _t(e, n.sel.primary().head, "div"),
                        o = t.wrapper.getBoundingClientRect(),
                        s = t.lineDiv.getBoundingClientRect();
                    r.teTop = Math.max(0, Math.min(t.wrapper.clientHeight - 10, i.top + s.top - o.top)), r.teLeft = Math.max(0, Math.min(t.wrapper.clientWidth - 10, i.left + s.left - o.left))
                }
                return r
            },
            showSelection: function(e) {
                var t = this.cm.display;
                wo(t.cursorDiv, e.cursors), wo(t.selectionDiv, e.selection), null != e.teTop && (this.wrapper.style.top = e.teTop + "px", this.wrapper.style.left = e.teLeft + "px")
            },
            reset: function(e) {
                if (!this.contextMenuPending) {
                    var t, n, r = this.cm,
                        i = r.doc;
                    if (r.somethingSelected()) {
                        this.prevInput = "";
                        var o = i.sel.primary(),
                            s = (t = Ho && (100 < o.to().line - o.from().line || 1e3 < (n = r.getSelection()).length)) ? "-" : n || r.getSelection();
                        this.textarea.value = s, r.state.focused && io(this.textarea), x && 9 <= w && (this.hasSelection = s)
                    } else e || (this.prevInput = this.textarea.value = "", x && 9 <= w && (this.hasSelection = null));
                    this.inaccurateSelection = t
                }
            },
            getField: function() {
                return this.textarea
            },
            supportsTouch: function() {
                return !1
            },
            focus: function() {
                if ("nocursor" != this.cm.options.readOnly && (!u || _o() != this.textarea)) try {
                    this.textarea.focus()
                } catch (e) {}
            },
            blur: function() {
                this.textarea.blur()
            },
            resetPosition: function() {
                this.wrapper.style.top = this.wrapper.style.left = 0
            },
            receivedFocus: function() {
                this.slowPoll()
            },
            slowPoll: function() {
                var e = this;
                e.pollingFast || e.polling.set(this.cm.options.pollInterval, function() {
                    e.poll(), e.cm.state.focused && e.slowPoll()
                })
            },
            fastPoll: function() {
                var t = !1,
                    n = this;
                n.pollingFast = !0, n.polling.set(20, function e() {
                    n.poll() || t ? (n.pollingFast = !1, n.slowPoll()) : (t = !0, n.polling.set(60, e))
                })
            },
            poll: function() {
                var e = this.cm,
                    t = this.textarea,
                    n = this.prevInput;
                if (!e.state.focused || $o(t) && !n || ge(e) || e.options.disableInput || e.state.keySeq) return !1;
                e.state.pasteIncoming && e.state.fakedLastChar && (t.value = t.value.substring(0, t.value.length - 1), e.state.fakedLastChar = !1);
                var r = t.value;
                if (r == n && !e.somethingSelected()) return !1;
                if (x && 9 <= w && this.hasSelection === r || g && /[\uf700-\uf7ff]/.test(r)) return e.display.input.reset(), !1;
                e.doc.sel == e.display.selForContextMenu && (8203 == r.charCodeAt(0) ? n || (n = "â€‹") : "â€‹" == n && (r = r.slice(1), n = ""));
                for (var i = 0, o = Math.min(n.length, r.length); i < o && n.charCodeAt(i) == r.charCodeAt(i);) ++i;
                var s = this;
                return Bt(e, function() {
                    ye(e, r.slice(i), n.length - i), 1e3 < r.length || -1 < r.indexOf("\n") ? t.value = s.prevInput = "" : s.prevInput = r
                }), !0
            },
            ensurePolled: function() {
                this.pollingFast && this.poll() && (this.pollingFast = !1)
            },
            onKeyPress: function() {
                x && 9 <= w && (this.hasSelection = null), this.fastPoll()
            },
            onContextMenu: function(e) {
                var n = this,
                    r = n.cm,
                    i = r.display,
                    o = n.textarea,
                    t = en(r, e),
                    s = i.scroller.scrollTop;
                if (t && !m) {
                    r.options.resetSelectionOnContextMenu && -1 == r.doc.sel.contains(t) && zt(r, ze)(r.doc, Ne(t), Yi);
                    var a = o.style.cssText;
                    if (n.wrapper.style.position = "absolute", o.style.cssText = "position: fixed; width: 30px; height: 30px; top: " + (e.clientY - 5) + "px; left: " + (e.clientX - 5) + "px; z-index: 1000; background: " + (x ? "rgba(255, 255, 255, .05)" : "transparent") + "; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);", p) var l = window.scrollY;
                    if (i.input.focus(), p && window.scrollTo(null, l), i.input.reset(), r.somethingSelected() || (o.value = n.prevInput = " "), n.contextMenuPending = !0, i.selForContextMenu = r.doc.sel, clearTimeout(i.detectingSelectAll), x && 9 <= w && u(), d) {
                        Ri(e);
                        var c = function() {
                            Hi(window, "mouseup", c), setTimeout(h, 20)
                        };
                        $i(window, "mouseup", c)
                    } else setTimeout(h, 50)
                }

                function u() {
                    if (null != o.selectionStart) {
                        var e = r.somethingSelected(),
                            t = o.value = "â€‹" + (e ? o.value : "");
                        n.prevInput = e ? "" : "â€‹", o.selectionStart = 1, o.selectionEnd = t.length, i.selForContextMenu = r.doc.sel
                    }
                }

                function h() {
                    if (n.contextMenuPending = !1, n.wrapper.style.position = "relative", o.style.cssText = a, x && w < 9 && i.scrollbars.setScrollTop(i.scroller.scrollTop = s), null != o.selectionStart) {
                        (!x || x && w < 9) && u();
                        var e = 0,
                            t = function() {
                                i.selForContextMenu == r.doc.sel && 0 == o.selectionStart && "â€‹" == n.prevInput ? zt(r, tr.selectAll)(r) : e++ < 10 ? i.detectingSelectAll = setTimeout(t, 500) : i.input.reset()
                            };
                        i.detectingSelectAll = setTimeout(t, 200)
                    }
                }
            },
            setUneditable: ao,
            needsContentAttribute: !1
        }, we.prototype), _e.prototype = co({
            init: function(e) {
                var i = this,
                    o = i.cm,
                    t = i.div = e.lineDiv;

                function n(e) {
                    if (o.somethingSelected()) ve = o.getSelections(), "cut" == e.type && o.replaceSelection("", null, "cut");
                    else {
                        var t = be(o);
                        ve = t.text, "cut" == e.type && o.operation(function() {
                            o.setSelections(t.ranges, 0, Yi), o.replaceSelection("", null, "cut")
                        })
                    }
                    if (e.clipboardData && !s) e.preventDefault(), e.clipboardData.clearData(), e.clipboardData.setData("text/plain", ve.join("\n"));
                    else {
                        var n = ke(),
                            r = n.firstChild;
                        o.display.lineSpace.insertBefore(n, o.display.lineSpace.firstChild), r.value = ve.join("\n");
                        var i = document.activeElement;
                        io(r), setTimeout(function() {
                            o.display.lineSpace.removeChild(n), i.focus()
                        }, 50)
                    }
                }
                t.contentEditable = "true", xe(t), $i(t, "paste", function(e) {
                    var t = e.clipboardData && e.clipboardData.getData("text/plain");
                    t && (e.preventDefault(), o.replaceSelection(t, null, "paste"))
                }), $i(t, "compositionstart", function(e) {
                    var t = e.data;
                    if (i.composing = {
                            sel: o.doc.sel,
                            data: t,
                            startData: t
                        }, t) {
                        var n = o.doc.sel.primary(),
                            r = o.getLine(n.head.line).indexOf(t, Math.max(0, n.head.ch - t.length)); - 1 < r && r <= n.head.ch && (i.composing.sel = Ne(ue(n.head.line, r), ue(n.head.line, r + t.length)))
                    }
                }), $i(t, "compositionupdate", function(e) {
                    i.composing.data = e.data
                }), $i(t, "compositionend", function(e) {
                    var t = i.composing;
                    t && (e.data == t.startData || /\u200b/.test(e.data) || (t.data = e.data), setTimeout(function() {
                        t.handled || i.applyComposition(t), i.composing == t && (i.composing = null)
                    }, 50))
                }), $i(t, "touchstart", function() {
                    i.forceCompositionEnd()
                }), $i(t, "input", function() {
                    i.composing || i.pollContent() || Bt(i.cm, function() {
                        Kt(o)
                    })
                }), $i(t, "copy", n), $i(t, "cut", n)
            },
            prepareSelection: function() {
                var e = Ge(this.cm, !1);
                return e.focus = this.cm.state.focused, e
            },
            showSelection: function(e) {
                e && this.cm.display.view.length && (e.focus && this.showPrimarySelection(), this.showMultipleSelections(e))
            },
            showPrimarySelection: function() {
                var e = window.getSelection(),
                    t = this.cm.doc.sel.primary(),
                    n = Te(this.cm, e.anchorNode, e.anchorOffset),
                    r = Te(this.cm, e.focusNode, e.focusOffset);
                if (!n || n.bad || !r || r.bad || 0 != he(pe(n, r), t.from()) || 0 != he(fe(n, r), t.to())) {
                    var i = Ce(this.cm, t.from()),
                        o = Ce(this.cm, t.to());
                    if (i || o) {
                        var s = this.cm.display.view,
                            a = e.rangeCount && e.getRangeAt(0);
                        if (i) {
                            if (!o) {
                                var l = s[s.length - 1].measure,
                                    c = l.maps ? l.maps[l.maps.length - 1] : l.map;
                                o = {
                                    node: c[c.length - 1],
                                    offset: c[c.length - 2] - c[c.length - 3]
                                }
                            }
                        } else i = {
                            node: s[0].measure.map[2],
                            offset: 0
                        };
                        try {
                            var u = go(i.node, i.offset, o.offset, o.node)
                        } catch (e) {}
                        u && (e.removeAllRanges(), e.addRange(u), a && null == e.anchorNode ? e.addRange(a) : f && this.startGracePeriod()), this.rememberSelection()
                    }
                }
            },
            startGracePeriod: function() {
                var e = this;
                clearTimeout(this.gracePeriod), this.gracePeriod = setTimeout(function() {
                    e.gracePeriod = !1, e.selectionChanged() && e.cm.operation(function() {
                        e.cm.curOp.selectionChanged = !0
                    })
                }, 20)
            },
            showMultipleSelections: function(e) {
                wo(this.cm.display.cursorDiv, e.cursors), wo(this.cm.display.selectionDiv, e.selection)
            },
            rememberSelection: function() {
                var e = window.getSelection();
                this.lastAnchorNode = e.anchorNode, this.lastAnchorOffset = e.anchorOffset, this.lastFocusNode = e.focusNode, this.lastFocusOffset = e.focusOffset
            },
            selectionInEditor: function() {
                var e = window.getSelection();
                if (!e.rangeCount) return !1;
                var t = e.getRangeAt(0).commonAncestorContainer;
                return ko(this.div, t)
            },
            focus: function() {
                "nocursor" != this.cm.options.readOnly && this.div.focus()
            },
            blur: function() {
                this.div.blur()
            },
            getField: function() {
                return this.div
            },
            supportsTouch: function() {
                return !0
            },
            receivedFocus: function() {
                var t = this;
                this.selectionInEditor() ? this.pollSelection() : Bt(this.cm, function() {
                    t.cm.curOp.selectionChanged = !0
                }), this.polling.set(this.cm.options.pollInterval, function e() {
                    t.cm.state.focused && (t.pollSelection(), t.polling.set(t.cm.options.pollInterval, e))
                })
            },
            selectionChanged: function() {
                var e = window.getSelection();
                return e.anchorNode != this.lastAnchorNode || e.anchorOffset != this.lastAnchorOffset || e.focusNode != this.lastFocusNode || e.focusOffset != this.lastFocusOffset
            },
            pollSelection: function() {
                if (!this.composing && !this.gracePeriod && this.selectionChanged()) {
                    var e = window.getSelection(),
                        t = this.cm;
                    this.rememberSelection();
                    var n = Te(t, e.anchorNode, e.anchorOffset),
                        r = Te(t, e.focusNode, e.focusOffset);
                    n && r && Bt(t, function() {
                        ze(t.doc, Ne(n, r), Yi), (n.bad || r.bad) && (t.curOp.selectionChanged = !0)
                    })
                }
            },
            pollContent: function() {
                var e, t = this.cm,
                    n = t.display,
                    r = t.doc.sel.primary(),
                    i = r.from(),
                    o = r.to();
                if (i.line < n.viewFrom || o.line > n.viewTo - 1) return !1;
                if (i.line == n.viewFrom || 0 == (e = Yt(t, i.line))) var s = gi(n.view[0].line),
                    a = n.view[0].node;
                else s = gi(n.view[e].line), a = n.view[e - 1].node.nextSibling;
                var l = Yt(t, o.line);
                if (l == n.view.length - 1) var c = n.viewTo - 1,
                    u = n.view[l].node;
                else c = gi(n.view[l + 1].line) - 1, u = n.view[l + 1].node.previousSibling;
                for (var h = Po(function(l, e, t, c, u) {
                        var h = "",
                            d = !1;

                        function f(e) {
                            if (1 == e.nodeType) {
                                var t = e.getAttribute("cm-text");
                                if (null != t) return "" == t && (t = e.textContent.replace(/\u200b/g, "")), void(h += t);
                                var n, r = e.getAttribute("cm-marker");
                                if (r) {
                                    var i = l.findMarks(ue(c, 0), ue(u + 1, 0), (a = +r, function(e) {
                                        return e.id == a
                                    }));
                                    return void(i.length && (n = i[0].find()) && (h += fi(l.doc, n.from, n.to).join("\n")))
                                }
                                if ("false" == e.getAttribute("contenteditable")) return;
                                for (var o = 0; o < e.childNodes.length; o++) f(e.childNodes[o]);
                                /^(pre|div|p)$/i.test(e.nodeName) && (d = !0)
                            } else if (3 == e.nodeType) {
                                var s = e.nodeValue;
                                if (!s) return;
                                d && (h += "\n", d = !1), h += s
                            }
                            var a
                        }
                        for (; f(e), e != t;) e = e.nextSibling;
                        return h
                    }(t, a, u, s, c)), d = fi(t.doc, ue(s, 0), ue(c, di(t.doc, c).text.length)); 1 < h.length && 1 < d.length;)
                    if (ro(h) == ro(d)) h.pop(), d.pop(), c--;
                    else {
                        if (h[0] != d[0]) break;
                        h.shift(), d.shift(), s++
                    } for (var f = 0, p = 0, m = h[0], g = d[0], v = Math.min(m.length, g.length); f < v && m.charCodeAt(f) == g.charCodeAt(f);) ++f;
                for (var y = ro(h), b = ro(d), x = Math.min(y.length - (1 == h.length ? f : 0), b.length - (1 == d.length ? f : 0)); p < x && y.charCodeAt(y.length - p - 1) == b.charCodeAt(b.length - p - 1);) ++p;
                h[h.length - 1] = y.slice(0, y.length - p), h[0] = h[0].slice(f);
                var w = ue(s, f),
                    k = ue(c, d.length ? ro(d).length - p : 0);
                return 1 < h.length || h[0] || he(w, k) ? (Rn(t.doc, h, w, k, "+input"), !0) : void 0
            },
            ensurePolled: function() {
                this.forceCompositionEnd()
            },
            reset: function() {
                this.forceCompositionEnd()
            },
            forceCompositionEnd: function() {
                this.composing && !this.composing.handled && (this.applyComposition(this.composing), this.composing.handled = !0, this.div.blur(), this.div.focus())
            },
            applyComposition: function(e) {
                e.data && e.data != e.startData && zt(this.cm, ye)(this.cm, e.data, 0, e.sel)
            },
            setUneditable: function(e) {
                e.setAttribute("contenteditable", "false")
            },
            onKeyPress: function(e) {
                e.preventDefault(), zt(this.cm, ye)(this.cm, String.fromCharCode(null == e.charCode ? e.keyCode : e.charCode), 0)
            },
            onContextMenu: ao,
            resetPosition: ao,
            needsContentAttribute: !0
        }, _e.prototype), b.inputStyles = {
            textarea: we,
            contenteditable: _e
        }, Ae.prototype = {
            primary: function() {
                return this.ranges[this.primIndex]
            },
            equals: function(e) {
                if (e == this) return !0;
                if (e.primIndex != this.primIndex || e.ranges.length != this.ranges.length) return !1;
                for (var t = 0; t < this.ranges.length; t++) {
                    var n = this.ranges[t],
                        r = e.ranges[t];
                    if (0 != he(n.anchor, r.anchor) || 0 != he(n.head, r.head)) return !1
                }
                return !0
            },
            deepCopy: function() {
                for (var e = [], t = 0; t < this.ranges.length; t++) e[t] = new Le(de(this.ranges[t].anchor), de(this.ranges[t].head));
                return new Ae(e, this.primIndex)
            },
            somethingSelected: function() {
                for (var e = 0; e < this.ranges.length; e++)
                    if (!this.ranges[e].empty()) return !0;
                return !1
            },
            contains: function(e, t) {
                t || (t = e);
                for (var n = 0; n < this.ranges.length; n++) {
                    var r = this.ranges[n];
                    if (0 <= he(t, r.from()) && he(e, r.to()) <= 0) return n
                }
                return -1
            }
        }, Le.prototype = {
            from: function() {
                return pe(this.anchor, this.head)
            },
            to: function() {
                return fe(this.anchor, this.head)
            },
            empty: function() {
                return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch
            }
        };
        var dt, ft = {
            left: 0,
            right: 0,
            top: 0,
            bottom: 0
        };

        function pt(e, t, n) {
            for (var r, i, o, s, a = 0; a < e.length; a += 3) {
                var l = e[a],
                    c = e[a + 1];
                if (t < l ? (i = 0, o = 1, s = "left") : t < c ? o = (i = t - l) + 1 : (a == e.length - 3 || t == c && e[a + 3] > t) && (i = (o = c - l) - 1, c <= t && (s = "right")), null != i) {
                    if (r = e[a + 2], l == c && n == (r.insertLeft ? "left" : "right") && (s = n), "left" == n && 0 == i)
                        for (; a && e[a - 2] == e[a - 3] && e[a - 1].insertLeft;) r = e[2 + (a -= 3)], s = "left";
                    if ("right" == n && i == c - l)
                        for (; a < e.length - 3 && e[a + 3] == e[a + 4] && !e[a + 5].insertLeft;) r = e[(a += 3) + 2], s = "right";
                    break
                }
            }
            return {
                node: r,
                start: i,
                end: o,
                collapse: s,
                coverStart: l,
                coverEnd: c
            }
        }

        function mt(e) {
            if (e.measure && (e.measure.cache = {}, e.measure.heights = null, e.rest))
                for (var t = 0; t < e.rest.length; t++) e.measure.caches[t] = {}
        }

        function gt(e) {
            e.display.externalMeasure = null, xo(e.display.lineMeasure);
            for (var t = 0; t < e.display.view.length; t++) mt(e.display.view[t])
        }

        function vt(e) {
            gt(e), e.display.cachedCharWidth = e.display.cachedTextHeight = e.display.cachedPaddingH = null, e.options.lineWrapping || (e.display.maxLineChanged = !0), e.display.lineNumChars = null
        }

        function yt() {
            return window.pageXOffset || (document.documentElement || document.body).scrollLeft
        }

        function bt() {
            return window.pageYOffset || (document.documentElement || document.body).scrollTop
        }

        function xt(e, t, n, r) {
            if (t.widgets)
                for (var i = 0; i < t.widgets.length; ++i)
                    if (t.widgets[i].above) {
                        var o = $r(t.widgets[i]);
                        n.top += o, n.bottom += o
                    } if ("line" == r) return n;
            r || (r = "local");
            var s = yi(t);
            if ("local" == r ? s += tt(e.display) : s -= e.display.viewOffset, "page" == r || "window" == r) {
                var a = e.display.lineSpace.getBoundingClientRect();
                s += a.top + ("window" == r ? 0 : bt());
                var l = a.left + ("window" == r ? 0 : yt());
                n.left += l, n.right += l
            }
            return n.top += s, n.bottom += s, n
        }

        function wt(e, t, n) {
            if ("div" == n) return t;
            var r = t.left,
                i = t.top;
            if ("page" == n) r -= yt(), i -= bt();
            else if ("local" == n || !n) {
                var o = e.display.sizer.getBoundingClientRect();
                r += o.left, i += o.top
            }
            var s = e.display.lineSpace.getBoundingClientRect();
            return {
                left: r - s.left,
                top: i - s.top
            }
        }

        function kt(e, t, n, r, i) {
            return r || (r = di(e.doc, t.line)), xt(e, r, lt(e, r, t.ch, i), n)
        }

        function _t(r, e, i, o, s, a) {
            function l(e, t) {
                var n = ht(r, s, e, t ? "right" : "left", a);
                return t ? n.left = n.right : n.right = n.left, xt(r, o, n, i)
            }

            function t(e, t) {
                var n = c[t],
                    r = n.level % 2;
                return e == qo(n) && t && n.level < c[t - 1].level ? (e = jo(n = c[--t]) - (n.level % 2 ? 0 : 1), r = !0) : e == jo(n) && t < c.length - 1 && n.level < c[t + 1].level && (e = qo(n = c[++t]) - n.level % 2, r = !1), r && e == n.to && e > n.from ? l(e - 1) : l(e, r)
            }
            o = o || di(r.doc, e.line), s || (s = ut(r, o));
            var c = bi(o),
                n = e.ch;
            if (!c) return l(n);
            var u = t(n, Go(c, n));
            return null != Bo && (u.other = t(n, Bo)), u
        }

        function Ct(e, t) {
            var n = 0;
            t = Oe(e.doc, t);
            e.options.lineWrapping || (n = Lt(e.display) * t.ch);
            var r = di(e.doc, t.line),
                i = yi(r) + tt(e.display);
            return {
                left: n,
                right: n,
                top: i,
                bottom: i + r.height
            }
        }

        function St(e, t, n, r) {
            var i = ue(e, t);
            return i.xRel = r, n && (i.outside = !0), i
        }

        function Tt(e, t, n) {
            var r = e.doc;
            if ((n += e.display.viewOffset) < 0) return St(r.first, 0, !0, -1);
            var i = vi(r, n),
                o = r.first + r.size - 1;
            if (o < i) return St(r.first + r.size - 1, di(r, o).text.length, !0, 1);
            t < 0 && (t = 0);
            for (var s = di(r, i);;) {
                var a = Mt(e, s, i, t, n),
                    l = Ar(s),
                    c = l && l.find(0, !0);
                if (!l || !(a.ch > c.from.ch || a.ch == c.from.ch && 0 < a.xRel)) return a;
                i = gi(s = c.to.line)
            }
        }

        function Mt(n, r, i, e, t) {
            var o = t - yi(r),
                s = !1,
                a = 2 * n.display.wrapper.clientWidth,
                l = ut(n, r);

            function c(e) {
                var t = _t(n, ue(i, e), "line", r, l);
                return s = !0, o > t.bottom ? t.left - a : o < t.top ? t.left + a : (s = !1, t.left)
            }
            var u = bi(r),
                h = r.text.length,
                d = Wo(r),
                f = Uo(r),
                p = c(d),
                m = s,
                g = c(f),
                v = s;
            if (g < e) return St(i, f, v, 1);
            for (;;) {
                if (u ? f == d || f == Xo(r, d, 1) : f - d <= 1) {
                    for (var y = e < p || e - p <= g - e ? d : f, b = e - (y == d ? p : g); yo(r.text.charAt(y));) ++y;
                    return St(i, y, y == d ? m : v, b < -1 ? -1 : 1 < b ? 1 : 0)
                }
                var x = Math.ceil(h / 2),
                    w = d + x;
                if (u) {
                    w = d;
                    for (var k = 0; k < x; ++k) w = Xo(r, w, 1)
                }
                var _ = c(w);
                e < _ ? (f = w, g = _, (v = s) && (g += 1e3), h = x) : (d = w, p = _, m = s, h -= x)
            }
        }

        function At(e) {
            if (null != e.cachedTextHeight) return e.cachedTextHeight;
            if (null == dt) {
                dt = bo("pre");
                for (var t = 0; t < 49; ++t) dt.appendChild(document.createTextNode("x")), dt.appendChild(bo("br"));
                dt.appendChild(document.createTextNode("x"))
            }
            wo(e.measure, dt);
            var n = dt.offsetHeight / 50;
            return 3 < n && (e.cachedTextHeight = n), xo(e.measure), n || 1
        }

        function Lt(e) {
            if (null != e.cachedCharWidth) return e.cachedCharWidth;
            var t = bo("span", "xxxxxxxxxx"),
                n = bo("pre", [t]);
            wo(e.measure, n);
            var r = t.getBoundingClientRect(),
                i = (r.right - r.left) / 10;
            return 2 < i && (e.cachedCharWidth = i), i || 10
        }
        var Et, Nt, It = null,
            Ot = 0;

        function Rt(e) {
            e.curOp = {
                cm: e,
                viewChanged: !1,
                startHeight: e.doc.height,
                forceUpdate: !1,
                updateInput: null,
                typing: !1,
                changeObjs: null,
                cursorActivityHandlers: null,
                cursorActivityCalled: 0,
                selectionChanged: !1,
                updateMaxLine: !1,
                scrollLeft: null,
                scrollTop: null,
                scrollToPos: null,
                id: ++Ot
            }, It ? It.ops.push(e.curOp) : e.curOp.ownsGroup = It = {
                ops: [e.curOp],
                delayedCallbacks: []
            }
        }

        function Dt(e) {
            var t = e.curOp.ownsGroup;
            if (t) try {
                ! function(e) {
                    var t = e.delayedCallbacks,
                        n = 0;
                    do {
                        for (; n < t.length; n++) t[n]();
                        for (var r = 0; r < e.ops.length; r++) {
                            var i = e.ops[r];
                            if (i.cursorActivityHandlers)
                                for (; i.cursorActivityCalled < i.cursorActivityHandlers.length;) i.cursorActivityHandlers[i.cursorActivityCalled++](i.cm)
                        }
                    } while (n < t.length)
                }(t)
            } finally {
                It = null;
                for (var n = 0; n < t.ops.length; n++) t.ops[n].cm.curOp = null;
                ! function(e) {
                    for (var t = e.ops, n = 0; n < t.length; n++) Pt(t[n]);
                    for (var n = 0; n < t.length; n++) r = t[n], r.updatedDisplay = r.mustUpdate && K(r.cm, r.update);
                    var r;
                    for (var n = 0; n < t.length; n++) $t(t[n]);
                    for (var n = 0; n < t.length; n++) Ht(t[n]);
                    for (var n = 0; n < t.length; n++) Ft(t[n])
                }(t)
            }
        }

        function Pt(e) {
            var t, n, r = e.cm,
                i = r.display;
            !(n = (t = r).display).scrollbarsClipped && n.scroller.offsetWidth && (n.nativeBarWidth = n.scroller.offsetWidth - n.scroller.clientWidth, n.heightForcer.style.height = it(t) + "px", n.sizer.style.marginBottom = -n.nativeBarWidth + "px", n.sizer.style.borderRightWidth = it(t) + "px", n.scrollbarsClipped = !0), e.updateMaxLine && I(r), e.mustUpdate = e.viewChanged || e.forceUpdate || null != e.scrollTop || e.scrollToPos && (e.scrollToPos.from.line < i.viewFrom || e.scrollToPos.to.line >= i.viewTo) || i.maxLineChanged && r.options.lineWrapping, e.update = e.mustUpdate && new U(r, e.mustUpdate && {
                top: e.scrollTop,
                ensure: e.scrollToPos
            }, e.forceUpdate)
        }

        function $t(e) {
            var t = e.cm,
                n = t.display;
            e.updatedDisplay && X(t), e.barMeasure = R(t), n.maxLineChanged && !t.options.lineWrapping && (e.adjustWidthTo = lt(t, n.maxLine, n.maxLine.text.length).left + 3, t.display.sizerWidth = e.adjustWidthTo, e.barMeasure.scrollWidth = Math.max(n.scroller.clientWidth, n.sizer.offsetLeft + e.adjustWidthTo + it(t) + t.display.barWidth), e.maxScrollLeft = Math.max(0, n.sizer.offsetLeft + e.adjustWidthTo - ot(t))), (e.updatedDisplay || e.selectionChanged) && (e.preparedSelection = n.input.prepareSelection())
        }

        function Ht(e) {
            var t = e.cm;
            null != e.adjustWidthTo && (t.display.sizer.style.minWidth = e.adjustWidthTo + "px", e.maxScrollLeft < t.doc.scrollLeft && ln(t, Math.min(t.display.scroller.scrollLeft, e.maxScrollLeft), !0), t.display.maxLineChanged = !1), e.preparedSelection && t.display.input.showSelection(e.preparedSelection), e.updatedDisplay && Y(t, e.barMeasure), (e.updatedDisplay || e.startHeight != t.doc.height) && H(t, e.barMeasure), e.selectionChanged && Qe(t), t.state.focused && e.updateInput && t.display.input.reset(e.typing)
        }

        function Ft(e) {
            var t = e.cm,
                n = t.display,
                r = t.doc;
            if (e.updatedDisplay && V(t, e.update), null == n.wheelStartX || null == e.scrollTop && null == e.scrollLeft && !e.scrollToPos || (n.wheelStartX = n.wheelStartY = null), null == e.scrollTop || n.scroller.scrollTop == e.scrollTop && !e.forceScroll || (r.scrollTop = Math.max(0, Math.min(n.scroller.scrollHeight - n.scroller.clientHeight, e.scrollTop)), n.scrollbars.setScrollTop(r.scrollTop), n.scroller.scrollTop = r.scrollTop), null == e.scrollLeft || n.scroller.scrollLeft == e.scrollLeft && !e.forceScroll || (r.scrollLeft = Math.max(0, Math.min(n.scroller.scrollWidth - ot(t), e.scrollLeft)), n.scrollbars.setScrollLeft(r.scrollLeft), n.scroller.scrollLeft = r.scrollLeft, z(t)), e.scrollToPos) {
                var i = function(e, t, n, r) {
                    null == r && (r = 0);
                    for (var i = 0; i < 5; i++) {
                        var o = !1,
                            s = _t(e, t),
                            a = n && n != t ? _t(e, n) : s,
                            l = Dn(e, Math.min(s.left, a.left), Math.min(s.top, a.top) - r, Math.max(s.left, a.left), Math.max(s.bottom, a.bottom) + r),
                            c = e.doc.scrollTop,
                            u = e.doc.scrollLeft;
                        if (null != l.scrollTop && (an(e, l.scrollTop), 1 < Math.abs(e.doc.scrollTop - c) && (o = !0)), null != l.scrollLeft && (ln(e, l.scrollLeft), 1 < Math.abs(e.doc.scrollLeft - u) && (o = !0)), !o) break
                    }
                    return s
                }(t, Oe(r, e.scrollToPos.from), Oe(r, e.scrollToPos.to), e.scrollToPos.margin);
                e.scrollToPos.isCursor && t.state.focused && function(e, t) {
                    if (ji(e, "scrollCursorIntoView")) return;
                    var n = e.display,
                        r = n.sizer.getBoundingClientRect(),
                        i = null;
                    t.top + r.top < 0 ? i = !0 : t.bottom + r.top > (window.innerHeight || document.documentElement.clientHeight) && (i = !1);
                    if (null != i && !c) {
                        var o = bo("div", "â€‹", null, "position: absolute; top: " + (t.top - n.viewOffset - tt(e.display)) + "px; height: " + (t.bottom - t.top + it(e) + n.barHeight) + "px; left: " + t.left + "px; width: 2px;");
                        e.display.lineSpace.appendChild(o), o.scrollIntoView(i), e.display.lineSpace.removeChild(o)
                    }
                }(t, i)
            }
            var o = e.maybeHiddenMarkers,
                s = e.maybeUnhiddenMarkers;
            if (o)
                for (var a = 0; a < o.length; ++a) o[a].lines.length || Fi(o[a], "hide");
            if (s)
                for (a = 0; a < s.length; ++a) s[a].lines.length && Fi(s[a], "unhide");
            n.wrapper.offsetHeight && (r.scrollTop = t.display.scroller.scrollTop), e.changeObjs && Fi(t, "changes", t, e.changeObjs), e.update && e.update.finish()
        }

        function Bt(e, t) {
            if (e.curOp) return t();
            Rt(e);
            try {
                return t()
            } finally {
                Dt(e)
            }
        }

        function zt(e, t) {
            return function() {
                if (e.curOp) return t.apply(e, arguments);
                Rt(e);
                try {
                    return t.apply(e, arguments)
                } finally {
                    Dt(e)
                }
            }
        }

        function qt(e) {
            return function() {
                if (this.curOp) return e.apply(this, arguments);
                Rt(this);
                try {
                    return e.apply(this, arguments)
                } finally {
                    Dt(this)
                }
            }
        }

        function jt(t) {
            return function() {
                var e = this.cm;
                if (!e || e.curOp) return t.apply(this, arguments);
                Rt(e);
                try {
                    return t.apply(this, arguments)
                } finally {
                    Dt(e)
                }
            }
        }

        function Wt(e, t, n) {
            this.line = t, this.rest = function(e) {
                var t, n;
                for (; t = Ar(e);) e = t.find(1, !0).line, (n || (n = [])).push(e);
                return n
            }(t), this.size = this.rest ? gi(ro(this.rest)) - n + 1 : 1, this.node = this.text = null, this.hidden = Or(e, t)
        }

        function Ut(e, t, n) {
            for (var r, i = [], o = t; o < n; o = r) {
                var s = new Wt(e.doc, di(e.doc, o), o);
                r = o + s.size, i.push(s)
            }
            return i
        }

        function Kt(e, t, n, r) {
            null == t && (t = e.doc.first), null == n && (n = e.doc.first + e.doc.size), r || (r = 0);
            var i = e.display;
            if (r && n < i.viewTo && (null == i.updateLineNumbers || i.updateLineNumbers > t) && (i.updateLineNumbers = t), e.curOp.viewChanged = !0, t >= i.viewTo) y && Nr(e.doc, t) < i.viewTo && Gt(e);
            else if (n <= i.viewFrom) y && Ir(e.doc, n + r) > i.viewFrom ? Gt(e) : (i.viewFrom += r, i.viewTo += r);
            else if (t <= i.viewFrom && n >= i.viewTo) Gt(e);
            else if (t <= i.viewFrom) {
                (o = Xt(e, n, n + r, 1)) ? (i.view = i.view.slice(o.index), i.viewFrom = o.lineN, i.viewTo += r) : Gt(e)
            } else if (n >= i.viewTo) {
                var o;
                (o = Xt(e, t, t, -1)) ? (i.view = i.view.slice(0, o.index), i.viewTo = o.lineN) : Gt(e)
            } else {
                var s = Xt(e, t, t, -1),
                    a = Xt(e, n, n + r, 1);
                s && a ? (i.view = i.view.slice(0, s.index).concat(Ut(e, s.lineN, a.lineN)).concat(i.view.slice(a.index)), i.viewTo += r) : Gt(e)
            }
            var l = i.externalMeasured;
            l && (n < l.lineN ? l.lineN += r : t < l.lineN + l.size && (i.externalMeasured = null))
        }

        function Vt(e, t, n) {
            e.curOp.viewChanged = !0;
            var r = e.display,
                i = e.display.externalMeasured;
            if (i && t >= i.lineN && t < i.lineN + i.size && (r.externalMeasured = null), !(t < r.viewFrom || t >= r.viewTo)) {
                var o = r.view[Yt(e, t)];
                if (null != o.node) {
                    var s = o.changes || (o.changes = []); - 1 == oo(s, n) && s.push(n)
                }
            }
        }

        function Gt(e) {
            e.display.viewFrom = e.display.viewTo = e.doc.first, e.display.view = [], e.display.viewOffset = 0
        }

        function Yt(e, t) {
            if (t >= e.display.viewTo) return null;
            if ((t -= e.display.viewFrom) < 0) return null;
            for (var n = e.display.view, r = 0; r < n.length; r++)
                if ((t -= n[r].size) < 0) return r
        }

        function Xt(e, t, n, r) {
            var i, o = Yt(e, t),
                s = e.display.view;
            if (!y || n == e.doc.first + e.doc.size) return {
                index: o,
                lineN: n
            };
            for (var a = 0, l = e.display.viewFrom; a < o; a++) l += s[a].size;
            if (l != t) {
                if (0 < r) {
                    if (o == s.length - 1) return null;
                    i = l + s[o].size - t, o++
                } else i = l - t;
                t += i, n += i
            }
            for (; Nr(e.doc, n) != n;) {
                if (o == (r < 0 ? 0 : s.length - 1)) return null;
                n += r * s[o - (r < 0 ? 1 : 0)].size, o += r
            }
            return {
                index: o,
                lineN: n
            }
        }

        function Qt(e) {
            for (var t = e.display.view, n = 0, r = 0; r < t.length; r++) {
                var i = t[r];
                i.hidden || i.node && !i.changes || ++n
            }
            return n
        }

        function Jt(e) {
            var t = e.display;
            t.lastWrapHeight == t.wrapper.clientHeight && t.lastWrapWidth == t.wrapper.clientWidth || (t.cachedCharWidth = t.cachedTextHeight = t.cachedPaddingH = null, t.scrollbarsClipped = !1, e.setSize())
        }

        function Zt(e, t) {
            for (var n = Di(t); n != e.wrapper; n = n.parentNode)
                if (!n || 1 == n.nodeType && "true" == n.getAttribute("cm-ignore-events") || n.parentNode == e.sizer && n != e.mover) return !0
        }

        function en(e, t, n, r) {
            var i = e.display;
            if (!n && "true" == Di(t).getAttribute("cm-not-content")) return null;
            var o, s, a = i.lineSpace.getBoundingClientRect();
            try {
                o = t.clientX - a.left, s = t.clientY - a.top
            } catch (t) {
                return null
            }
            var l, c = Tt(e, o, s);
            if (r && 1 == c.xRel && (l = di(e.doc, c.line).text).length == c.ch) {
                var u = Zi(l, l.length, e.options.tabSize) - l.length;
                c = ue(c.line, Math.max(0, Math.round((o - rt(e.display).left) / Lt(e.display)) - u))
            }
            return c
        }

        function tn(e) {
            var t = this.display;
            if (!(t.activeTouch && t.input.supportsTouch() || ji(this, e)))
                if (t.shift = e.shiftKey, Zt(t, e)) p || (t.scroller.draggable = !1, setTimeout(function() {
                    t.scroller.draggable = !0
                }, 100));
                else if (!rn(this, e)) {
                var n, r = en(this, e);
                switch (window.focus(), Pi(e)) {
                    case 1:
                        r ? function(e, t, n) {
                            x ? setTimeout(uo(me, e), 0) : me(e);
                            var r, i = +new Date;
                            Nt && Nt.time > i - 400 && 0 == he(Nt.pos, n) ? r = "triple" : Et && Et.time > i - 400 && 0 == he(Et.pos, n) ? (r = "double", Nt = {
                                time: i,
                                pos: n
                            }) : (r = "single", Et = {
                                time: i,
                                pos: n
                            });
                            var o, s = e.doc.sel,
                                a = g ? t.metaKey : t.ctrlKey;
                            e.options.dragDrop && Io && !ge(e) && "single" == r && -1 < (o = s.contains(n)) && !s.ranges[o].empty() ? function(t, n, r, i) {
                                var o = t.display,
                                    s = zt(t, function(e) {
                                        p && (o.scroller.draggable = !1), t.state.draggingText = !1, Hi(document, "mouseup", s), Hi(o.scroller, "drop", s), Math.abs(n.clientX - e.clientX) + Math.abs(n.clientY - e.clientY) < 10 && (Ni(e), i || Pe(t.doc, r), p || x && 9 == w ? setTimeout(function() {
                                            document.body.focus(), o.input.focus()
                                        }, 20) : o.input.focus())
                                    });
                                p && (o.scroller.draggable = !0);
                                t.state.draggingText = s, o.scroller.dragDrop && o.scroller.dragDrop();
                                $i(document, "mouseup", s), $i(o.scroller, "drop", s)
                            }(e, t, n, a) : function(m, e, g, v, t) {
                                var o = m.display,
                                    y = m.doc;
                                Ni(e);
                                var b, x, w = y.sel,
                                    n = w.ranges;
                                t && !e.shiftKey ? (x = y.sel.contains(g), b = -1 < x ? n[x] : new Le(g, g)) : (b = y.sel.primary(), x = y.sel.primIndex);
                                if (e.altKey) v = "rect", t || (b = new Le(g, g)), g = en(m, e, !0, !0), x = -1;
                                else if ("double" == v) {
                                    var r = m.findWordAt(g);
                                    b = m.display.shift || y.extend ? De(y, b, r.anchor, r.head) : r
                                } else if ("triple" == v) {
                                    var i = new Le(ue(g.line, 0), Oe(y, ue(g.line + 1, 0)));
                                    b = m.display.shift || y.extend ? De(y, b, i.anchor, i.head) : i
                                } else b = De(y, b, g);
                                t ? -1 == x ? (x = n.length, ze(y, Ee(n.concat([b]), x), {
                                    scroll: !1,
                                    origin: "*mouse"
                                })) : 1 < n.length && n[x].empty() && "single" == v && !e.shiftKey ? (ze(y, Ee(n.slice(0, x).concat(n.slice(x + 1)), 0)), w = y.sel) : He(y, x, b, Xi) : (ze(y, new Ae([b], x = 0), Xi), w = y.sel);
                                var k = g;
                                var s = o.wrapper.getBoundingClientRect(),
                                    a = 0;

                                function l(e) {
                                    var t = ++a,
                                        n = en(m, e, !0, "rect" == v);
                                    if (n)
                                        if (0 != he(n, k)) {
                                            me(m),
                                                function(e) {
                                                    if (0 == he(k, e)) return;
                                                    if (k = e, "rect" == v) {
                                                        for (var t = [], n = m.options.tabSize, r = Zi(di(y, g.line).text, g.ch, n), i = Zi(di(y, e.line).text, e.ch, n), o = Math.min(r, i), s = Math.max(r, i), a = Math.min(g.line, e.line), l = Math.min(m.lastLine(), Math.max(g.line, e.line)); a <= l; a++) {
                                                            var c = di(y, a).text,
                                                                u = eo(c, o, n);
                                                            o == s ? t.push(new Le(ue(a, u), ue(a, u))) : c.length > u && t.push(new Le(ue(a, u), ue(a, eo(c, s, n))))
                                                        }
                                                        t.length || t.push(new Le(g, g)), ze(y, Ee(w.ranges.slice(0, x).concat(t), x), {
                                                            origin: "*mouse",
                                                            scroll: !1
                                                        }), m.scrollIntoView(e)
                                                    } else {
                                                        var h = b,
                                                            d = h.anchor,
                                                            f = e;
                                                        if ("single" != v) {
                                                            if ("double" == v) var p = m.findWordAt(e);
                                                            else var p = new Le(ue(e.line, 0), Oe(y, ue(e.line + 1, 0)));
                                                            d = 0 < he(p.anchor, d) ? (f = p.head, pe(h.from(), p.anchor)) : (f = p.anchor, fe(h.to(), p.head))
                                                        }
                                                        var t = w.ranges.slice(0);
                                                        t[x] = new Le(Oe(y, d), f), ze(y, Ee(t, x), Xi)
                                                    }
                                                }(n);
                                            var r = B(o, y);
                                            (n.line >= r.to || n.line < r.from) && setTimeout(zt(m, function() {
                                                a == t && l(e)
                                            }), 150)
                                        } else {
                                            var i = e.clientY < s.top ? -20 : e.clientY > s.bottom ? 20 : 0;
                                            i && setTimeout(zt(m, function() {
                                                a == t && (o.scroller.scrollTop += i, l(e))
                                            }), 50)
                                        }
                                }

                                function c(e) {
                                    a = 1 / 0, Ni(e), o.input.focus(), Hi(document, "mousemove", u), Hi(document, "mouseup", h), y.history.lastSelOrigin = null
                                }
                                var u = zt(m, function(e) {
                                        Pi(e) ? l(e) : c(e)
                                    }),
                                    h = zt(m, c);
                                $i(document, "mousemove", u), $i(document, "mouseup", h)
                            }(e, t, n, r, a)
                        }(this, e, r) : Di(e) == t.scroller && Ni(e);
                        break;
                    case 2:
                        p && (this.state.lastMiddleDown = +new Date), r && Pe(this.doc, r), setTimeout(function() {
                            t.input.focus()
                        }, 20), Ni(e);
                        break;
                    case 3:
                        d ? _n(this, e) : ((n = this).state.delayingBlurEvent = !0, setTimeout(function() {
                            n.state.delayingBlurEvent && (n.state.delayingBlurEvent = !1, kn(n))
                        }, 100))
                }
            }
        }

        function nn(e, t, n, r, i) {
            try {
                var o = t.clientX,
                    s = t.clientY
            } catch (t) {
                return !1
            }
            if (o >= Math.floor(e.display.gutters.getBoundingClientRect().right)) return !1;
            r && Ni(t);
            var a = e.display,
                l = a.lineDiv.getBoundingClientRect();
            if (s > l.bottom || !Ui(e, n)) return Oi(t);
            s -= l.top - a.viewOffset;
            for (var c = 0; c < e.options.gutters.length; ++c) {
                var u = a.gutters.childNodes[c];
                if (u && u.getBoundingClientRect().right >= o) return i(e, n, e, vi(e.doc, s), e.options.gutters[c], t), Oi(t)
            }
        }

        function rn(e, t) {
            return nn(e, t, "gutterClick", !0, zi)
        }
        var on = 0;

        function sn(e) {
            var r = this;
            if (!ji(r, e) && !Zt(r.display, e)) {
                Ni(e), x && (on = +new Date);
                var i = en(r, e, !0),
                    t = e.dataTransfer.files;
                if (i && !ge(r))
                    if (t && t.length && window.FileReader && window.File)
                        for (var o = t.length, s = Array(o), a = 0, n = function(e, t) {
                                var n = new FileReader;
                                n.onload = zt(r, function() {
                                    if (s[t] = n.result, ++a == o) {
                                        var e = {
                                            from: i = Oe(r.doc, i),
                                            to: i,
                                            text: Po(s.join("\n")),
                                            origin: "paste"
                                        };
                                        Ln(r.doc, e), Be(r.doc, Ne(i, Cn(e)))
                                    }
                                }), n.readAsText(e)
                            }, l = 0; l < o; ++l) n(t[l], l);
                    else {
                        if (r.state.draggingText && -1 < r.doc.sel.contains(i)) return r.state.draggingText(e), void setTimeout(function() {
                            r.display.input.focus()
                        }, 20);
                        try {
                            if (s = e.dataTransfer.getData("Text")) {
                                if (r.state.draggingText && !(g ? e.metaKey : e.ctrlKey)) var c = r.listSelections();
                                if (qe(r.doc, Ne(i, i)), c)
                                    for (l = 0; l < c.length; ++l) Rn(r.doc, "", c[l].anchor, c[l].head, "drag");
                                r.replaceSelection(s, "around", "paste"), r.display.input.focus()
                            }
                        } catch (e) {}
                    }
            }
        }

        function an(e, t) {
            Math.abs(e.doc.scrollTop - t) < 2 || (e.doc.scrollTop = t, f || G(e, {
                top: t
            }), e.display.scroller.scrollTop != t && (e.display.scroller.scrollTop = t), e.display.scrollbars.setScrollTop(t), f && G(e), Je(e, 100))
        }

        function ln(e, t, n) {
            (n ? t == e.doc.scrollLeft : Math.abs(e.doc.scrollLeft - t) < 2) || (t = Math.min(t, e.display.scroller.scrollWidth - e.display.scroller.clientWidth), e.doc.scrollLeft = t, z(e), e.display.scroller.scrollLeft != t && (e.display.scroller.scrollLeft = t), e.display.scrollbars.setScrollLeft(t))
        }
        var cn = 0,
            un = null;
        x ? un = -.53 : f ? un = 15 : r ? un = -.7 : l && (un = -1 / 3);
        var hn = function(e) {
            var t = e.wheelDeltaX,
                n = e.wheelDeltaY;
            return null == t && e.detail && e.axis == e.HORIZONTAL_AXIS && (t = e.detail), null == n && e.detail && e.axis == e.VERTICAL_AXIS ? n = e.detail : null == n && (n = e.wheelDelta), {
                x: t,
                y: n
            }
        };

        function dn(e, t) {
            var n = hn(t),
                r = n.x,
                i = n.y,
                o = e.display,
                s = o.scroller;
            if (r && s.scrollWidth > s.clientWidth || i && s.scrollHeight > s.clientHeight) {
                if (i && g && p) e: for (var a = t.target, l = o.view; a != s; a = a.parentNode)
                    for (var c = 0; c < l.length; c++)
                        if (l[c].node == a) {
                            e.display.currentWheelTarget = a;
                            break e
                        } if (r && !f && !m && null != un) return i && an(e, Math.max(0, Math.min(s.scrollTop + i * un, s.scrollHeight - s.clientHeight))), ln(e, Math.max(0, Math.min(s.scrollLeft + r * un, s.scrollWidth - s.clientWidth))), Ni(t), void(o.wheelStartX = null);
                if (i && null != un) {
                    var u = i * un,
                        h = e.doc.scrollTop,
                        d = h + o.wrapper.clientHeight;
                    u < 0 ? h = Math.max(0, h + u - 50) : d = Math.min(e.doc.height, d + u + 50), G(e, {
                        top: h,
                        bottom: d
                    })
                }
                cn < 20 && (null == o.wheelStartX ? (o.wheelStartX = s.scrollLeft, o.wheelStartY = s.scrollTop, o.wheelDX = r, o.wheelDY = i, setTimeout(function() {
                    if (null != o.wheelStartX) {
                        var e = s.scrollLeft - o.wheelStartX,
                            t = s.scrollTop - o.wheelStartY,
                            n = t && o.wheelDY && t / o.wheelDY || e && o.wheelDX && e / o.wheelDX;
                        o.wheelStartX = o.wheelStartY = null, n && (un = (un * cn + n) / (cn + 1), ++cn)
                    }
                }, 200)) : (o.wheelDX += r, o.wheelDY += i))
            }
        }

        function fn(e, t, n) {
            if ("string" == typeof t && !(t = tr[t])) return !1;
            e.display.input.ensurePolled();
            var r = e.display.shift,
                i = !1;
            try {
                ge(e) && (e.state.suppressEdits = !0), n && (e.display.shift = !1), i = t(e) != Gi
            } finally {
                e.display.shift = r, e.state.suppressEdits = !1
            }
            return i
        }
        b.wheelEventPixels = function(e) {
            var t = hn(e);
            return t.x *= un, t.y *= un, t
        };
        var pn = new Ji;

        function mn(e, t, n, r) {
            var i = e.state.keySeq;
            if (i) {
                if (or(t)) return "handled";
                pn.set(50, function() {
                    e.state.keySeq == i && (e.state.keySeq = null, e.display.input.reset())
                }), t = i + " " + t
            }
            var o = function(e, t, n) {
                for (var r = 0; r < e.state.keyMaps.length; r++) {
                    var i = ir(t, e.state.keyMaps[r], n, e);
                    if (i) return i
                }
                return e.options.extraKeys && ir(t, e.options.extraKeys, n, e) || ir(t, e.options.keyMap, n, e)
            }(e, t, r);
            return "multi" == o && (e.state.keySeq = t), "handled" == o && zi(e, "keyHandled", e, t, n), "handled" != o && "multi" != o || (Ni(n), Qe(e)), i && !o && /\'$/.test(t) ? (Ni(n), !0) : !!o
        }

        function gn(t, e) {
            var n = sr(e, !0);
            return !!n && (e.shiftKey && !t.state.keySeq ? mn(t, "Shift-" + n, e, function(e) {
                return fn(t, e, !0)
            }) || mn(t, n, e, function(e) {
                if ("string" == typeof e ? /^go[A-Z]/.test(e) : e.motion) return fn(t, e)
            }) : mn(t, n, e, function(e) {
                return fn(t, e)
            }))
        }
        var vn = null;

        function yn(e) {
            if (me(this), !ji(this, e)) {
                x && w < 11 && 27 == e.keyCode && (e.returnValue = !1);
                var t = e.keyCode;
                this.display.shift = 16 == t || e.shiftKey;
                var n = gn(this, e);
                m && (vn = n ? t : null, !n && 88 == t && !Ho && (g ? e.metaKey : e.ctrlKey) && this.replaceSelection("", null, "cut")), 18 != t || /\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className) || function(e) {
                    var t = e.display.lineDiv;

                    function n(e) {
                        18 != e.keyCode && e.altKey || (So(t, "CodeMirror-crosshair"), Hi(document, "keyup", n), Hi(document, "mouseover", n))
                    }
                    To(t, "CodeMirror-crosshair"), $i(document, "keyup", n), $i(document, "mouseover", n)
                }(this)
            }
        }

        function bn(e) {
            16 == e.keyCode && (this.doc.sel.shift = !1), ji(this, e)
        }

        function xn(e) {
            if (!(Zt(this.display, e) || ji(this, e) || e.ctrlKey && !e.altKey || g && e.metaKey)) {
                var t = e.keyCode,
                    n = e.charCode;
                if (m && t == vn) return vn = null, void Ni(e);
                if (!m || e.which && !(e.which < 10) || !gn(this, e)) {
                    var r, i = String.fromCharCode(null == n ? t : n);
                    if (!mn(r = this, "'" + i + "'", e, function(e) {
                            return fn(r, e, !0)
                        })) this.display.input.onKeyPress(e)
                }
            }
        }

        function wn(e) {
            e.state.delayingBlurEvent && (e.state.delayingBlurEvent = !1), "nocursor" != e.options.readOnly && (e.state.focused || (Fi(e, "focus", e), e.state.focused = !0, To(e.display.wrapper, "CodeMirror-focused"), e.curOp || e.display.selForContextMenu == e.doc.sel || (e.display.input.reset(), p && setTimeout(function() {
                e.display.input.reset(!0)
            }, 20)), e.display.input.receivedFocus()), Qe(e))
        }

        function kn(e) {
            e.state.delayingBlurEvent || (e.state.focused && (Fi(e, "blur", e), e.state.focused = !1, So(e.display.wrapper, "CodeMirror-focused")), clearInterval(e.display.blinker), setTimeout(function() {
                e.state.focused || (e.display.shift = !1)
            }, 150))
        }

        function _n(e, t) {
            var n, r;
            Zt(e.display, t) || (r = t, Ui(n = e, "gutterContextMenu") && nn(n, r, "gutterContextMenu", !1, Fi)) || e.display.input.onContextMenu(t)
        }
        var Cn = b.changeEnd = function(e) {
            return e.text ? ue(e.from.line + e.text.length - 1, ro(e.text).length + (1 == e.text.length ? e.from.ch : 0)) : e.to
        };

        function Sn(e, t) {
            if (he(e, t.from) < 0) return e;
            if (he(e, t.to) <= 0) return Cn(t);
            var n = e.line + t.text.length - (t.to.line - t.from.line) - 1,
                r = e.ch;
            return e.line == t.to.line && (r += Cn(t).ch - t.to.ch), ue(n, r)
        }

        function Tn(e, t) {
            for (var n = [], r = 0; r < e.sel.ranges.length; r++) {
                var i = e.sel.ranges[r];
                n.push(new Le(Sn(i.anchor, t), Sn(i.head, t)))
            }
            return Ee(n, e.sel.primIndex)
        }

        function Mn(e, t, n) {
            return e.line == t.line ? ue(n.line, e.ch - t.ch + n.ch) : ue(n.line + (e.line - t.line), e.ch)
        }

        function An(i, e, t) {
            var n = {
                canceled: !1,
                from: e.from,
                to: e.to,
                text: e.text,
                origin: e.origin,
                cancel: function() {
                    this.canceled = !0
                }
            };
            return t && (n.update = function(e, t, n, r) {
                e && (this.from = Oe(i, e)), t && (this.to = Oe(i, t)), n && (this.text = n), void 0 !== r && (this.origin = r)
            }), Fi(i, "beforeChange", i, n), i.cm && Fi(i.cm, "beforeChange", i.cm, n), n.canceled ? null : {
                from: n.from,
                to: n.to,
                text: n.text,
                origin: n.origin
            }
        }

        function Ln(e, t, n) {
            if (e.cm) {
                if (!e.cm.curOp) return zt(e.cm, Ln)(e, t, n);
                if (e.cm.state.suppressEdits) return
            }
            if (!(Ui(e, "beforeChange") || e.cm && Ui(e.cm, "beforeChange")) || (t = An(e, t, !0))) {
                var r = v && !n && function(e, t, n) {
                    var r = null;
                    if (e.iter(t.line, n.line + 1, function(e) {
                            if (e.markedSpans)
                                for (var t = 0; t < e.markedSpans.length; ++t) {
                                    var n = e.markedSpans[t].marker;
                                    !n.readOnly || r && -1 != oo(r, n) || (r || (r = [])).push(n)
                                }
                        }), !r) return null;
                    for (var i = [{
                            from: t,
                            to: n
                        }], o = 0; o < r.length; ++o)
                        for (var s = r[o], a = s.find(0), l = 0; l < i.length; ++l) {
                            var c = i[l];
                            if (!(he(c.to, a.from) < 0 || 0 < he(c.from, a.to))) {
                                var u = [l, 1],
                                    h = he(c.from, a.from),
                                    d = he(c.to, a.to);
                                (h < 0 || !s.inclusiveLeft && !h) && u.push({
                                    from: c.from,
                                    to: a.from
                                }), (0 < d || !s.inclusiveRight && !d) && u.push({
                                    from: a.to,
                                    to: c.to
                                }), i.splice.apply(i, u), l += u.length - 1
                            }
                        }
                    return i
                }(e, t.from, t.to);
                if (r)
                    for (var i = r.length - 1; 0 <= i; --i) En(e, {
                        from: r[i].from,
                        to: r[i].to,
                        text: i ? [""] : t.text
                    });
                else En(e, t)
            }
        }

        function En(e, n) {
            if (1 != n.text.length || "" != n.text[0] || 0 != he(n.from, n.to)) {
                var t = Tn(e, n);
                _i(e, n, t, e.cm ? e.cm.curOp.id : NaN), On(e, n, t, yr(e, n));
                var r = [];
                ui(e, function(e, t) {
                    t || -1 != oo(r, e.history) || (Ei(e.history, n), r.push(e.history)), On(e, n, null, yr(e, n))
                })
            }
        }

        function Nn(e, t, n) {
            if (!e.cm || !e.cm.state.suppressEdits) {
                for (var r, i = e.history, o = e.sel, s = "undo" == t ? i.done : i.undone, a = "undo" == t ? i.undone : i.done, l = 0; l < s.length && (r = s[l], n ? !r.ranges || r.equals(e.sel) : r.ranges); l++);
                if (l != s.length) {
                    for (i.lastOrigin = i.lastSelOrigin = null;
                        (r = s.pop()).ranges;) {
                        if (Ci(r, a), n && !r.equals(e.sel)) return void ze(e, r, {
                            clearRedo: !1
                        });
                        o = r
                    }
                    var c = [];
                    Ci(o, a), a.push({
                        changes: c,
                        generation: i.generation
                    }), i.generation = r.generation || ++i.maxGeneration;
                    var u = Ui(e, "beforeChange") || e.cm && Ui(e.cm, "beforeChange");
                    for (l = r.changes.length - 1; 0 <= l; --l) {
                        var h = r.changes[l];
                        if (h.origin = t, u && !An(e, h, !1)) return void(s.length = 0);
                        c.push(wi(e, h));
                        var d = l ? Tn(e, h) : ro(s);
                        On(e, h, d, xr(e, h)), !l && e.cm && e.cm.scrollIntoView({
                            from: h.from,
                            to: Cn(h)
                        });
                        var f = [];
                        ui(e, function(e, t) {
                            t || -1 != oo(f, e.history) || (Ei(e.history, h), f.push(e.history)), On(e, h, null, xr(e, h))
                        })
                    }
                }
            }
        }

        function In(e, t) {
            if (0 != t && (e.first += t, e.sel = new Ae(so(e.sel.ranges, function(e) {
                    return new Le(ue(e.anchor.line + t, e.anchor.ch), ue(e.head.line + t, e.head.ch))
                }), e.sel.primIndex), e.cm)) {
                Kt(e.cm, e.first, e.first - t, t);
                for (var n = e.cm.display, r = n.viewFrom; r < n.viewTo; r++) Vt(e.cm, r, "gutter")
            }
        }

        function On(e, t, n, r) {
            if (e.cm && !e.cm.curOp) return zt(e.cm, On)(e, t, n, r);
            if (t.to.line < e.first) In(e, t.text.length - 1 - (t.to.line - t.from.line));
            else if (!(t.from.line > e.lastLine())) {
                if (t.from.line < e.first) {
                    var i = t.text.length - 1 - (e.first - t.from.line);
                    In(e, i), t = {
                        from: ue(e.first, 0),
                        to: ue(t.to.line + i, t.to.ch),
                        text: [ro(t.text)],
                        origin: t.origin
                    }
                }
                var o = e.lastLine();
                t.to.line > o && (t = {
                    from: t.from,
                    to: ue(o, di(e, o).text.length),
                    text: [t.text[0]],
                    origin: t.origin
                }), t.removed = fi(e, t.from, t.to), n || (n = Tn(e, t)), e.cm ? function(e, t, n) {
                    var r = e.doc,
                        i = e.display,
                        o = t.from,
                        s = t.to,
                        a = !1,
                        l = o.line;
                    e.options.lineWrapping || (l = gi(Er(di(r, o.line))), r.iter(l, s.line + 1, function(e) {
                        if (e == i.maxLine) return a = !0
                    })); - 1 < r.sel.contains(t.from, t.to) && Wi(e);
                    ri(r, t, n, S(e)), e.options.lineWrapping || (r.iter(l, o.line + t.text.length, function(e) {
                        var t = N(e);
                        t > i.maxLineLength && (i.maxLine = e, i.maxLineLength = t, i.maxLineChanged = !0, a = !1)
                    }), a && (e.curOp.updateMaxLine = !0));
                    r.frontier = Math.min(r.frontier, o.line), Je(e, 400);
                    var c = t.text.length - (s.line - o.line) - 1;
                    t.full ? Kt(e) : o.line != s.line || 1 != t.text.length || ni(e.doc, t) ? Kt(e, o.line, s.line + 1, c) : Vt(e, o.line, "text");
                    var u = Ui(e, "changes"),
                        h = Ui(e, "change");
                    if (h || u) {
                        var d = {
                            from: o,
                            to: s,
                            text: t.text,
                            removed: t.removed,
                            origin: t.origin
                        };
                        h && zi(e, "change", e, d), u && (e.curOp.changeObjs || (e.curOp.changeObjs = [])).push(d)
                    }
                    e.display.selForContextMenu = null
                }(e.cm, t, r) : ri(e, t, r), qe(e, n, Yi)
            }
        }

        function Rn(e, t, n, r, i) {
            if (r || (r = n), he(r, n) < 0) {
                var o = r;
                r = n, n = o
            }
            "string" == typeof t && (t = Po(t)), Ln(e, {
                from: n,
                to: r,
                text: t,
                origin: i
            })
        }

        function Dn(e, t, n, r, i) {
            var o = e.display,
                s = At(e.display);
            n < 0 && (n = 0);
            var a = e.curOp && null != e.curOp.scrollTop ? e.curOp.scrollTop : o.scroller.scrollTop,
                l = st(e),
                c = {};
            l < i - n && (i = n + l);
            var u = e.doc.height + nt(o),
                h = n < s,
                d = u - s < i;
            if (n < a) c.scrollTop = h ? 0 : n;
            else if (a + l < i) {
                var f = Math.min(n, (d ? u : i) - l);
                f != a && (c.scrollTop = f)
            }
            var p = e.curOp && null != e.curOp.scrollLeft ? e.curOp.scrollLeft : o.scroller.scrollLeft,
                m = ot(e) - (e.options.fixedGutter ? o.gutters.offsetWidth : 0),
                g = m < r - t;
            return g && (r = t + m), t < 10 ? c.scrollLeft = 0 : t < p ? c.scrollLeft = Math.max(0, t - (g ? 0 : 10)) : m + p - 3 < r && (c.scrollLeft = r + (g ? 0 : 10) - m), c
        }

        function Pn(e, t, n) {
            null == t && null == n || Hn(e), null != t && (e.curOp.scrollLeft = (null == e.curOp.scrollLeft ? e.doc.scrollLeft : e.curOp.scrollLeft) + t), null != n && (e.curOp.scrollTop = (null == e.curOp.scrollTop ? e.doc.scrollTop : e.curOp.scrollTop) + n)
        }

        function $n(e) {
            Hn(e);
            var t = e.getCursor(),
                n = t,
                r = t;
            e.options.lineWrapping || (n = t.ch ? ue(t.line, t.ch - 1) : t, r = ue(t.line, t.ch + 1)), e.curOp.scrollToPos = {
                from: n,
                to: r,
                margin: e.options.cursorScrollMargin,
                isCursor: !0
            }
        }

        function Hn(e) {
            var t = e.curOp.scrollToPos;
            if (t) {
                e.curOp.scrollToPos = null;
                var n = Ct(e, t.from),
                    r = Ct(e, t.to),
                    i = Dn(e, Math.min(n.left, r.left), Math.min(n.top, r.top) - t.margin, Math.max(n.right, r.right), Math.max(n.bottom, r.bottom) + t.margin);
                e.scrollTo(i.scrollLeft, i.scrollTop)
            }
        }

        function Fn(e, t, n, r) {
            var i, o = e.doc;
            null == n && (n = "add"), "smart" == n && (o.mode.indent ? i = et(e, t) : n = "prev");
            var s = e.options.tabSize,
                a = di(o, t),
                l = Zi(a.text, null, s);
            a.stateAfter && (a.stateAfter = null);
            var c, u = a.text.match(/^\s*/)[0];
            if (r || /\S/.test(a.text)) {
                if ("smart" == n && ((c = o.mode.indent(i, a.text.slice(u.length), a.text)) == Gi || 150 < c)) {
                    if (!r) return;
                    n = "prev"
                }
            } else c = 0, n = "not";
            "prev" == n ? c = t > o.first ? Zi(di(o, t - 1).text, null, s) : 0 : "add" == n ? c = l + e.options.indentUnit : "subtract" == n ? c = l - e.options.indentUnit : "number" == typeof n && (c = l + n), c = Math.max(0, c);
            var h = "",
                d = 0;
            if (e.options.indentWithTabs)
                for (var f = Math.floor(c / s); f; --f) d += s, h += "\t";
            if (d < c && (h += no(c - d)), h != u) Rn(o, h, ue(t, 0), ue(t, u.length), "+input");
            else
                for (f = 0; f < o.sel.ranges.length; f++) {
                    var p = o.sel.ranges[f];
                    if (p.head.line == t && p.head.ch < u.length) {
                        He(o, f, new Le(d = ue(t, u.length), d));
                        break
                    }
                }
            a.stateAfter = null
        }

        function Bn(e, t, n, r) {
            var i = t,
                o = t;
            return "number" == typeof t ? o = di(e, Ie(e, t)) : i = gi(t), null == i ? null : (r(o, i) && e.cm && Vt(e.cm, i, n), o)
        }

        function zn(t, e) {
            for (var n = t.doc.sel.ranges, r = [], i = 0; i < n.length; i++) {
                for (var o = e(n[i]); r.length && he(o.from, ro(r).to) <= 0;) {
                    var s = r.pop();
                    if (he(s.from, o.from) < 0) {
                        o.from = s.from;
                        break
                    }
                }
                r.push(o)
            }
            Bt(t, function() {
                for (var e = r.length - 1; 0 <= e; e--) Rn(t.doc, "", r[e].from, r[e].to, "+delete");
                $n(t)
            })
        }

        function qn(r, e, i, t, o) {
            var s = e.line,
                a = e.ch,
                n = i,
                l = di(r, s),
                c = !0;

            function u(e) {
                var t, n = (o ? Xo : Qo)(l, a, i, !0);
                if (null == n) {
                    if (e || !((t = s + i) < r.first || t >= r.first + r.size ? c = !1 : l = di(r, s = t))) return c = !1;
                    a = o ? (i < 0 ? Uo : Wo)(l) : i < 0 ? l.text.length : 0
                } else a = n;
                return !0
            }
            if ("char" == t) u();
            else if ("column" == t) u(!0);
            else if ("word" == t || "group" == t)
                for (var h = null, d = "group" == t, f = r.cm && r.cm.getHelper(e, "wordChars"), p = !0; !(i < 0) || u(!p); p = !1) {
                    var m = l.text.charAt(a) || "\n",
                        g = po(m, f) ? "w" : d && "\n" == m ? "n" : !d || /\s/.test(m) ? null : "p";
                    if (!d || p || g || (g = "s"), h && h != g) {
                        i < 0 && (i = 1, u());
                        break
                    }
                    if (g && (h = g), 0 < i && !u(!p)) break
                }
            var v = Ke(r, ue(s, a), n, !0);
            return c || (v.hitSide = !0), v
        }

        function jn(e, t, n, r) {
            var i, o = e.doc,
                s = t.left;
            if ("page" == r) {
                var a = Math.min(e.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);
                i = t.top + n * (a - (n < 0 ? 1.5 : .5) * At(e.display))
            } else "line" == r && (i = 0 < n ? t.bottom + 3 : t.top - 3);
            for (;;) {
                var l = Tt(e, s, i);
                if (!l.outside) break;
                if (n < 0 ? i <= 0 : i >= o.height) {
                    l.hitSide = !0;
                    break
                }
                i += 5 * n
            }
            return l
        }
        b.prototype = {
            constructor: b,
            focus: function() {
                window.focus(), this.display.input.focus()
            },
            setOption: function(e, t) {
                var n = this.options,
                    r = n[e];
                n[e] == t && "mode" != e || (n[e] = t, Un.hasOwnProperty(e) && zt(this, Un[e])(this, t, r))
            },
            getOption: function(e) {
                return this.options[e]
            },
            getDoc: function() {
                return this.doc
            },
            addKeyMap: function(e, t) {
                this.state.keyMaps[t ? "push" : "unshift"](ar(e))
            },
            removeKeyMap: function(e) {
                for (var t = this.state.keyMaps, n = 0; n < t.length; ++n)
                    if (t[n] == e || t[n].name == e) return t.splice(n, 1), !0
            },
            addOverlay: qt(function(e, t) {
                var n = e.token ? e : b.getMode(this.options, e);
                if (n.startState) throw new Error("Overlays may not be stateful.");
                this.state.overlays.push({
                    mode: n,
                    modeSpec: e,
                    opaque: t && t.opaque
                }), this.state.modeGen++, Kt(this)
            }),
            removeOverlay: qt(function(e) {
                for (var t = this.state.overlays, n = 0; n < t.length; ++n) {
                    var r = t[n].modeSpec;
                    if (r == e || "string" == typeof e && r.name == e) return t.splice(n, 1), this.state.modeGen++, void Kt(this)
                }
            }),
            indentLine: qt(function(e, t, n) {
                "string" != typeof t && "number" != typeof t && (t = null == t ? this.options.smartIndent ? "smart" : "prev" : t ? "add" : "subtract"), Re(this.doc, e) && Fn(this, e, t, n)
            }),
            indentSelection: qt(function(e) {
                for (var t = this.doc.sel.ranges, n = -1, r = 0; r < t.length; r++) {
                    var i = t[r];
                    if (i.empty()) i.head.line > n && (Fn(this, i.head.line, e, !0), n = i.head.line, r == this.doc.sel.primIndex && $n(this));
                    else {
                        var o = i.from(),
                            s = i.to(),
                            a = Math.max(n, o.line);
                        n = Math.min(this.lastLine(), s.line - (s.ch ? 0 : 1)) + 1;
                        for (var l = a; l < n; ++l) Fn(this, l, e);
                        var c = this.doc.sel.ranges;
                        0 == o.ch && t.length == c.length && 0 < c[r].from().ch && He(this.doc, r, new Le(o, c[r].to()), Yi)
                    }
                }
            }),
            getTokenAt: function(e, t) {
                return qr(this, e, t)
            },
            getLineTokens: function(e, t) {
                return qr(this, ue(e), t, !0)
            },
            getTokenTypeAt: function(e) {
                e = Oe(this.doc, e);
                var t, n = Ur(this, di(this.doc, e.line)),
                    r = 0,
                    i = (n.length - 1) / 2,
                    o = e.ch;
                if (0 == o) t = n[2];
                else
                    for (;;) {
                        var s = r + i >> 1;
                        if ((s ? n[2 * s - 1] : 0) >= o) i = s;
                        else {
                            if (!(n[2 * s + 1] < o)) {
                                t = n[2 * s + 2];
                                break
                            }
                            r = s + 1
                        }
                    }
                var a = t ? t.indexOf("cm-overlay ") : -1;
                return a < 0 ? t : 0 == a ? null : t.slice(0, a - 1)
            },
            getModeAt: function(e) {
                var t = this.doc.mode;
                return t.innerMode ? b.innerMode(t, this.getTokenAt(e).state).mode : t
            },
            getHelper: function(e, t) {
                return this.getHelpers(e, t)[0]
            },
            getHelpers: function(e, t) {
                var n = [];
                if (!Jn.hasOwnProperty(t)) return n;
                var r = Jn[t],
                    i = this.getModeAt(e);
                if ("string" == typeof i[t]) r[i[t]] && n.push(r[i[t]]);
                else if (i[t])
                    for (var o = 0; o < i[t].length; o++) {
                        var s = r[i[t][o]];
                        s && n.push(s)
                    } else i.helperType && r[i.helperType] ? n.push(r[i.helperType]) : r[i.name] && n.push(r[i.name]);
                for (o = 0; o < r._global.length; o++) {
                    var a = r._global[o];
                    a.pred(i, this) && -1 == oo(n, a.val) && n.push(a.val)
                }
                return n
            },
            getStateAfter: function(e, t) {
                var n = this.doc;
                return et(this, (e = Ie(n, null == e ? n.first + n.size - 1 : e)) + 1, t)
            },
            cursorCoords: function(e, t) {
                var n = this.doc.sel.primary();
                return _t(this, null == e ? n.head : "object" == typeof e ? Oe(this.doc, e) : e ? n.from() : n.to(), t || "page")
            },
            charCoords: function(e, t) {
                return kt(this, Oe(this.doc, e), t || "page")
            },
            coordsChar: function(e, t) {
                return Tt(this, (e = wt(this, e, t || "page")).left, e.top)
            },
            lineAtHeight: function(e, t) {
                return e = wt(this, {
                    top: e,
                    left: 0
                }, t || "page").top, vi(this.doc, e + this.display.viewOffset)
            },
            heightAtLine: function(e, t) {
                var n = !1,
                    r = this.doc.first + this.doc.size - 1;
                e < this.doc.first ? e = this.doc.first : r < e && (e = r, n = !0);
                var i = di(this.doc, e);
                return xt(this, i, {
                    top: 0,
                    left: 0
                }, t || "page").top + (n ? this.doc.height - yi(i) : 0)
            },
            defaultTextHeight: function() {
                return At(this.display)
            },
            defaultCharWidth: function() {
                return Lt(this.display)
            },
            setGutterMarker: qt(function(e, n, r) {
                return Bn(this.doc, e, "gutter", function(e) {
                    var t = e.gutterMarkers || (e.gutterMarkers = {});
                    return !(t[n] = r) && mo(t) && (e.gutterMarkers = null), !0
                })
            }),
            clearGutter: qt(function(t) {
                var n = this,
                    e = n.doc,
                    r = e.first;
                e.iter(function(e) {
                    e.gutterMarkers && e.gutterMarkers[t] && (e.gutterMarkers[t] = null, Vt(n, r, "gutter"), mo(e.gutterMarkers) && (e.gutterMarkers = null)), ++r
                })
            }),
            lineInfo: function(e) {
                if ("number" == typeof e) {
                    if (!Re(this.doc, e)) return null;
                    var t = e;
                    if (!(e = di(this.doc, e))) return null
                } else {
                    if (null == (t = gi(e))) return null
                }
                return {
                    line: t,
                    handle: e,
                    text: e.text,
                    gutterMarkers: e.gutterMarkers,
                    textClass: e.textClass,
                    bgClass: e.bgClass,
                    wrapClass: e.wrapClass,
                    widgets: e.widgets
                }
            },
            getViewport: function() {
                return {
                    from: this.display.viewFrom,
                    to: this.display.viewTo
                }
            },
            addWidget: function(e, t, n, r, i) {
                var o, s, a, l, c, u, h = this.display,
                    d = (e = _t(this, Oe(this.doc, e))).bottom,
                    f = e.left;
                if (t.style.position = "absolute", t.setAttribute("cm-ignore-events", "true"), this.display.input.setUneditable(t), h.sizer.appendChild(t), "over" == r) d = e.top;
                else if ("above" == r || "near" == r) {
                    var p = Math.max(h.wrapper.clientHeight, this.doc.height),
                        m = Math.max(h.sizer.clientWidth, h.lineSpace.clientWidth);
                    ("above" == r || e.bottom + t.offsetHeight > p) && e.top > t.offsetHeight ? d = e.top - t.offsetHeight : e.bottom + t.offsetHeight <= p && (d = e.bottom), f + t.offsetWidth > m && (f = m - t.offsetWidth)
                }
                t.style.top = d + "px", t.style.left = t.style.right = "", "right" == i ? (f = h.sizer.clientWidth - t.offsetWidth, t.style.right = "0px") : ("left" == i ? f = 0 : "middle" == i && (f = (h.sizer.clientWidth - t.offsetWidth) / 2), t.style.left = f + "px"), n && (o = this, a = d, l = (s = f) + t.offsetWidth, c = d + t.offsetHeight, null != (u = Dn(o, s, a, l, c)).scrollTop && an(o, u.scrollTop), null != u.scrollLeft && ln(o, u.scrollLeft))
            },
            triggerOnKeyDown: qt(yn),
            triggerOnKeyPress: qt(xn),
            triggerOnKeyUp: bn,
            execCommand: function(e) {
                if (tr.hasOwnProperty(e)) return tr[e](this)
            },
            findPosH: function(e, t, n, r) {
                var i = 1;
                t < 0 && (i = -1, t = -t);
                for (var o = 0, s = Oe(this.doc, e); o < t && !(s = qn(this.doc, s, i, n, r)).hitSide; ++o);
                return s
            },
            moveH: qt(function(t, n) {
                var r = this;
                r.extendSelectionsBy(function(e) {
                    return r.display.shift || r.doc.extend || e.empty() ? qn(r.doc, e.head, t, n, r.options.rtlMoveVisually) : t < 0 ? e.from() : e.to()
                }, Qi)
            }),
            deleteH: qt(function(n, r) {
                var e = this.doc.sel,
                    i = this.doc;
                e.somethingSelected() ? i.replaceSelection("", null, "+delete") : zn(this, function(e) {
                    var t = qn(i, e.head, n, r, !1);
                    return n < 0 ? {
                        from: t,
                        to: e.head
                    } : {
                        from: e.head,
                        to: t
                    }
                })
            }),
            findPosV: function(e, t, n, r) {
                var i = 1,
                    o = r;
                t < 0 && (i = -1, t = -t);
                for (var s = 0, a = Oe(this.doc, e); s < t; ++s) {
                    var l = _t(this, a, "div");
                    if (null == o ? o = l.left : l.left = o, (a = jn(this, l, i, n)).hitSide) break
                }
                return a
            },
            moveV: qt(function(r, i) {
                var o = this,
                    s = this.doc,
                    a = [],
                    l = !o.display.shift && !s.extend && s.sel.somethingSelected();
                if (s.extendSelectionsBy(function(e) {
                        if (l) return r < 0 ? e.from() : e.to();
                        var t = _t(o, e.head, "div");
                        null != e.goalColumn && (t.left = e.goalColumn), a.push(t.left);
                        var n = jn(o, t, r, i);
                        return "page" == i && e == s.sel.primary() && Pn(o, null, kt(o, n, "div").top - t.top), n
                    }, Qi), a.length)
                    for (var e = 0; e < s.sel.ranges.length; e++) s.sel.ranges[e].goalColumn = a[e]
            }),
            findWordAt: function(e) {
                var t = di(this.doc, e.line).text,
                    n = e.ch,
                    r = e.ch;
                if (t) {
                    var i = this.getHelper(e, "wordChars");
                    (e.xRel < 0 || r == t.length) && n ? --n : ++r;
                    for (var o = t.charAt(n), s = po(o, i) ? function(e) {
                            return po(e, i)
                        } : /\s/.test(o) ? function(e) {
                            return /\s/.test(e)
                        } : function(e) {
                            return !/\s/.test(e) && !po(e)
                        }; 0 < n && s(t.charAt(n - 1));) --n;
                    for (; r < t.length && s(t.charAt(r));) ++r
                }
                return new Le(ue(e.line, n), ue(e.line, r))
            },
            toggleOverwrite: function(e) {
                null != e && e == this.state.overwrite || ((this.state.overwrite = !this.state.overwrite) ? To(this.display.cursorDiv, "CodeMirror-overwrite") : So(this.display.cursorDiv, "CodeMirror-overwrite"), Fi(this, "overwriteToggle", this, this.state.overwrite))
            },
            hasFocus: function() {
                return this.display.input.getField() == _o()
            },
            scrollTo: qt(function(e, t) {
                null == e && null == t || Hn(this), null != e && (this.curOp.scrollLeft = e), null != t && (this.curOp.scrollTop = t)
            }),
            getScrollInfo: function() {
                var e = this.display.scroller;
                return {
                    left: e.scrollLeft,
                    top: e.scrollTop,
                    height: e.scrollHeight - it(this) - this.display.barHeight,
                    width: e.scrollWidth - it(this) - this.display.barWidth,
                    clientHeight: st(this),
                    clientWidth: ot(this)
                }
            },
            scrollIntoView: qt(function(e, t) {
                if (null == e ? (e = {
                        from: this.doc.sel.primary().head,
                        to: null
                    }, null == t && (t = this.options.cursorScrollMargin)) : "number" == typeof e ? e = {
                        from: ue(e, 0),
                        to: null
                    } : null == e.from && (e = {
                        from: e,
                        to: null
                    }), e.to || (e.to = e.from), e.margin = t || 0, null != e.from.line) Hn(this), this.curOp.scrollToPos = e;
                else {
                    var n = Dn(this, Math.min(e.from.left, e.to.left), Math.min(e.from.top, e.to.top) - e.margin, Math.max(e.from.right, e.to.right), Math.max(e.from.bottom, e.to.bottom) + e.margin);
                    this.scrollTo(n.scrollLeft, n.scrollTop)
                }
            }),
            setSize: qt(function(e, t) {
                var n = this;

                function r(e) {
                    return "number" == typeof e || /^\d+$/.test(String(e)) ? e + "px" : e
                }
                null != e && (n.display.wrapper.style.width = r(e)), null != t && (n.display.wrapper.style.height = r(t)), n.options.lineWrapping && gt(this);
                var i = n.display.viewFrom;
                n.doc.iter(i, n.display.viewTo, function(e) {
                    if (e.widgets)
                        for (var t = 0; t < e.widgets.length; t++)
                            if (e.widgets[t].noHScroll) {
                                Vt(n, i, "widget");
                                break
                            }++ i
                }), n.curOp.forceUpdate = !0, Fi(n, "refresh", this)
            }),
            operation: function(e) {
                return Bt(this, e)
            },
            refresh: qt(function() {
                var e = this.display.cachedTextHeight;
                Kt(this), this.curOp.forceUpdate = !0, vt(this), this.scrollTo(this.doc.scrollLeft, this.doc.scrollTop), E(this), (null == e || .5 < Math.abs(e - At(this.display))) && T(this), Fi(this, "refresh", this)
            }),
            swapDoc: qt(function(e) {
                var t = this.doc;
                return t.cm = null, hi(this, e), vt(this), this.display.input.reset(), this.scrollTo(e.scrollLeft, e.scrollTop), this.curOp.forceScroll = !0, zi(this, "swapDoc", this, t), t
            }),
            getInputField: function() {
                return this.display.input.getField()
            },
            getWrapperElement: function() {
                return this.display.wrapper
            },
            getScrollerElement: function() {
                return this.display.scroller
            },
            getGutterElement: function() {
                return this.display.gutters
            }
        }, Ki(b);
        var Wn = b.defaults = {},
            Un = b.optionHandlers = {};

        function Kn(e, t, r, n) {
            b.defaults[e] = t, r && (Un[e] = n ? function(e, t, n) {
                n != Vn && r(e, t, n)
            } : r)
        }
        var Vn = b.Init = {
            toString: function() {
                return "CodeMirror.Init"
            }
        };
        Kn("value", "", function(e, t) {
            e.setValue(t)
        }, !0), Kn("mode", null, function(e, t) {
            e.doc.modeOption = t, _(e)
        }, !0), Kn("indentUnit", 2, _, !0), Kn("indentWithTabs", !1), Kn("smartIndent", !0), Kn("tabSize", 4, function(e) {
            C(e), vt(e), Kt(e)
        }, !0), Kn("specialChars", /[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g, function(e, t, n) {
            e.state.specialChars = new RegExp(t.source + (t.test("\t") ? "" : "|\t"), "g"), n != b.Init && e.refresh()
        }), Kn("specialCharPlaceholder", function(e) {
            var t = bo("span", "â€¢", "cm-invalidchar");
            return t.title = "\\u" + e.charCodeAt(0).toString(16), t.setAttribute("aria-label", t.title), t
        }, function(e) {
            e.refresh()
        }, !0), Kn("electricChars", !0), Kn("inputStyle", u ? "contenteditable" : "textarea", function() {
            throw new Error("inputStyle can not (yet) be changed in a running editor")
        }, !0), Kn("rtlMoveVisually", !o), Kn("wholeLineUpdateBefore", !0), Kn("theme", "default", function(e) {
            M(e), A(e)
        }, !0), Kn("keyMap", "default", function(e, t, n) {
            var r = ar(t),
                i = n != b.Init && ar(n);
            i && i.detach && i.detach(e, r), r.attach && r.attach(e, i || null)
        }), Kn("extraKeys", null), Kn("lineWrapping", !1, function(e) {
            e.options.lineWrapping ? (To(e.display.wrapper, "CodeMirror-wrap"), e.display.sizer.style.minWidth = "", e.display.sizerWidth = null) : (So(e.display.wrapper, "CodeMirror-wrap"), I(e)), T(e), Kt(e), vt(e), setTimeout(function() {
                H(e)
            }, 100)
        }, !0), Kn("gutters", [], function(e) {
            O(e.options), A(e)
        }, !0), Kn("fixedGutter", !0, function(e, t) {
            e.display.gutters.style.left = t ? W(e.display) + "px" : "0", e.refresh()
        }, !0), Kn("coverGutterNextToScrollbar", !1, function(e) {
            H(e)
        }, !0), Kn("scrollbarStyle", "native", function(e) {
            $(e), H(e), e.display.scrollbars.setScrollTop(e.doc.scrollTop), e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)
        }, !0), Kn("lineNumbers", !1, function(e) {
            O(e.options), A(e)
        }, !0), Kn("firstLineNumber", 1, A, !0), Kn("lineNumberFormatter", function(e) {
            return e
        }, A, !0), Kn("showCursorWhenSelecting", !1, Ve, !0), Kn("resetSelectionOnContextMenu", !0), Kn("readOnly", !1, function(e, t) {
            "nocursor" == t ? (kn(e), e.display.input.blur(), e.display.disabled = !0) : (e.display.disabled = !1, t || e.display.input.reset())
        }), Kn("disableInput", !1, function(e, t) {
            t || e.display.input.reset()
        }, !0), Kn("dragDrop", !0), Kn("cursorBlinkRate", 530), Kn("cursorScrollMargin", 0), Kn("cursorHeight", 1, Ve, !0), Kn("singleCursorHeightPerLine", !0, Ve, !0), Kn("workTime", 100), Kn("workDelay", 100), Kn("flattenSpans", !0, C, !0), Kn("addModeClass", !1, C, !0), Kn("pollInterval", 100), Kn("undoDepth", 200, function(e, t) {
            e.doc.history.undoDepth = t
        }), Kn("historyEventDelay", 1250), Kn("viewportMargin", 10, function(e) {
            e.refresh()
        }, !0), Kn("maxHighlightLength", 1e4, C, !0), Kn("moveInputWithCursor", !0, function(e, t) {
            t || e.display.input.resetPosition()
        }), Kn("tabindex", null, function(e, t) {
            e.display.input.getField().tabIndex = t || ""
        }), Kn("autofocus", null);
        var Gn = b.modes = {},
            Yn = b.mimeModes = {};
        b.defineMode = function(e, t) {
            b.defaults.mode || "null" == e || (b.defaults.mode = e), 2 < arguments.length && (t.dependencies = Array.prototype.slice.call(arguments, 2)), Gn[e] = t
        }, b.defineMIME = function(e, t) {
            Yn[e] = t
        }, b.resolveMode = function(e) {
            if ("string" == typeof e && Yn.hasOwnProperty(e)) e = Yn[e];
            else if (e && "string" == typeof e.name && Yn.hasOwnProperty(e.name)) {
                var t = Yn[e.name];
                "string" == typeof t && (t = {
                    name: t
                }), (e = lo(t, e)).name = t.name
            } else if ("string" == typeof e && /^[\w\-]+\/[\w\-]+\+xml$/.test(e)) return b.resolveMode("application/xml");
            return "string" == typeof e ? {
                name: e
            } : e || {
                name: "null"
            }
        }, b.getMode = function(e, t) {
            t = b.resolveMode(t);
            var n = Gn[t.name];
            if (!n) return b.getMode(e, "text/plain");
            var r = n(e, t);
            if (Xn.hasOwnProperty(t.name)) {
                var i = Xn[t.name];
                for (var o in i) i.hasOwnProperty(o) && (r.hasOwnProperty(o) && (r["_" + o] = r[o]), r[o] = i[o])
            }
            if (r.name = t.name, t.helperType && (r.helperType = t.helperType), t.modeProps)
                for (var o in t.modeProps) r[o] = t.modeProps[o];
            return r
        }, b.defineMode("null", function() {
            return {
                token: function(e) {
                    e.skipToEnd()
                }
            }
        }), b.defineMIME("text/plain", "null");
        var Xn = b.modeExtensions = {};
        b.extendMode = function(e, t) {
            co(t, Xn.hasOwnProperty(e) ? Xn[e] : Xn[e] = {})
        }, b.defineExtension = function(e, t) {
            b.prototype[e] = t
        }, b.defineDocExtension = function(e, t) {
            ai.prototype[e] = t
        }, b.defineOption = Kn;
        var Qn = [];
        b.defineInitHook = function(e) {
            Qn.push(e)
        };
        var Jn = b.helpers = {};
        b.registerHelper = function(e, t, n) {
            Jn.hasOwnProperty(e) || (Jn[e] = b[e] = {
                _global: []
            }), Jn[e][t] = n
        }, b.registerGlobalHelper = function(e, t, n, r) {
            b.registerHelper(e, t, r), Jn[e]._global.push({
                pred: n,
                val: r
            })
        };
        var Zn = b.copyState = function(e, t) {
                if (!0 === t) return t;
                if (e.copyState) return e.copyState(t);
                var n = {};
                for (var r in t) {
                    var i = t[r];
                    i instanceof Array && (i = i.concat([])), n[r] = i
                }
                return n
            },
            er = b.startState = function(e, t, n) {
                return !e.startState || e.startState(t, n)
            };
        b.innerMode = function(e, t) {
            for (; e.innerMode;) {
                var n = e.innerMode(t);
                if (!n || n.mode == e) break;
                t = n.state, e = n.mode
            }
            return n || {
                mode: e,
                state: t
            }
        };
        var tr = b.commands = {
                selectAll: function(e) {
                    e.setSelection(ue(e.firstLine(), 0), ue(e.lastLine()), Yi)
                },
                singleSelection: function(e) {
                    e.setSelection(e.getCursor("anchor"), e.getCursor("head"), Yi)
                },
                killLine: function(n) {
                    zn(n, function(e) {
                        if (e.empty()) {
                            var t = di(n.doc, e.head.line).text.length;
                            return e.head.ch == t && e.head.line < n.lastLine() ? {
                                from: e.head,
                                to: ue(e.head.line + 1, 0)
                            } : {
                                from: e.head,
                                to: ue(e.head.line, t)
                            }
                        }
                        return {
                            from: e.from(),
                            to: e.to()
                        }
                    })
                },
                deleteLine: function(t) {
                    zn(t, function(e) {
                        return {
                            from: ue(e.from().line, 0),
                            to: Oe(t.doc, ue(e.to().line + 1, 0))
                        }
                    })
                },
                delLineLeft: function(e) {
                    zn(e, function(e) {
                        return {
                            from: ue(e.from().line, 0),
                            to: e.from()
                        }
                    })
                },
                delWrappedLineLeft: function(n) {
                    zn(n, function(e) {
                        var t = n.charCoords(e.head, "div").top + 5;
                        return {
                            from: n.coordsChar({
                                left: 0,
                                top: t
                            }, "div"),
                            to: e.from()
                        }
                    })
                },
                delWrappedLineRight: function(r) {
                    zn(r, function(e) {
                        var t = r.charCoords(e.head, "div").top + 5,
                            n = r.coordsChar({
                                left: r.display.lineDiv.offsetWidth + 100,
                                top: t
                            }, "div");
                        return {
                            from: e.from(),
                            to: n
                        }
                    })
                },
                undo: function(e) {
                    e.undo()
                },
                redo: function(e) {
                    e.redo()
                },
                undoSelection: function(e) {
                    e.undoSelection()
                },
                redoSelection: function(e) {
                    e.redoSelection()
                },
                goDocStart: function(e) {
                    e.extendSelection(ue(e.firstLine(), 0))
                },
                goDocEnd: function(e) {
                    e.extendSelection(ue(e.lastLine()))
                },
                goLineStart: function(t) {
                    t.extendSelectionsBy(function(e) {
                        return Ko(t, e.head.line)
                    }, {
                        origin: "+move",
                        bias: 1
                    })
                },
                goLineStartSmart: function(t) {
                    t.extendSelectionsBy(function(e) {
                        return Vo(t, e.head)
                    }, {
                        origin: "+move",
                        bias: 1
                    })
                },
                goLineEnd: function(t) {
                    t.extendSelectionsBy(function(e) {
                        return function(e, t) {
                            var n, r = di(e.doc, t);
                            for (; n = Ar(r);) r = n.find(1, !0).line, t = null;
                            var i = bi(r),
                                o = i ? i[0].level % 2 ? Wo(r) : Uo(r) : r.text.length;
                            return ue(null == t ? gi(r) : t, o)
                        }(t, e.head.line)
                    }, {
                        origin: "+move",
                        bias: -1
                    })
                },
                goLineRight: function(n) {
                    n.extendSelectionsBy(function(e) {
                        var t = n.charCoords(e.head, "div").top + 5;
                        return n.coordsChar({
                            left: n.display.lineDiv.offsetWidth + 100,
                            top: t
                        }, "div")
                    }, Qi)
                },
                goLineLeft: function(n) {
                    n.extendSelectionsBy(function(e) {
                        var t = n.charCoords(e.head, "div").top + 5;
                        return n.coordsChar({
                            left: 0,
                            top: t
                        }, "div")
                    }, Qi)
                },
                goLineLeftSmart: function(r) {
                    r.extendSelectionsBy(function(e) {
                        var t = r.charCoords(e.head, "div").top + 5,
                            n = r.coordsChar({
                                left: 0,
                                top: t
                            }, "div");
                        return n.ch < r.getLine(n.line).search(/\S/) ? Vo(r, e.head) : n
                    }, Qi)
                },
                goLineUp: function(e) {
                    e.moveV(-1, "line")
                },
                goLineDown: function(e) {
                    e.moveV(1, "line")
                },
                goPageUp: function(e) {
                    e.moveV(-1, "page")
                },
                goPageDown: function(e) {
                    e.moveV(1, "page")
                },
                goCharLeft: function(e) {
                    e.moveH(-1, "char")
                },
                goCharRight: function(e) {
                    e.moveH(1, "char")
                },
                goColumnLeft: function(e) {
                    e.moveH(-1, "column")
                },
                goColumnRight: function(e) {
                    e.moveH(1, "column")
                },
                goWordLeft: function(e) {
                    e.moveH(-1, "word")
                },
                goGroupRight: function(e) {
                    e.moveH(1, "group")
                },
                goGroupLeft: function(e) {
                    e.moveH(-1, "group")
                },
                goWordRight: function(e) {
                    e.moveH(1, "word")
                },
                delCharBefore: function(e) {
                    e.deleteH(-1, "char")
                },
                delCharAfter: function(e) {
                    e.deleteH(1, "char")
                },
                delWordBefore: function(e) {
                    e.deleteH(-1, "word")
                },
                delWordAfter: function(e) {
                    e.deleteH(1, "word")
                },
                delGroupBefore: function(e) {
                    e.deleteH(-1, "group")
                },
                delGroupAfter: function(e) {
                    e.deleteH(1, "group")
                },
                indentAuto: function(e) {
                    e.indentSelection("smart")
                },
                indentMore: function(e) {
                    e.indentSelection("add")
                },
                indentLess: function(e) {
                    e.indentSelection("subtract")
                },
                insertTab: function(e) {
                    e.replaceSelection("\t")
                },
                insertSoftTab: function(e) {
                    for (var t = [], n = e.listSelections(), r = e.options.tabSize, i = 0; i < n.length; i++) {
                        var o = n[i].from(),
                            s = Zi(e.getLine(o.line), o.ch, r);
                        t.push(new Array(r - s % r + 1).join(" "))
                    }
                    e.replaceSelections(t)
                },
                defaultTab: function(e) {
                    e.somethingSelected() ? e.indentSelection("add") : e.execCommand("insertTab")
                },
                transposeChars: function(s) {
                    Bt(s, function() {
                        for (var e = s.listSelections(), t = [], n = 0; n < e.length; n++) {
                            var r = e[n].head,
                                i = di(s.doc, r.line).text;
                            if (i)
                                if (r.ch == i.length && (r = new ue(r.line, r.ch - 1)), 0 < r.ch) r = new ue(r.line, r.ch + 1), s.replaceRange(i.charAt(r.ch - 1) + i.charAt(r.ch - 2), ue(r.line, r.ch - 2), r, "+transpose");
                                else if (r.line > s.doc.first) {
                                var o = di(s.doc, r.line - 1).text;
                                o && s.replaceRange(i.charAt(0) + "\n" + o.charAt(o.length - 1), ue(r.line - 1, o.length - 1), ue(r.line, 1), "+transpose")
                            }
                            t.push(new Le(r, r))
                        }
                        s.setSelections(t)
                    })
                },
                newlineAndIndent: function(r) {
                    Bt(r, function() {
                        for (var e = r.listSelections().length, t = 0; t < e; t++) {
                            var n = r.listSelections()[t];
                            r.replaceRange("\n", n.anchor, n.head, "+input"), r.indentLine(n.from().line + 1, null, !0), $n(r)
                        }
                    })
                },
                toggleOverwrite: function(e) {
                    e.toggleOverwrite()
                }
            },
            nr = b.keyMap = {};

        function rr(e) {
            for (var t, n, r, i, o = e.split(/-(?!$)/), s = (e = o[o.length - 1], 0); s < o.length - 1; s++) {
                var a = o[s];
                if (/^(cmd|meta|m)$/i.test(a)) i = !0;
                else if (/^a(lt)?$/i.test(a)) t = !0;
                else if (/^(c|ctrl|control)$/i.test(a)) n = !0;
                else {
                    if (!/^s(hift)$/i.test(a)) throw new Error("Unrecognized modifier name: " + a);
                    r = !0
                }
            }
            return t && (e = "Alt-" + e), n && (e = "Ctrl-" + e), i && (e = "Cmd-" + e), r && (e = "Shift-" + e), e
        }
        nr.basic = {
            Left: "goCharLeft",
            Right: "goCharRight",
            Up: "goLineUp",
            Down: "goLineDown",
            End: "goLineEnd",
            Home: "goLineStartSmart",
            PageUp: "goPageUp",
            PageDown: "goPageDown",
            Delete: "delCharAfter",
            Backspace: "delCharBefore",
            "Shift-Backspace": "delCharBefore",
            Tab: "defaultTab",
            "Shift-Tab": "indentAuto",
            Enter: "newlineAndIndent",
            Insert: "toggleOverwrite",
            Esc: "singleSelection"
        }, nr.pcDefault = {
            "Ctrl-A": "selectAll",
            "Ctrl-D": "deleteLine",
            "Ctrl-Z": "undo",
            "Shift-Ctrl-Z": "redo",
            "Ctrl-Y": "redo",
            "Ctrl-Home": "goDocStart",
            "Ctrl-End": "goDocEnd",
            "Ctrl-Up": "goLineUp",
            "Ctrl-Down": "goLineDown",
            "Ctrl-Left": "goGroupLeft",
            "Ctrl-Right": "goGroupRight",
            "Alt-Left": "goLineStart",
            "Alt-Right": "goLineEnd",
            "Ctrl-Backspace": "delGroupBefore",
            "Ctrl-Delete": "delGroupAfter",
            "Ctrl-S": "save",
            "Ctrl-F": "find",
            "Ctrl-G": "findNext",
            "Shift-Ctrl-G": "findPrev",
            "Shift-Ctrl-F": "replace",
            "Shift-Ctrl-R": "replaceAll",
            "Ctrl-[": "indentLess",
            "Ctrl-]": "indentMore",
            "Ctrl-U": "undoSelection",
            "Shift-Ctrl-U": "redoSelection",
            "Alt-U": "redoSelection",
            fallthrough: "basic"
        }, nr.emacsy = {
            "Ctrl-F": "goCharRight",
            "Ctrl-B": "goCharLeft",
            "Ctrl-P": "goLineUp",
            "Ctrl-N": "goLineDown",
            "Alt-F": "goWordRight",
            "Alt-B": "goWordLeft",
            "Ctrl-A": "goLineStart",
            "Ctrl-E": "goLineEnd",
            "Ctrl-V": "goPageDown",
            "Shift-Ctrl-V": "goPageUp",
            "Ctrl-D": "delCharAfter",
            "Ctrl-H": "delCharBefore",
            "Alt-D": "delWordAfter",
            "Alt-Backspace": "delWordBefore",
            "Ctrl-K": "killLine",
            "Ctrl-T": "transposeChars"
        }, nr.macDefault = {
            "Cmd-A": "selectAll",
            "Cmd-D": "deleteLine",
            "Cmd-Z": "undo",
            "Shift-Cmd-Z": "redo",
            "Cmd-Y": "redo",
            "Cmd-Home": "goDocStart",
            "Cmd-Up": "goDocStart",
            "Cmd-End": "goDocEnd",
            "Cmd-Down": "goDocEnd",
            "Alt-Left": "goGroupLeft",
            "Alt-Right": "goGroupRight",
            "Cmd-Left": "goLineLeft",
            "Cmd-Right": "goLineRight",
            "Alt-Backspace": "delGroupBefore",
            "Ctrl-Alt-Backspace": "delGroupAfter",
            "Alt-Delete": "delGroupAfter",
            "Cmd-S": "save",
            "Cmd-F": "find",
            "Cmd-G": "findNext",
            "Shift-Cmd-G": "findPrev",
            "Cmd-Alt-F": "replace",
            "Shift-Cmd-Alt-F": "replaceAll",
            "Cmd-[": "indentLess",
            "Cmd-]": "indentMore",
            "Cmd-Backspace": "delWrappedLineLeft",
            "Cmd-Delete": "delWrappedLineRight",
            "Cmd-U": "undoSelection",
            "Shift-Cmd-U": "redoSelection",
            "Ctrl-Up": "goDocStart",
            "Ctrl-Down": "goDocEnd",
            fallthrough: ["basic", "emacsy"]
        }, nr.default = g ? nr.macDefault : nr.pcDefault, b.normalizeKeyMap = function(e) {
            var t = {};
            for (var n in e)
                if (e.hasOwnProperty(n)) {
                    var r = e[n];
                    if (/^(name|fallthrough|(de|at)tach)$/.test(n)) continue;
                    if ("..." == r) {
                        delete e[n];
                        continue
                    }
                    for (var i = so(n.split(" "), rr), o = 0; o < i.length; o++) {
                        var s, a;
                        s = o == i.length - 1 ? (a = n, r) : (a = i.slice(0, o + 1).join(" "), "...");
                        var l = t[a];
                        if (l) {
                            if (l != s) throw new Error("Inconsistent bindings for " + a)
                        } else t[a] = s
                    }
                    delete e[n]
                } for (var c in t) e[c] = t[c];
            return e
        };
        var ir = b.lookupKey = function(e, t, n, r) {
                var i = (t = ar(t)).call ? t.call(e, r) : t[e];
                if (!1 === i) return "nothing";
                if ("..." === i) return "multi";
                if (null != i && n(i)) return "handled";
                if (t.fallthrough) {
                    if ("[object Array]" != Object.prototype.toString.call(t.fallthrough)) return ir(e, t.fallthrough, n, r);
                    for (var o = 0; o < t.fallthrough.length; o++) {
                        var s = ir(e, t.fallthrough[o], n, r);
                        if (s) return s
                    }
                }
            },
            or = b.isModifierKey = function(e) {
                var t = "string" == typeof e ? e : zo[e.keyCode];
                return "Ctrl" == t || "Alt" == t || "Shift" == t || "Mod" == t
            },
            sr = b.keyName = function(e, t) {
                if (m && 34 == e.keyCode && e.char) return !1;
                var n = zo[e.keyCode],
                    r = n;
                return null != r && !e.altGraphKey && (e.altKey && "Alt" != n && (r = "Alt-" + r), (h ? e.metaKey : e.ctrlKey) && "Ctrl" != n && (r = "Ctrl-" + r), (h ? e.ctrlKey : e.metaKey) && "Cmd" != n && (r = "Cmd-" + r), !t && e.shiftKey && "Shift" != n && (r = "Shift-" + r), r)
            };

        function ar(e) {
            return "string" == typeof e ? nr[e] : e
        }
        b.fromTextArea = function(t, e) {
            if ((e = e ? co(e) : {}).value = t.value, !e.tabindex && t.tabIndex && (e.tabindex = t.tabIndex), !e.placeholder && t.placeholder && (e.placeholder = t.placeholder), null == e.autofocus) {
                var n = _o();
                e.autofocus = n == t || null != t.getAttribute("autofocus") && n == document.body
            }

            function r() {
                t.value = a.getValue()
            }
            if (t.form && ($i(t.form, "submit", r), !e.leaveSubmitMethodAlone)) {
                var i = t.form,
                    o = i.submit;
                try {
                    var s = i.submit = function() {
                        r(), i.submit = o, i.submit(), i.submit = s
                    }
                } catch (e) {}
            }
            e.finishInit = function(e) {
                e.save = r, e.getTextArea = function() {
                    return t
                }, e.toTextArea = function() {
                    e.toTextArea = isNaN, r(), t.parentNode.removeChild(e.getWrapperElement()), t.style.display = "", t.form && (Hi(t.form, "submit", r), "function" == typeof t.form.submit && (t.form.submit = o))
                }
            }, t.style.display = "none";
            var a = b(function(e) {
                t.parentNode.insertBefore(e, t.nextSibling)
            }, e);
            return a
        };
        var lr = b.StringStream = function(e, t) {
            this.pos = this.start = 0, this.string = e, this.tabSize = t || 8, this.lastColumnPos = this.lastColumnValue = 0, this.lineStart = 0
        };
        lr.prototype = {
            eol: function() {
                return this.pos >= this.string.length
            },
            sol: function() {
                return this.pos == this.lineStart
            },
            peek: function() {
                return this.string.charAt(this.pos) || void 0
            },
            next: function() {
                if (this.pos < this.string.length) return this.string.charAt(this.pos++)
            },
            eat: function(e) {
                var t = this.string.charAt(this.pos);
                if ("string" == typeof e) var n = t == e;
                else n = t && (e.test ? e.test(t) : e(t));
                if (n) return ++this.pos, t
            },
            eatWhile: function(e) {
                for (var t = this.pos; this.eat(e););
                return this.pos > t
            },
            eatSpace: function() {
                for (var e = this.pos;
                    /[\s\u00a0]/.test(this.string.charAt(this.pos));) ++this.pos;
                return this.pos > e
            },
            skipToEnd: function() {
                this.pos = this.string.length
            },
            skipTo: function(e) {
                var t = this.string.indexOf(e, this.pos);
                if (-1 < t) return this.pos = t, !0
            },
            backUp: function(e) {
                this.pos -= e
            },
            column: function() {
                return this.lastColumnPos < this.start && (this.lastColumnValue = Zi(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue), this.lastColumnPos = this.start), this.lastColumnValue - (this.lineStart ? Zi(this.string, this.lineStart, this.tabSize) : 0)
            },
            indentation: function() {
                return Zi(this.string, null, this.tabSize) - (this.lineStart ? Zi(this.string, this.lineStart, this.tabSize) : 0)
            },
            match: function(e, t, n) {
                if ("string" != typeof e) {
                    var r = this.string.slice(this.pos).match(e);
                    return r && 0 < r.index ? null : (r && !1 !== t && (this.pos += r[0].length), r)
                }
                var i = function(e) {
                    return n ? e.toLowerCase() : e
                };
                if (i(this.string.substr(this.pos, e.length)) == i(e)) return !1 !== t && (this.pos += e.length), !0
            },
            current: function() {
                return this.string.slice(this.start, this.pos)
            },
            hideFirstChars: function(e, t) {
                this.lineStart += e;
                try {
                    return t()
                } finally {
                    this.lineStart -= e
                }
            }
        };
        var cr = 0,
            ur = b.TextMarker = function(e, t) {
                this.lines = [], this.type = t, this.doc = e, this.id = ++cr
            };
        Ki(ur), ur.prototype.clear = function() {
            if (!this.explicitlyCleared) {
                var e = this.doc.cm,
                    t = e && !e.curOp;
                if (t && Rt(e), Ui(this, "clear")) {
                    var n = this.find();
                    n && zi(this, "clear", n.from, n.to)
                }
                for (var r = null, i = null, o = 0; o < this.lines.length; ++o) {
                    var s = this.lines[o],
                        a = gr(s.markedSpans, this);
                    e && !this.collapsed ? Vt(e, gi(s), "text") : e && (null != a.to && (i = gi(s)), null != a.from && (r = gi(s))), s.markedSpans = vr(s.markedSpans, a), null == a.from && this.collapsed && !Or(this.doc, s) && e && mi(s, At(e.display))
                }
                if (e && this.collapsed && !e.options.lineWrapping)
                    for (o = 0; o < this.lines.length; ++o) {
                        var l = Er(this.lines[o]),
                            c = N(l);
                        c > e.display.maxLineLength && (e.display.maxLine = l, e.display.maxLineLength = c, e.display.maxLineChanged = !0)
                    }
                null != r && e && this.collapsed && Kt(e, r, i + 1), this.lines.length = 0, this.explicitlyCleared = !0, this.atomic && this.doc.cantEdit && (this.doc.cantEdit = !1, e && We(e.doc)), e && zi(e, "markerCleared", e, this), t && Dt(e), this.parent && this.parent.clear()
            }
        }, ur.prototype.find = function(e, t) {
            var n, r;
            null == e && "bookmark" == this.type && (e = 1);
            for (var i = 0; i < this.lines.length; ++i) {
                var o = this.lines[i],
                    s = gr(o.markedSpans, this);
                if (null != s.from && (n = ue(t ? o : gi(o), s.from), -1 == e)) return n;
                if (null != s.to && (r = ue(t ? o : gi(o), s.to), 1 == e)) return r
            }
            return n && {
                from: n,
                to: r
            }
        }, ur.prototype.changed = function() {
            var o = this.find(-1, !0),
                s = this,
                a = this.doc.cm;
            o && a && Bt(a, function() {
                var e = o.line,
                    t = gi(o.line),
                    n = ct(a, t);
                if (n && (mt(n), a.curOp.selectionChanged = a.curOp.forceUpdate = !0), a.curOp.updateMaxLine = !0, !Or(s.doc, e) && null != s.height) {
                    var r = s.height;
                    s.height = null;
                    var i = $r(s) - r;
                    i && mi(e, e.height + i)
                }
            })
        }, ur.prototype.attachLine = function(e) {
            if (!this.lines.length && this.doc.cm) {
                var t = this.doc.cm.curOp;
                t.maybeHiddenMarkers && -1 != oo(t.maybeHiddenMarkers, this) || (t.maybeUnhiddenMarkers || (t.maybeUnhiddenMarkers = [])).push(this)
            }
            this.lines.push(e)
        }, ur.prototype.detachLine = function(e) {
            if (this.lines.splice(oo(this.lines, e), 1), !this.lines.length && this.doc.cm) {
                var t = this.doc.cm.curOp;
                (t.maybeHiddenMarkers || (t.maybeHiddenMarkers = [])).push(this)
            }
        };
        cr = 0;

        function hr(t, r, i, e, n) {
            if (e && e.shared) return function(e, n, r, i, o) {
                (i = co(i)).shared = !1;
                var s = [hr(e, n, r, i, o)],
                    a = s[0],
                    l = i.widgetNode;
                return ui(e, function(e) {
                    l && (i.widgetNode = l.cloneNode(!0)), s.push(hr(e, Oe(e, n), Oe(e, r), i, o));
                    for (var t = 0; t < e.linked.length; ++t)
                        if (e.linked[t].isParent) return;
                    a = ro(s)
                }), new dr(s, a)
            }(t, r, i, e, n);
            if (t.cm && !t.cm.curOp) return zt(t.cm, hr)(t, r, i, e, n);
            var o = new ur(t, n),
                s = he(r, i);
            if (e && co(e, o, !1), 0 < s || 0 == s && !1 !== o.clearWhenEmpty) return o;
            if (o.replacedWith && (o.collapsed = !0, o.widgetNode = bo("span", [o.replacedWith], "CodeMirror-widget"), e.handleMouseEvents || o.widgetNode.setAttribute("cm-ignore-events", "true"), e.insertLeft && (o.widgetNode.insertLeft = !0)), o.collapsed) {
                if (Lr(t, r.line, r, i, o) || r.line != i.line && Lr(t, i.line, r, i, o)) throw new Error("Inserting collapsed marker partially overlapping an existing one");
                y = !0
            }
            o.addToHistory && _i(t, {
                from: r,
                to: i,
                origin: "markText"
            }, t.sel, NaN);
            var a, l = r.line,
                c = t.cm;
            if (t.iter(l, i.line + 1, function(e) {
                    var t, n;
                    c && o.collapsed && !c.options.lineWrapping && Er(e) == c.display.maxLine && (a = !0), o.collapsed && l != r.line && mi(e, 0), t = e, n = new mr(o, l == r.line ? r.ch : null, l == i.line ? i.ch : null), t.markedSpans = t.markedSpans ? t.markedSpans.concat([n]) : [n], n.marker.attachLine(t), ++l
                }), o.collapsed && t.iter(r.line, i.line + 1, function(e) {
                    Or(t, e) && mi(e, 0)
                }), o.clearOnEnter && $i(o, "beforeCursorEnter", function() {
                    o.clear()
                }), o.readOnly && (v = !0, (t.history.done.length || t.history.undone.length) && t.clearHistory()), o.collapsed && (o.id = ++cr, o.atomic = !0), c) {
                if (a && (c.curOp.updateMaxLine = !0), o.collapsed) Kt(c, r.line, i.line + 1);
                else if (o.className || o.title || o.startStyle || o.endStyle || o.css)
                    for (var u = r.line; u <= i.line; u++) Vt(c, u, "text");
                o.atomic && We(c.doc), zi(c, "markerAdded", c, o)
            }
            return o
        }
        var dr = b.SharedTextMarker = function(e, t) {
            this.markers = e, this.primary = t;
            for (var n = 0; n < e.length; ++n) e[n].parent = this
        };

        function fr(e) {
            return e.findMarks(ue(e.first, 0), e.clipPos(ue(e.lastLine())), function(e) {
                return e.parent
            })
        }

        function pr(e) {
            for (var t = 0; t < e.length; t++) {
                var n = e[t],
                    r = [n.primary.doc];
                ui(n.primary.doc, function(e) {
                    r.push(e)
                });
                for (var i = 0; i < n.markers.length; i++) {
                    var o = n.markers[i]; - 1 == oo(r, o.doc) && (o.parent = null, n.markers.splice(i--, 1))
                }
            }
        }

        function mr(e, t, n) {
            this.marker = e, this.from = t, this.to = n
        }

        function gr(e, t) {
            if (e)
                for (var n = 0; n < e.length; ++n) {
                    var r = e[n];
                    if (r.marker == t) return r
                }
        }

        function vr(e, t) {
            for (var n, r = 0; r < e.length; ++r) e[r] != t && (n || (n = [])).push(e[r]);
            return n
        }

        function yr(e, t) {
            if (t.full) return null;
            var n = Re(e, t.from.line) && di(e, t.from.line).markedSpans,
                r = Re(e, t.to.line) && di(e, t.to.line).markedSpans;
            if (!n && !r) return null;
            var i = t.from.ch,
                o = t.to.ch,
                s = 0 == he(t.from, t.to),
                a = function(e, t, n) {
                    if (e)
                        for (var r, i = 0; i < e.length; ++i) {
                            var o = e[i],
                                s = o.marker;
                            if (null == o.from || (s.inclusiveLeft ? o.from <= t : o.from < t) || o.from == t && "bookmark" == s.type && (!n || !o.marker.insertLeft)) {
                                var a = null == o.to || (s.inclusiveRight ? o.to >= t : o.to > t);
                                (r || (r = [])).push(new mr(s, o.from, a ? null : o.to))
                            }
                        }
                    return r
                }(n, i, s),
                l = function(e, t, n) {
                    if (e)
                        for (var r, i = 0; i < e.length; ++i) {
                            var o = e[i],
                                s = o.marker;
                            if (null == o.to || (s.inclusiveRight ? o.to >= t : o.to > t) || o.from == t && "bookmark" == s.type && (!n || o.marker.insertLeft)) {
                                var a = null == o.from || (s.inclusiveLeft ? o.from <= t : o.from < t);
                                (r || (r = [])).push(new mr(s, a ? null : o.from - t, null == o.to ? null : o.to - t))
                            }
                        }
                    return r
                }(r, o, s),
                c = 1 == t.text.length,
                u = ro(t.text).length + (c ? i : 0);
            if (a)
                for (var h = 0; h < a.length; ++h) {
                    if (null == (d = a[h]).to)(f = gr(l, d.marker)) ? c && (d.to = null == f.to ? null : f.to + u) : d.to = i
                }
            if (l)
                for (h = 0; h < l.length; ++h) {
                    var d, f;
                    if (null != (d = l[h]).to && (d.to += u), null == d.from)(f = gr(a, d.marker)) || (d.from = u, c && (a || (a = [])).push(d));
                    else d.from += u, c && (a || (a = [])).push(d)
                }
            a && (a = br(a)), l && l != a && (l = br(l));
            var p = [a];
            if (!c) {
                var m, g = t.text.length - 2;
                if (0 < g && a)
                    for (h = 0; h < a.length; ++h) null == a[h].to && (m || (m = [])).push(new mr(a[h].marker, null, null));
                for (h = 0; h < g; ++h) p.push(m);
                p.push(l)
            }
            return p
        }

        function br(e) {
            for (var t = 0; t < e.length; ++t) {
                var n = e[t];
                null != n.from && n.from == n.to && !1 !== n.marker.clearWhenEmpty && e.splice(t--, 1)
            }
            return e.length ? e : null
        }

        function xr(e, t) {
            var n = function(e, t) {
                    var n = t["spans_" + e.id];
                    if (!n) return null;
                    for (var r = 0, i = []; r < t.text.length; ++r) i.push(Ti(n[r]));
                    return i
                }(e, t),
                r = yr(e, t);
            if (!n) return r;
            if (!r) return n;
            for (var i = 0; i < n.length; ++i) {
                var o = n[i],
                    s = r[i];
                if (o && s) e: for (var a = 0; a < s.length; ++a) {
                    for (var l = s[a], c = 0; c < o.length; ++c)
                        if (o[c].marker == l.marker) continue e;
                    o.push(l)
                } else s && (n[i] = s)
            }
            return n
        }

        function wr(e) {
            var t = e.markedSpans;
            if (t) {
                for (var n = 0; n < t.length; ++n) t[n].marker.detachLine(e);
                e.markedSpans = null
            }
        }

        function kr(e, t) {
            if (t) {
                for (var n = 0; n < t.length; ++n) t[n].marker.attachLine(e);
                e.markedSpans = t
            }
        }

        function _r(e) {
            return e.inclusiveLeft ? -1 : 0
        }

        function Cr(e) {
            return e.inclusiveRight ? 1 : 0
        }

        function Sr(e, t) {
            var n = e.lines.length - t.lines.length;
            if (0 != n) return n;
            var r = e.find(),
                i = t.find(),
                o = he(r.from, i.from) || _r(e) - _r(t);
            if (o) return -o;
            var s = he(r.to, i.to) || Cr(e) - Cr(t);
            return s || t.id - e.id
        }

        function Tr(e, t) {
            var n, r = y && e.markedSpans;
            if (r)
                for (var i, o = 0; o < r.length; ++o)(i = r[o]).marker.collapsed && null == (t ? i.from : i.to) && (!n || Sr(n, i.marker) < 0) && (n = i.marker);
            return n
        }

        function Mr(e) {
            return Tr(e, !0)
        }

        function Ar(e) {
            return Tr(e, !1)
        }

        function Lr(e, t, n, r, i) {
            var o = di(e, t),
                s = y && o.markedSpans;
            if (s)
                for (var a = 0; a < s.length; ++a) {
                    var l = s[a];
                    if (l.marker.collapsed) {
                        var c = l.marker.find(0),
                            u = he(c.from, n) || _r(l.marker) - _r(i),
                            h = he(c.to, r) || Cr(l.marker) - Cr(i);
                        if (!(0 <= u && h <= 0 || u <= 0 && 0 <= h) && (u <= 0 && (0 < he(c.to, n) || l.marker.inclusiveRight && i.inclusiveLeft) || 0 <= u && (he(c.from, r) < 0 || l.marker.inclusiveLeft && i.inclusiveRight))) return !0
                    }
                }
        }

        function Er(e) {
            for (var t; t = Mr(e);) e = t.find(-1, !0).line;
            return e
        }

        function Nr(e, t) {
            var n = di(e, t),
                r = Er(n);
            return n == r ? t : gi(r)
        }

        function Ir(e, t) {
            if (t > e.lastLine()) return t;
            var n, r = di(e, t);
            if (!Or(e, r)) return t;
            for (; n = Ar(r);) r = n.find(1, !0).line;
            return gi(r) + 1
        }

        function Or(e, t) {
            var n = y && t.markedSpans;
            if (n)
                for (var r, i = 0; i < n.length; ++i)
                    if ((r = n[i]).marker.collapsed) {
                        if (null == r.from) return !0;
                        if (!r.marker.widgetNode && 0 == r.from && r.marker.inclusiveLeft && Rr(e, t, r)) return !0
                    }
        }

        function Rr(e, t, n) {
            if (null == n.to) {
                var r = n.marker.find(1, !0);
                return Rr(e, r.line, gr(r.line.markedSpans, n.marker))
            }
            if (n.marker.inclusiveRight && n.to == t.text.length) return !0;
            for (var i, o = 0; o < t.markedSpans.length; ++o)
                if ((i = t.markedSpans[o]).marker.collapsed && !i.marker.widgetNode && i.from == n.to && (null == i.to || i.to != n.from) && (i.marker.inclusiveLeft || n.marker.inclusiveRight) && Rr(e, t, i)) return !0
        }
        Ki(dr), dr.prototype.clear = function() {
            if (!this.explicitlyCleared) {
                this.explicitlyCleared = !0;
                for (var e = 0; e < this.markers.length; ++e) this.markers[e].clear();
                zi(this, "clear")
            }
        }, dr.prototype.find = function(e, t) {
            return this.primary.find(e, t)
        };
        var Dr = b.LineWidget = function(e, t, n) {
            if (n)
                for (var r in n) n.hasOwnProperty(r) && (this[r] = n[r]);
            this.doc = e, this.node = t
        };

        function Pr(e, t, n) {
            yi(t) < (e.curOp && e.curOp.scrollTop || e.doc.scrollTop) && Pn(e, null, n)
        }

        function $r(e) {
            if (null != e.height) return e.height;
            var t = e.doc.cm;
            if (!t) return 0;
            if (!ko(document.body, e.node)) {
                var n = "position: relative;";
                e.coverGutter && (n += "margin-left: -" + t.display.gutters.offsetWidth + "px;"), e.noHScroll && (n += "width: " + t.display.wrapper.clientWidth + "px;"), wo(t.display.measure, bo("div", [e.node], null, n))
            }
            return e.height = e.node.offsetHeight
        }
        Ki(Dr), Dr.prototype.clear = function() {
            var e = this.doc.cm,
                t = this.line.widgets,
                n = this.line,
                r = gi(n);
            if (null != r && t) {
                for (var i = 0; i < t.length; ++i) t[i] == this && t.splice(i--, 1);
                t.length || (n.widgets = null);
                var o = $r(this);
                mi(n, Math.max(0, n.height - o)), e && Bt(e, function() {
                    Pr(e, n, -o), Vt(e, r, "widget")
                })
            }
        }, Dr.prototype.changed = function() {
            var e = this.height,
                t = this.doc.cm,
                n = this.line;
            this.height = null;
            var r = $r(this) - e;
            r && (mi(n, n.height + r), t && Bt(t, function() {
                t.curOp.forceUpdate = !0, Pr(t, n, r)
            }))
        };
        var Hr = b.Line = function(e, t, n) {
            this.text = e, kr(this, t), this.height = n ? n(this) : 1
        };

        function Fr(e, t) {
            if (e)
                for (;;) {
                    var n = e.match(/(?:^|\s+)line-(background-)?(\S+)/);
                    if (!n) break;
                    e = e.slice(0, n.index) + e.slice(n.index + n[0].length);
                    var r = n[1] ? "bgClass" : "textClass";
                    null == t[r] ? t[r] = n[2] : new RegExp("(?:^|s)" + n[2] + "(?:$|s)").test(t[r]) || (t[r] += " " + n[2])
                }
            return e
        }

        function Br(e, t) {
            if (e.blankLine) return e.blankLine(t);
            if (e.innerMode) {
                var n = b.innerMode(e, t);
                return n.mode.blankLine ? n.mode.blankLine(n.state) : void 0
            }
        }

        function zr(e, t, n, r) {
            for (var i = 0; i < 10; i++) {
                r && (r[0] = b.innerMode(e, n).mode);
                var o = e.token(t, n);
                if (t.pos > t.start) return o
            }
            throw new Error("Mode " + e.name + " failed to advance stream.")
        }

        function qr(e, t, n, r) {
            function i(e) {
                return {
                    start: h.start,
                    end: h.pos,
                    string: h.current(),
                    type: o || null,
                    state: e ? Zn(s.mode, u) : u
                }
            }
            var o, s = e.doc,
                a = s.mode;
            t = Oe(s, t);
            var l, c = di(s, t.line),
                u = et(e, t.line, n),
                h = new lr(c.text, e.options.tabSize);
            for (r && (l = []);
                (r || h.pos < t.ch) && !h.eol();) h.start = h.pos, o = zr(a, h, u), r && l.push(i(!0));
            return r ? l : i()
        }

        function jr(e, t, n, r, i, o, s) {
            var a = n.flattenSpans;
            null == a && (a = e.options.flattenSpans);
            var l, c = 0,
                u = null,
                h = new lr(t, e.options.tabSize),
                d = e.options.addModeClass && [null];
            for ("" == t && Fr(Br(n, r), o); !h.eol();) {
                if (l = h.pos > e.options.maxHighlightLength ? (a = !1, s && Kr(e, t, r, h.pos), h.pos = t.length, null) : Fr(zr(n, h, r, d), o), d) {
                    var f = d[0].name;
                    f && (l = "m-" + (l ? f + " " + l : f))
                }
                if (!a || u != l) {
                    for (; c < h.start;) i(c = Math.min(h.start, c + 5e4), u);
                    u = l
                }
                h.start = h.pos
            }
            for (; c < h.pos;) {
                var p = Math.min(h.pos, c + 5e4);
                i(p, u), c = p
            }
        }

        function Wr(e, t, n, r) {
            var o = [e.state.modeGen],
                i = {};
            jr(e, t.text, e.doc.mode, n, function(e, t) {
                o.push(e, t)
            }, i, r);
            for (var s = 0; s < e.state.overlays.length; ++s) {
                var a = e.state.overlays[s],
                    l = 1,
                    c = 0;
                jr(e, t.text, a.mode, !0, function(e, t) {
                    for (var n = l; c < e;) {
                        var r = o[l];
                        e < r && o.splice(l, 1, e, o[l + 1], r), l += 2, c = Math.min(e, r)
                    }
                    if (t)
                        if (a.opaque) o.splice(n, l - n, e, "cm-overlay " + t), l = n + 2;
                        else
                            for (; n < l; n += 2) {
                                var i = o[n + 1];
                                o[n + 1] = (i ? i + " " : "") + "cm-overlay " + t
                            }
                }, i)
            }
            return {
                styles: o,
                classes: i.bgClass || i.textClass ? i : null
            }
        }

        function Ur(e, t, n) {
            if (!t.styles || t.styles[0] != e.state.modeGen) {
                var r = Wr(e, t, t.stateAfter = et(e, gi(t)));
                t.styles = r.styles, r.classes ? t.styleClasses = r.classes : t.styleClasses && (t.styleClasses = null), n === e.doc.frontier && e.doc.frontier++
            }
            return t.styles
        }

        function Kr(e, t, n, r) {
            var i = e.doc.mode,
                o = new lr(t, e.options.tabSize);
            for (o.start = o.pos = r || 0, "" == t && Br(i, n); !o.eol() && o.pos <= e.options.maxHighlightLength;) zr(i, o, n), o.start = o.pos
        }
        Ki(Hr), Hr.prototype.lineNo = function() {
            return gi(this)
        };
        var Vr = {},
            Gr = {};

        function Yr(e, t) {
            if (!e || /^\s*$/.test(e)) return null;
            var n = t.addModeClass ? Gr : Vr;
            return n[e] || (n[e] = e.replace(/\S+/g, "cm-$&"))
        }

        function Xr(e, t) {
            var n = bo("span", null, null, p ? "padding-right: .1px" : null),
                r = {
                    pre: bo("pre", [n]),
                    content: n,
                    col: 0,
                    pos: 0,
                    cm: e,
                    splitSpaces: (x || p) && e.getOption("lineWrapping")
                };
            t.measure = {};
            for (var i = 0; i <= (t.rest ? t.rest.length : 0); i++) {
                var o, s = i ? t.rest[i - 1] : t.line;
                r.pos = 0, r.addToken = Qr, Ro(e.display.measure) && (o = bi(s)) && (r.addToken = Zr(r.addToken, o)), r.map = [], ti(s, r, Ur(e, s, t != e.display.externalMeasured && gi(s))), s.styleClasses && (s.styleClasses.bgClass && (r.bgClass = Mo(s.styleClasses.bgClass, r.bgClass || "")), s.styleClasses.textClass && (r.textClass = Mo(s.styleClasses.textClass, r.textClass || ""))), 0 == r.map.length && r.map.push(0, 0, r.content.appendChild(Oo(e.display.measure))), 0 == i ? (t.measure.map = r.map, t.measure.cache = {}) : ((t.measure.maps || (t.measure.maps = [])).push(r.map), (t.measure.caches || (t.measure.caches = [])).push({}))
            }
            return p && /\bcm-tab\b/.test(r.content.lastChild.className) && (r.content.className = "cm-tab-wrap-hack"), Fi(e, "renderLine", e, t.line, r.pre), r.pre.className && (r.textClass = Mo(r.pre.className, r.textClass || "")), r
        }

        function Qr(e, t, n, r, i, o, s) {
            if (t) {
                var a = e.splitSpaces ? t.replace(/ {3,}/g, Jr) : t,
                    l = e.cm.state.specialChars,
                    c = !1;
                if (l.test(t)) {
                    g = document.createDocumentFragment();
                    for (var u = 0;;) {
                        l.lastIndex = u;
                        var h = l.exec(t),
                            d = h ? h.index - u : t.length - u;
                        if (d) {
                            var f = document.createTextNode(a.slice(u, u + d));
                            x && w < 9 ? g.appendChild(bo("span", [f])) : g.appendChild(f), e.map.push(e.pos, e.pos + d, f), e.col += d, e.pos += d
                        }
                        if (!h) break;
                        if (u += d + 1, "\t" == h[0]) {
                            var p = e.cm.options.tabSize,
                                m = p - e.col % p;
                            (f = g.appendChild(bo("span", no(m), "cm-tab"))).setAttribute("role", "presentation"), f.setAttribute("cm-text", "\t"), e.col += m
                        } else {
                            (f = e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text", h[0]), x && w < 9 ? g.appendChild(bo("span", [f])) : g.appendChild(f), e.col += 1
                        }
                        e.map.push(e.pos, e.pos + 1, f), e.pos++
                    }
                } else {
                    e.col += t.length;
                    var g = document.createTextNode(a);
                    e.map.push(e.pos, e.pos + t.length, g), x && w < 9 && (c = !0), e.pos += t.length
                }
                if (n || r || i || c || s) {
                    var v = n || "";
                    r && (v += r), i && (v += i);
                    var y = bo("span", [g], v, s);
                    return o && (y.title = o), e.content.appendChild(y)
                }
                e.content.appendChild(g)
            }
        }

        function Jr(e) {
            for (var t = " ", n = 0; n < e.length - 2; ++n) t += n % 2 ? " " : "Â ";
            return t += " "
        }

        function Zr(h, d) {
            return function(e, t, n, r, i, o, s) {
                n = n ? n + " cm-force-border" : "cm-force-border";
                for (var a = e.pos, l = a + t.length;;) {
                    for (var c = 0; c < d.length; c++) {
                        var u = d[c];
                        if (u.to > a && u.from <= a) break
                    }
                    if (u.to >= l) return h(e, t, n, r, i, o, s);
                    h(e, t.slice(0, u.to - a), n, r, null, o, s), r = null, t = t.slice(u.to - a), a = u.to
                }
            }
        }

        function ei(e, t, n, r) {
            var i = !r && n.widgetNode;
            i && e.map.push(e.pos, e.pos + t, i), !r && e.cm.display.input.needsContentAttribute && (i || (i = e.content.appendChild(document.createElement("span"))), i.setAttribute("cm-marker", n.id)), i && (e.cm.display.input.setUneditable(i), e.content.appendChild(i)), e.pos += t
        }

        function ti(e, t, n) {
            var r = e.markedSpans,
                i = e.text,
                o = 0;
            if (r)
                for (var s, a, l, c, u, h, d, f = i.length, p = 0, m = (C = 1, ""), g = 0;;) {
                    if (g == p) {
                        l = c = u = h = a = "", d = null, g = 1 / 0;
                        for (var v = [], y = 0; y < r.length; ++y) {
                            var b = r[y],
                                x = b.marker;
                            b.from <= p && (null == b.to || b.to > p) ? (null != b.to && g > b.to && (g = b.to, c = ""), x.className && (l += " " + x.className), x.css && (a = x.css), x.startStyle && b.from == p && (u += " " + x.startStyle), x.endStyle && b.to == g && (c += " " + x.endStyle), x.title && !h && (h = x.title), x.collapsed && (!d || Sr(d.marker, x) < 0) && (d = b)) : b.from > p && g > b.from && (g = b.from), "bookmark" == x.type && b.from == p && x.widgetNode && v.push(x)
                        }
                        if (d && (d.from || 0) == p && (ei(t, (null == d.to ? f + 1 : d.to) - p, d.marker, null == d.from), null == d.to)) return;
                        if (!d && v.length)
                            for (y = 0; y < v.length; ++y) ei(t, 0, v[y])
                    }
                    if (f <= p) break;
                    for (var w = Math.min(f, g);;) {
                        if (m) {
                            var k = p + m.length;
                            if (!d) {
                                var _ = w < k ? m.slice(0, w - p) : m;
                                t.addToken(t, _, s ? s + l : l, u, p + _.length == g ? c : "", h, a)
                            }
                            if (w <= k) {
                                m = m.slice(w - p), p = w;
                                break
                            }
                            p = k, u = ""
                        }
                        m = i.slice(o, o = n[C++]), s = Yr(n[C++], t.cm.options)
                    }
                } else
                    for (var C = 1; C < n.length; C += 2) t.addToken(t, i.slice(o, o = n[C]), Yr(n[C + 1], t.cm.options))
        }

        function ni(e, t) {
            return 0 == t.from.ch && 0 == t.to.ch && "" == ro(t.text) && (!e.cm || e.cm.options.wholeLineUpdateBefore)
        }

        function ri(e, r, t, i) {
            function o(e) {
                return t ? t[e] : null
            }

            function n(e, t, n) {
                ! function(e, t, n, r) {
                    e.text = t, e.stateAfter && (e.stateAfter = null), e.styles && (e.styles = null), null != e.order && (e.order = null), wr(e), kr(e, n);
                    var i = r ? r(e) : 1;
                    i != e.height && mi(e, i)
                }(e, t, n, i), zi(e, "change", e, r)
            }

            function s(e, t) {
                for (var n = e, r = []; n < t; ++n) r.push(new Hr(c[n], o(n), i));
                return r
            }
            var a = r.from,
                l = r.to,
                c = r.text,
                u = di(e, a.line),
                h = di(e, l.line),
                d = ro(c),
                f = o(c.length - 1),
                p = l.line - a.line;
            if (r.full) e.insert(0, s(0, c.length)), e.remove(c.length, e.size - c.length);
            else if (ni(e, r)) {
                var m = s(0, c.length - 1);
                n(h, h.text, f), p && e.remove(a.line, p), m.length && e.insert(a.line, m)
            } else if (u == h) {
                if (1 == c.length) n(u, u.text.slice(0, a.ch) + d + u.text.slice(l.ch), f);
                else(m = s(1, c.length - 1)).push(new Hr(d + u.text.slice(l.ch), f, i)), n(u, u.text.slice(0, a.ch) + c[0], o(0)), e.insert(a.line + 1, m)
            } else if (1 == c.length) n(u, u.text.slice(0, a.ch) + c[0] + h.text.slice(l.ch), o(0)), e.remove(a.line + 1, p);
            else {
                n(u, u.text.slice(0, a.ch) + c[0], o(0)), n(h, d + h.text.slice(l.ch), f);
                m = s(1, c.length - 1);
                1 < p && e.remove(a.line + 1, p - 1), e.insert(a.line + 1, m)
            }
            zi(e, "change", e, r)
        }

        function ii(e) {
            this.lines = e, this.parent = null;
            for (var t = 0, n = 0; t < e.length; ++t) e[t].parent = this, n += e[t].height;
            this.height = n
        }

        function oi(e) {
            this.children = e;
            for (var t = 0, n = 0, r = 0; r < e.length; ++r) {
                var i = e[r];
                t += i.chunkSize(), n += i.height, i.parent = this
            }
            this.size = t, this.height = n, this.parent = null
        }
        ii.prototype = {
            chunkSize: function() {
                return this.lines.length
            },
            removeInner: function(e, t) {
                for (var n = e, r = e + t; n < r; ++n) {
                    var i = this.lines[n];
                    this.height -= i.height, (o = i).parent = null, wr(o), zi(i, "delete")
                }
                var o;
                this.lines.splice(e, t)
            },
            collapse: function(e) {
                e.push.apply(e, this.lines)
            },
            insertInner: function(e, t, n) {
                this.height += n, this.lines = this.lines.slice(0, e).concat(t).concat(this.lines.slice(e));
                for (var r = 0; r < t.length; ++r) t[r].parent = this
            },
            iterN: function(e, t, n) {
                for (var r = e + t; e < r; ++e)
                    if (n(this.lines[e])) return !0
            }
        }, oi.prototype = {
            chunkSize: function() {
                return this.size
            },
            removeInner: function(e, t) {
                this.size -= t;
                for (var n = 0; n < this.children.length; ++n) {
                    var r = this.children[n],
                        i = r.chunkSize();
                    if (e < i) {
                        var o = Math.min(t, i - e),
                            s = r.height;
                        if (r.removeInner(e, o), this.height -= s - r.height, i == o && (this.children.splice(n--, 1), r.parent = null), 0 == (t -= o)) break;
                        e = 0
                    } else e -= i
                }
                if (this.size - t < 25 && (1 < this.children.length || !(this.children[0] instanceof ii))) {
                    var a = [];
                    this.collapse(a), this.children = [new ii(a)], this.children[0].parent = this
                }
            },
            collapse: function(e) {
                for (var t = 0; t < this.children.length; ++t) this.children[t].collapse(e)
            },
            insertInner: function(e, t, n) {
                this.size += t.length, this.height += n;
                for (var r = 0; r < this.children.length; ++r) {
                    var i = this.children[r],
                        o = i.chunkSize();
                    if (e <= o) {
                        if (i.insertInner(e, t, n), i.lines && 50 < i.lines.length) {
                            for (; 50 < i.lines.length;) {
                                var s = new ii(i.lines.splice(i.lines.length - 25, 25));
                                i.height -= s.height, this.children.splice(r + 1, 0, s), s.parent = this
                            }
                            this.maybeSpill()
                        }
                        break
                    }
                    e -= o
                }
            },
            maybeSpill: function() {
                if (!(this.children.length <= 10)) {
                    var e = this;
                    do {
                        var t = new oi(e.children.splice(e.children.length - 5, 5));
                        if (e.parent) {
                            e.size -= t.size, e.height -= t.height;
                            var n = oo(e.parent.children, e);
                            e.parent.children.splice(n + 1, 0, t)
                        } else {
                            var r = new oi(e.children);
                            (r.parent = e).children = [r, t], e = r
                        }
                        t.parent = e.parent
                    } while (10 < e.children.length);
                    e.parent.maybeSpill()
                }
            },
            iterN: function(e, t, n) {
                for (var r = 0; r < this.children.length; ++r) {
                    var i = this.children[r],
                        o = i.chunkSize();
                    if (e < o) {
                        var s = Math.min(t, o - e);
                        if (i.iterN(e, s, n)) return !0;
                        if (0 == (t -= s)) break;
                        e = 0
                    } else e -= o
                }
            }
        };
        var si = 0,
            ai = b.Doc = function(e, t, n) {
                if (!(this instanceof ai)) return new ai(e, t, n);
                null == n && (n = 0), oi.call(this, [new ii([new Hr("", null)])]), this.first = n, this.scrollTop = this.scrollLeft = 0, this.cantEdit = !1, this.cleanGeneration = 1, this.frontier = n;
                var r = ue(n, 0);
                this.sel = Ne(r), this.history = new xi(null), this.id = ++si, this.modeOption = t, "string" == typeof e && (e = Po(e)), ri(this, {
                    from: r,
                    to: r,
                    text: e
                }), ze(this, Ne(r), Yi)
            };
        ai.prototype = lo(oi.prototype, {
            constructor: ai,
            iter: function(e, t, n) {
                n ? this.iterN(e - this.first, t - e, n) : this.iterN(this.first, this.first + this.size, e)
            },
            insert: function(e, t) {
                for (var n = 0, r = 0; r < t.length; ++r) n += t[r].height;
                this.insertInner(e - this.first, t, n)
            },
            remove: function(e, t) {
                this.removeInner(e - this.first, t)
            },
            getValue: function(e) {
                var t = pi(this, this.first, this.first + this.size);
                return !1 === e ? t : t.join(e || "\n")
            },
            setValue: jt(function(e) {
                var t = ue(this.first, 0),
                    n = this.first + this.size - 1;
                Ln(this, {
                    from: t,
                    to: ue(n, di(this, n).text.length),
                    text: Po(e),
                    origin: "setValue",
                    full: !0
                }, !0), ze(this, Ne(t))
            }),
            replaceRange: function(e, t, n, r) {
                Rn(this, e, t = Oe(this, t), n = n ? Oe(this, n) : t, r)
            },
            getRange: function(e, t, n) {
                var r = fi(this, Oe(this, e), Oe(this, t));
                return !1 === n ? r : r.join(n || "\n")
            },
            getLine: function(e) {
                var t = this.getLineHandle(e);
                return t && t.text
            },
            getLineHandle: function(e) {
                if (Re(this, e)) return di(this, e)
            },
            getLineNumber: function(e) {
                return gi(e)
            },
            getLineHandleVisualStart: function(e) {
                return "number" == typeof e && (e = di(this, e)), Er(e)
            },
            lineCount: function() {
                return this.size
            },
            firstLine: function() {
                return this.first
            },
            lastLine: function() {
                return this.first + this.size - 1
            },
            clipPos: function(e) {
                return Oe(this, e)
            },
            getCursor: function(e) {
                var t = this.sel.primary();
                return null == e || "head" == e ? t.head : "anchor" == e ? t.anchor : "end" == e || "to" == e || !1 === e ? t.to() : t.from()
            },
            listSelections: function() {
                return this.sel.ranges
            },
            somethingSelected: function() {
                return this.sel.somethingSelected()
            },
            setCursor: jt(function(e, t, n) {
                Fe(this, Oe(this, "number" == typeof e ? ue(e, t || 0) : e), null, n)
            }),
            setSelection: jt(function(e, t, n) {
                Fe(this, Oe(this, e), Oe(this, t || e), n)
            }),
            extendSelection: jt(function(e, t, n) {
                Pe(this, Oe(this, e), t && Oe(this, t), n)
            }),
            extendSelections: jt(function(e, t) {
                $e(this, function(e, t) {
                    for (var n = [], r = 0; r < t.length; r++) n[r] = Oe(e, t[r]);
                    return n
                }(this, e))
            }),
            extendSelectionsBy: jt(function(e, t) {
                $e(this, so(this.sel.ranges, e), t)
            }),
            setSelections: jt(function(e, t, n) {
                if (e.length) {
                    for (var r = 0, i = []; r < e.length; r++) i[r] = new Le(Oe(this, e[r].anchor), Oe(this, e[r].head));
                    null == t && (t = Math.min(e.length - 1, this.sel.primIndex)), ze(this, Ee(i, t), n)
                }
            }),
            addSelection: jt(function(e, t, n) {
                var r = this.sel.ranges.slice(0);
                r.push(new Le(Oe(this, e), Oe(this, t || e))), ze(this, Ee(r, r.length - 1), n)
            }),
            getSelection: function(e) {
                for (var t, n = this.sel.ranges, r = 0; r < n.length; r++) {
                    var i = fi(this, n[r].from(), n[r].to());
                    t = t ? t.concat(i) : i
                }
                return !1 === e ? t : t.join(e || "\n")
            },
            getSelections: function(e) {
                for (var t = [], n = this.sel.ranges, r = 0; r < n.length; r++) {
                    var i = fi(this, n[r].from(), n[r].to());
                    !1 !== e && (i = i.join(e || "\n")), t[r] = i
                }
                return t
            },
            replaceSelection: function(e, t, n) {
                for (var r = [], i = 0; i < this.sel.ranges.length; i++) r[i] = e;
                this.replaceSelections(r, t, n || "+input")
            },
            replaceSelections: jt(function(e, t, n) {
                for (var r = [], i = this.sel, o = 0; o < i.ranges.length; o++) {
                    var s = i.ranges[o];
                    r[o] = {
                        from: s.from(),
                        to: s.to(),
                        text: Po(e[o]),
                        origin: n
                    }
                }
                var a = t && "end" != t && function(e, t, n) {
                    for (var r = [], i = ue(e.first, 0), o = i, s = 0; s < t.length; s++) {
                        var a = t[s],
                            l = Mn(a.from, i, o),
                            c = Mn(Cn(a), i, o);
                        if (i = a.to, o = c, "around" == n) {
                            var u = e.sel.ranges[s],
                                h = he(u.head, u.anchor) < 0;
                            r[s] = new Le(h ? c : l, h ? l : c)
                        } else r[s] = new Le(l, l)
                    }
                    return new Ae(r, e.sel.primIndex)
                }(this, r, t);
                for (o = r.length - 1; 0 <= o; o--) Ln(this, r[o]);
                a ? Be(this, a) : this.cm && $n(this.cm)
            }),
            undo: jt(function() {
                Nn(this, "undo")
            }),
            redo: jt(function() {
                Nn(this, "redo")
            }),
            undoSelection: jt(function() {
                Nn(this, "undo", !0)
            }),
            redoSelection: jt(function() {
                Nn(this, "redo", !0)
            }),
            setExtending: function(e) {
                this.extend = e
            },
            getExtending: function() {
                return this.extend
            },
            historySize: function() {
                for (var e = this.history, t = 0, n = 0, r = 0; r < e.done.length; r++) e.done[r].ranges || ++t;
                for (r = 0; r < e.undone.length; r++) e.undone[r].ranges || ++n;
                return {
                    undo: t,
                    redo: n
                }
            },
            clearHistory: function() {
                this.history = new xi(this.history.maxGeneration)
            },
            markClean: function() {
                this.cleanGeneration = this.changeGeneration(!0)
            },
            changeGeneration: function(e) {
                return e && (this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null), this.history.generation
            },
            isClean: function(e) {
                return this.history.generation == (e || this.cleanGeneration)
            },
            getHistory: function() {
                return {
                    done: Mi(this.history.done),
                    undone: Mi(this.history.undone)
                }
            },
            setHistory: function(e) {
                var t = this.history = new xi(this.history.maxGeneration);
                t.done = Mi(e.done.slice(0), null, !0), t.undone = Mi(e.undone.slice(0), null, !0)
            },
            addLineClass: jt(function(e, n, r) {
                return Bn(this, e, "gutter" == n ? "gutter" : "class", function(e) {
                    var t = "text" == n ? "textClass" : "background" == n ? "bgClass" : "gutter" == n ? "gutterClass" : "wrapClass";
                    if (e[t]) {
                        if (Co(r).test(e[t])) return !1;
                        e[t] += " " + r
                    } else e[t] = r;
                    return !0
                })
            }),
            removeLineClass: jt(function(e, o, s) {
                return Bn(this, e, "gutter" == o ? "gutter" : "class", function(e) {
                    var t = "text" == o ? "textClass" : "background" == o ? "bgClass" : "gutter" == o ? "gutterClass" : "wrapClass",
                        n = e[t];
                    if (!n) return !1;
                    if (null == s) e[t] = null;
                    else {
                        var r = n.match(Co(s));
                        if (!r) return !1;
                        var i = r.index + r[0].length;
                        e[t] = n.slice(0, r.index) + (r.index && i != n.length ? " " : "") + n.slice(i) || null
                    }
                    return !0
                })
            }),
            addLineWidget: jt(function(e, t, n) {
                return i = e, o = new Dr(r = this, t, n), (s = r.cm) && o.noHScroll && (s.display.alignWidgets = !0), Bn(r, i, "widget", function(e) {
                    var t = e.widgets || (e.widgets = []);
                    if (null == o.insertAt ? t.push(o) : t.splice(Math.min(t.length - 1, Math.max(0, o.insertAt)), 0, o), o.line = e, s && !Or(r, e)) {
                        var n = yi(e) < r.scrollTop;
                        mi(e, e.height + $r(o)), n && Pn(s, null, o.height), s.curOp.forceUpdate = !0
                    }
                    return !0
                }), o;
                var r, i, o, s
            }),
            removeLineWidget: function(e) {
                e.clear()
            },
            markText: function(e, t, n) {
                return hr(this, Oe(this, e), Oe(this, t), n, "range")
            },
            setBookmark: function(e, t) {
                var n = {
                    replacedWith: t && (null == t.nodeType ? t.widget : t),
                    insertLeft: t && t.insertLeft,
                    clearWhenEmpty: !1,
                    shared: t && t.shared,
                    handleMouseEvents: t && t.handleMouseEvents
                };
                return hr(this, e = Oe(this, e), e, n, "bookmark")
            },
            findMarksAt: function(e) {
                var t = [],
                    n = di(this, (e = Oe(this, e)).line).markedSpans;
                if (n)
                    for (var r = 0; r < n.length; ++r) {
                        var i = n[r];
                        (null == i.from || i.from <= e.ch) && (null == i.to || i.to >= e.ch) && t.push(i.marker.parent || i.marker)
                    }
                return t
            },
            findMarks: function(i, o, s) {
                i = Oe(this, i), o = Oe(this, o);
                var a = [],
                    l = i.line;
                return this.iter(i.line, o.line + 1, function(e) {
                    var t = e.markedSpans;
                    if (t)
                        for (var n = 0; n < t.length; n++) {
                            var r = t[n];
                            l == i.line && i.ch > r.to || null == r.from && l != i.line || l == o.line && r.from > o.ch || s && !s(r.marker) || a.push(r.marker.parent || r.marker)
                        }++l
                }), a
            },
            getAllMarks: function() {
                var r = [];
                return this.iter(function(e) {
                    var t = e.markedSpans;
                    if (t)
                        for (var n = 0; n < t.length; ++n) null != t[n].from && r.push(t[n].marker)
                }), r
            },
            posFromIndex: function(n) {
                var r, i = this.first;
                return this.iter(function(e) {
                    var t = e.text.length + 1;
                    if (n < t) return r = n, !0;
                    n -= t, ++i
                }), Oe(this, ue(i, r))
            },
            indexFromPos: function(e) {
                var t = (e = Oe(this, e)).ch;
                return e.line < this.first || e.ch < 0 ? 0 : (this.iter(this.first, e.line, function(e) {
                    t += e.text.length + 1
                }), t)
            },
            copy: function(e) {
                var t = new ai(pi(this, this.first, this.first + this.size), this.modeOption, this.first);
                return t.scrollTop = this.scrollTop, t.scrollLeft = this.scrollLeft, t.sel = this.sel, t.extend = !1, e && (t.history.undoDepth = this.history.undoDepth, t.setHistory(this.getHistory())), t
            },
            linkedDoc: function(e) {
                e || (e = {});
                var t = this.first,
                    n = this.first + this.size;
                null != e.from && e.from > t && (t = e.from), null != e.to && e.to < n && (n = e.to);
                var r = new ai(pi(this, t, n), e.mode || this.modeOption, t);
                return e.sharedHist && (r.history = this.history), (this.linked || (this.linked = [])).push({
                        doc: r,
                        sharedHist: e.sharedHist
                    }), r.linked = [{
                        doc: this,
                        isParent: !0,
                        sharedHist: e.sharedHist
                    }],
                    function(e, t) {
                        for (var n = 0; n < t.length; n++) {
                            var r = t[n],
                                i = r.find(),
                                o = e.clipPos(i.from),
                                s = e.clipPos(i.to);
                            if (he(o, s)) {
                                var a = hr(e, o, s, r.primary, r.primary.type);
                                r.markers.push(a), a.parent = r
                            }
                        }
                    }(r, fr(this)), r
            },
            unlinkDoc: function(e) {
                if (e instanceof b && (e = e.doc), this.linked)
                    for (var t = 0; t < this.linked.length; ++t) {
                        if (this.linked[t].doc == e) {
                            this.linked.splice(t, 1), e.unlinkDoc(this), pr(fr(this));
                            break
                        }
                    }
                if (e.history == this.history) {
                    var n = [e.id];
                    ui(e, function(e) {
                        n.push(e.id)
                    }, !0), e.history = new xi(null), e.history.done = Mi(this.history.done, n), e.history.undone = Mi(this.history.undone, n)
                }
            },
            iterLinkedDocs: function(e) {
                ui(this, e)
            },
            getMode: function() {
                return this.mode
            },
            getEditor: function() {
                return this.cm
            }
        }), ai.prototype.eachLine = ai.prototype.iter;
        var li = "iter insert remove copy getEditor".split(" ");
        for (var ci in ai.prototype) ai.prototype.hasOwnProperty(ci) && oo(li, ci) < 0 && (b.prototype[ci] = function(e) {
            return function() {
                return e.apply(this.doc, arguments)
            }
        }(ai.prototype[ci]));

        function ui(e, a, l) {
            ! function e(t, n, r) {
                if (t.linked)
                    for (var i = 0; i < t.linked.length; ++i) {
                        var o = t.linked[i];
                        if (o.doc != n) {
                            var s = r && o.sharedHist;
                            l && !s || (a(o.doc, s), e(o.doc, t, s))
                        }
                    }
            }(e, null, !0)
        }

        function hi(e, t) {
            if (t.cm) throw new Error("This document is already in use.");
            T((e.doc = t).cm = e), _(e), e.options.lineWrapping || I(e), e.options.mode = t.modeOption, Kt(e)
        }

        function di(e, t) {
            if ((t -= e.first) < 0 || t >= e.size) throw new Error("There is no line " + (t + e.first) + " in the document.");
            for (var n = e; !n.lines;)
                for (var r = 0;; ++r) {
                    var i = n.children[r],
                        o = i.chunkSize();
                    if (t < o) {
                        n = i;
                        break
                    }
                    t -= o
                }
            return n.lines[t]
        }

        function fi(e, n, r) {
            var i = [],
                o = n.line;
            return e.iter(n.line, r.line + 1, function(e) {
                var t = e.text;
                o == r.line && (t = t.slice(0, r.ch)), o == n.line && (t = t.slice(n.ch)), i.push(t), ++o
            }), i
        }

        function pi(e, t, n) {
            var r = [];
            return e.iter(t, n, function(e) {
                r.push(e.text)
            }), r
        }

        function mi(e, t) {
            var n = t - e.height;
            if (n)
                for (var r = e; r; r = r.parent) r.height += n
        }

        function gi(e) {
            if (null == e.parent) return null;
            for (var t = e.parent, n = oo(t.lines, e), r = t.parent; r; r = (t = r).parent)
                for (var i = 0; r.children[i] != t; ++i) n += r.children[i].chunkSize();
            return n + t.first
        }

        function vi(e, t) {
            var n = e.first;
            e: do {
                for (var r = 0; r < e.children.length; ++r) {
                    var i = e.children[r],
                        o = i.height;
                    if (t < o) {
                        e = i;
                        continue e
                    }
                    t -= o, n += i.chunkSize()
                }
                return n
            } while (!e.lines);
            for (r = 0; r < e.lines.length; ++r) {
                var s = e.lines[r].height;
                if (t < s) break;
                t -= s
            }
            return n + r
        }

        function yi(e) {
            for (var t = 0, n = (e = Er(e)).parent, r = 0; r < n.lines.length; ++r) {
                var i = n.lines[r];
                if (i == e) break;
                t += i.height
            }
            for (var o = n.parent; o; o = (n = o).parent)
                for (r = 0; r < o.children.length; ++r) {
                    var s = o.children[r];
                    if (s == n) break;
                    t += s.height
                }
            return t
        }

        function bi(e) {
            var t = e.order;
            return null == t && (t = e.order = Jo(e.text)), t
        }

        function xi(e) {
            this.done = [], this.undone = [], this.undoDepth = 1 / 0, this.lastModTime = this.lastSelTime = 0, this.lastOp = this.lastSelOp = null, this.lastOrigin = this.lastSelOrigin = null, this.generation = this.maxGeneration = e || 1
        }

        function wi(e, t) {
            var n = {
                from: de(t.from),
                to: Cn(t),
                text: fi(e, t.from, t.to)
            };
            return Si(e, n, t.from.line, t.to.line + 1), ui(e, function(e) {
                Si(e, n, t.from.line, t.to.line + 1)
            }, !0), n
        }

        function ki(e) {
            for (; e.length;) {
                if (!ro(e).ranges) break;
                e.pop()
            }
        }

        function _i(e, t, n, r) {
            var i = e.history;
            i.undone.length = 0;
            var o, s, a = +new Date;
            if ((i.lastOp == r || i.lastOrigin == t.origin && t.origin && ("+" == t.origin.charAt(0) && e.cm && i.lastModTime > a - e.cm.options.historyEventDelay || "*" == t.origin.charAt(0))) && (o = (s = i).lastOp == r ? (ki(s.done), ro(s.done)) : s.done.length && !ro(s.done).ranges ? ro(s.done) : 1 < s.done.length && !s.done[s.done.length - 2].ranges ? (s.done.pop(), ro(s.done)) : void 0)) {
                var l = ro(o.changes);
                0 == he(t.from, t.to) && 0 == he(t.from, l.to) ? l.to = Cn(t) : o.changes.push(wi(e, t))
            } else {
                var c = ro(i.done);
                for (c && c.ranges || Ci(e.sel, i.done), o = {
                        changes: [wi(e, t)],
                        generation: i.generation
                    }, i.done.push(o); i.done.length > i.undoDepth;) i.done.shift(), i.done[0].ranges || i.done.shift()
            }
            i.done.push(n), i.generation = ++i.maxGeneration, i.lastModTime = i.lastSelTime = a, i.lastOp = i.lastSelOp = r, i.lastOrigin = i.lastSelOrigin = t.origin, l || Fi(e, "historyAdded")
        }

        function Ci(e, t) {
            var n = ro(t);
            n && n.ranges && n.equals(e) || t.push(e)
        }

        function Si(t, n, e, r) {
            var i = n["spans_" + t.id],
                o = 0;
            t.iter(Math.max(t.first, e), Math.min(t.first + t.size, r), function(e) {
                e.markedSpans && ((i || (i = n["spans_" + t.id] = {}))[o] = e.markedSpans), ++o
            })
        }

        function Ti(e) {
            if (!e) return null;
            for (var t, n = 0; n < e.length; ++n) e[n].marker.explicitlyCleared ? t || (t = e.slice(0, n)) : t && t.push(e[n]);
            return t ? t.length ? t : null : e
        }

        function Mi(e, t, n) {
            for (var r = 0, i = []; r < e.length; ++r) {
                var o = e[r];
                if (o.ranges) i.push(n ? Ae.prototype.deepCopy.call(o) : o);
                else {
                    var s = o.changes,
                        a = [];
                    i.push({
                        changes: a
                    });
                    for (var l = 0; l < s.length; ++l) {
                        var c, u = s[l];
                        if (a.push({
                                from: u.from,
                                to: u.to,
                                text: u.text
                            }), t)
                            for (var h in u)(c = h.match(/^spans_(\d+)$/)) && -1 < oo(t, Number(c[1])) && (ro(a)[h] = u[h], delete u[h])
                    }
                }
            }
            return i
        }

        function Ai(e, t, n, r) {
            n < e.line ? e.line += r : t < e.line && (e.line = t, e.ch = 0)
        }

        function Li(e, t, n, r) {
            for (var i = 0; i < e.length; ++i) {
                var o = e[i],
                    s = !0;
                if (o.ranges) {
                    o.copied || ((o = e[i] = o.deepCopy()).copied = !0);
                    for (var a = 0; a < o.ranges.length; a++) Ai(o.ranges[a].anchor, t, n, r), Ai(o.ranges[a].head, t, n, r)
                } else {
                    for (a = 0; a < o.changes.length; ++a) {
                        var l = o.changes[a];
                        if (n < l.from.line) l.from = ue(l.from.line + r, l.from.ch), l.to = ue(l.to.line + r, l.to.ch);
                        else if (t <= l.to.line) {
                            s = !1;
                            break
                        }
                    }
                    s || (e.splice(0, i + 1), i = 0)
                }
            }
        }

        function Ei(e, t) {
            var n = t.from.line,
                r = t.to.line,
                i = t.text.length - (r - n) - 1;
            Li(e.done, n, r, i), Li(e.undone, n, r, i)
        }
        Ki(ai);
        var Ni = b.e_preventDefault = function(e) {
                e.preventDefault ? e.preventDefault() : e.returnValue = !1
            },
            Ii = b.e_stopPropagation = function(e) {
                e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0
            };

        function Oi(e) {
            return null != e.defaultPrevented ? e.defaultPrevented : 0 == e.returnValue
        }
        var Ri = b.e_stop = function(e) {
            Ni(e), Ii(e)
        };

        function Di(e) {
            return e.target || e.srcElement
        }

        function Pi(e) {
            var t = e.which;
            return null == t && (1 & e.button ? t = 1 : 2 & e.button ? t = 3 : 4 & e.button && (t = 2)), g && e.ctrlKey && 1 == t && (t = 3), t
        }
        var $i = b.on = function(e, t, n) {
                if (e.addEventListener) e.addEventListener(t, n, !1);
                else if (e.attachEvent) e.attachEvent("on" + t, n);
                else {
                    var r = e._handlers || (e._handlers = {});
                    (r[t] || (r[t] = [])).push(n)
                }
            },
            Hi = b.off = function(e, t, n) {
                if (e.removeEventListener) e.removeEventListener(t, n, !1);
                else if (e.detachEvent) e.detachEvent("on" + t, n);
                else {
                    var r = e._handlers && e._handlers[t];
                    if (!r) return;
                    for (var i = 0; i < r.length; ++i)
                        if (r[i] == n) {
                            r.splice(i, 1);
                            break
                        }
                }
            },
            Fi = b.signal = function(e, t) {
                var n = e._handlers && e._handlers[t];
                if (n)
                    for (var r = Array.prototype.slice.call(arguments, 2), i = 0; i < n.length; ++i) n[i].apply(null, r)
            },
            Bi = null;

        function zi(e, t) {
            var n = e._handlers && e._handlers[t];
            if (n) {
                var r, i = Array.prototype.slice.call(arguments, 2);
                It ? r = It.delayedCallbacks : Bi ? r = Bi : (r = Bi = [], setTimeout(qi, 0));
                for (var o = 0; o < n.length; ++o) r.push(s(n[o]))
            }

            function s(e) {
                return function() {
                    e.apply(null, i)
                }
            }
        }

        function qi() {
            var e = Bi;
            Bi = null;
            for (var t = 0; t < e.length; ++t) e[t]()
        }

        function ji(e, t, n) {
            return "string" == typeof t && (t = {
                type: t,
                preventDefault: function() {
                    this.defaultPrevented = !0
                }
            }), Fi(e, n || t.type, e, t), Oi(t) || t.codemirrorIgnore
        }

        function Wi(e) {
            var t = e._handlers && e._handlers.cursorActivity;
            if (t)
                for (var n = e.curOp.cursorActivityHandlers || (e.curOp.cursorActivityHandlers = []), r = 0; r < t.length; ++r) - 1 == oo(n, t[r]) && n.push(t[r])
        }

        function Ui(e, t) {
            var n = e._handlers && e._handlers[t];
            return n && 0 < n.length
        }

        function Ki(e) {
            e.prototype.on = function(e, t) {
                $i(this, e, t)
            }, e.prototype.off = function(e, t) {
                Hi(this, e, t)
            }
        }
        var Vi = 30,
            Gi = b.Pass = {
                toString: function() {
                    return "CodeMirror.Pass"
                }
            },
            Yi = {
                scroll: !1
            },
            Xi = {
                origin: "*mouse"
            },
            Qi = {
                origin: "+move"
            };

        function Ji() {
            this.id = null
        }
        Ji.prototype.set = function(e, t) {
            clearTimeout(this.id), this.id = setTimeout(t, e)
        };
        var Zi = b.countColumn = function(e, t, n, r, i) {
            null == t && -1 == (t = e.search(/[^\s\u00a0]/)) && (t = e.length);
            for (var o = r || 0, s = i || 0;;) {
                var a = e.indexOf("\t", o);
                if (a < 0 || t <= a) return s + (t - o);
                s += a - o, s += n - s % n, o = a + 1
            }
        };

        function eo(e, t, n) {
            for (var r = 0, i = 0;;) {
                var o = e.indexOf("\t", r); - 1 == o && (o = e.length);
                var s = o - r;
                if (o == e.length || t <= i + s) return r + Math.min(s, t - i);
                if (i += o - r, r = o + 1, t <= (i += n - i % n)) return r
            }
        }
        var to = [""];

        function no(e) {
            for (; to.length <= e;) to.push(ro(to) + " ");
            return to[e]
        }

        function ro(e) {
            return e[e.length - 1]
        }
        var io = function(e) {
            e.select()
        };

        function oo(e, t) {
            for (var n = 0; n < e.length; ++n)
                if (e[n] == t) return n;
            return -1
        }

        function so(e, t) {
            for (var n = [], r = 0; r < e.length; r++) n[r] = t(e[r], r);
            return n
        }

        function ao() {}

        function lo(e, t) {
            var n;
            return n = Object.create ? Object.create(e) : (ao.prototype = e, new ao), t && co(t, n), n
        }

        function co(e, t, n) {
            for (var r in t || (t = {}), e) !e.hasOwnProperty(r) || !1 === n && t.hasOwnProperty(r) || (t[r] = e[r]);
            return t
        }

        function uo(e) {
            var t = Array.prototype.slice.call(arguments, 1);
            return function() {
                return e.apply(null, t)
            }
        }
        s ? io = function(e) {
            e.selectionStart = 0, e.selectionEnd = e.value.length
        } : x && (io = function(e) {
            try {
                e.select()
            } catch (e) {}
        });
        var ho = /[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,
            fo = b.isWordChar = function(e) {
                return /\w/.test(e) || "Â€" < e && (e.toUpperCase() != e.toLowerCase() || ho.test(e))
            };

        function po(e, t) {
            return t ? !!(-1 < t.source.indexOf("\\w") && fo(e)) || t.test(e) : fo(e)
        }

        function mo(e) {
            for (var t in e)
                if (e.hasOwnProperty(t) && e[t]) return !1;
            return !0
        }
        var go, vo = /[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;

        function yo(e) {
            return 768 <= e.charCodeAt(0) && vo.test(e)
        }

        function bo(e, t, n, r) {
            var i = document.createElement(e);
            if (n && (i.className = n), r && (i.style.cssText = r), "string" == typeof t) i.appendChild(document.createTextNode(t));
            else if (t)
                for (var o = 0; o < t.length; ++o) i.appendChild(t[o]);
            return i
        }

        function xo(e) {
            for (var t = e.childNodes.length; 0 < t; --t) e.removeChild(e.firstChild);
            return e
        }

        function wo(e, t) {
            return xo(e).appendChild(t)
        }
        go = document.createRange ? function(e, t, n, r) {
            var i = document.createRange();
            return i.setEnd(r || e, n), i.setStart(e, t), i
        } : function(e, t, n) {
            var r = document.body.createTextRange();
            try {
                r.moveToElementText(e.parentNode)
            } catch (e) {
                return r
            }
            return r.collapse(!0), r.moveEnd("character", n), r.moveStart("character", t), r
        };
        var ko = b.contains = function(e, t) {
            if (3 == t.nodeType && (t = t.parentNode), e.contains) return e.contains(t);
            do {
                if (11 == t.nodeType && (t = t.host), t == e) return !0
            } while (t = t.parentNode)
        };

        function _o() {
            return document.activeElement
        }

        function Co(e) {
            return new RegExp("(^|\\s)" + e + "(?:$|\\s)\\s*")
        }
        x && w < 11 && (_o = function() {
            try {
                return document.activeElement
            } catch (e) {
                return document.body
            }
        });
        var So = b.rmClass = function(e, t) {
                var n = e.className,
                    r = Co(t).exec(n);
                if (r) {
                    var i = n.slice(r.index + r[0].length);
                    e.className = n.slice(0, r.index) + (i ? r[1] + i : "")
                }
            },
            To = b.addClass = function(e, t) {
                var n = e.className;
                Co(t).test(n) || (e.className += (n ? " " : "") + t)
            };

        function Mo(e, t) {
            for (var n = e.split(" "), r = 0; r < n.length; r++) n[r] && !Co(n[r]).test(t) && (t += " " + n[r]);
            return t
        }

        function Ao(e) {
            if (document.body.getElementsByClassName)
                for (var t = document.body.getElementsByClassName("CodeMirror"), n = 0; n < t.length; n++) {
                    var r = t[n].CodeMirror;
                    r && e(r)
                }
        }
        var Lo = !1;
        var Eo, No, Io = function() {
            if (x && w < 9) return !1;
            var e = bo("div");
            return "draggable" in e || "dragDrop" in e
        }();

        function Oo(e) {
            if (null == Eo) {
                var t = bo("span", "â€‹");
                wo(e, bo("span", [t, document.createTextNode("x")])), 0 != e.firstChild.offsetHeight && (Eo = t.offsetWidth <= 1 && 2 < t.offsetHeight && !(x && w < 8))
            }
            var n = Eo ? bo("span", "â€‹") : bo("span", "Â ", null, "display: inline-block; width: 1px; margin-right: -1px");
            return n.setAttribute("cm-text", ""), n
        }

        function Ro(e) {
            if (null != No) return No;
            var t = wo(e, document.createTextNode("AØ®A")),
                n = go(t, 0, 1).getBoundingClientRect();
            if (!n || n.left == n.right) return !1;
            var r = go(t, 1, 2).getBoundingClientRect();
            return No = r.right - n.right < 3
        }
        var Do, Po = b.splitLines = 3 != "\n\nb".split(/\n/).length ? function(e) {
                for (var t = 0, n = [], r = e.length; t <= r;) {
                    var i = e.indexOf("\n", t); - 1 == i && (i = e.length);
                    var o = e.slice(t, "\r" == e.charAt(i - 1) ? i - 1 : i),
                        s = o.indexOf("\r"); - 1 != s ? (n.push(o.slice(0, s)), t += s + 1) : (n.push(o), t = i + 1)
                }
                return n
            } : function(e) {
                return e.split(/\r\n?|\n/)
            },
            $o = window.getSelection ? function(e) {
                try {
                    return e.selectionStart != e.selectionEnd
                } catch (e) {
                    return !1
                }
            } : function(e) {
                try {
                    var t = e.ownerDocument.selection.createRange()
                } catch (e) {}
                return !(!t || t.parentElement() != e) && 0 != t.compareEndPoints("StartToEnd", t)
            },
            Ho = "oncopy" in (Do = bo("div")) || (Do.setAttribute("oncopy", "return;"), "function" == typeof Do.oncopy),
            Fo = null;
        var Bo, zo = {
            3: "Enter",
            8: "Backspace",
            9: "Tab",
            13: "Enter",
            16: "Shift",
            17: "Ctrl",
            18: "Alt",
            19: "Pause",
            20: "CapsLock",
            27: "Esc",
            32: "Space",
            33: "PageUp",
            34: "PageDown",
            35: "End",
            36: "Home",
            37: "Left",
            38: "Up",
            39: "Right",
            40: "Down",
            44: "PrintScrn",
            45: "Insert",
            46: "Delete",
            59: ";",
            61: "=",
            91: "Mod",
            92: "Mod",
            93: "Mod",
            107: "=",
            109: "-",
            127: "Delete",
            173: "-",
            186: ";",
            187: "=",
            188: ",",
            189: "-",
            190: ".",
            191: "/",
            192: "`",
            219: "[",
            220: "\\",
            221: "]",
            222: "'",
            63232: "Up",
            63233: "Down",
            63234: "Left",
            63235: "Right",
            63272: "Delete",
            63273: "Home",
            63275: "End",
            63276: "PageUp",
            63277: "PageDown",
            63302: "Insert"
        };

        function qo(e) {
            return e.level % 2 ? e.to : e.from
        }

        function jo(e) {
            return e.level % 2 ? e.from : e.to
        }

        function Wo(e) {
            var t = bi(e);
            return t ? qo(t[0]) : 0
        }

        function Uo(e) {
            var t = bi(e);
            return t ? jo(ro(t)) : e.text.length
        }

        function Ko(e, t) {
            var n = di(e.doc, t),
                r = Er(n);
            r != n && (t = gi(r));
            var i = bi(r),
                o = i ? i[0].level % 2 ? Uo(r) : Wo(r) : 0;
            return ue(t, o)
        }

        function Vo(e, t) {
            var n = Ko(e, t.line),
                r = di(e.doc, n.line),
                i = bi(r);
            if (i && 0 != i[0].level) return n;
            var o = Math.max(0, r.text.search(/\S/)),
                s = t.line == n.line && t.ch <= o && t.ch;
            return ue(n.line, s ? 0 : o)
        }

        function Go(e, t) {
            Bo = null;
            for (var n, r = 0; r < e.length; ++r) {
                var i = e[r];
                if (i.from < t && i.to > t) return r;
                if (i.from == t || i.to == t) {
                    if (null != n) return o = e, s = i.level, a = e[n].level, void 0, l = o[0].level, s == l || a != l && s < a ? (i.from != i.to && (Bo = n), r) : (i.from != i.to && (Bo = r), n);
                    n = r
                }
            }
            var o, s, a, l;
            return n
        }

        function Yo(e, t, n, r) {
            if (!r) return t + n;
            for (; 0 < (t += n) && yo(e.text.charAt(t)););
            return t
        }

        function Xo(e, t, n, r) {
            var i = bi(e);
            if (!i) return Qo(e, t, n, r);
            for (var o = Go(i, t), s = i[o], a = Yo(e, t, s.level % 2 ? -n : n, r);;) {
                if (a > s.from && a < s.to) return a;
                if (a == s.from || a == s.to) return Go(i, a) == o ? a : 0 < n == (s = i[o += n]).level % 2 ? s.to : s.from;
                if (!(s = i[o += n])) return null;
                a = 0 < n == s.level % 2 ? Yo(e, s.to, -1, r) : Yo(e, s.from, 1, r)
            }
        }

        function Qo(e, t, n, r) {
            var i = t + n;
            if (r)
                for (; 0 < i && yo(e.text.charAt(i));) i += n;
            return i < 0 || i > e.text.length ? null : i
        }
        b.keyNames = zo,
            function() {
                for (var e = 0; e < 10; e++) zo[e + 48] = zo[e + 96] = String(e);
                for (e = 65; e <= 90; e++) zo[e] = String.fromCharCode(e);
                for (e = 1; e <= 12; e++) zo[e + 111] = zo[e + 63235] = "F" + e
            }();
        var Jo = function() {
            var b = "bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",
                x = "rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";
            var w = /[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,
                k = /[stwN]/,
                _ = /[LRr]/,
                C = /[Lb1n]/,
                S = /[1n]/;

            function T(e, t, n) {
                this.level = e, this.from = t, this.to = n
            }
            return function(e) {
                if (!w.test(e)) return !1;
                for (var t, n = e.length, r = [], i = 0; i < n; ++i) r.push(u = (t = e.charCodeAt(i)) <= 247 ? b.charAt(t) : 1424 <= t && t <= 1524 ? "R" : 1536 <= t && t <= 1773 ? x.charAt(t - 1536) : 1774 <= t && t <= 2220 ? "r" : 8192 <= t && t <= 8203 ? "w" : 8204 == t ? "b" : "L");
                i = 0;
                for (var o = "L"; i < n; ++i) {
                    "m" == (u = r[i]) ? r[i] = o: o = u
                }
                i = 0;
                for (var s = "L"; i < n; ++i) {
                    "1" == (u = r[i]) && "r" == s ? r[i] = "n" : _.test(u) && "r" == (s = u) && (r[i] = "R")
                }
                for (i = 1, o = r[0]; i < n - 1; ++i) {
                    "+" == (u = r[i]) && "1" == o && "1" == r[i + 1] ? r[i] = "1" : "," != u || o != r[i + 1] || "1" != o && "n" != o || (r[i] = o), o = u
                }
                for (i = 0; i < n; ++i) {
                    if ("," == (u = r[i])) r[i] = "N";
                    else if ("%" == u) {
                        for (var a = i + 1; a < n && "%" == r[a]; ++a);
                        for (var l = i && "!" == r[i - 1] || a < n && "1" == r[a] ? "1" : "N", c = i; c < a; ++c) r[c] = l;
                        i = a - 1
                    }
                }
                for (i = 0, s = "L"; i < n; ++i) {
                    var u = r[i];
                    "L" == s && "1" == u ? r[i] = "L" : _.test(u) && (s = u)
                }
                for (i = 0; i < n; ++i)
                    if (k.test(r[i])) {
                        for (a = i + 1; a < n && k.test(r[a]); ++a);
                        var h = "L" == (i ? r[i - 1] : "L"),
                            d = "L" == (a < n ? r[a] : "L");
                        for (l = h || d ? "L" : "R", c = i; c < a; ++c) r[c] = l;
                        i = a - 1
                    } var f, p = [];
                for (i = 0; i < n;)
                    if (C.test(r[i])) {
                        var m = i;
                        for (++i; i < n && C.test(r[i]); ++i);
                        p.push(new T(0, m, i))
                    } else {
                        var g = i,
                            v = p.length;
                        for (++i; i < n && "L" != r[i]; ++i);
                        for (c = g; c < i;)
                            if (S.test(r[c])) {
                                g < c && p.splice(v, 0, new T(1, g, c));
                                var y = c;
                                for (++c; c < i && S.test(r[c]); ++c);
                                p.splice(v, 0, new T(2, y, c)), g = c
                            } else ++c;
                        g < i && p.splice(v, 0, new T(1, g, i))
                    } return 1 == p[0].level && (f = e.match(/^\s+/)) && (p[0].from = f[0].length, p.unshift(new T(0, 0, f[0].length))), 1 == ro(p).level && (f = e.match(/\s+$/)) && (ro(p).to -= f[0].length, p.push(new T(0, n - f[0].length, n))), p[0].level != ro(p).level && p.push(new T(p[0].level, n, n)), p
            }
        }();
        return b.version = "5.1.0", b
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        var C = {},
            S = /[^\s\u00a0]/,
            T = e.Pos;

        function d(e) {
            var t = e.search(S);
            return -1 == t ? 0 : t
        }
        e.commands.toggleComment = function(e) {
            for (var t = 1 / 0, n = e.listSelections(), r = null, i = n.length - 1; 0 <= i; i--) {
                var o = n[i].from(),
                    s = n[i].to();
                o.line >= t || (s.line >= t && (s = T(t, 0)), t = o.line, null == r ? r = e.uncomment(o, s) ? "un" : (e.lineComment(o, s), "line") : "un" == r ? e.uncomment(o, s) : e.lineComment(o, s))
            }
        }, e.defineExtension("lineComment", function(i, e, o) {
            o || (o = C);
            var s = this,
                t = s.getModeAt(i),
                a = o.lineComment || t.lineComment;
            if (a) {
                var l = s.getLine(i.line);
                if (null != l) {
                    var c = Math.min(0 != e.ch || e.line == i.line ? e.line + 1 : e.line, s.lastLine() + 1),
                        u = null == o.padding ? " " : o.padding,
                        h = o.commentBlankLines || i.line == e.line;
                    s.operation(function() {
                        if (o.indent)
                            for (var e = l.slice(0, d(l)), t = i.line; t < c; ++t) {
                                var n = s.getLine(t),
                                    r = e.length;
                                (h || S.test(n)) && (n.slice(0, r) != e && (r = d(n)), s.replaceRange(e + a + u, T(t, 0), T(t, r)))
                            } else
                                for (t = i.line; t < c; ++t)(h || S.test(s.getLine(t))) && s.replaceRange(a + u, T(t, 0))
                    })
                }
            } else(o.blockCommentStart || t.blockCommentStart) && (o.fullLines = !0, s.blockComment(i, e, o))
        }), e.defineExtension("blockComment", function(r, i, o) {
            o || (o = C);
            var s = this,
                a = s.getModeAt(r),
                l = o.blockCommentStart || a.blockCommentStart,
                c = o.blockCommentEnd || a.blockCommentEnd;
            if (l && c) {
                var u = Math.min(i.line, s.lastLine());
                u != r.line && 0 == i.ch && S.test(s.getLine(u)) && --u;
                var h = null == o.padding ? " " : o.padding;
                r.line > u || s.operation(function() {
                    if (0 != o.fullLines) {
                        var e = S.test(s.getLine(u));
                        s.replaceRange(h + c, T(u)), s.replaceRange(l + h, T(r.line, 0));
                        var t = o.blockCommentLead || a.blockCommentLead;
                        if (null != t)
                            for (var n = r.line + 1; n <= u; ++n)(n != u || e) && s.replaceRange(t + h, T(n, 0))
                    } else s.replaceRange(c, i), s.replaceRange(l, r)
                })
            } else(o.lineComment || a.lineComment) && 0 != o.fullLines && s.lineComment(r, i, o)
        }), e.defineExtension("uncomment", function(e, t, n) {
            n || (n = C);
            var i, o = this,
                r = o.getModeAt(e),
                s = Math.min(0 != t.ch || t.line == e.line ? t.line : t.line - 1, o.lastLine()),
                a = Math.min(e.line, s),
                l = n.lineComment || r.lineComment,
                c = [],
                u = null == n.padding ? " " : n.padding;
            e: if (l) {
                for (var h = a; h <= s; ++h) {
                    var d = o.getLine(h),
                        f = d.indexOf(l);
                    if (-1 < f && !/comment/.test(o.getTokenTypeAt(T(h, f + 1))) && (f = -1), -1 == f && (h != s || h == a) && S.test(d)) break e;
                    if (-1 < f && S.test(d.slice(0, f))) break e;
                    c.push(d)
                }
                if (o.operation(function() {
                        for (var e = a; e <= s; ++e) {
                            var t = c[e - a],
                                n = t.indexOf(l),
                                r = n + l.length;
                            n < 0 || (t.slice(r, r + u.length) == u && (r += u.length), i = !0, o.replaceRange("", T(e, n), T(e, r)))
                        }
                    }), i) return !0
            }
            var p = n.blockCommentStart || r.blockCommentStart,
                m = n.blockCommentEnd || r.blockCommentEnd;
            if (!p || !m) return !1;
            var g = n.blockCommentLead || r.blockCommentLead,
                v = o.getLine(a),
                y = s == a ? v : o.getLine(s),
                b = v.indexOf(p),
                x = y.lastIndexOf(m);
            if (-1 == x && a != s && (y = o.getLine(--s), x = y.lastIndexOf(m)), -1 == b || -1 == x || !/comment/.test(o.getTokenTypeAt(T(a, b + 1))) || !/comment/.test(o.getTokenTypeAt(T(s, x + 1)))) return !1;
            var w = v.lastIndexOf(p, e.ch),
                k = -1 == w ? -1 : v.slice(0, e.ch).indexOf(m, w + p.length);
            if (-1 != w && -1 != k && k + m.length != e.ch) return !1;
            k = y.indexOf(m, t.ch);
            var _ = y.slice(t.ch).lastIndexOf(p, k - t.ch);
            return w = -1 == k || -1 == _ ? -1 : t.ch + _, (-1 == k || -1 == w || w == t.ch) && (o.operation(function() {
                o.replaceRange("", T(s, x - (u && y.slice(x - u.length, x) == u ? u.length : 0)), T(s, x + m.length));
                var e = b + p.length;
                if (u && v.slice(e, e + u.length) == u && (e += u.length), o.replaceRange("", T(a, b), T(a, e)), g)
                    for (var t = a + 1; t <= s; ++t) {
                        var n = o.getLine(t),
                            r = n.indexOf(g);
                        if (-1 != r && !S.test(n.slice(0, r))) {
                            var i = r + g.length;
                            u && n.slice(i, i + u.length) == u && (i += u.length), o.replaceRange("", T(t, r), T(t, i))
                        }
                    }
            }), !0)
        })
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(r) {
        var u = /MSIE \d/.test(navigator.userAgent) && (null == document.documentMode || document.documentMode < 8),
            m = r.Pos,
            g = {
                "(": ")>",
                ")": "(<",
                "[": "]>",
                "]": "[<",
                "{": "}>",
                "}": "{<"
            };

        function h(e, t, n, r) {
            var i = e.getLineHandle(t.line),
                o = t.ch - 1,
                s = 0 <= o && g[i.text.charAt(o)] || g[i.text.charAt(++o)];
            if (!s) return null;
            var a = ">" == s.charAt(1) ? 1 : -1;
            if (n && 0 < a != (o == t.ch)) return null;
            var l = e.getTokenTypeAt(m(t.line, o + 1)),
                c = d(e, m(t.line, o + (0 < a ? 1 : 0)), a, l || null, r);
            return null == c ? null : {
                from: m(t.line, o),
                to: c && c.pos,
                match: c && c.ch == s.charAt(0),
                forward: 0 < a
            }
        }

        function d(e, t, n, r, i) {
            for (var o = i && i.maxScanLineLength || 1e4, s = i && i.maxScanLines || 1e3, a = [], l = i && i.bracketRegex ? i.bracketRegex : /[(){}[\]]/, c = 0 < n ? Math.min(t.line + s, e.lastLine() + 1) : Math.max(e.firstLine() - 1, t.line - s), u = t.line; u != c; u += n) {
                var h = e.getLine(u);
                if (h) {
                    var d = 0 < n ? 0 : h.length - 1,
                        f = 0 < n ? h.length : -1;
                    if (!(h.length > o))
                        for (u == t.line && (d = t.ch - (n < 0 ? 1 : 0)); d != f; d += n) {
                            var p = h.charAt(d);
                            if (l.test(p) && (void 0 === r || e.getTokenTypeAt(m(u, d + 1)) == r))
                                if (">" == g[p].charAt(1) == 0 < n) a.push(p);
                                else {
                                    if (!a.length) return {
                                        pos: m(u, d),
                                        ch: p
                                    };
                                    a.pop()
                                }
                        }
                }
            }
            return u - n != (0 < n ? e.lastLine() : e.firstLine()) && null
        }

        function t(e, t, n) {
            for (var r = e.state.matchBrackets.maxHighlightLineLength || 1e3, i = [], o = e.listSelections(), s = 0; s < o.length; s++) {
                var a = o[s].empty() && h(e, o[s].head, !1, n);
                if (a && e.getLine(a.from.line).length <= r) {
                    var l = a.match ? "CodeMirror-matchingbracket" : "CodeMirror-nonmatchingbracket";
                    i.push(e.markText(a.from, m(a.from.line, a.from.ch + 1), {
                        className: l
                    })), a.to && e.getLine(a.to.line).length <= r && i.push(e.markText(a.to, m(a.to.line, a.to.ch + 1), {
                        className: l
                    }))
                }
            }
            if (i.length) {
                u && e.state.focused && e.focus();
                var c = function() {
                    e.operation(function() {
                        for (var e = 0; e < i.length; e++) i[e].clear()
                    })
                };
                if (!t) return c;
                setTimeout(c, 800)
            }
        }
        var n = null;

        function i(e) {
            e.operation(function() {
                n && (n(), n = null), n = t(e, !1, e.state.matchBrackets)
            })
        }
        r.defineOption("matchBrackets", !1, function(e, t, n) {
            n && n != r.Init && e.off("cursorActivity", i), t && (e.state.matchBrackets = "object" == typeof t ? t : {}, e.on("cursorActivity", i))
        }), r.defineExtension("matchBrackets", function() {
            t(this, !0)
        }), r.defineExtension("findMatchingBracket", function(e, t, n) {
            return h(this, e, t, n)
        }), r.defineExtension("scanForBracket", function(e, t, n, r) {
            return d(this, e, t, n, r)
        })
    }),
    function(t) {
        "object" == typeof exports && "object" == typeof module ? t(require("../../lib/codemirror"), "cjs") : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], function(e) {
            t(e, "amd")
        }) : t(CodeMirror, "plain")
    }(function(c, s) {
        c.modeURL || (c.modeURL = "../mode/%N/%N.js");
        var a = {};

        function l(e, t) {
            var n = c.modes[e].dependencies;
            if (!n) return t();
            for (var r = [], i = 0; i < n.length; ++i) c.modes.hasOwnProperty(n[i]) || r.push(n[i]);
            if (!r.length) return t();
            var o, s, a, l = (o = t, s = r.length, a = s, function() {
                0 == --a && o()
            });
            for (i = 0; i < r.length; ++i) c.requireMode(r[i], l)
        }
        c.requireMode = function(e, t) {
            if ("string" != typeof e && (e = e.name), c.modes.hasOwnProperty(e)) return l(e, t);
            if (a.hasOwnProperty(e)) return a[e].push(t);
            var n = c.modeURL.replace(/%N/g, e);
            if ("plain" == s) {
                var r = document.createElement("script");
                r.src = n;
                var i = document.getElementsByTagName("script")[0],
                    o = a[e] = [t];
                c.on(r, "load", function() {
                    l(e, function() {
                        for (var e = 0; e < o.length; ++e) o[e]()
                    })
                }), i.parentNode.insertBefore(r, i)
            } else "cjs" == s ? (require(n), t()) : "amd" == s && requirejs([n], t)
        }, c.autoLoadMode = function(e, t) {
            c.modes.hasOwnProperty(t) || c.requireMode(t, function() {
                e.setOption("mode", e.getOption("mode"))
            })
        }
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(k) {
        "use strict";
        var _ = "CodeMirror-hint",
            C = "CodeMirror-hint-active";
        k.showHint = function(e, t, n) {
            if (!t) return e.showHint(n);
            n && n.async && (t.async = !0);
            var r = {
                hint: t
            };
            if (n)
                for (var i in n) r[i] = n[i];
            return e.showHint(r)
        };
        var o = 0;

        function f(e, t, n, r) {
            if (e.async) {
                var i = ++o;
                e(t, function(e) {
                    o == i && r(e)
                }, n)
            } else r(e(t, n))
        }

        function r(e, t) {
            this.cm = e, this.options = this.buildOptions(t), this.widget = this.onClose = null
        }

        function S(e) {
            return "string" == typeof e ? e : e.text
        }

        function T(e, t) {
            for (; t && t != e;) {
                if ("LI" === t.nodeName.toUpperCase() && t.parentNode == e) return t;
                t = t.parentNode
            }
        }

        function p(i, e) {
            this.completion = i, this.data = e;
            var n = this,
                o = i.cm,
                s = this.hints = document.createElement("ul");
            s.className = "CodeMirror-hints", this.selectedHint = e.selectedHint || 0;
            for (var t = e.list, r = 0; r < t.length; ++r) {
                var a = s.appendChild(document.createElement("li")),
                    l = t[r],
                    c = _ + (r != this.selectedHint ? "" : " " + C);
                null != l.className && (c = l.className + " " + c), a.className = c, l.render ? l.render(a, e, l) : a.appendChild(document.createTextNode(l.displayText || S(l))), a.hintId = r
            }
            var u = o.cursorCoords(i.options.alignWithWord ? e.from : null),
                h = u.left,
                d = u.bottom,
                f = !0;
            s.style.left = h + "px", s.style.top = d + "px";
            var p = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth),
                m = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);
            (i.options.container || document.body).appendChild(s);
            var g = s.getBoundingClientRect();
            if (0 < g.bottom - m) {
                var v = g.bottom - g.top;
                if (0 < u.top - (u.bottom - g.top) - v) s.style.top = (d = u.top - v) + "px", f = !1;
                else if (m < v) {
                    s.style.height = m - 5 + "px", s.style.top = (d = u.bottom - g.top) + "px";
                    var y = o.getCursor();
                    e.from.ch != y.ch && (u = o.cursorCoords(y), s.style.left = (h = u.left) + "px", g = s.getBoundingClientRect())
                }
            }
            var b, x = g.right - p;
            (0 < x && (g.right - g.left > p && (s.style.width = p - 5 + "px", x -= g.right - g.left - p), s.style.left = (h = u.left - x) + "px"), o.addKeyMap(this.keyMap = function(e, r) {
                var i = {
                        Up: function() {
                            r.moveFocus(-1)
                        },
                        Down: function() {
                            r.moveFocus(1)
                        },
                        PageUp: function() {
                            r.moveFocus(1 - r.menuSize(), !0)
                        },
                        PageDown: function() {
                            r.moveFocus(r.menuSize() - 1, !0)
                        },
                        Home: function() {
                            r.setFocus(0)
                        },
                        End: function() {
                            r.setFocus(r.length - 1)
                        },
                        Enter: r.pick,
                        Tab: r.pick,
                        Esc: r.close
                    },
                    t = e.options.customKeys,
                    o = t ? {} : i;

                function n(e, t) {
                    var n;
                    n = "string" != typeof t ? function(e) {
                        return t(e, r)
                    } : i.hasOwnProperty(t) ? i[t] : t, o[e] = n
                }
                if (t)
                    for (var s in t) t.hasOwnProperty(s) && n(s, t[s]);
                var a = e.options.extraKeys;
                if (a)
                    for (var s in a) a.hasOwnProperty(s) && n(s, a[s]);
                return o
            }(i, {
                moveFocus: function(e, t) {
                    n.changeActive(n.selectedHint + e, t)
                },
                setFocus: function(e) {
                    n.changeActive(e)
                },
                menuSize: function() {
                    return n.screenAmount()
                },
                length: t.length,
                close: function() {
                    i.close()
                },
                pick: function() {
                    n.pick()
                },
                data: e
            })), i.options.closeOnUnfocus) && (o.on("blur", this.onBlur = function() {
                b = setTimeout(function() {
                    i.close()
                }, 100)
            }), o.on("focus", this.onFocus = function() {
                clearTimeout(b)
            }));
            var w = o.getScrollInfo();
            return o.on("scroll", this.onScroll = function() {
                var e = o.getScrollInfo(),
                    t = o.getWrapperElement().getBoundingClientRect(),
                    n = d + w.top - e.top,
                    r = n - (window.pageYOffset || (document.documentElement || document.body).scrollTop);
                if (f || (r += s.offsetHeight), r <= t.top || r >= t.bottom) return i.close();
                s.style.top = n + "px", s.style.left = h + w.left - e.left + "px"
            }), k.on(s, "dblclick", function(e) {
                var t = T(s, e.target || e.srcElement);
                t && null != t.hintId && (n.changeActive(t.hintId), n.pick())
            }), k.on(s, "click", function(e) {
                var t = T(s, e.target || e.srcElement);
                t && null != t.hintId && (n.changeActive(t.hintId), i.options.completeOnSingleClick && n.pick())
            }), k.on(s, "mousedown", function() {
                setTimeout(function() {
                    o.focus()
                }, 20)
            }), k.signal(e, "select", t[0], s.firstChild), !0
        }
        k.defineExtension("showHint", function(e) {
            if (!(1 < this.listSelections().length || this.somethingSelected())) {
                this.state.completionActive && this.state.completionActive.close();
                var t = this.state.completionActive = new r(this, e),
                    n = t.options.hint;
                if (n) return k.signal(this, "startCompletion", this), f(n, this, t.options, function(e) {
                    t.showHints(e)
                })
            }
        }), r.prototype = {
            close: function() {
                this.active() && (this.cm.state.completionActive = null, this.widget && this.widget.close(), this.onClose && this.onClose(), k.signal(this.cm, "endCompletion", this.cm))
            },
            active: function() {
                return this.cm.state.completionActive == this
            },
            pick: function(e, t) {
                var n = e.list[t];
                n.hint ? n.hint(this.cm, e, n) : this.cm.replaceRange(S(n), n.from || e.from, n.to || e.to, "complete"), k.signal(e, "pick", n), this.close()
            },
            showHints: function(e) {
                if (!e || !e.list.length || !this.active()) return this.close();
                this.options.completeSingle && 1 == e.list.length ? this.pick(e, 0) : this.showWidget(e)
            },
            showWidget: function(t) {
                this.widget = new p(this, t), k.signal(t, "shown");
                var n, r = 0,
                    i = this,
                    o = this.options.closeCharacters,
                    s = this.cm.getCursor(),
                    a = this.cm.getLine(s.line).length,
                    l = window.requestAnimationFrame || function(e) {
                        return setTimeout(e, 1e3 / 60)
                    },
                    c = window.cancelAnimationFrame || clearTimeout;

                function u() {
                    n || (n = !0, i.close(), i.cm.off("cursorActivity", d), t && k.signal(t, "close"))
                }

                function h() {
                    n || (k.signal(t, "update"), f(i.options.hint, i.cm, i.options, e))
                }

                function e(e) {
                    if (t = e, !n) {
                        if (!t || !t.list.length) return u();
                        i.widget && i.widget.close(), i.widget = new p(i, t)
                    }
                }

                function d() {
                    r && (c(r), r = 0);
                    var e = i.cm.getCursor(),
                        t = i.cm.getLine(e.line);
                    e.line != s.line || t.length - e.ch != a - s.ch || e.ch < s.ch || i.cm.somethingSelected() || e.ch && o.test(t.charAt(e.ch - 1)) ? i.close() : (r = l(h), i.widget && i.widget.close())
                }
                this.cm.on("cursorActivity", d), this.onClose = u
            },
            buildOptions: function(e) {
                var t = this.cm.options.hintOptions,
                    n = {};
                for (var r in i) n[r] = i[r];
                if (t)
                    for (var r in t) void 0 !== t[r] && (n[r] = t[r]);
                if (e)
                    for (var r in e) void 0 !== e[r] && (n[r] = e[r]);
                return n
            }
        }, p.prototype = {
            close: function() {
                if (this.completion.widget == this) {
                    this.completion.widget = null, this.hints.parentNode.removeChild(this.hints), this.completion.cm.removeKeyMap(this.keyMap);
                    var e = this.completion.cm;
                    this.completion.options.closeOnUnfocus && (e.off("blur", this.onBlur), e.off("focus", this.onFocus)), e.off("scroll", this.onScroll)
                }
            },
            pick: function() {
                this.completion.pick(this.data, this.selectedHint)
            },
            changeActive: function(e, t) {
                if (e >= this.data.list.length ? e = t ? this.data.list.length - 1 : 0 : e < 0 && (e = t ? 0 : this.data.list.length - 1), this.selectedHint != e) {
                    var n = this.hints.childNodes[this.selectedHint];
                    n.className = n.className.replace(" " + C, ""), (n = this.hints.childNodes[this.selectedHint = e]).className += " " + C, n.offsetTop < this.hints.scrollTop ? this.hints.scrollTop = n.offsetTop - 3 : n.offsetTop + n.offsetHeight > this.hints.scrollTop + this.hints.clientHeight && (this.hints.scrollTop = n.offsetTop + n.offsetHeight - this.hints.clientHeight + 3), k.signal(this.data, "select", this.data.list[this.selectedHint], n)
                }
            },
            screenAmount: function() {
                return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1
            }
        }, k.registerHelper("hint", "auto", function(e, t) {
            var n, r = e.getHelpers(e.getCursor(), "hint");
            if (r.length)
                for (var i = 0; i < r.length; i++) {
                    var o = r[i](e, t);
                    if (o && o.list.length) return o
                } else if (n = e.getHelper(e.getCursor(), "hintWords")) {
                    if (n) return k.hint.fromList(e, {
                        words: n
                    })
                } else if (k.hint.anyword) return k.hint.anyword(e, t)
        }), k.registerHelper("hint", "fromList", function(e, t) {
            for (var n = e.getCursor(), r = e.getTokenAt(n), i = [], o = 0; o < t.words.length; o++) {
                var s = t.words[o];
                s.slice(0, r.string.length) == r.string && i.push(s)
            }
            if (i.length) return {
                list: i,
                from: k.Pos(n.line, r.start),
                to: k.Pos(n.line, r.end)
            }
        }), k.commands.autocomplete = k.showHint;
        var i = {
            hint: k.hint.auto,
            completeSingle: !0,
            alignWithWord: !0,
            closeCharacters: /[\s()\[\]{};:>,]/,
            closeOnUnfocus: !0,
            completeOnSingleClick: !1,
            container: null,
            customKeys: null,
            extraKeys: null
        };
        k.defineOption("hintOptions", null)
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(w) {
        "use strict";

        function e(e) {
            for (var t = {}, n = e.split(" "), r = 0; r < n.length; ++r) t[n[r]] = !0;
            return t
        }
        w.defineMode("clike", function(e, t) {
            var s, o = e.indentUnit,
                a = t.statementIndentUnit || o,
                l = t.dontAlignCalls,
                c = t.keywords || {},
                u = t.builtin || {},
                h = t.blockKeywords || {},
                d = t.atoms || {},
                f = t.hooks || {},
                p = t.multiLineStrings,
                i = !1 !== t.indentStatements,
                m = /[+\-*&%=<>!?|\/]/;

            function g(e, t) {
                var o, n = e.next();
                if (f[n]) {
                    var r = f[n](e, t);
                    if (!1 !== r) return r
                }
                if ('"' == n || "'" == n) return t.tokenize = (o = n, function(e, t) {
                    for (var n, r = !1, i = !1; null != (n = e.next());) {
                        if (n == o && !r) {
                            i = !0;
                            break
                        }
                        r = !r && "\\" == n
                    }
                    return (i || !r && !p) && (t.tokenize = null), "string"
                }), t.tokenize(e, t);
                if (/[\[\]{}\(\),;\:\.]/.test(n)) return s = n, null;
                if (/\d/.test(n)) return e.eatWhile(/[\w\.]/), "number";
                if ("/" == n) {
                    if (e.eat("*")) return (t.tokenize = v)(e, t);
                    if (e.eat("/")) return e.skipToEnd(), "comment"
                }
                if (m.test(n)) return e.eatWhile(m), "operator";
                e.eatWhile(/[\w\$_\xa1-\uffff]/);
                var i = e.current();
                return c.propertyIsEnumerable(i) ? (h.propertyIsEnumerable(i) && (s = "newstatement"), "keyword") : u.propertyIsEnumerable(i) ? (h.propertyIsEnumerable(i) && (s = "newstatement"), "builtin") : d.propertyIsEnumerable(i) ? "atom" : "variable"
            }

            function v(e, t) {
                for (var n, r = !1; n = e.next();) {
                    if ("/" == n && r) {
                        t.tokenize = null;
                        break
                    }
                    r = "*" == n
                }
                return "comment"
            }

            function y(e, t, n, r, i) {
                this.indented = e, this.column = t, this.type = n, this.align = r, this.prev = i
            }

            function b(e, t, n) {
                var r = e.indented;
                return e.context && "statement" == e.context.type && (r = e.context.indented), e.context = new y(r, t, n, null, e.context)
            }

            function x(e) {
                var t = e.context.type;
                return ")" != t && "]" != t && "}" != t || (e.indented = e.context.indented), e.context = e.context.prev
            }
            return {
                startState: function(e) {
                    return {
                        tokenize: null,
                        context: new y((e || 0) - o, 0, "top", !1),
                        indented: 0,
                        startOfLine: !0
                    }
                },
                token: function(e, t) {
                    var n = t.context;
                    if (e.sol() && (null == n.align && (n.align = !1), t.indented = e.indentation(), t.startOfLine = !0), e.eatSpace()) return null;
                    s = null;
                    var r = (t.tokenize || g)(e, t);
                    if ("comment" == r || "meta" == r) return r;
                    if (null == n.align && (n.align = !0), ";" != s && ":" != s && "," != s || "statement" != n.type)
                        if ("{" == s) b(t, e.column(), "}");
                        else if ("[" == s) b(t, e.column(), "]");
                    else if ("(" == s) b(t, e.column(), ")");
                    else if ("}" == s) {
                        for (;
                            "statement" == n.type;) n = x(t);
                        for ("}" == n.type && (n = x(t));
                            "statement" == n.type;) n = x(t)
                    } else s == n.type ? x(t) : i && (("}" == n.type || "top" == n.type) && ";" != s || "statement" == n.type && "newstatement" == s) && b(t, e.column(), "statement");
                    else x(t);
                    return t.startOfLine = !1, r
                },
                indent: function(e, t) {
                    if (e.tokenize != g && null != e.tokenize) return w.Pass;
                    var n = e.context,
                        r = t && t.charAt(0);
                    "statement" == n.type && "}" == r && (n = n.prev);
                    var i = r == n.type;
                    return "statement" == n.type ? n.indented + ("{" == r ? 0 : a) : !n.align || l && ")" == n.type ? ")" != n.type || i ? n.indented + (i ? 0 : o) : n.indented + a : n.column + (i ? 0 : 1)
                },
                electricChars: "{}",
                blockCommentStart: "/*",
                blockCommentEnd: "*/",
                lineComment: "//",
                fold: "brace"
            }
        });
        var t = "auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";

        function n(e, t) {
            if (!t.startOfLine) return !1;
            for (;;) {
                if (!e.skipTo("\\")) {
                    e.skipToEnd(), t.tokenize = null;
                    break
                }
                if (e.next(), e.eol()) {
                    t.tokenize = n;
                    break
                }
            }
            return "meta"
        }

        function r(e, t) {
            if (e.backUp(1), e.match(/(R|u8R|uR|UR|LR)/)) {
                var n = e.match(/"([^\s\\()]{0,16})\(/);
                return !!n && (t.cpp11RawStringDelim = n[1], (t.tokenize = o)(e, t))
            }
            return e.match(/(u8|u|U|L)/) ? !!e.match(/["']/, !1) && "string" : (e.next(), !1)
        }

        function i(e, t) {
            for (var n; null != (n = e.next());)
                if ('"' == n && !e.eat('"')) {
                    t.tokenize = null;
                    break
                } return "string"
        }

        function o(e, t) {
            var n = t.cpp11RawStringDelim.replace(/[^\w\s]/g, "\\$&");
            return e.match(new RegExp(".*?\\)" + n + '"')) ? t.tokenize = null : e.skipToEnd(), "string"
        }

        function s(e, t) {
            "string" == typeof e && (e = [e]);
            var n = [];

            function r(e) {
                if (e)
                    for (var t in e) e.hasOwnProperty(t) && n.push(t)
            }
            r(t.keywords), r(t.builtin), r(t.atoms), n.length && (t.helperType = e[0], w.registerHelper("hintWords", e[0], n));
            for (var i = 0; i < e.length; ++i) w.defineMIME(e[i], t)
        }

        function a(e, t) {
            for (var n = !1; !e.eol();) {
                if (!n && e.match('"""')) {
                    t.tokenize = null;
                    break
                }
                n = "\\" == e.next() && !n
            }
            return "string"
        }
        s(["text/x-csrc", "text/x-c", "text/x-chdr"], {
            name: "clike",
            keywords: e(t),
            blockKeywords: e("case do else for if switch while struct"),
            atoms: e("null"),
            hooks: {
                "#": n
            },
            modeProps: {
                fold: ["brace", "include"]
            }
        }), s(["text/x-c++src", "text/x-c++hdr"], {
            name: "clike",
            keywords: e(t + " asm dynamic_cast namespace reinterpret_cast try bool explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected wchar_t alignas alignof constexpr decltype nullptr noexcept thread_local final static_assert override"),
            blockKeywords: e("catch class do else finally for if struct switch try while"),
            atoms: e("true false null"),
            hooks: {
                "#": n,
                u: r,
                U: r,
                L: r,
                R: r
            },
            modeProps: {
                fold: ["brace", "include"]
            }
        }), s("text/x-java", {
            name: "clike",
            keywords: e("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),
            blockKeywords: e("catch class do else finally for if switch try while"),
            atoms: e("true false null"),
            hooks: {
                "@": function(e) {
                    return e.eatWhile(/[\w\$_]/), "meta"
                }
            },
            modeProps: {
                fold: ["brace", "import"]
            }
        }), s("text/x-csharp", {
            name: "clike",
            keywords: e("abstract as base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),
            blockKeywords: e("catch class do else finally for foreach if struct switch try while"),
            builtin: e("Boolean Byte Char DateTime DateTimeOffset Decimal Double Guid Int16 Int32 Int64 Object SByte Single String TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),
            atoms: e("true false null"),
            hooks: {
                "@": function(e, t) {
                    return e.eat('"') ? (t.tokenize = i)(e, t) : (e.eatWhile(/[\w\$_]/), "meta")
                }
            }
        }), s("text/x-scala", {
            name: "clike",
            keywords: e("abstract case catch class def do else extends false final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try trye type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector :: #:: Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),
            multiLineStrings: !0,
            blockKeywords: e("catch class do else finally for forSome if match switch try while"),
            atoms: e("true false null"),
            indentStatements: !1,
            hooks: {
                "@": function(e) {
                    return e.eatWhile(/[\w\$_]/), "meta"
                },
                '"': function(e, t) {
                    return !!e.match('""') && (t.tokenize = a, t.tokenize(e, t))
                },
                "'": function(e) {
                    return e.eatWhile(/[\w\$_\xa1-\uffff]/), "atom"
                }
            },
            modeProps: {
                closeBrackets: {
                    triples: '"'
                }
            }
        }), s(["x-shader/x-vertex", "x-shader/x-fragment"], {
            name: "clike",
            keywords: e("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),
            blockKeywords: e("for while do if else struct"),
            builtin: e("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),
            atoms: e("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),
            hooks: {
                "#": n
            },
            modeProps: {
                fold: ["brace", "include"]
            }
        }), s("text/x-nesc", {
            name: "clike",
            keywords: e(t + "as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),
            blockKeywords: e("case do else for if switch while struct"),
            atoms: e("null"),
            hooks: {
                "#": n
            },
            modeProps: {
                fold: ["brace", "include"]
            }
        }), s("text/x-objectivec", {
            name: "clike",
            keywords: e(t + "inline restrict _Bool _Complex _Imaginery BOOL Class bycopy byref id IMP in inout nil oneway out Protocol SEL self super atomic nonatomic retain copy readwrite readonly"),
            atoms: e("YES NO NULL NILL ON OFF"),
            hooks: {
                "@": function(e) {
                    return e.eatWhile(/[\w\$]/), "keyword"
                },
                "#": n
            },
            modeProps: {
                fold: "brace"
            }
        })
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("clojure", function(e) {
            var p = e.indentUnit || 2,
                m = e.indentUnit || 2;

            function t(e) {
                for (var t = {}, n = e.split(" "), r = 0; r < n.length; ++r) t[n[r]] = !0;
                return t
            }
            var g = t("true false nil"),
                v = t("defn defn- def def- defonce defmulti defmethod defmacro defstruct deftype defprotocol defrecord defproject deftest slice defalias defhinted defmacro- defn-memo defnk defnk defonce- defunbound defunbound- defvar defvar- let letfn do case cond condp for loop recur when when-not when-let when-first if if-let if-not . .. -> ->> doto and or dosync doseq dotimes dorun doall load import unimport ns in-ns refer try catch finally throw with-open with-local-vars binding gen-class gen-and-load-class gen-and-save-class handler-case handle"),
                y = t("* *' *1 *2 *3 *agent* *allow-unresolved-vars* *assert* *clojure-version* *command-line-args* *compile-files* *compile-path* *compiler-options* *data-readers* *e *err* *file* *flush-on-newline* *fn-loader* *in* *math-context* *ns* *out* *print-dup* *print-length* *print-level* *print-meta* *print-readably* *read-eval* *source-path* *unchecked-math* *use-context-classloader* *verbose-defrecords* *warn-on-reflection* + +' - -' -> ->> ->ArrayChunk ->Vec ->VecNode ->VecSeq -cache-protocol-fn -reset-methods .. / < <= = == > >= EMPTY-NODE accessor aclone add-classpath add-watch agent agent-error agent-errors aget alength alias all-ns alter alter-meta! alter-var-root amap ancestors and apply areduce array-map aset aset-boolean aset-byte aset-char aset-double aset-float aset-int aset-long aset-short assert assoc assoc! assoc-in associative? atom await await-for await1 bases bean bigdec bigint biginteger binding bit-and bit-and-not bit-clear bit-flip bit-not bit-or bit-set bit-shift-left bit-shift-right bit-test bit-xor boolean boolean-array booleans bound-fn bound-fn* bound? butlast byte byte-array bytes case cast char char-array char-escape-string char-name-string char? chars chunk chunk-append chunk-buffer chunk-cons chunk-first chunk-next chunk-rest chunked-seq? class class? clear-agent-errors clojure-version coll? comment commute comp comparator compare compare-and-set! compile complement concat cond condp conj conj! cons constantly construct-proxy contains? count counted? create-ns create-struct cycle dec dec' decimal? declare default-data-readers definline definterface defmacro defmethod defmulti defn defn- defonce defprotocol defrecord defstruct deftype delay delay? deliver denominator deref derive descendants destructure disj disj! dissoc dissoc! distinct distinct? doall dorun doseq dosync dotimes doto double double-array doubles drop drop-last drop-while empty empty? ensure enumeration-seq error-handler error-mode eval even? every-pred every? ex-data ex-info extend extend-protocol extend-type extenders extends? false? ffirst file-seq filter filterv find find-keyword find-ns find-protocol-impl find-protocol-method find-var first flatten float float-array float? floats flush fn fn? fnext fnil for force format frequencies future future-call future-cancel future-cancelled? future-done? future? gen-class gen-interface gensym get get-in get-method get-proxy-class get-thread-bindings get-validator group-by hash hash-combine hash-map hash-set identical? identity if-let if-not ifn? import in-ns inc inc' init-proxy instance? int int-array integer? interleave intern interpose into into-array ints io! isa? iterate iterator-seq juxt keep keep-indexed key keys keyword keyword? last lazy-cat lazy-seq let letfn line-seq list list* list? load load-file load-reader load-string loaded-libs locking long long-array longs loop macroexpand macroexpand-1 make-array make-hierarchy map map-indexed map? mapcat mapv max max-key memfn memoize merge merge-with meta method-sig methods min min-key mod munge name namespace namespace-munge neg? newline next nfirst nil? nnext not not-any? not-empty not-every? not= ns ns-aliases ns-imports ns-interns ns-map ns-name ns-publics ns-refers ns-resolve ns-unalias ns-unmap nth nthnext nthrest num number? numerator object-array odd? or parents partial partition partition-all partition-by pcalls peek persistent! pmap pop pop! pop-thread-bindings pos? pr pr-str prefer-method prefers primitives-classnames print print-ctor print-dup print-method print-simple print-str printf println println-str prn prn-str promise proxy proxy-call-with-super proxy-mappings proxy-name proxy-super push-thread-bindings pvalues quot rand rand-int rand-nth range ratio? rational? rationalize re-find re-groups re-matcher re-matches re-pattern re-seq read read-line read-string realized? reduce reduce-kv reductions ref ref-history-count ref-max-history ref-min-history ref-set refer refer-clojure reify release-pending-sends rem remove remove-all-methods remove-method remove-ns remove-watch repeat repeatedly replace replicate require reset! reset-meta! resolve rest restart-agent resultset-seq reverse reversible? rseq rsubseq satisfies? second select-keys send send-off seq seq? seque sequence sequential? set set-error-handler! set-error-mode! set-validator! set? short short-array shorts shuffle shutdown-agents slurp some some-fn sort sort-by sorted-map sorted-map-by sorted-set sorted-set-by sorted? special-symbol? spit split-at split-with str string? struct struct-map subs subseq subvec supers swap! symbol symbol? sync take take-last take-nth take-while test the-ns thread-bound? time to-array to-array-2d trampoline transient tree-seq true? type unchecked-add unchecked-add-int unchecked-byte unchecked-char unchecked-dec unchecked-dec-int unchecked-divide-int unchecked-double unchecked-float unchecked-inc unchecked-inc-int unchecked-int unchecked-long unchecked-multiply unchecked-multiply-int unchecked-negate unchecked-negate-int unchecked-remainder-int unchecked-short unchecked-subtract unchecked-subtract-int underive unquote unquote-splicing update-in update-proxy use val vals var-get var-set var? vary-meta vec vector vector-of vector? when when-first when-let when-not while with-bindings with-bindings* with-in-str with-loading-context with-local-vars with-meta with-open with-out-str with-precision with-redefs with-redefs-fn xml-seq zero? zipmap *default-data-reader-fn* as-> cond-> cond->> reduced reduced? send-via set-agent-send-executor! set-agent-send-off-executor! some-> some->>"),
                b = t("ns fn def defn defmethod bound-fn if if-not case condp when while when-not when-first do future comment doto locking proxy with-open with-precision reify deftype defrecord defprotocol extend extend-protocol extend-type try catch let letfn binding loop for doseq dotimes when-let if-let defstruct struct-map assoc testing deftest handler-case handle dotrace deftrace"),
                x = {
                    digit: /\d/,
                    digit_or_colon: /[\d:]/,
                    hex: /[0-9a-f]/i,
                    sign: /[+-]/,
                    exponent: /e/i,
                    keyword_char: /[^\s\(\[\;\)\]]/,
                    symbol: /[\w*+!\-\._?:<>\/\xa1-\uffff]/
                };

            function r(e, t, n) {
                this.indent = e, this.type = t, this.prev = n
            }

            function w(e, t, n) {
                e.indentStack = new r(t, n, e.indentStack)
            }
            return {
                startState: function() {
                    return {
                        indentStack: null,
                        indentation: 0,
                        mode: !1
                    }
                },
                token: function(e, t) {
                    if (null == t.indentStack && e.sol() && (t.indentation = e.indentation()), e.eatSpace()) return null;
                    var n, r, i, o, s, a = null;
                    switch (t.mode) {
                        case "string":
                            for (var l, c = !1; null != (l = e.next());) {
                                if ('"' == l && !c) {
                                    t.mode = !1;
                                    break
                                }
                                c = !c && "\\" == l
                            }
                            a = "string";
                            break;
                        default:
                            var u = e.next();
                            if ('"' == u) a = t.mode = "string";
                            else if ("\\" == u)(s = (o = e).next()) && s.match(/[a-z]/) && o.match(/[a-z]+/, !0) || "u" === s && o.match(/[0-9a-z]{4}/i, !0), a = "string-2";
                            else if ("'" != u || x.digit_or_colon.test(e.peek()))
                                if (";" == u) e.skipToEnd(), a = "comment";
                                else if (i = e, "0" === (r = u) && i.eat(/x/i) ? (i.eatWhile(x.hex), 1) : ("+" != r && "-" != r || !x.digit.test(i.peek()) || (i.eat(x.sign), r = i.next()), x.digit.test(r) && (i.eat(r), i.eatWhile(x.digit), "." == i.peek() && (i.eat("."), i.eatWhile(x.digit)), i.eat(x.exponent) && (i.eat(x.sign), i.eatWhile(x.digit)), 1))) a = "number";
                            else if ("(" == u || "[" == u || "{" == u) {
                                var h, d = "",
                                    f = e.column();
                                if ("(" == u)
                                    for (; null != (h = e.eat(x.keyword_char));) d += h;
                                0 < d.length && (b.propertyIsEnumerable(d) || /^(?:def|with)/.test(d)) ? w(t, f + p, u) : (e.eatSpace(), e.eol() || ";" == e.peek() ? w(t, f + m, u) : w(t, f + e.current().length, u)), e.backUp(e.current().length - 1), a = "bracket"
                            } else if (")" == u || "]" == u || "}" == u) a = "bracket", null != t.indentStack && t.indentStack.type == (")" == u ? "(" : "]" == u ? "[" : "{") && ((n = t).indentStack = n.indentStack.prev);
                            else {
                                if (":" == u) return e.eatWhile(x.symbol), "atom";
                                e.eatWhile(x.symbol), a = v && v.propertyIsEnumerable(e.current()) ? "keyword" : y && y.propertyIsEnumerable(e.current()) ? "builtin" : g && g.propertyIsEnumerable(e.current()) ? "atom" : "variable"
                            } else a = "atom"
                    }
                    return a
                },
                indent: function(e) {
                    return null == e.indentStack ? e.indentation : e.indentStack.indent
                },
                closeBrackets: {
                    pairs: '()[]{}""'
                },
                lineComment: ";;"
            }
        }), e.defineMIME("text/x-clojure", "clojure")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("coffeescript", function(a, o) {
            var l = "error";

            function e(e) {
                return new RegExp("^((" + e.join(")|(") + "))\\b")
            }
            var c = /^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/,
                u = /^(?:[()\[\]{},:`=;]|\.\.?\.?)/,
                h = /^[_A-Za-z$][_A-Za-z$0-9]*/,
                d = /^(@|this\.)[_A-Za-z$][_A-Za-z$0-9]*/,
                f = e(["and", "or", "not", "is", "isnt", "in", "instanceof", "typeof"]),
                s = ["for", "while", "loop", "if", "unless", "else", "switch", "try", "catch", "finally", "class"],
                p = e(s.concat(["break", "by", "continue", "debugger", "delete", "do", "in", "of", "new", "return", "then", "this", "@", "throw", "when", "until", "extends"]));
            s = e(s);
            var m = /^('{3}|\"{3}|['\"])/,
                g = /^(\/{3}|\/)/,
                v = e(["Infinity", "NaN", "undefined", "null", "true", "false", "on", "off", "yes", "no"]);

            function y(e, t) {
                if (e.sol()) {
                    null === t.scope.align && (t.scope.align = !1);
                    var n = t.scope.offset;
                    if (e.eatSpace()) {
                        var r = e.indentation();
                        return n < r && "coffee" == t.scope.type ? "indent" : r < n ? "dedent" : null
                    }
                    0 < n && k(e, t)
                }
                if (e.eatSpace()) return null;
                var i = e.peek();
                if (e.match("####")) return e.skipToEnd(), "comment";
                if (e.match("###")) return t.tokenize = x, t.tokenize(e, t);
                if ("#" === i) return e.skipToEnd(), "comment";
                if (e.match(/^-?[0-9\.]/, !1)) {
                    var o = !1;
                    if (e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i) && (o = !0), e.match(/^-?\d+\.\d*/) && (o = !0), e.match(/^-?\.\d+/) && (o = !0), o) return "." == e.peek() && e.backUp(1), "number";
                    var s = !1;
                    if (e.match(/^-?0x[0-9a-f]+/i) && (s = !0), e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/) && (s = !0), e.match(/^-?0(?![\dx])/i) && (s = !0), s) return "number"
                }
                if (e.match(m)) return t.tokenize = b(e.current(), !1, "string"), t.tokenize(e, t);
                if (e.match(g)) {
                    if ("/" != e.current() || e.match(/^.*\//, !1)) return t.tokenize = b(e.current(), !0, "string-2"), t.tokenize(e, t);
                    e.backUp(1)
                }
                return e.match(c) || e.match(f) ? "operator" : e.match(u) ? "punctuation" : e.match(v) ? "atom" : e.match(p) ? "keyword" : e.match(h) ? "variable" : e.match(d) ? "property" : (e.next(), l)
            }

            function b(n, r, i) {
                return function(e, t) {
                    for (; !e.eol();)
                        if (e.eatWhile(/[^'"\/\\]/), e.eat("\\")) {
                            if (e.next(), r && e.eol()) return i
                        } else {
                            if (e.match(n)) return t.tokenize = y, i;
                            e.eat(/['"\/]/)
                        } return r && (o.singleLineStringErrors ? i = l : t.tokenize = y), i
                }
            }

            function x(e, t) {
                for (; !e.eol();) {
                    if (e.eatWhile(/[^#]/), e.match("###")) {
                        t.tokenize = y;
                        break
                    }
                    e.eatWhile("#")
                }
                return "comment"
            }

            function w(e, t, n) {
                n = n || "coffee";
                for (var r = 0, i = !1, o = null, s = t.scope; s; s = s.prev)
                    if ("coffee" === s.type || "}" == s.type) {
                        r = s.offset + a.indentUnit;
                        break
                    }
                "coffee" !== n ? (i = null, o = e.column() + e.current().length) : t.scope.align && (t.scope.align = !1), t.scope = {
                    offset: r,
                    type: n,
                    prev: t.scope,
                    align: i,
                    alignOffset: o
                }
            }

            function k(e, t) {
                if (t.scope.prev) {
                    if ("coffee" !== t.scope.type) return t.scope = t.scope.prev, !1;
                    for (var n = e.indentation(), r = !1, i = t.scope; i; i = i.prev)
                        if (n === i.offset) {
                            r = !0;
                            break
                        } if (!r) return !0;
                    for (; t.scope.prev && t.scope.offset !== n;) t.scope = t.scope.prev;
                    return !1
                }
            }
            return {
                startState: function(e) {
                    return {
                        tokenize: y,
                        scope: {
                            offset: e || 0,
                            type: "coffee",
                            prev: null,
                            align: !1
                        },
                        lastToken: null,
                        lambda: !1,
                        dedent: 0
                    }
                },
                token: function(e, t) {
                    var n = null === t.scope.align && t.scope;
                    n && e.sol() && (n.align = !1);
                    var r = function(e, t) {
                        var n = t.tokenize(e, t),
                            r = e.current();
                        if ("." === r) return n = t.tokenize(e, t), r = e.current(), /^\.[\w$]+$/.test(r) ? "variable" : l;
                        "return" === r && (t.dedent = !0), ("->" !== r && "=>" !== r || t.lambda || e.peek()) && "indent" !== n || w(e, t);
                        var i = "[({".indexOf(r);
                        if (-1 !== i && w(e, t, "])}".slice(i, i + 1)), s.exec(r) && w(e, t), "then" == r && k(e, t), "dedent" === n && k(e, t)) return l;
                        if (-1 !== (i = "])}".indexOf(r))) {
                            for (;
                                "coffee" == t.scope.type && t.scope.prev;) t.scope = t.scope.prev;
                            t.scope.type == r && (t.scope = t.scope.prev)
                        }
                        return t.dedent && e.eol() && ("coffee" == t.scope.type && t.scope.prev && (t.scope = t.scope.prev), t.dedent = !1), n
                    }(e, t);
                    return n && r && "comment" != r && (n.align = !0), t.lastToken = {
                        style: r,
                        content: e.current()
                    }, e.eol() && e.lambda && (t.lambda = !1), r
                },
                indent: function(e, t) {
                    if (e.tokenize != y) return 0;
                    var n = e.scope,
                        r = t && -1 < "])}".indexOf(t.charAt(0));
                    if (r)
                        for (;
                            "coffee" == n.type && n.prev;) n = n.prev;
                    var i = r && n.type === t.charAt(0);
                    return n.align ? n.alignOffset - (i ? 1 : 0) : (i ? n.prev : n).offset
                },
                lineComment: "#",
                fold: "indent"
            }
        }), e.defineMIME("text/x-coffeescript", "coffeescript")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(R) {
        "use strict";
        R.defineMIME("text/x-erlang", "erlang"), R.defineMode("erlang", function(f) {
            var s = ["-type", "-spec", "-export_type", "-opaque"],
                a = ["after", "begin", "catch", "case", "cond", "end", "fun", "if", "let", "of", "query", "receive", "try", "when"],
                l = /[\->,;]/,
                c = ["->", ";", ","],
                u = ["and", "andalso", "band", "bnot", "bor", "bsl", "bsr", "bxor", "div", "not", "or", "orelse", "rem", "xor"],
                h = /[\+\-\*\/<>=\|:!]/,
                d = ["=", "+", "-", "*", "/", ">", ">=", "<", "=<", "=:=", "==", "=/=", "/=", "||", "<-", "!"],
                p = /[<\(\[\{]/,
                m = ["<<", "(", "[", "{"],
                g = /[>\)\]\}]/,
                v = ["}", "]", ")", ">>"],
                y = ["is_atom", "is_binary", "is_bitstring", "is_boolean", "is_float", "is_function", "is_integer", "is_list", "is_number", "is_pid", "is_port", "is_record", "is_reference", "is_tuple", "atom", "binary", "bitstring", "boolean", "function", "integer", "list", "number", "pid", "port", "record", "reference", "tuple"],
                b = ["abs", "adler32", "adler32_combine", "alive", "apply", "atom_to_binary", "atom_to_list", "binary_to_atom", "binary_to_existing_atom", "binary_to_list", "binary_to_term", "bit_size", "bitstring_to_list", "byte_size", "check_process_code", "contact_binary", "crc32", "crc32_combine", "date", "decode_packet", "delete_module", "disconnect_node", "element", "erase", "exit", "float", "float_to_list", "garbage_collect", "get", "get_keys", "group_leader", "halt", "hd", "integer_to_list", "internal_bif", "iolist_size", "iolist_to_binary", "is_alive", "is_atom", "is_binary", "is_bitstring", "is_boolean", "is_float", "is_function", "is_integer", "is_list", "is_number", "is_pid", "is_port", "is_process_alive", "is_record", "is_reference", "is_tuple", "length", "link", "list_to_atom", "list_to_binary", "list_to_bitstring", "list_to_existing_atom", "list_to_float", "list_to_integer", "list_to_pid", "list_to_tuple", "load_module", "make_ref", "module_loaded", "monitor_node", "node", "node_link", "node_unlink", "nodes", "notalive", "now", "open_port", "pid_to_list", "port_close", "port_command", "port_connect", "port_control", "pre_loaded", "process_flag", "process_info", "processes", "purge_module", "put", "register", "registered", "round", "self", "setelement", "size", "spawn", "spawn_link", "spawn_monitor", "spawn_opt", "split_binary", "statistics", "term_to_binary", "time", "throw", "tl", "trunc", "tuple_size", "tuple_to_list", "unlink", "unregister", "whereis"],
                x = /[\w@Ã˜-ÃžÃ€-Ã–ÃŸ-Ã¶Ã¸-Ã¿]/,
                w = /[0-7]{1,3}|[bdefnrstv\\"']|\^[a-zA-Z]|x[0-9a-zA-Z]{2}|x{[0-9a-zA-Z]+}/;

            function k(e, t, n) {
                if (1 == e.current().length && t.test(e.current())) {
                    for (e.backUp(1); t.test(e.peek());)
                        if (e.next(), T(e.current(), n)) return !0;
                    e.backUp(e.current().length - 1)
                }
                return !1
            }

            function _(e, t, n) {
                if (1 == e.current().length && t.test(e.current())) {
                    for (; t.test(e.peek());) e.next();
                    for (; 0 < e.current().length;) {
                        if (T(e.current(), n)) return !0;
                        e.backUp(1)
                    }
                    e.next()
                }
                return !1
            }

            function C(e) {
                return t(e, '"', "\\")
            }

            function S(e) {
                return t(e, "'", "\\")
            }

            function t(e, t, n) {
                for (; !e.eol();) {
                    var r = e.next();
                    if (r == t) return !0;
                    r == n && e.next()
                }
                return !1
            }

            function T(e, t) {
                return -1 < t.indexOf(e)
            }

            function M(e, t, n) {
                var r, i, o, s, a, l, c;
                switch (s = e, l = n, "comment" != (a = A((c = t).current(), c.column(), c.indentation(), l)).type && "whitespace" != a.type && (s.tokenStack = (r = s.tokenStack, i = a, 0 < (o = r.length - 1) && "record" === r[o].type && "dot" === i.type ? r.pop() : (0 < o && "group" === r[o].type && r.pop(), r.push(i)), r), s.tokenStack = function(e) {
                    var t = e.length - 1;
                    if ("dot" === e[t].type) return [];
                    if ("fun" === e[t].type && "fun" === e[t - 1].token) return e.slice(0, t - 1);
                    switch (e[e.length - 1].token) {
                        case "}":
                            return E(e, {
                                g: ["{"]
                            });
                        case "]":
                            return E(e, {
                                i: ["["]
                            });
                        case ")":
                            return E(e, {
                                i: ["("]
                            });
                        case ">>":
                            return E(e, {
                                i: ["<<"]
                            });
                        case "end":
                            return E(e, {
                                i: ["begin", "case", "fun", "if", "receive", "try"]
                            });
                        case ",":
                            return E(e, {
                                e: ["begin", "try", "when", "->", ",", "(", "[", "{", "<<"]
                            });
                        case "->":
                            return E(e, {
                                r: ["when"],
                                m: ["try", "if", "case", "receive"]
                            });
                        case ";":
                            return E(e, {
                                E: ["case", "fun", "if", "receive", "try", "when"]
                            });
                        case "catch":
                            return E(e, {
                                e: ["try"]
                            });
                        case "of":
                            return E(e, {
                                e: ["case"]
                            });
                        case "after":
                            return E(e, {
                                e: ["receive", "try"]
                            });
                        default:
                            return e
                    }
                }(s.tokenStack)), n) {
                    case "atom":
                        return "atom";
                    case "attribute":
                        return "attribute";
                    case "boolean":
                        return "atom";
                    case "builtin":
                        return "builtin";
                    case "close_paren":
                    case "colon":
                        return null;
                    case "comment":
                        return "comment";
                    case "dot":
                        return null;
                    case "error":
                        return "error";
                    case "fun":
                        return "meta";
                    case "function":
                        return "tag";
                    case "guard":
                        return "property";
                    case "keyword":
                        return "keyword";
                    case "macro":
                        return "variable-2";
                    case "number":
                        return "number";
                    case "open_paren":
                        return null;
                    case "operator":
                        return "operator";
                    case "record":
                        return "bracket";
                    case "separator":
                        return null;
                    case "string":
                        return "string";
                    case "type":
                        return "def";
                    case "variable":
                        return "variable";
                    default:
                        return null
                }
            }

            function A(e, t, n, r) {
                return {
                    token: e,
                    column: t,
                    indent: n,
                    type: r
                }
            }

            function L(e, t) {
                var n = e.tokenStack.length,
                    r = t || 1;
                return !(n < r) && e.tokenStack[n - r]
            }

            function E(e, t) {
                for (var n in t)
                    for (var r = e.length - 1, i = t[n], o = r - 1; - 1 < o; o--)
                        if (T(e[o].token, i)) {
                            var s = e.slice(0, o);
                            switch (n) {
                                case "m":
                                    return s.concat(e[o]).concat(e[r]);
                                case "r":
                                    return s.concat(e[r]);
                                case "i":
                                    return s;
                                case "g":
                                    return s.concat(A(a = "group", 0, 0, a));
                                case "E":
                                case "e":
                                    return s.concat(e[o])
                            }
                        } var a;
                return "E" == n ? [] : e
            }

            function n(e, t) {
                var n, r, i, o, s, a, l, c = f.indentUnit,
                    u = O(r = t.match(/,|[a-z]+|\}|\]|\)|>>|\|+|\(/)) && 0 === r.index ? r[0] : "",
                    h = L(e, 1),
                    d = L(e, 2);
                return e.in_string || e.in_atom ? R.Pass : d ? "when" == h.token ? h.column + c : "when" === u && "function" === d.type ? d.indent + c : "(" === u && "fun" === h.token ? h.column + 3 : "catch" === u && (n = N(e, ["try"])) ? n.column : T(u, ["end", "after", "of"]) ? (n = N(e, ["begin", "case", "fun", "if", "receive", "try"])) ? n.column : R.Pass : T(u, v) ? (n = N(e, m)) ? n.column : R.Pass : T(h.token, [",", "|", "||"]) || T(u, [",", "|", "||"]) ? (a = e.tokenStack.slice(0, -1), l = I(a, "type", ["open_paren"]), (n = !!O(a[l]) && a[l]) ? n.column + n.token.length : c) : "->" == h.token ? T(d.token, ["receive", "case", "if", "try"]) ? d.column + c + c : d.column + c : T(h.token, m) ? h.column + h.token.length : (i = e.tokenStack, o = I(i, "type", ["open_paren", "separator", "keyword"]), s = I(i, "type", ["operator"]), O(n = O(o) && O(s) && o < s ? i[o + 1] : !!O(o) && i[o]) ? n.column + c : 0) : 0
            }

            function N(e, t) {
                var n = e.tokenStack,
                    r = I(n, "token", t);
                return !!O(n[r]) && n[r]
            }

            function I(e, t, n) {
                for (var r = e.length - 1; - 1 < r; r--)
                    if (T(e[r][t], n)) return r;
                return !1
            }

            function O(e) {
                return !1 !== e && null != e
            }
            return {
                startState: function() {
                    return {
                        tokenStack: [],
                        in_string: !1,
                        in_atom: !1
                    }
                },
                token: function(e, t) {
                    return function(e, t) {
                        if (t.in_string) return t.in_string = !C(e), M(t, e, "string");
                        if (t.in_atom) return t.in_atom = !S(e), M(t, e, "atom");
                        if (e.eatSpace()) return M(t, e, "whitespace");
                        if (!L(t) && e.match(/-\s*[a-zÃŸ-Ã¶Ã¸-Ã¿][\wÃ˜-ÃžÃ€-Ã–ÃŸ-Ã¶Ã¸-Ã¿]*/)) return T(e.current(), s) ? M(t, e, "type") : M(t, e, "attribute");
                        var n, r = e.next();
                        if ("%" == r) return e.skipToEnd(), M(t, e, "comment");
                        if (":" == r) return M(t, e, "colon");
                        if ("?" == r) return e.eatSpace(), e.eatWhile(x), M(t, e, "macro");
                        if ("#" == r) return e.eatSpace(), e.eatWhile(x), M(t, e, "record");
                        if ("$" == r) return "\\" != e.next() || e.match(w) ? M(t, e, "number") : M(t, e, "error");
                        if ("." == r) return M(t, e, "dot");
                        if ("'" == r) {
                            if (!(t.in_atom = !S(e))) {
                                if (e.match(/\s*\/\s*[0-9]/, !1)) return e.match(/\s*\/\s*[0-9]/, !0), M(t, e, "fun");
                                if (e.match(/\s*\(/, !1) || e.match(/\s*:/, !1)) return M(t, e, "function")
                            }
                            return M(t, e, "atom")
                        }
                        if ('"' == r) return t.in_string = !C(e), M(t, e, "string");
                        if (/[A-Z_Ã˜-ÃžÃ€-Ã–]/.test(r)) return e.eatWhile(x), M(t, e, "variable");
                        if (/[a-z_ÃŸ-Ã¶Ã¸-Ã¿]/.test(r)) {
                            if (e.eatWhile(x), e.match(/\s*\/\s*[0-9]/, !1)) return e.match(/\s*\/\s*[0-9]/, !0), M(t, e, "fun");
                            var i = e.current();
                            return T(i, a) ? M(t, e, "keyword") : T(i, u) ? M(t, e, "operator") : e.match(/\s*\(/, !1) ? !T(i, b) || ":" == L(t).token && "erlang" != L(t, 2).token ? T(i, y) ? M(t, e, "guard") : M(t, e, "function") : M(t, e, "builtin") : T(i, u) ? M(t, e, "operator") : ":" == ((n = e.match(/([\n\s]+|%[^\n]*\n)*(.)/, !1)) ? n.pop() : "") ? M(t, e, "erlang" == i ? "builtin" : "function") : T(i, ["true", "false"]) ? M(t, e, "boolean") : T(i, ["true", "false"]) ? M(t, e, "boolean") : M(t, e, "atom")
                        }
                        var o = /[0-9]/;
                        return o.test(r) ? (e.eatWhile(o), e.eat("#") ? e.eatWhile(/[0-9a-zA-Z]/) || e.backUp(1) : e.eat(".") && (e.eatWhile(o) ? e.eat(/[eE]/) && (e.eat(/[-+]/) ? e.eatWhile(o) || e.backUp(2) : e.eatWhile(o) || e.backUp(1)) : e.backUp(1)), M(t, e, "number")) : k(e, p, m) ? M(t, e, "open_paren") : k(e, g, v) ? M(t, e, "close_paren") : _(e, l, c) ? M(t, e, "separator") : _(e, h, d) ? M(t, e, "operator") : M(t, e, null)
                    }(e, t)
                },
                indent: function(e, t) {
                    return n(e, t)
                },
                lineComment: "%"
            }
        })
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("go", function(e) {
            var i, o = e.indentUnit,
                s = {
                    break: !0,
                    case: !0,
                    chan: !0,
                    const: !0,
                    continue: !0,
                    default: !0,
                    defer: !0,
                    else: !0,
                    fallthrough: !0,
                    for: !0,
                    func: !0,
                    go: !0,
                    goto: !0,
                    if: !0,
                    import: !0,
                    interface: !0,
                    map: !0,
                    package: !0,
                    range: !0,
                    return: !0,
                    select: !0,
                    struct: !0,
                    switch: !0,
                    type: !0,
                    var: !0,
                    bool: !0,
                    byte: !0,
                    complex64: !0,
                    complex128: !0,
                    float32: !0,
                    float64: !0,
                    int8: !0,
                    int16: !0,
                    int32: !0,
                    int64: !0,
                    string: !0,
                    uint8: !0,
                    uint16: !0,
                    uint32: !0,
                    uint64: !0,
                    int: !0,
                    uint: !0,
                    uintptr: !0
                },
                a = {
                    true: !0,
                    false: !0,
                    iota: !0,
                    nil: !0,
                    append: !0,
                    cap: !0,
                    close: !0,
                    complex: !0,
                    copy: !0,
                    imag: !0,
                    len: !0,
                    make: !0,
                    new: !0,
                    panic: !0,
                    print: !0,
                    println: !0,
                    real: !0,
                    recover: !0
                },
                l = /[+\-*&^%:=<>!|\/]/;

            function c(e, t) {
                var o, n = e.next();
                if ('"' == n || "'" == n || "`" == n) return t.tokenize = (o = n, function(e, t) {
                    for (var n, r = !1, i = !1; null != (n = e.next());) {
                        if (n == o && !r) {
                            i = !0;
                            break
                        }
                        r = !r && "\\" == n
                    }
                    return (i || !r && "`" != o) && (t.tokenize = c), "string"
                }), t.tokenize(e, t);
                if (/[\d\.]/.test(n)) return "." == n ? e.match(/^[0-9]+([eE][\-+]?[0-9]+)?/) : "0" == n ? e.match(/^[xX][0-9a-fA-F]+/) || e.match(/^0[0-7]+/) : e.match(/^[0-9]*\.?[0-9]*([eE][\-+]?[0-9]+)?/), "number";
                if (/[\[\]{}\(\),;\:\.]/.test(n)) return i = n, null;
                if ("/" == n) {
                    if (e.eat("*")) return (t.tokenize = u)(e, t);
                    if (e.eat("/")) return e.skipToEnd(), "comment"
                }
                if (l.test(n)) return e.eatWhile(l), "operator";
                e.eatWhile(/[\w\$_\xa1-\uffff]/);
                var r = e.current();
                return s.propertyIsEnumerable(r) ? ("case" != r && "default" != r || (i = "case"), "keyword") : a.propertyIsEnumerable(r) ? "atom" : "variable"
            }

            function u(e, t) {
                for (var n, r = !1; n = e.next();) {
                    if ("/" == n && r) {
                        t.tokenize = c;
                        break
                    }
                    r = "*" == n
                }
                return "comment"
            }

            function r(e, t, n, r, i) {
                this.indented = e, this.column = t, this.type = n, this.align = r, this.prev = i
            }

            function h(e, t, n) {
                return e.context = new r(e.indented, t, n, null, e.context)
            }

            function d(e) {
                if (e.context.prev) {
                    var t = e.context.type;
                    return ")" != t && "]" != t && "}" != t || (e.indented = e.context.indented), e.context = e.context.prev
                }
            }
            return {
                startState: function(e) {
                    return {
                        tokenize: null,
                        context: new r((e || 0) - o, 0, "top", !1),
                        indented: 0,
                        startOfLine: !0
                    }
                },
                token: function(e, t) {
                    var n = t.context;
                    if (e.sol() && (null == n.align && (n.align = !1), t.indented = e.indentation(), t.startOfLine = !0, "case" == n.type && (n.type = "}")), e.eatSpace()) return null;
                    i = null;
                    var r = (t.tokenize || c)(e, t);
                    return "comment" == r || (null == n.align && (n.align = !0), "{" == i ? h(t, e.column(), "}") : "[" == i ? h(t, e.column(), "]") : "(" == i ? h(t, e.column(), ")") : "case" == i ? n.type = "case" : "}" == i && "}" == n.type ? n = d(t) : i == n.type && d(t), t.startOfLine = !1), r
                },
                indent: function(e, t) {
                    if (e.tokenize != c && null != e.tokenize) return 0;
                    var n = e.context,
                        r = t && t.charAt(0);
                    if ("case" == n.type && /^(?:case|default)\b/.test(t)) return e.context.type = "}", n.indented;
                    var i = r == n.type;
                    return n.align ? n.column + (i ? 0 : 1) : n.indented + (i ? 0 : o)
                },
                electricChars: "{}):",
                fold: "brace",
                blockCommentStart: "/*",
                blockCommentEnd: "*/",
                lineComment: "//"
            }
        }), e.defineMIME("text/x-go", "go")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("haskell", function(e, i) {
            function o(e, t, n) {
                return t(n), n(e, t)
            }
            var s = /[a-z_]/,
                a = /[A-Z]/,
                l = /\d/,
                c = /[0-9A-Fa-f]/,
                u = /[0-7]/,
                h = /[a-z_A-Z0-9'\xa1-\uffff]/,
                d = /[-!#$%&*+.\/<=>?@\\^|~:]/,
                f = /[(),;[\]`{}]/,
                p = /[ \t\v\f]/;

            function m(e, t) {
                if (e.eatWhile(p)) return null;
                var n = e.next();
                if (f.test(n)) {
                    if ("{" == n && e.eat("-")) {
                        var r = "comment";
                        return e.eat("#") && (r = "meta"), o(e, t, function i(o, s) {
                            if (0 == s) return m;
                            return function(e, t) {
                                for (var n = s; !e.eol();) {
                                    var r = e.next();
                                    if ("{" == r && e.eat("-")) ++n;
                                    else if ("-" == r && e.eat("}") && 0 == --n) return t(m), o
                                }
                                return t(i(o, n)), o
                            }
                        }(r, 1))
                    }
                    return null
                }
                if ("'" == n) return e.eat("\\"), e.next(), e.eat("'") ? "string" : "error";
                if ('"' == n) return o(e, t, g);
                if (a.test(n)) return e.eatWhile(h), e.eat(".") ? "qualifier" : "variable-2";
                if (s.test(n)) return e.eatWhile(h), "variable";
                if (l.test(n)) {
                    if ("0" == n) {
                        if (e.eat(/[xX]/)) return e.eatWhile(c), "integer";
                        if (e.eat(/[oO]/)) return e.eatWhile(u), "number"
                    }
                    e.eatWhile(l);
                    r = "number";
                    return e.match(/^\.\d+/) && (r = "number"), e.eat(/[eE]/) && (r = "number", e.eat(/[-+]/), e.eatWhile(l)), r
                }
                if ("." == n && e.eat(".")) return "keyword";
                if (d.test(n)) {
                    if ("-" == n && e.eat(/-/) && (e.eatWhile(/-/), !e.eat(d))) return e.skipToEnd(), "comment";
                    r = "variable";
                    return ":" == n && (r = "variable-2"), e.eatWhile(d), r
                }
                return "error"
            }

            function g(e, t) {
                for (; !e.eol();) {
                    var n = e.next();
                    if ('"' == n) return t(m), "string";
                    if ("\\" == n) {
                        if (e.eol() || e.eat(p)) return t(r), "string";
                        e.eat("&") || e.next()
                    }
                }
                return t(m), "error"
            }

            function r(e, t) {
                return e.eat("\\") ? o(e, t, g) : (e.next(), t(m), "error")
            }
            var v = function() {
                var n = {};

                function e(t) {
                    return function() {
                        for (var e = 0; e < arguments.length; e++) n[arguments[e]] = t
                    }
                }
                e("keyword")("case", "class", "data", "default", "deriving", "do", "else", "foreign", "if", "import", "in", "infix", "infixl", "infixr", "instance", "let", "module", "newtype", "of", "then", "type", "where", "_"), e("keyword")("..", ":", "::", "=", "\\", '"', "<-", "->", "@", "~", "=>"), e("builtin")("!!", "$!", "$", "&&", "+", "++", "-", ".", "/", "/=", "<", "<=", "=<<", "==", ">", ">=", ">>", ">>=", "^", "^^", "||", "*", "**"), e("builtin")("Bool", "Bounded", "Char", "Double", "EQ", "Either", "Enum", "Eq", "False", "FilePath", "Float", "Floating", "Fractional", "Functor", "GT", "IO", "IOError", "Int", "Integer", "Integral", "Just", "LT", "Left", "Maybe", "Monad", "Nothing", "Num", "Ord", "Ordering", "Rational", "Read", "ReadS", "Real", "RealFloat", "RealFrac", "Right", "Show", "ShowS", "String", "True"), e("builtin")("abs", "acos", "acosh", "all", "and", "any", "appendFile", "asTypeOf", "asin", "asinh", "atan", "atan2", "atanh", "break", "catch", "ceiling", "compare", "concat", "concatMap", "const", "cos", "cosh", "curry", "cycle", "decodeFloat", "div", "divMod", "drop", "dropWhile", "either", "elem", "encodeFloat", "enumFrom", "enumFromThen", "enumFromThenTo", "enumFromTo", "error", "even", "exp", "exponent", "fail", "filter", "flip", "floatDigits", "floatRadix", "floatRange", "floor", "fmap", "foldl", "foldl1", "foldr", "foldr1", "fromEnum", "fromInteger", "fromIntegral", "fromRational", "fst", "gcd", "getChar", "getContents", "getLine", "head", "id", "init", "interact", "ioError", "isDenormalized", "isIEEE", "isInfinite", "isNaN", "isNegativeZero", "iterate", "last", "lcm", "length", "lex", "lines", "log", "logBase", "lookup", "map", "mapM", "mapM_", "max", "maxBound", "maximum", "maybe", "min", "minBound", "minimum", "mod", "negate", "not", "notElem", "null", "odd", "or", "otherwise", "pi", "pred", "print", "product", "properFraction", "putChar", "putStr", "putStrLn", "quot", "quotRem", "read", "readFile", "readIO", "readList", "readLn", "readParen", "reads", "readsPrec", "realToFrac", "recip", "rem", "repeat", "replicate", "return", "reverse", "round", "scaleFloat", "scanl", "scanl1", "scanr", "scanr1", "seq", "sequence", "sequence_", "show", "showChar", "showList", "showParen", "showString", "shows", "showsPrec", "significand", "signum", "sin", "sinh", "snd", "span", "splitAt", "sqrt", "subtract", "succ", "sum", "tail", "take", "takeWhile", "tan", "tanh", "toEnum", "toInteger", "toRational", "truncate", "uncurry", "undefined", "unlines", "until", "unwords", "unzip", "unzip3", "userError", "words", "writeFile", "zip", "zip3", "zipWith", "zipWith3");
                var t = i.overrideKeywords;
                if (t)
                    for (var r in t) t.hasOwnProperty(r) && (n[r] = t[r]);
                return n
            }();
            return {
                startState: function() {
                    return {
                        f: m
                    }
                },
                copyState: function(e) {
                    return {
                        f: e.f
                    }
                },
                token: function(e, t) {
                    var n = t.f(e, function(e) {
                            t.f = e
                        }),
                        r = e.current();
                    return v.hasOwnProperty(r) ? v[r] : n
                },
                blockCommentStart: "{-",
                blockCommentEnd: "-}",
                lineComment: "--"
            }
        }), e.defineMIME("text/x-haskell", "haskell")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(Se) {
        "use strict";
        Se.defineMode("javascript", function(e, u) {
            var r, i, h = e.indentUnit,
                d = u.statementIndent,
                s = u.jsonld,
                a = u.json || s,
                f = u.typescript,
                l = u.wordCharacters || /[\w$\xa1-\uffff]/,
                c = function() {
                    function e(e) {
                        return {
                            type: e,
                            style: "keyword"
                        }
                    }
                    var t = e("keyword a"),
                        n = e("keyword b"),
                        r = e("keyword c"),
                        i = e("operator"),
                        o = {
                            type: "atom",
                            style: "atom"
                        },
                        s = {
                            if: e("if"),
                            while: t,
                            with: t,
                            else: n,
                            do: n,
                            try: n,
                            finally: n,
                            return: r,
                            break: r,
                            continue: r,
                            new: r,
                            delete: r,
                            throw: r,
                            debugger: r,
                            var: e("var"),
                            const: e("var"),
                            let: e("var"),
                            function: e("function"),
                            catch: e("catch"),
                            for: e("for"),
                            switch: e("switch"),
                            case: e("case"),
                            default: e("default"),
                            in: i,
                            typeof: i,
                            instanceof: i,
                            true: o,
                            false: o,
                            null: o,
                            undefined: o,
                            NaN: o,
                            Infinity: o,
                            this: e("this"),
                            module: e("module"),
                            class: e("class"),
                            super: e("atom"),
                            yield: r,
                            export: e("export"),
                            import: e("import"),
                            extends: r
                        };
                    if (f) {
                        var a = {
                                type: "variable",
                                style: "variable-3"
                            },
                            l = {
                                interface: e("interface"),
                                extends: e("extends"),
                                constructor: e("constructor"),
                                public: e("public"),
                                private: e("private"),
                                protected: e("protected"),
                                static: e("static"),
                                string: a,
                                number: a,
                                bool: a,
                                any: a
                            };
                        for (var c in l) s[c] = l[c]
                    }
                    return s
                }(),
                p = /[+\-*&%=<>!?|~^]/,
                m = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;

            function g(e, t, n) {
                return r = e, i = n, t
            }

            function v(e, t) {
                var i, n = e.next();
                if ('"' == n || "'" == n) return t.tokenize = (i = n, function(e, t) {
                    var n, r = !1;
                    if (s && "@" == e.peek() && e.match(m)) return t.tokenize = v, g("jsonld-keyword", "meta");
                    for (; null != (n = e.next()) && (n != i || r);) r = !r && "\\" == n;
                    return r || (t.tokenize = v), g("string", "string")
                }), t.tokenize(e, t);
                if ("." == n && e.match(/^\d+(?:[eE][+\-]?\d+)?/)) return g("number", "number");
                if ("." == n && e.match("..")) return g("spread", "meta");
                if (/[\[\]{}\(\),;\:\.]/.test(n)) return g(n);
                if ("=" == n && e.eat(">")) return g("=>", "operator");
                if ("0" == n && e.eat(/x/i)) return e.eatWhile(/[\da-f]/i), g("number", "number");
                if (/\d/.test(n)) return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/), g("number", "number");
                if ("/" == n) return e.eat("*") ? (t.tokenize = y)(e, t) : e.eat("/") ? (e.skipToEnd(), g("comment", "comment")) : "operator" == t.lastType || "keyword c" == t.lastType || "sof" == t.lastType || /^[\[{}\(,;:]$/.test(t.lastType) ? (function(e) {
                    for (var t, n = !1, r = !1; null != (t = e.next());) {
                        if (!n) {
                            if ("/" == t && !r) return;
                            "[" == t ? r = !0 : r && "]" == t && (r = !1)
                        }
                        n = !n && "\\" == t
                    }
                }(e), e.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/), g("regexp", "string-2")) : (e.eatWhile(p), g("operator", "operator", e.current()));
                if ("`" == n) return (t.tokenize = b)(e, t);
                if ("#" == n) return e.skipToEnd(), g("error", "error");
                if (p.test(n)) return e.eatWhile(p), g("operator", "operator", e.current());
                if (l.test(n)) {
                    e.eatWhile(l);
                    var r = e.current(),
                        o = c.propertyIsEnumerable(r) && c[r];
                    return o && "." != t.lastType ? g(o.type, o.style, r) : g("variable", "variable", r)
                }
            }

            function y(e, t) {
                for (var n, r = !1; n = e.next();) {
                    if ("/" == n && r) {
                        t.tokenize = v;
                        break
                    }
                    r = "*" == n
                }
                return g("comment", "comment")
            }

            function b(e, t) {
                for (var n, r = !1; null != (n = e.next());) {
                    if (!r && ("`" == n || "$" == n && e.eat("{"))) {
                        t.tokenize = v;
                        break
                    }
                    r = !r && "\\" == n
                }
                return g("quasi", "string-2", e.current())
            }
            var x = "([{}])";

            function o(e, t) {
                t.fatArrowAt && (t.fatArrowAt = null);
                var n = e.string.indexOf("=>", e.start);
                if (!(n < 0)) {
                    for (var r = 0, i = !1, o = n - 1; 0 <= o; --o) {
                        var s = e.string.charAt(o),
                            a = x.indexOf(s);
                        if (0 <= a && a < 3) {
                            if (!r) {
                                ++o;
                                break
                            }
                            if (0 == --r) break
                        } else if (3 <= a && a < 6) ++r;
                        else if (l.test(s)) i = !0;
                        else {
                            if (/["'\/]/.test(s)) return;
                            if (i && !r) {
                                ++o;
                                break
                            }
                        }
                    }
                    i && !r && (t.fatArrowAt = o)
                }
            }
            var w = {
                atom: !0,
                number: !0,
                variable: !0,
                string: !0,
                regexp: !0,
                this: !0,
                "jsonld-keyword": !0
            };

            function k(e, t, n, r, i, o) {
                this.indented = e, this.column = t, this.type = n, this.prev = i, this.info = o, null != r && (this.align = r)
            }

            function _(e, t) {
                for (var n = e.localVars; n; n = n.next)
                    if (n.name == t) return !0;
                for (var r = e.context; r; r = r.prev)
                    for (n = r.vars; n; n = n.next)
                        if (n.name == t) return !0
            }
            var C = {
                state: null,
                column: null,
                marked: null,
                cc: null
            };

            function S() {
                for (var e = arguments.length - 1; 0 <= e; e--) C.cc.push(arguments[e])
            }

            function T() {
                return S.apply(null, arguments), !0
            }

            function n(n) {
                function e(e) {
                    for (var t = e; t; t = t.next)
                        if (t.name == n) return !0;
                    return !1
                }
                var t = C.state;
                if (t.context) {
                    if (C.marked = "def", e(t.localVars)) return;
                    t.localVars = {
                        name: n,
                        next: t.localVars
                    }
                } else {
                    if (e(t.globalVars)) return;
                    u.globalVars && (t.globalVars = {
                        name: n,
                        next: t.globalVars
                    })
                }
            }
            var t = {
                name: "this",
                next: {
                    name: "arguments"
                }
            };

            function M() {
                C.state.context = {
                    prev: C.state.context,
                    vars: C.state.localVars
                }, C.state.localVars = t
            }

            function A() {
                C.state.localVars = C.state.context.vars, C.state.context = C.state.context.prev
            }

            function L(r, i) {
                var e = function() {
                    var e = C.state,
                        t = e.indented;
                    if ("stat" == e.lexical.type) t = e.lexical.indented;
                    else
                        for (var n = e.lexical; n && ")" == n.type && n.align; n = n.prev) t = n.indented;
                    e.lexical = new k(t, C.stream.column(), r, null, e.lexical, i)
                };
                return e.lex = !0, e
            }

            function E() {
                var e = C.state;
                e.lexical.prev && (")" == e.lexical.type && (e.indented = e.lexical.indented), e.lexical = e.lexical.prev)
            }

            function N(n) {
                return function e(t) {
                    return t == n ? T() : ";" == n ? S() : T(e)
                }
            }

            function I(e, t) {
                return "var" == e ? T(L("vardef", t.length), ee, N(";"), E) : "keyword a" == e ? T(L("form"), O, I, E) : "keyword b" == e ? T(L("form"), I, E) : "{" == e ? T(L("}"), Q, E) : ";" == e ? T() : "if" == e ? ("else" == C.state.lexical.info && C.state.cc[C.state.cc.length - 1] == E && C.state.cc.pop()(), T(L("form"), O, I, E, oe)) : "function" == e ? T(he) : "for" == e ? T(L("form"), se, I, E) : "variable" == e ? T(L("stat"), W) : "switch" == e ? T(L("form"), O, L("}", "switch"), N("{"), Q, E, E) : "case" == e ? T(O, N(":")) : "default" == e ? T(N(":")) : "catch" == e ? T(L("form"), M, N("("), de, N(")"), I, E, A) : "module" == e ? T(L("form"), M, ve, A, E) : "class" == e ? T(L("form"), fe, E) : "export" == e ? T(L("form"), ye, E) : "import" == e ? T(L("form"), be, E) : S(L("stat"), O, N(";"), E)
            }

            function O(e) {
                return D(e, !1)
            }

            function R(e) {
                return D(e, !0)
            }

            function D(e, t) {
                if (C.state.fatArrowAt == C.stream.start) {
                    var n = t ? j : q;
                    if ("(" == e) return T(M, L(")"), Y(te, ")"), E, N("=>"), n, A);
                    if ("variable" == e) return S(M, te, N("=>"), n, A)
                }
                var r = t ? F : H;
                return w.hasOwnProperty(e) ? T(r) : "function" == e ? T(he, r) : "keyword c" == e ? T(t ? $ : P) : "(" == e ? T(L(")"), P, Ce, N(")"), E, r) : "operator" == e || "spread" == e ? T(t ? R : O) : "[" == e ? T(L("]"), ke, E, r) : "{" == e ? X(K, "}", null, r) : "quasi" == e ? S(B, r) : T()
            }

            function P(e) {
                return e.match(/[;\}\)\],]/) ? S() : S(O)
            }

            function $(e) {
                return e.match(/[;\}\)\],]/) ? S() : S(R)
            }

            function H(e, t) {
                return "," == e ? T(O) : F(e, t, !1)
            }

            function F(e, t, n) {
                var r = 0 == n ? H : F,
                    i = 0 == n ? O : R;
                return "=>" == e ? T(M, n ? j : q, A) : "operator" == e ? /\+\+|--/.test(t) ? T(r) : "?" == t ? T(O, N(":"), i) : T(i) : "quasi" == e ? S(B, r) : ";" != e ? "(" == e ? X(R, ")", "call", r) : "." == e ? T(U, r) : "[" == e ? T(L("]"), P, N("]"), E, r) : void 0 : void 0
            }

            function B(e, t) {
                return "quasi" != e ? S() : "${" != t.slice(t.length - 2) ? T(B) : T(O, z)
            }

            function z(e) {
                if ("}" == e) return C.marked = "string-2", C.state.tokenize = b, T(B)
            }

            function q(e) {
                return o(C.stream, C.state), S("{" == e ? I : O)
            }

            function j(e) {
                return o(C.stream, C.state), S("{" == e ? I : R)
            }

            function W(e) {
                return ":" == e ? T(E, I) : S(H, N(";"), E)
            }

            function U(e) {
                if ("variable" == e) return C.marked = "property", T()
            }

            function K(e, t) {
                return "variable" == e || "keyword" == C.style ? (C.marked = "property", T("get" == t || "set" == t ? V : G)) : "number" == e || "string" == e ? (C.marked = s ? "property" : C.style + " property", T(G)) : "jsonld-keyword" == e ? T(G) : "[" == e ? T(O, N("]"), G) : void 0
            }

            function V(e) {
                return "variable" != e ? S(G) : (C.marked = "property", T(he))
            }

            function G(e) {
                return ":" == e ? T(R) : "(" == e ? S(he) : void 0
            }

            function Y(n, r) {
                function i(e) {
                    if ("," != e) return e == r ? T() : T(N(r));
                    var t = C.state.lexical;
                    return "call" == t.info && (t.pos = (t.pos || 0) + 1), T(n, i)
                }
                return function(e) {
                    return e == r ? T() : S(n, i)
                }
            }

            function X(e, t, n) {
                for (var r = 3; r < arguments.length; r++) C.cc.push(arguments[r]);
                return T(L(t, n), Y(e, t), E)
            }

            function Q(e) {
                return "}" == e ? T() : S(I, Q)
            }

            function J(e) {
                if (f && ":" == e) return T(Z)
            }

            function Z(e) {
                if ("variable" == e) return C.marked = "variable-3", T()
            }

            function ee() {
                return S(te, J, re, ie)
            }

            function te(e, t) {
                return "variable" == e ? (n(t), T()) : "[" == e ? X(te, "]") : "{" == e ? X(ne, "}") : void 0
            }

            function ne(e, t) {
                return "variable" != e || C.stream.match(/^\s*:/, !1) ? ("variable" == e && (C.marked = "property"), T(N(":"), te, re)) : (n(t), T(re))
            }

            function re(e, t) {
                if ("=" == t) return T(R)
            }

            function ie(e) {
                if ("," == e) return T(ee)
            }

            function oe(e, t) {
                if ("keyword b" == e && "else" == t) return T(L("form", "else"), I, E)
            }

            function se(e) {
                if ("(" == e) return T(L(")"), ae, N(")"), E)
            }

            function ae(e) {
                return "var" == e ? T(ee, N(";"), ce) : ";" == e ? T(ce) : "variable" == e ? T(le) : S(O, N(";"), ce)
            }

            function le(e, t) {
                return "in" == t || "of" == t ? (C.marked = "keyword", T(O)) : T(H, ce)
            }

            function ce(e, t) {
                return ";" == e ? T(ue) : "in" == t || "of" == t ? (C.marked = "keyword", T(O)) : S(O, N(";"), ue)
            }

            function ue(e) {
                ")" != e && T(O)
            }

            function he(e, t) {
                return "*" == t ? (C.marked = "keyword", T(he)) : "variable" == e ? (n(t), T(he)) : "(" == e ? T(M, L(")"), Y(de, ")"), E, I, A) : void 0
            }

            function de(e) {
                return "spread" == e ? T(de) : S(te, J)
            }

            function fe(e, t) {
                if ("variable" == e) return n(t), T(pe)
            }

            function pe(e, t) {
                return "extends" == t ? T(O, pe) : "{" == e ? T(L("}"), me, E) : void 0
            }

            function me(e, t) {
                return "variable" == e || "keyword" == C.style ? "static" == t ? (C.marked = "keyword", T(me)) : (C.marked = "property", "get" == t || "set" == t ? T(ge, he, me) : T(he, me)) : "*" == t ? (C.marked = "keyword", T(me)) : ";" == e ? T(me) : "}" == e ? T() : void 0
            }

            function ge(e) {
                return "variable" != e ? S() : (C.marked = "property", T())
            }

            function ve(e, t) {
                return "string" == e ? T(I) : "variable" == e ? (n(t), T(we)) : void 0
            }

            function ye(e, t) {
                return "*" == t ? (C.marked = "keyword", T(we, N(";"))) : "default" == t ? (C.marked = "keyword", T(O, N(";"))) : S(I)
            }

            function be(e) {
                return "string" == e ? T() : S(xe, we)
            }

            function xe(e, t) {
                return "{" == e ? X(xe, "}") : ("variable" == e && n(t), T())
            }

            function we(e, t) {
                if ("from" == t) return C.marked = "keyword", T(O)
            }

            function ke(e) {
                return "]" == e ? T() : S(R, _e)
            }

            function _e(e) {
                return "for" == e ? S(Ce, N("]")) : "," == e ? T(Y($, "]")) : S(Y(R, "]"))
            }

            function Ce(e) {
                return "for" == e ? T(se, Ce) : "if" == e ? T(O, Ce) : void 0
            }
            return E.lex = !0, {
                startState: function(e) {
                    var t = {
                        tokenize: v,
                        lastType: "sof",
                        cc: [],
                        lexical: new k((e || 0) - h, 0, "block", !1),
                        localVars: u.localVars,
                        context: u.localVars && {
                            vars: u.localVars
                        },
                        indented: 0
                    };
                    return u.globalVars && "object" == typeof u.globalVars && (t.globalVars = u.globalVars), t
                },
                token: function(e, t) {
                    if (e.sol() && (t.lexical.hasOwnProperty("align") || (t.lexical.align = !1), t.indented = e.indentation(), o(e, t)), t.tokenize != y && e.eatSpace()) return null;
                    var n = t.tokenize(e, t);
                    return "comment" == r ? n : (t.lastType = "operator" != r || "++" != i && "--" != i ? r : "incdec", function(e, t, n, r, i) {
                        var o = e.cc;
                        for (C.state = e, C.stream = i, C.marked = null, C.cc = o, C.style = t, e.lexical.hasOwnProperty("align") || (e.lexical.align = !0);;)
                            if ((o.length ? o.pop() : a ? O : I)(n, r)) {
                                for (; o.length && o[o.length - 1].lex;) o.pop()();
                                return C.marked ? C.marked : "variable" == n && _(e, r) ? "variable-2" : t
                            }
                    }(t, n, r, i, e))
                },
                indent: function(e, t) {
                    if (e.tokenize == y) return Se.Pass;
                    if (e.tokenize != v) return 0;
                    var n = t && t.charAt(0),
                        r = e.lexical;
                    if (!/^\s*else\b/.test(t))
                        for (var i = e.cc.length - 1; 0 <= i; --i) {
                            var o = e.cc[i];
                            if (o == E) r = r.prev;
                            else if (o != oe) break
                        }
                    "stat" == r.type && "}" == n && (r = r.prev), d && ")" == r.type && "stat" == r.prev.type && (r = r.prev);
                    var s, a, l = r.type,
                        c = n == l;
                    return "vardef" == l ? r.indented + ("operator" == e.lastType || "," == e.lastType ? r.info + 1 : 0) : "form" == l && "{" == n ? r.indented : "form" == l ? r.indented + h : "stat" == l ? r.indented + (a = t, "operator" == (s = e).lastType || "," == s.lastType || p.test(a.charAt(0)) || /[,.]/.test(a.charAt(0)) ? d || h : 0) : "switch" != r.info || c || 0 == u.doubleIndentSwitch ? r.align ? r.column + (c ? 0 : 1) : r.indented + (c ? 0 : h) : r.indented + (/^(?:case|default)\b/.test(t) ? h : 2 * h)
                },
                electricInput: /^\s*(?:case .*?:|default:|\{|\})$/,
                blockCommentStart: a ? null : "/*",
                blockCommentEnd: a ? null : "*/",
                lineComment: a ? null : "//",
                fold: "brace",
                closeBrackets: "()[]{}''\"\"``",
                helperType: a ? "json" : "javascript",
                jsonldMode: s,
                jsonMode: a
            }
        }), Se.registerHelper("wordChars", "javascript", /[\w$]/), Se.defineMIME("text/javascript", "javascript"), Se.defineMIME("text/ecmascript", "javascript"), Se.defineMIME("application/javascript", "javascript"), Se.defineMIME("application/x-javascript", "javascript"), Se.defineMIME("application/ecmascript", "javascript"), Se.defineMIME("application/json", {
            name: "javascript",
            json: !0
        }), Se.defineMIME("application/x-json", {
            name: "javascript",
            json: !0
        }), Se.defineMIME("application/ld+json", {
            name: "javascript",
            jsonld: !0
        }), Se.defineMIME("text/typescript", {
            name: "javascript",
            typescript: !0
        }), Se.defineMIME("application/typescript", {
            name: "javascript",
            typescript: !0
        })
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("julia", function(e, c) {
            var u = "error";

            function t(e) {
                return new RegExp("^((" + e.join(")|(") + "))\\b")
            }
            var h = c.operators || /^\.?[|&^\\%*+\-<>!=\/]=?|\?|~|:|\$|\.[<>]|<<=?|>>>?=?|\.[<>=]=|->?|\/\/|\bin\b/,
                d = c.delimiters || /^[;,()[\]{}]/,
                f = c.identifiers || /^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*!*/,
                p = /^(`|'|"{3}|([br]?"))/,
                m = t(["if", "else", "elseif", "while", "for", "begin", "let", "end", "do", "try", "catch", "finally", "return", "break", "continue", "global", "local", "const", "export", "import", "importall", "using", "function", "macro", "module", "baremodule", "type", "immutable", "quote", "typealias", "abstract", "bitstype", "ccall"]),
                g = t(["true", "false", "enumerate", "open", "close", "nothing", "NaN", "Inf", "print", "println", "Int", "Int8", "Uint8", "Int16", "Uint16", "Int32", "Uint32", "Int64", "Uint64", "Int128", "Uint128", "Bool", "Char", "Float16", "Float32", "Float64", "Array", "Vector", "Matrix", "String", "UTF8String", "ASCIIString", "error", "warn", "info", "@printf"]),
                v = t(["begin", "function", "type", "immutable", "let", "macro", "for", "while", "quote", "if", "else", "elseif", "try", "finally", "catch", "do"]),
                y = t(["end", "else", "elseif", "catch", "finally"]),
                b = /^@[_A-Za-z][_A-Za-z0-9]*/,
                x = /^:[_A-Za-z][_A-Za-z0-9]*/;

            function w(e) {
                var t = k(e);
                return "[" == t || "{" == t
            }

            function k(e) {
                return 0 == e.scopes.length ? null : e.scopes[e.scopes.length - 1]
            }

            function _(e, t) {
                var n = t.leaving_expr;
                if (e.sol() && (n = !1), t.leaving_expr = !1, n && e.match(/^'+/)) return "operator";
                if (e.match(/^\.{2,3}/)) return "operator";
                if (e.eatSpace()) return null;
                var r = e.peek();
                if ("#" === r) return e.skipToEnd(), "comment";
                "[" === r && t.scopes.push("["), "{" === r && t.scopes.push("{");
                var i, o = k(t);
                if ("[" === o && "]" === r && (t.scopes.pop(), t.leaving_expr = !0), "{" === o && "}" === r && (t.scopes.pop(), t.leaving_expr = !0), ")" === r && (t.leaving_expr = !0), !w(t) && (i = e.match(v, !1)) && t.scopes.push(i), !w(t) && e.match(y, !1) && t.scopes.pop(), w(t) && e.match(/^end/)) return "number";
                if (e.match(/^=>/)) return "operator";
                if (e.match(/^[0-9\.]/, !1)) {
                    var s = RegExp(/^im\b/),
                        a = !1;
                    if (e.match(/^\d*\.(?!\.)\d+([ef][\+\-]?\d+)?/i) && (a = !0), e.match(/^\d+\.(?!\.)\d*/) && (a = !0), e.match(/^\.\d+/) && (a = !0), a) return e.match(s), t.leaving_expr = !0, "number";
                    var l = !1;
                    if (e.match(/^0x[0-9a-f]+/i) && (l = !0), e.match(/^0b[01]+/i) && (l = !0), e.match(/^0o[0-7]+/i) && (l = !0), e.match(/^[1-9]\d*(e[\+\-]?\d+)?/) && (l = !0), e.match(/^0(?![\dx])/i) && (l = !0), l) return e.match(s), t.leaving_expr = !0, "number"
                }
                return e.match(/^(::)|(<:)/) ? "operator" : !n && e.match(x) ? "string" : e.match(h) ? "operator" : e.match(p) ? (t.tokenize = function(n) {
                    for (; 0 <= "rub".indexOf(n.charAt(0).toLowerCase());) n = n.substr(1);
                    var r = 1 == n.length,
                        i = "string";

                    function e(e, t) {
                        for (; !e.eol();)
                            if (e.eatWhile(/[^'"\\]/), e.eat("\\")) {
                                if (e.next(), r && e.eol()) return i
                            } else {
                                if (e.match(n)) return t.tokenize = _, i;
                                e.eat(/['"]/)
                            } if (r) {
                            if (c.singleLineStringErrors) return u;
                            t.tokenize = _
                        }
                        return i
                    }
                    return e.isString = !0, e
                }(e.current()), t.tokenize(e, t)) : e.match(b) ? "meta" : e.match(d) ? null : e.match(m) ? "keyword" : e.match(g) ? "builtin" : e.match(f) ? (t.leaving_expr = !0, "variable") : (e.next(), u)
            }
            return {
                startState: function() {
                    return {
                        tokenize: _,
                        scopes: [],
                        leaving_expr: !1
                    }
                },
                token: function(e, t) {
                    var n = function(e, t) {
                        null;
                        var n = t.tokenize(e, t);
                        return "." === e.current() && null === (n = e.match(f, !1) ? null : u) && "meta" === t.lastStyle && (n = "meta"), n
                    }(e, t);
                    return t.lastStyle = n
                },
                indent: function(e, t) {
                    var n = 0;
                    return "end" != t && "]" != t && "}" != t && "else" != t && "elseif" != t && "catch" != t && "finally" != t || (n = -1), 4 * (e.scopes.length + n)
                },
                lineComment: "#",
                fold: "indent",
                electricChars: "edlsifyh]}"
            }
        }), e.defineMIME("text/x-julia", "julia")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("lua", function(e, t) {
            var r = e.indentUnit;

            function n(e) {
                return new RegExp("^(?:" + e.join("|") + ")$", "i")
            }
            var i = n(t.specials || []),
                o = n(["_G", "_VERSION", "assert", "collectgarbage", "dofile", "error", "getfenv", "getmetatable", "ipairs", "load", "loadfile", "loadstring", "module", "next", "pairs", "pcall", "print", "rawequal", "rawget", "rawset", "require", "select", "setfenv", "setmetatable", "tonumber", "tostring", "type", "unpack", "xpcall", "coroutine.create", "coroutine.resume", "coroutine.running", "coroutine.status", "coroutine.wrap", "coroutine.yield", "debug.debug", "debug.getfenv", "debug.gethook", "debug.getinfo", "debug.getlocal", "debug.getmetatable", "debug.getregistry", "debug.getupvalue", "debug.setfenv", "debug.sethook", "debug.setlocal", "debug.setmetatable", "debug.setupvalue", "debug.traceback", "close", "flush", "lines", "read", "seek", "setvbuf", "write", "io.close", "io.flush", "io.input", "io.lines", "io.open", "io.output", "io.popen", "io.read", "io.stderr", "io.stdin", "io.stdout", "io.tmpfile", "io.type", "io.write", "math.abs", "math.acos", "math.asin", "math.atan", "math.atan2", "math.ceil", "math.cos", "math.cosh", "math.deg", "math.exp", "math.floor", "math.fmod", "math.frexp", "math.huge", "math.ldexp", "math.log", "math.log10", "math.max", "math.min", "math.modf", "math.pi", "math.pow", "math.rad", "math.random", "math.randomseed", "math.sin", "math.sinh", "math.sqrt", "math.tan", "math.tanh", "os.clock", "os.date", "os.difftime", "os.execute", "os.exit", "os.getenv", "os.remove", "os.rename", "os.setlocale", "os.time", "os.tmpname", "package.cpath", "package.loaded", "package.loaders", "package.loadlib", "package.path", "package.preload", "package.seeall", "string.byte", "string.char", "string.dump", "string.find", "string.format", "string.gmatch", "string.gsub", "string.len", "string.lower", "string.match", "string.rep", "string.reverse", "string.sub", "string.upper", "table.concat", "table.insert", "table.maxn", "table.remove", "table.sort"]),
                s = n(["and", "break", "elseif", "false", "nil", "not", "or", "return", "true", "function", "end", "if", "then", "else", "do", "while", "repeat", "until", "for", "in", "local"]),
                a = n(["function", "if", "repeat", "do", "\\(", "{"]),
                l = n(["end", "until", "\\)", "}"]),
                c = new RegExp("^(?:" + ["end", "until", "\\)", "}", "else", "elseif"].join("|") + ")", "i");

            function u(e) {
                for (var t = 0; e.eat("=");) ++t;
                return e.eat("["), t
            }

            function h(e, t) {
                var i, n = e.next();
                return "-" == n && e.eat("-") ? e.eat("[") && e.eat("[") ? (t.cur = d(u(e), "comment"))(e, t) : (e.skipToEnd(), "comment") : '"' == n || "'" == n ? (t.cur = (i = n, function(e, t) {
                    for (var n, r = !1; null != (n = e.next()) && (n != i || r);) r = !r && "\\" == n;
                    return r || (t.cur = h), "string"
                }))(e, t) : "[" == n && /[\[=]/.test(e.peek()) ? (t.cur = d(u(e), "string"))(e, t) : /\d/.test(n) ? (e.eatWhile(/[\w.%]/), "number") : /[\w_]/.test(n) ? (e.eatWhile(/[\w\\\-_.]/), "variable") : null
            }

            function d(i, o) {
                return function(e, t) {
                    for (var n, r = null; null != (n = e.next());)
                        if (null == r) "]" == n && (r = 0);
                        else if ("=" == n) ++r;
                    else {
                        if ("]" == n && r == i) {
                            t.cur = h;
                            break
                        }
                        r = null
                    }
                    return o
                }
            }
            return {
                startState: function(e) {
                    return {
                        basecol: e || 0,
                        indentDepth: 0,
                        cur: h
                    }
                },
                token: function(e, t) {
                    if (e.eatSpace()) return null;
                    var n = t.cur(e, t),
                        r = e.current();
                    return "variable" == n && (s.test(r) ? n = "keyword" : o.test(r) ? n = "builtin" : i.test(r) && (n = "variable-2")), "comment" != n && "string" != n && (a.test(r) ? ++t.indentDepth : l.test(r) && --t.indentDepth), n
                },
                indent: function(e, t) {
                    var n = c.test(t);
                    return e.basecol + r * (e.indentDepth - (n ? 1 : 0))
                },
                lineComment: "--",
                blockCommentStart: "--[[",
                blockCommentEnd: "]]"
            }
        }), e.defineMIME("text/x-lua", "lua")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("mllike", function(e, i) {
            var o = {
                    let: "keyword",
                    rec: "keyword",
                    in: "keyword",
                    of: "keyword",
                    and: "keyword",
                    if: "keyword",
                    then: "keyword",
                    else: "keyword",
                    for: "keyword",
                    to: "keyword",
                    while: "keyword",
                    do: "keyword",
                    done: "keyword",
                    fun: "keyword",
                    function: "keyword",
                    val: "keyword",
                    type: "keyword",
                    mutable: "keyword",
                    match: "keyword",
                    with: "keyword",
                    try: "keyword",
                    open: "builtin",
                    ignore: "builtin",
                    begin: "keyword",
                    end: "keyword"
                },
                t = i.extraWords || {};
            for (var n in t) t.hasOwnProperty(n) && (o[n] = i.extraWords[n]);

            function s(e, t) {
                var n = e.next();
                if ('"' === n) return t.tokenize = a, t.tokenize(e, t);
                if ("(" === n && e.eat("*")) return t.commentLevel++, t.tokenize = l, t.tokenize(e, t);
                if ("~" === n) return e.eatWhile(/\w/), "variable-2";
                if ("`" === n) return e.eatWhile(/\w/), "quote";
                if ("/" === n && i.slashComments && e.eat("/")) return e.skipToEnd(), "comment";
                if (/\d/.test(n)) return e.eatWhile(/[\d]/), e.eat(".") && e.eatWhile(/[\d]/), "number";
                if (/[+\-*&%=<>!?|]/.test(n)) return "operator";
                e.eatWhile(/\w/);
                var r = e.current();
                return o.hasOwnProperty(r) ? o[r] : "variable"
            }

            function a(e, t) {
                for (var n, r = !1, i = !1; null != (n = e.next());) {
                    if ('"' === n && !i) {
                        r = !0;
                        break
                    }
                    i = !i && "\\" === n
                }
                return r && !i && (t.tokenize = s), "string"
            }

            function l(e, t) {
                for (var n, r; 0 < t.commentLevel && null != (r = e.next());) "(" === n && "*" === r && t.commentLevel++, "*" === n && ")" === r && t.commentLevel--, n = r;
                return t.commentLevel <= 0 && (t.tokenize = s), "comment"
            }
            return {
                startState: function() {
                    return {
                        tokenize: s,
                        commentLevel: 0
                    }
                },
                token: function(e, t) {
                    return e.eatSpace() ? null : t.tokenize(e, t)
                },
                blockCommentStart: "(*",
                blockCommentEnd: "*)",
                lineComment: i.slashComments ? "//" : null
            }
        }), e.defineMIME("text/x-ocaml", {
            name: "mllike",
            extraWords: {
                succ: "keyword",
                trace: "builtin",
                exit: "builtin",
                print_string: "builtin",
                print_endline: "builtin",
                true: "atom",
                false: "atom",
                raise: "keyword"
            }
        }), e.defineMIME("text/x-fsharp", {
            name: "mllike",
            extraWords: {
                abstract: "keyword",
                as: "keyword",
                assert: "keyword",
                base: "keyword",
                class: "keyword",
                default: "keyword",
                delegate: "keyword",
                downcast: "keyword",
                downto: "keyword",
                elif: "keyword",
                exception: "keyword",
                extern: "keyword",
                finally: "keyword",
                global: "keyword",
                inherit: "keyword",
                inline: "keyword",
                interface: "keyword",
                internal: "keyword",
                lazy: "keyword",
                "let!": "keyword",
                member: "keyword",
                module: "keyword",
                namespace: "keyword",
                new: "keyword",
                null: "keyword",
                override: "keyword",
                private: "keyword",
                public: "keyword",
                return: "keyword",
                "return!": "keyword",
                select: "keyword",
                static: "keyword",
                struct: "keyword",
                upcast: "keyword",
                use: "keyword",
                "use!": "keyword",
                val: "keyword",
                when: "keyword",
                yield: "keyword",
                "yield!": "keyword",
                List: "builtin",
                Seq: "builtin",
                Map: "builtin",
                Set: "builtin",
                int: "builtin",
                string: "builtin",
                raise: "builtin",
                failwith: "builtin",
                not: "builtin",
                true: "builtin",
                false: "builtin"
            },
            slashComments: !0
        })
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";

        function f(e, t) {
            return e.string.charAt(e.pos + (t || 0))
        }

        function p(e, t) {
            if (t) {
                var n = e.pos - t;
                return e.string.substr(0 <= n ? n : 0, t)
            }
            return e.string.substr(0, e.pos - 1)
        }

        function m(e, t) {
            var n = e.string.length,
                r = n - e.pos + 1;
            return e.string.substr(e.pos, t && t < n ? t : r)
        }

        function g(e, t) {
            var n, r = e.pos + t;
            r <= 0 ? e.pos = 0 : r >= (n = e.string.length - 1) ? e.pos = n : e.pos = r
        }
        e.defineMode("perl", function() {
            var a = {
                    "->": 4,
                    "++": 4,
                    "--": 4,
                    "**": 4,
                    "=~": 4,
                    "!~": 4,
                    "*": 4,
                    "/": 4,
                    "%": 4,
                    x: 4,
                    "+": 4,
                    "-": 4,
                    ".": 4,
                    "<<": 4,
                    ">>": 4,
                    "<": 4,
                    ">": 4,
                    "<=": 4,
                    ">=": 4,
                    lt: 4,
                    gt: 4,
                    le: 4,
                    ge: 4,
                    "==": 4,
                    "!=": 4,
                    "<=>": 4,
                    eq: 4,
                    ne: 4,
                    cmp: 4,
                    "~~": 4,
                    "&": 4,
                    "|": 4,
                    "^": 4,
                    "&&": 4,
                    "||": 4,
                    "//": 4,
                    "..": 4,
                    "...": 4,
                    "?": 4,
                    ":": 4,
                    "=": 4,
                    "+=": 4,
                    "-=": 4,
                    "*=": 4,
                    ",": 4,
                    "=>": 4,
                    "::": 4,
                    not: 4,
                    and: 4,
                    or: 4,
                    xor: 4,
                    BEGIN: [5, 1],
                    END: [5, 1],
                    PRINT: [5, 1],
                    PRINTF: [5, 1],
                    GETC: [5, 1],
                    READ: [5, 1],
                    READLINE: [5, 1],
                    DESTROY: [5, 1],
                    TIE: [5, 1],
                    TIEHANDLE: [5, 1],
                    UNTIE: [5, 1],
                    STDIN: 5,
                    STDIN_TOP: 5,
                    STDOUT: 5,
                    STDOUT_TOP: 5,
                    STDERR: 5,
                    STDERR_TOP: 5,
                    $ARG: 5,
                    $_: 5,
                    "@ARG": 5,
                    "@_": 5,
                    $LIST_SEPARATOR: 5,
                    '$"': 5,
                    $PROCESS_ID: 5,
                    $PID: 5,
                    $$: 5,
                    $REAL_GROUP_ID: 5,
                    $GID: 5,
                    "$(": 5,
                    $EFFECTIVE_GROUP_ID: 5,
                    $EGID: 5,
                    "$)": 5,
                    $PROGRAM_NAME: 5,
                    $0: 5,
                    $SUBSCRIPT_SEPARATOR: 5,
                    $SUBSEP: 5,
                    "$;": 5,
                    $REAL_USER_ID: 5,
                    $UID: 5,
                    "$<": 5,
                    $EFFECTIVE_USER_ID: 5,
                    $EUID: 5,
                    "$>": 5,
                    $a: 5,
                    $b: 5,
                    $COMPILING: 5,
                    "$^C": 5,
                    $DEBUGGING: 5,
                    "$^D": 5,
                    "${^ENCODING}": 5,
                    $ENV: 5,
                    "%ENV": 5,
                    $SYSTEM_FD_MAX: 5,
                    "$^F": 5,
                    "@F": 5,
                    "${^GLOBAL_PHASE}": 5,
                    "$^H": 5,
                    "%^H": 5,
                    "@INC": 5,
                    "%INC": 5,
                    $INPLACE_EDIT: 5,
                    "$^I": 5,
                    "$^M": 5,
                    $OSNAME: 5,
                    "$^O": 5,
                    "${^OPEN}": 5,
                    $PERLDB: 5,
                    "$^P": 5,
                    $SIG: 5,
                    "%SIG": 5,
                    $BASETIME: 5,
                    "$^T": 5,
                    "${^TAINT}": 5,
                    "${^UNICODE}": 5,
                    "${^UTF8CACHE}": 5,
                    "${^UTF8LOCALE}": 5,
                    $PERL_VERSION: 5,
                    "$^V": 5,
                    "${^WIN32_SLOPPY_STAT}": 5,
                    $EXECUTABLE_NAME: 5,
                    "$^X": 5,
                    $1: 5,
                    $MATCH: 5,
                    "$&": 5,
                    "${^MATCH}": 5,
                    $PREMATCH: 5,
                    "$`": 5,
                    "${^PREMATCH}": 5,
                    $POSTMATCH: 5,
                    "$'": 5,
                    "${^POSTMATCH}": 5,
                    $LAST_PAREN_MATCH: 5,
                    "$+": 5,
                    $LAST_SUBMATCH_RESULT: 5,
                    "$^N": 5,
                    "@LAST_MATCH_END": 5,
                    "@+": 5,
                    "%LAST_PAREN_MATCH": 5,
                    "%+": 5,
                    "@LAST_MATCH_START": 5,
                    "@-": 5,
                    "%LAST_MATCH_START": 5,
                    "%-": 5,
                    $LAST_REGEXP_CODE_RESULT: 5,
                    "$^R": 5,
                    "${^RE_DEBUG_FLAGS}": 5,
                    "${^RE_TRIE_MAXBUF}": 5,
                    $ARGV: 5,
                    "@ARGV": 5,
                    ARGV: 5,
                    ARGVOUT: 5,
                    $OUTPUT_FIELD_SEPARATOR: 5,
                    $OFS: 5,
                    "$,": 5,
                    $INPUT_LINE_NUMBER: 5,
                    $NR: 5,
                    "$.": 5,
                    $INPUT_RECORD_SEPARATOR: 5,
                    $RS: 5,
                    "$/": 5,
                    $OUTPUT_RECORD_SEPARATOR: 5,
                    $ORS: 5,
                    "$\\": 5,
                    $OUTPUT_AUTOFLUSH: 5,
                    "$|": 5,
                    $ACCUMULATOR: 5,
                    "$^A": 5,
                    $FORMAT_FORMFEED: 5,
                    "$^L": 5,
                    $FORMAT_PAGE_NUMBER: 5,
                    "$%": 5,
                    $FORMAT_LINES_LEFT: 5,
                    "$-": 5,
                    $FORMAT_LINE_BREAK_CHARACTERS: 5,
                    "$:": 5,
                    $FORMAT_LINES_PER_PAGE: 5,
                    "$=": 5,
                    $FORMAT_TOP_NAME: 5,
                    "$^": 5,
                    $FORMAT_NAME: 5,
                    "$~": 5,
                    "${^CHILD_ERROR_NATIVE}": 5,
                    $EXTENDED_OS_ERROR: 5,
                    "$^E": 5,
                    $EXCEPTIONS_BEING_CAUGHT: 5,
                    "$^S": 5,
                    $WARNING: 5,
                    "$^W": 5,
                    "${^WARNING_BITS}": 5,
                    $OS_ERROR: 5,
                    $ERRNO: 5,
                    "$!": 5,
                    "%OS_ERROR": 5,
                    "%ERRNO": 5,
                    "%!": 5,
                    $CHILD_ERROR: 5,
                    "$?": 5,
                    $EVAL_ERROR: 5,
                    "$@": 5,
                    $OFMT: 5,
                    "$#": 5,
                    "$*": 5,
                    $ARRAY_BASE: 5,
                    "$[": 5,
                    $OLD_PERL_VERSION: 5,
                    "$]": 5,
                    if: [1, 1],
                    elsif: [1, 1],
                    else: [1, 1],
                    while: [1, 1],
                    unless: [1, 1],
                    for: [1, 1],
                    foreach: [1, 1],
                    abs: 1,
                    accept: 1,
                    alarm: 1,
                    atan2: 1,
                    bind: 1,
                    binmode: 1,
                    bless: 1,
                    bootstrap: 1,
                    break: 1,
                    caller: 1,
                    chdir: 1,
                    chmod: 1,
                    chomp: 1,
                    chop: 1,
                    chown: 1,
                    chr: 1,
                    chroot: 1,
                    close: 1,
                    closedir: 1,
                    connect: 1,
                    continue: [1, 1],
                    cos: 1,
                    crypt: 1,
                    dbmclose: 1,
                    dbmopen: 1,
                    default: 1,
                    defined: 1,
                    delete: 1,
                    die: 1,
                    do: 1,
                    dump: 1,
                    each: 1,
                    endgrent: 1,
                    endhostent: 1,
                    endnetent: 1,
                    endprotoent: 1,
                    endpwent: 1,
                    endservent: 1,
                    eof: 1,
                    eval: 1,
                    exec: 1,
                    exists: 1,
                    exit: 1,
                    exp: 1,
                    fcntl: 1,
                    fileno: 1,
                    flock: 1,
                    fork: 1,
                    format: 1,
                    formline: 1,
                    getc: 1,
                    getgrent: 1,
                    getgrgid: 1,
                    getgrnam: 1,
                    gethostbyaddr: 1,
                    gethostbyname: 1,
                    gethostent: 1,
                    getlogin: 1,
                    getnetbyaddr: 1,
                    getnetbyname: 1,
                    getnetent: 1,
                    getpeername: 1,
                    getpgrp: 1,
                    getppid: 1,
                    getpriority: 1,
                    getprotobyname: 1,
                    getprotobynumber: 1,
                    getprotoent: 1,
                    getpwent: 1,
                    getpwnam: 1,
                    getpwuid: 1,
                    getservbyname: 1,
                    getservbyport: 1,
                    getservent: 1,
                    getsockname: 1,
                    getsockopt: 1,
                    given: 1,
                    glob: 1,
                    gmtime: 1,
                    goto: 1,
                    grep: 1,
                    hex: 1,
                    import: 1,
                    index: 1,
                    int: 1,
                    ioctl: 1,
                    join: 1,
                    keys: 1,
                    kill: 1,
                    last: 1,
                    lc: 1,
                    lcfirst: 1,
                    length: 1,
                    link: 1,
                    listen: 1,
                    local: 2,
                    localtime: 1,
                    lock: 1,
                    log: 1,
                    lstat: 1,
                    m: null,
                    map: 1,
                    mkdir: 1,
                    msgctl: 1,
                    msgget: 1,
                    msgrcv: 1,
                    msgsnd: 1,
                    my: 2,
                    new: 1,
                    next: 1,
                    no: 1,
                    oct: 1,
                    open: 1,
                    opendir: 1,
                    ord: 1,
                    our: 2,
                    pack: 1,
                    package: 1,
                    pipe: 1,
                    pop: 1,
                    pos: 1,
                    print: 1,
                    printf: 1,
                    prototype: 1,
                    push: 1,
                    q: null,
                    qq: null,
                    qr: null,
                    quotemeta: null,
                    qw: null,
                    qx: null,
                    rand: 1,
                    read: 1,
                    readdir: 1,
                    readline: 1,
                    readlink: 1,
                    readpipe: 1,
                    recv: 1,
                    redo: 1,
                    ref: 1,
                    rename: 1,
                    require: 1,
                    reset: 1,
                    return: 1,
                    reverse: 1,
                    rewinddir: 1,
                    rindex: 1,
                    rmdir: 1,
                    s: null,
                    say: 1,
                    scalar: 1,
                    seek: 1,
                    seekdir: 1,
                    select: 1,
                    semctl: 1,
                    semget: 1,
                    semop: 1,
                    send: 1,
                    setgrent: 1,
                    sethostent: 1,
                    setnetent: 1,
                    setpgrp: 1,
                    setpriority: 1,
                    setprotoent: 1,
                    setpwent: 1,
                    setservent: 1,
                    setsockopt: 1,
                    shift: 1,
                    shmctl: 1,
                    shmget: 1,
                    shmread: 1,
                    shmwrite: 1,
                    shutdown: 1,
                    sin: 1,
                    sleep: 1,
                    socket: 1,
                    socketpair: 1,
                    sort: 1,
                    splice: 1,
                    split: 1,
                    sprintf: 1,
                    sqrt: 1,
                    srand: 1,
                    stat: 1,
                    state: 1,
                    study: 1,
                    sub: 1,
                    substr: 1,
                    symlink: 1,
                    syscall: 1,
                    sysopen: 1,
                    sysread: 1,
                    sysseek: 1,
                    system: 1,
                    syswrite: 1,
                    tell: 1,
                    telldir: 1,
                    tie: 1,
                    tied: 1,
                    time: 1,
                    times: 1,
                    tr: null,
                    truncate: 1,
                    uc: 1,
                    ucfirst: 1,
                    umask: 1,
                    undef: 1,
                    unlink: 1,
                    unpack: 1,
                    unshift: 1,
                    untie: 1,
                    use: 1,
                    utime: 1,
                    values: 1,
                    vec: 1,
                    wait: 1,
                    waitpid: 1,
                    wantarray: 1,
                    warn: 1,
                    when: 1,
                    write: 1,
                    y: null
                },
                l = "string-2",
                c = /[goseximacplud]/;

            function u(e, t, o, s, a) {
                return t.chain = null, t.style = null, t.tail = null, t.tokenize = function(e, t) {
                    for (var n, r = !1, i = 0; n = e.next();) {
                        if (n === o[i] && !r) return void 0 !== o[++i] ? (t.chain = o[i], t.style = s, t.tail = a) : a && e.eatWhile(a), t.tokenize = d, s;
                        r = !r && "\\" == n
                    }
                    return s
                }, t.tokenize(e, t)
            }

            function h(e, t, n) {
                return t.tokenize = function(e, t) {
                    return e.string == n && (t.tokenize = d), e.skipToEnd(), "string"
                }, t.tokenize(e, t)
            }

            function d(e, t) {
                if (e.eatSpace()) return null;
                if (t.chain) return u(e, t, t.chain, t.style, t.tail);
                if (e.match(/^\-?[\d\.]/, !1) && e.match(/^(\-?(\d*\.\d+(e[+-]?\d+)?|\d+\.\d*)|0x[\da-fA-F]+|0b[01]+|\d+(e[+-]?\d+)?)/)) return "number";
                if (e.match(/^<<(?=\w)/)) return e.eatWhile(/\w/), h(e, t, e.current().substr(2));
                if (e.sol() && e.match(/^\=item(?!\w)/)) return h(e, t, "=cut");
                var n = e.next();
                if ('"' == n || "'" == n) {
                    if (p(e, 3) == "<<" + n) {
                        var r = e.pos;
                        e.eatWhile(/\w/);
                        var i = e.current().substr(1);
                        if (i && e.eat(n)) return h(e, t, i);
                        e.pos = r
                    }
                    return u(e, t, [n], "string")
                }
                if ("q" == n && (!(o = f(e, -2)) || !/\w/.test(o)))
                    if ("x" == (o = f(e, 0))) {
                        if ("(" == (o = f(e, 1))) return g(e, 2), u(e, t, [")"], l, c);
                        if ("[" == o) return g(e, 2), u(e, t, ["]"], l, c);
                        if ("{" == o) return g(e, 2), u(e, t, ["}"], l, c);
                        if ("<" == o) return g(e, 2), u(e, t, [">"], l, c);
                        if (/[\^'"!~\/]/.test(o)) return g(e, 1), u(e, t, [e.eat(o)], l, c)
                    } else if ("q" == o) {
                    if ("(" == (o = f(e, 1))) return g(e, 2), u(e, t, [")"], "string");
                    if ("[" == o) return g(e, 2), u(e, t, ["]"], "string");
                    if ("{" == o) return g(e, 2), u(e, t, ["}"], "string");
                    if ("<" == o) return g(e, 2), u(e, t, [">"], "string");
                    if (/[\^'"!~\/]/.test(o)) return g(e, 1), u(e, t, [e.eat(o)], "string")
                } else if ("w" == o) {
                    if ("(" == (o = f(e, 1))) return g(e, 2), u(e, t, [")"], "bracket");
                    if ("[" == o) return g(e, 2), u(e, t, ["]"], "bracket");
                    if ("{" == o) return g(e, 2), u(e, t, ["}"], "bracket");
                    if ("<" == o) return g(e, 2), u(e, t, [">"], "bracket");
                    if (/[\^'"!~\/]/.test(o)) return g(e, 1), u(e, t, [e.eat(o)], "bracket")
                } else if ("r" == o) {
                    if ("(" == (o = f(e, 1))) return g(e, 2), u(e, t, [")"], l, c);
                    if ("[" == o) return g(e, 2), u(e, t, ["]"], l, c);
                    if ("{" == o) return g(e, 2), u(e, t, ["}"], l, c);
                    if ("<" == o) return g(e, 2), u(e, t, [">"], l, c);
                    if (/[\^'"!~\/]/.test(o)) return g(e, 1), u(e, t, [e.eat(o)], l, c)
                } else if (/[\^'"!~\/(\[{<]/.test(o)) {
                    if ("(" == o) return g(e, 1), u(e, t, [")"], "string");
                    if ("[" == o) return g(e, 1), u(e, t, ["]"], "string");
                    if ("{" == o) return g(e, 1), u(e, t, ["}"], "string");
                    if ("<" == o) return g(e, 1), u(e, t, [">"], "string");
                    if (/[\^'"!~\/]/.test(o)) return u(e, t, [e.eat(o)], "string")
                }
                if ("m" == n && ((!(o = f(e, -2)) || !/\w/.test(o)) && (o = e.eat(/[(\[{<\^'"!~\/]/)))) {
                    if (/[\^'"!~\/]/.test(o)) return u(e, t, [o], l, c);
                    if ("(" == o) return u(e, t, [")"], l, c);
                    if ("[" == o) return u(e, t, ["]"], l, c);
                    if ("{" == o) return u(e, t, ["}"], l, c);
                    if ("<" == o) return u(e, t, [">"], l, c)
                }
                if ("s" == n && (!(o = /[\/>\]})\w]/.test(f(e, -2))) && (o = e.eat(/[(\[{<\^'"!~\/]/)))) return u(e, t, "[" == o ? ["]", "]"] : "{" == o ? ["}", "}"] : "<" == o ? [">", ">"] : "(" == o ? [")", ")"] : [o, o], l, c);
                if ("y" == n && (!(o = /[\/>\]})\w]/.test(f(e, -2))) && (o = e.eat(/[(\[{<\^'"!~\/]/)))) return u(e, t, "[" == o ? ["]", "]"] : "{" == o ? ["}", "}"] : "<" == o ? [">", ">"] : "(" == o ? [")", ")"] : [o, o], l, c);
                if ("t" == n && (!(o = /[\/>\]})\w]/.test(f(e, -2))) && (o = e.eat("r")) && (o = e.eat(/[(\[{<\^'"!~\/]/)))) return u(e, t, "[" == o ? ["]", "]"] : "{" == o ? ["}", "}"] : "<" == o ? [">", ">"] : "(" == o ? [")", ")"] : [o, o], l, c);
                if ("`" == n) return u(e, t, [n], "variable-2");
                if ("/" == n) return /~\s*$/.test(p(e)) ? u(e, t, [n], l, c) : "operator";
                if ("$" == n) {
                    r = e.pos;
                    if (e.eatWhile(/\d/) || e.eat("{") && e.eatWhile(/\d/) && e.eat("}")) return "variable-2";
                    e.pos = r
                }
                if (/[$@%]/.test(n)) {
                    r = e.pos;
                    if (e.eat("^") && e.eat(/[A-Z]/) || !/[@$%&]/.test(f(e, -2)) && e.eat(/[=|\\\-#?@;:&`~\^!\[\]*'"$+.,\/<>()]/)) {
                        var o = e.current();
                        if (a[o]) return "variable-2"
                    }
                    e.pos = r
                }
                if (/[$@%&]/.test(n) && (e.eatWhile(/[\w$\[\]]/) || e.eat("{") && e.eatWhile(/[\w$\[\]]/) && e.eat("}"))) {
                    o = e.current();
                    return a[o] ? "variable-2" : "variable"
                }
                if ("#" == n && "$" != f(e, -2)) return e.skipToEnd(), "comment";
                if (/[:+\-\^*$&%@=<>!?|\/~\.]/.test(n)) {
                    r = e.pos;
                    if (e.eatWhile(/[:+\-\^*$&%@=<>!?|\/~\.]/), a[e.current()]) return "operator";
                    e.pos = r
                }
                if ("_" == n && 1 == e.pos) {
                    if ("_END__" == m(e, 6)) return u(e, t, ["\0"], "comment");
                    if ("_DATA__" == m(e, 7)) return u(e, t, ["\0"], "variable-2");
                    if ("_C__" == m(e, 7)) return u(e, t, ["\0"], "string")
                }
                if (/\w/.test(n)) {
                    r = e.pos;
                    if ("{" == f(e, -2) && ("}" == f(e, 0) || e.eatWhile(/\w/) && "}" == f(e, 0))) return "string";
                    e.pos = r
                }
                if (/[A-Z]/.test(n)) {
                    var s = f(e, -2);
                    r = e.pos;
                    if (e.eatWhile(/[A-Z_]/), !/[\da-z]/.test(f(e, 0))) return (o = a[e.current()]) ? (o[1] && (o = o[0]), ":" != s ? 1 == o ? "keyword" : 2 == o ? "def" : 3 == o ? "atom" : 4 == o ? "operator" : 5 == o ? "variable-2" : "meta" : "meta") : "meta";
                    e.pos = r
                }
                if (/[a-zA-Z_]/.test(n)) {
                    s = f(e, -2);
                    return e.eatWhile(/\w/), (o = a[e.current()]) ? (o[1] && (o = o[0]), ":" != s ? 1 == o ? "keyword" : 2 == o ? "def" : 3 == o ? "atom" : 4 == o ? "operator" : 5 == o ? "variable-2" : "meta" : "meta") : "meta"
                }
                return null
            }
            return {
                startState: function() {
                    return {
                        tokenize: d,
                        chain: null,
                        style: null,
                        tail: null
                    }
                },
                token: function(e, t) {
                    return (t.tokenize || d)(e, t)
                },
                lineComment: "#"
            }
        }), e.registerHelper("wordChars", "perl", /[\w$]/), e.defineMIME("text/x-perl", "perl")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror"), require("../htmlmixed/htmlmixed"), require("../clike/clike")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror", "../htmlmixed/htmlmixed", "../clike/clike"], e) : e(CodeMirror)
    }(function(s) {
        "use strict";

        function e(e) {
            for (var t = {}, n = e.split(" "), r = 0; r < n.length; ++r) t[n[r]] = !0;
            return t
        }

        function a(i, o) {
            return 0 == i.length ? l(o) : function(e, t) {
                for (var n = i[0], r = 0; r < n.length; r++)
                    if (e.match(n[r][0])) return t.tokenize = a(i.slice(1), o), n[r][1];
                return t.tokenize = l(o), "string"
            }
        }

        function l(n) {
            return function(e, t) {
                return function(e, t, n) {
                    if (e.match("${", !1) || e.match("{$", !1)) return t.tokenize = null, "string";
                    if (e.match(/^\$[a-zA-Z_][a-zA-Z0-9_]*/)) return e.match("[", !1) && (t.tokenize = a([
                        [
                            ["[", null]
                        ],
                        [
                            [/\d[\w\.]*/, "number"],
                            [/\$[a-zA-Z_][a-zA-Z0-9_]*/, "variable-2"],
                            [/[\w\$]+/, "variable"]
                        ],
                        [
                            ["]", null]
                        ]
                    ], n)), e.match(/\-\>\w/, !1) && (t.tokenize = a([
                        [
                            ["->", null]
                        ],
                        [
                            [/[\w]+/, "variable"]
                        ]
                    ], n)), "variable-2";
                    var r = !1;
                    for (; !e.eol() && (r || !e.match("{$", !1) && !e.match(/^(\$[a-zA-Z_][a-zA-Z0-9_]*|\$\{)/, !1));) {
                        if (!r && e.match(n)) {
                            t.tokenize = null, t.tokStack.pop(), t.tokStack.pop();
                            break
                        }
                        r = "\\" == e.next() && !r
                    }
                    return "string"
                }(e, t, n)
            }
        }
        var t = "abstract and array as break case catch class clone const continue declare default do else elseif enddeclare endfor endforeach endif endswitch endwhile extends final for foreach function global goto if implements interface instanceof namespace new or private protected public static switch throw trait try use var while xor die echo empty exit eval include include_once isset list require require_once return print unset __halt_compiler self static parent yield insteadof finally",
            n = "true false null TRUE FALSE NULL __CLASS__ __DIR__ __FILE__ __LINE__ __METHOD__ __FUNCTION__ __NAMESPACE__ __TRAIT__",
            r = "func_num_args func_get_arg func_get_args strlen strcmp strncmp strcasecmp strncasecmp each error_reporting define defined trigger_error user_error set_error_handler restore_error_handler get_declared_classes get_loaded_extensions extension_loaded get_extension_funcs debug_backtrace constant bin2hex hex2bin sleep usleep time mktime gmmktime strftime gmstrftime strtotime date gmdate getdate localtime checkdate flush wordwrap htmlspecialchars htmlentities html_entity_decode md5 md5_file crc32 getimagesize image_type_to_mime_type phpinfo phpversion phpcredits strnatcmp strnatcasecmp substr_count strspn strcspn strtok strtoupper strtolower strpos strrpos strrev hebrev hebrevc nl2br basename dirname pathinfo stripslashes stripcslashes strstr stristr strrchr str_shuffle str_word_count strcoll substr substr_replace quotemeta ucfirst ucwords strtr addslashes addcslashes rtrim str_replace str_repeat count_chars chunk_split trim ltrim strip_tags similar_text explode implode setlocale localeconv parse_str str_pad chop strchr sprintf printf vprintf vsprintf sscanf fscanf parse_url urlencode urldecode rawurlencode rawurldecode readlink linkinfo link unlink exec system escapeshellcmd escapeshellarg passthru shell_exec proc_open proc_close rand srand getrandmax mt_rand mt_srand mt_getrandmax base64_decode base64_encode abs ceil floor round is_finite is_nan is_infinite bindec hexdec octdec decbin decoct dechex base_convert number_format fmod ip2long long2ip getenv putenv getopt microtime gettimeofday getrusage uniqid quoted_printable_decode set_time_limit get_cfg_var magic_quotes_runtime set_magic_quotes_runtime get_magic_quotes_gpc get_magic_quotes_runtime import_request_variables error_log serialize unserialize memory_get_usage var_dump var_export debug_zval_dump print_r highlight_file show_source highlight_string ini_get ini_get_all ini_set ini_alter ini_restore get_include_path set_include_path restore_include_path setcookie header headers_sent connection_aborted connection_status ignore_user_abort parse_ini_file is_uploaded_file move_uploaded_file intval floatval doubleval strval gettype settype is_null is_resource is_bool is_long is_float is_int is_integer is_double is_real is_numeric is_string is_array is_object is_scalar ereg ereg_replace eregi eregi_replace split spliti join sql_regcase dl pclose popen readfile rewind rmdir umask fclose feof fgetc fgets fgetss fread fopen fpassthru ftruncate fstat fseek ftell fflush fwrite fputs mkdir rename copy tempnam tmpfile file file_get_contents stream_select stream_context_create stream_context_set_params stream_context_set_option stream_context_get_options stream_filter_prepend stream_filter_append fgetcsv flock get_meta_tags stream_set_write_buffer set_file_buffer set_socket_blocking stream_set_blocking socket_set_blocking stream_get_meta_data stream_register_wrapper stream_wrapper_register stream_set_timeout socket_set_timeout socket_get_status realpath fnmatch fsockopen pfsockopen pack unpack get_browser crypt opendir closedir chdir getcwd rewinddir readdir dir glob fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype file_exists is_writable is_writeable is_readable is_executable is_file is_dir is_link stat lstat chown touch clearstatcache mail ob_start ob_flush ob_clean ob_end_flush ob_end_clean ob_get_flush ob_get_clean ob_get_length ob_get_level ob_get_status ob_get_contents ob_implicit_flush ob_list_handlers ksort krsort natsort natcasesort asort arsort sort rsort usort uasort uksort shuffle array_walk count end prev next reset current key min max in_array array_search extract compact array_fill range array_multisort array_push array_pop array_shift array_unshift array_splice array_slice array_merge array_merge_recursive array_keys array_values array_count_values array_reverse array_reduce array_pad array_flip array_change_key_case array_rand array_unique array_intersect array_intersect_assoc array_diff array_diff_assoc array_sum array_filter array_map array_chunk array_key_exists pos sizeof key_exists assert assert_options version_compare ftok str_rot13 aggregate session_name session_module_name session_save_path session_id session_regenerate_id session_decode session_register session_unregister session_is_registered session_encode session_start session_destroy session_unset session_set_save_handler session_cache_limiter session_cache_expire session_set_cookie_params session_get_cookie_params session_write_close preg_match preg_match_all preg_replace preg_replace_callback preg_split preg_quote preg_grep overload ctype_alnum ctype_alpha ctype_cntrl ctype_digit ctype_lower ctype_graph ctype_print ctype_punct ctype_space ctype_upper ctype_xdigit virtual apache_request_headers apache_note apache_lookup_uri apache_child_terminate apache_setenv apache_response_headers apache_get_version getallheaders mysql_connect mysql_pconnect mysql_close mysql_select_db mysql_create_db mysql_drop_db mysql_query mysql_unbuffered_query mysql_db_query mysql_list_dbs mysql_list_tables mysql_list_fields mysql_list_processes mysql_error mysql_errno mysql_affected_rows mysql_insert_id mysql_result mysql_num_rows mysql_num_fields mysql_fetch_row mysql_fetch_array mysql_fetch_assoc mysql_fetch_object mysql_data_seek mysql_fetch_lengths mysql_fetch_field mysql_field_seek mysql_free_result mysql_field_name mysql_field_table mysql_field_len mysql_field_type mysql_field_flags mysql_escape_string mysql_real_escape_string mysql_stat mysql_thread_id mysql_client_encoding mysql_get_client_info mysql_get_host_info mysql_get_proto_info mysql_get_server_info mysql_info mysql mysql_fieldname mysql_fieldtable mysql_fieldlen mysql_fieldtype mysql_fieldflags mysql_selectdb mysql_createdb mysql_dropdb mysql_freeresult mysql_numfields mysql_numrows mysql_listdbs mysql_listtables mysql_listfields mysql_db_name mysql_dbname mysql_tablename mysql_table_name pg_connect pg_pconnect pg_close pg_connection_status pg_connection_busy pg_connection_reset pg_host pg_dbname pg_port pg_tty pg_options pg_ping pg_query pg_send_query pg_cancel_query pg_fetch_result pg_fetch_row pg_fetch_assoc pg_fetch_array pg_fetch_object pg_fetch_all pg_affected_rows pg_get_result pg_result_seek pg_result_status pg_free_result pg_last_oid pg_num_rows pg_num_fields pg_field_name pg_field_num pg_field_size pg_field_type pg_field_prtlen pg_field_is_null pg_get_notify pg_get_pid pg_result_error pg_last_error pg_last_notice pg_put_line pg_end_copy pg_copy_to pg_copy_from pg_trace pg_untrace pg_lo_create pg_lo_unlink pg_lo_open pg_lo_close pg_lo_read pg_lo_write pg_lo_read_all pg_lo_import pg_lo_export pg_lo_seek pg_lo_tell pg_escape_string pg_escape_bytea pg_unescape_bytea pg_client_encoding pg_set_client_encoding pg_meta_data pg_convert pg_insert pg_update pg_delete pg_select pg_exec pg_getlastoid pg_cmdtuples pg_errormessage pg_numrows pg_numfields pg_fieldname pg_fieldsize pg_fieldtype pg_fieldnum pg_fieldprtlen pg_fieldisnull pg_freeresult pg_result pg_loreadall pg_locreate pg_lounlink pg_loopen pg_loclose pg_loread pg_lowrite pg_loimport pg_loexport http_response_code get_declared_traits getimagesizefromstring socket_import_stream stream_set_chunk_size trait_exists header_register_callback class_uses session_status session_register_shutdown echo print global static exit array empty eval isset unset die include require include_once require_once json_decode json_encode json_last_error json_last_error_msg curl_close curl_copy_handle curl_errno curl_error curl_escape curl_exec curl_file_create curl_getinfo curl_init curl_multi_add_handle curl_multi_close curl_multi_exec curl_multi_getcontent curl_multi_info_read curl_multi_init curl_multi_remove_handle curl_multi_select curl_multi_setopt curl_multi_strerror curl_pause curl_reset curl_setopt_array curl_setopt curl_share_close curl_share_init curl_share_setopt curl_strerror curl_unescape curl_version mysqli_affected_rows mysqli_autocommit mysqli_change_user mysqli_character_set_name mysqli_close mysqli_commit mysqli_connect_errno mysqli_connect_error mysqli_connect mysqli_data_seek mysqli_debug mysqli_dump_debug_info mysqli_errno mysqli_error_list mysqli_error mysqli_fetch_all mysqli_fetch_array mysqli_fetch_assoc mysqli_fetch_field_direct mysqli_fetch_field mysqli_fetch_fields mysqli_fetch_lengths mysqli_fetch_object mysqli_fetch_row mysqli_field_count mysqli_field_seek mysqli_field_tell mysqli_free_result mysqli_get_charset mysqli_get_client_info mysqli_get_client_stats mysqli_get_client_version mysqli_get_connection_stats mysqli_get_host_info mysqli_get_proto_info mysqli_get_server_info mysqli_get_server_version mysqli_info mysqli_init mysqli_insert_id mysqli_kill mysqli_more_results mysqli_multi_query mysqli_next_result mysqli_num_fields mysqli_num_rows mysqli_options mysqli_ping mysqli_prepare mysqli_query mysqli_real_connect mysqli_real_escape_string mysqli_real_query mysqli_reap_async_query mysqli_refresh mysqli_rollback mysqli_select_db mysqli_set_charset mysqli_set_local_infile_default mysqli_set_local_infile_handler mysqli_sqlstate mysqli_ssl_set mysqli_stat mysqli_stmt_init mysqli_store_result mysqli_thread_id mysqli_thread_safe mysqli_use_result mysqli_warning_count";
        s.registerHelper("hintWords", "php", [t, n, r].join(" ").split(" ")), s.registerHelper("wordChars", "php", /[\w$]/);
        var i = {
            name: "clike",
            helperType: "php",
            keywords: e(t),
            blockKeywords: e("catch do else elseif for foreach if switch try while finally"),
            atoms: e(n),
            builtin: e(r),
            multiLineStrings: !0,
            hooks: {
                $: function(e) {
                    return e.eatWhile(/[\w\$_]/), "variable-2"
                },
                "<": function(e, t) {
                    if (e.match(/<</)) {
                        e.eatWhile(/[\w\.]/);
                        var n = e.current().slice(3);
                        if (n) return (t.tokStack || (t.tokStack = [])).push(n, 0), t.tokenize = l(n), "string"
                    }
                    return !1
                },
                "#": function(e) {
                    for (; !e.eol() && !e.match("?>", !1);) e.next();
                    return "comment"
                },
                "/": function(e) {
                    if (e.eat("/")) {
                        for (; !e.eol() && !e.match("?>", !1);) e.next();
                        return "comment"
                    }
                    return !1
                },
                '"': function(e, t) {
                    return (t.tokStack || (t.tokStack = [])).push('"', 0), t.tokenize = l('"'), "string"
                },
                "{": function(e, t) {
                    return t.tokStack && t.tokStack.length && t.tokStack[t.tokStack.length - 1]++, !1
                },
                "}": function(e, t) {
                    return t.tokStack && 0 < t.tokStack.length && !--t.tokStack[t.tokStack.length - 1] && (t.tokenize = l(t.tokStack[t.tokStack.length - 2])), !1
                }
            }
        };
        s.defineMode("php", function(e, n) {
            var a = s.getMode(e, "text/html"),
                l = s.getMode(e, i);
            return {
                startState: function() {
                    var e = s.startState(a),
                        t = s.startState(l);
                    return {
                        html: e,
                        php: t,
                        curMode: n.startOpen ? l : a,
                        curState: n.startOpen ? t : e,
                        pending: null
                    }
                },
                copyState: function(e) {
                    var t, n = e.html,
                        r = s.copyState(a, n),
                        i = e.php,
                        o = s.copyState(l, i);
                    return t = e.curMode == a ? r : o, {
                        html: r,
                        php: o,
                        curMode: e.curMode,
                        curState: t,
                        pending: e.pending
                    }
                },
                token: function(e, t) {
                    var n = t.curMode == l;
                    if (e.sol() && t.pending && '"' != t.pending && "'" != t.pending && (t.pending = null), n) return n && null == t.php.tokenize && e.match("?>") ? (t.curMode = a, t.curState = t.html, "meta") : l.token(e, t.curState);
                    if (e.match(/^<\?\w*/)) return t.curMode = l, t.curState = t.php, "meta";
                    if ('"' == t.pending || "'" == t.pending) {
                        for (; !e.eol() && e.next() != t.pending;);
                        var r = "string"
                    } else r = t.pending && e.pos < t.pending.end ? (e.pos = t.pending.end, t.pending.style) : a.token(e, t.curState);
                    t.pending && (t.pending = null);
                    var i, o = e.current(),
                        s = o.search(/<\?/);
                    return -1 != s && ("string" == r && (i = o.match(/[\'\"]$/)) && !/\?>/.test(o) ? t.pending = i[0] : t.pending = {
                        end: e.pos,
                        style: r
                    }, e.backUp(o.length - s)), r
                },
                indent: function(e, t) {
                    return e.curMode != l && /^\s*<\//.test(t) || e.curMode == l && /^\?>/.test(t) ? a.indent(e.html, t) : e.curMode.indent(e.curState, t)
                },
                blockCommentStart: "/*",
                blockCommentEnd: "*/",
                lineComment: "//",
                innerMode: function(e) {
                    return {
                        state: e.curState,
                        mode: e.curMode
                    }
                }
            }
        }, "htmlmixed", "clike"), s.defineMIME("application/x-httpd-php", "php"), s.defineMIME("application/x-httpd-php-open", {
            name: "php",
            startOpen: !0
        }), s.defineMIME("text/x-php", i)
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(w) {
        "use strict";

        function n(e) {
            return new RegExp("^((" + e.join(")|(") + "))\\b")
        }
        var k = n(["and", "or", "not", "is"]),
            r = ["as", "assert", "break", "class", "continue", "def", "del", "elif", "else", "except", "finally", "for", "from", "global", "if", "import", "lambda", "pass", "raise", "return", "try", "while", "with", "yield", "in"],
            _ = ["abs", "all", "any", "bin", "bool", "bytearray", "callable", "chr", "classmethod", "compile", "complex", "delattr", "dict", "dir", "divmod", "enumerate", "eval", "filter", "float", "format", "frozenset", "getattr", "globals", "hasattr", "hash", "help", "hex", "id", "input", "int", "isinstance", "issubclass", "iter", "len", "list", "locals", "map", "max", "memoryview", "min", "next", "object", "oct", "open", "ord", "pow", "property", "range", "repr", "reversed", "round", "set", "setattr", "slice", "sorted", "staticmethod", "str", "sum", "super", "tuple", "type", "vars", "zip", "__import__", "NotImplemented", "Ellipsis", "__debug__"],
            C = ["apply", "basestring", "buffer", "cmp", "coerce", "execfile", "file", "intern", "long", "raw_input", "reduce", "reload", "unichr", "unicode", "xrange", "False", "True", "None"],
            S = ["exec", "print"],
            T = ["ascii", "bytes", "exec", "print"],
            M = ["nonlocal", "False", "True", "None"];

        function A(e) {
            return e.scopes[e.scopes.length - 1]
        }
        w.registerHelper("hintWords", "python", r.concat(_)), w.defineMode("python", function(o, s) {
            var a = "error",
                i = s.singleDelimiters || new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),
                l = s.doubleOperators || new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),
                c = s.doubleDelimiters || new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),
                u = s.tripleDelimiters || new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");
            if (s.version && 3 == parseInt(s.version, 10)) var h = s.singleOperators || new RegExp("^[\\+\\-\\*/%&|\\^~<>!@]"),
                d = s.identifiers || new RegExp("^[_A-Za-zÂ¡-ï¿¿][_A-Za-z0-9Â¡-ï¿¿]*");
            else h = s.singleOperators || new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"), d = s.identifiers || new RegExp("^[_A-Za-z][_A-Za-z0-9]*");
            var f = s.hangingIndent || o.indentUnit,
                e = r,
                t = _;
            if (null != s.extra_keywords && (e = e.concat(s.extra_keywords)), null != s.extra_builtins && (t = t.concat(s.extra_builtins)), s.version && 3 == parseInt(s.version, 10)) {
                e = e.concat(M), t = t.concat(T);
                var p = new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))", "i")
            } else {
                e = e.concat(S), t = t.concat(C);
                p = new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))", "i")
            }
            var m = n(e),
                g = n(t);

            function v(e, t) {
                if (e.sol() && "py" == A(t).type) {
                    var n = A(t).offset;
                    if (e.eatSpace()) {
                        var r = e.indentation();
                        return n < r ? b(e, t, "py") : r < n && x(e, t) && (t.errorToken = !0), null
                    }
                    var i = y(e, t);
                    return 0 < n && x(e, t) && (i += " " + a), i
                }
                return y(e, t)
            }

            function y(e, t) {
                if (e.eatSpace()) return null;
                if ("#" == e.peek()) return e.skipToEnd(), "comment";
                if (e.match(/^[0-9\.]/, !1)) {
                    var n = !1;
                    if (e.match(/^\d*\.\d+(e[\+\-]?\d+)?/i) && (n = !0), e.match(/^\d+\.\d*/) && (n = !0), e.match(/^\.\d+/) && (n = !0), n) return e.eat(/J/i), "number";
                    var r = !1;
                    if (e.match(/^0x[0-9a-f]+/i) && (r = !0), e.match(/^0b[01]+/i) && (r = !0), e.match(/^0o[0-7]+/i) && (r = !0), e.match(/^[1-9]\d*(e[\+\-]?\d+)?/) && (e.eat(/J/i), r = !0), e.match(/^0(?![\dx])/i) && (r = !0), r) return e.eat(/L/i), "number"
                }
                return e.match(p) ? (t.tokenize = function(n) {
                    for (; 0 <= "rub".indexOf(n.charAt(0).toLowerCase());) n = n.substr(1);
                    var r = 1 == n.length,
                        i = "string";

                    function e(e, t) {
                        for (; !e.eol();)
                            if (e.eatWhile(/[^'"\\]/), e.eat("\\")) {
                                if (e.next(), r && e.eol()) return i
                            } else {
                                if (e.match(n)) return t.tokenize = v, i;
                                e.eat(/['"]/)
                            } if (r) {
                            if (s.singleLineStringErrors) return a;
                            t.tokenize = v
                        }
                        return i
                    }
                    return e.isString = !0, e
                }(e.current()), t.tokenize(e, t)) : e.match(u) || e.match(c) ? null : e.match(l) || e.match(h) || e.match(k) ? "operator" : e.match(i) ? null : e.match(m) ? "keyword" : e.match(g) ? "builtin" : e.match(/^(self|cls)\b/) ? "variable-2" : e.match(d) ? "def" == t.lastToken || "class" == t.lastToken ? "def" : "variable" : (e.next(), a)
            }

            function b(e, t, n) {
                var r, i = null;
                if ("py" == n)
                    for (;
                        "py" != A(t).type;) t.scopes.pop();
                r = A(t).offset + ("py" == n ? o.indentUnit : f), "py" == n || e.match(/^(\s|#.*)*$/, !1) || (i = e.column() + 1), t.scopes.push({
                    offset: r,
                    type: n,
                    align: i
                })
            }

            function x(e, t) {
                for (var n = e.indentation(); A(t).offset > n;) {
                    if ("py" != A(t).type) return !0;
                    t.scopes.pop()
                }
                return A(t).offset != n
            }
            return {
                startState: function(e) {
                    return {
                        tokenize: v,
                        scopes: [{
                            offset: e || 0,
                            type: "py",
                            align: null
                        }],
                        lastStyle: null,
                        lastToken: null,
                        lambda: !1,
                        dedent: 0
                    }
                },
                token: function(e, t) {
                    var n = t.errorToken;
                    n && (t.errorToken = !1);
                    var r = function(e, t) {
                        var n = t.tokenize(e, t),
                            r = e.current();
                        if ("." == r) return null == (n = e.match(d, !1) ? null : a) && "meta" == t.lastStyle && (n = "meta"), n;
                        if ("@" == r) return s.version && 3 == parseInt(s.version, 10) ? e.match(d, !1) ? "meta" : "operator" : e.match(d, !1) ? "meta" : a;
                        "variable" != n && "builtin" != n || "meta" != t.lastStyle || (n = "meta"), "pass" != r && "return" != r || (t.dedent += 1), "lambda" == r && (t.lambda = !0), ":" != r || t.lambda || "py" != A(t).type || b(e, t, "py");
                        var i = 1 == r.length ? "[({".indexOf(r) : -1;
                        if (-1 != i && b(e, t, "])}".slice(i, i + 1)), -1 != (i = "])}".indexOf(r))) {
                            if (A(t).type != r) return a;
                            t.scopes.pop()
                        }
                        return 0 < t.dedent && e.eol() && "py" == A(t).type && (1 < t.scopes.length && t.scopes.pop(), t.dedent -= 1), n
                    }(e, t);
                    t.lastStyle = r;
                    var i = e.current();
                    return i && r && (t.lastToken = i), e.eol() && t.lambda && (t.lambda = !1), n ? r + " " + a : r
                },
                indent: function(e, t) {
                    if (e.tokenize != v) return e.tokenize.isString ? w.Pass : 0;
                    var n = A(e),
                        r = t && t.charAt(0) == n.type;
                    return null != n.align ? n.align - (r ? 1 : 0) : r && 1 < e.scopes.length ? e.scopes[e.scopes.length - 2].offset : n.offset
                },
                closeBrackets: {
                    triples: "'\""
                },
                lineComment: "#",
                fold: "indent"
            }
        }), w.defineMIME("text/x-python", "python");
        var e;
        w.defineMIME("text/x-cython", {
            name: "python",
            extra_keywords: (e = "by cdef cimport cpdef ctypedef enum exceptextern gil include nogil property publicreadonly struct union DEF IF ELIF ELSE", e.split(" "))
        })
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("r", function(o) {
            function e(e) {
                for (var t = e.split(" "), n = {}, r = 0; r < t.length; ++r) n[t[r]] = !0;
                return n
            }
            var s, a = e("NULL NA Inf NaN NA_integer_ NA_real_ NA_complex_ NA_character_"),
                l = e("list quote bquote eval return call parse deparse"),
                c = e("if else repeat while function for in next break"),
                u = e("if else repeat while function for"),
                h = /[+\-*\/^<>=!&|~$:]/;

            function d(e, t) {
                s = null;
                var i, n = e.next();
                if ("#" == n) return e.skipToEnd(), "comment";
                if ("0" == n && e.eat("x")) return e.eatWhile(/[\da-f]/i), "number";
                if ("." == n && e.eat(/\d/)) return e.match(/\d*(?:e[+\-]?\d+)?/), "number";
                if (/\d/.test(n)) return e.match(/\d*(?:\.\d+)?(?:e[+\-]\d+)?L?/), "number";
                if ("'" == n || '"' == n) return t.tokenize = (i = n, function(e, t) {
                    if (e.eat("\\")) {
                        var n = e.next();
                        return "x" == n ? e.match(/^[a-f0-9]{2}/i) : ("u" == n || "U" == n) && e.eat("{") && e.skipTo("}") ? e.next() : "u" == n ? e.match(/^[a-f0-9]{4}/i) : "U" == n ? e.match(/^[a-f0-9]{8}/i) : /[0-7]/.test(n) && e.match(/^[0-7]{1,2}/), "string-2"
                    }
                    for (var r; null != (r = e.next());) {
                        if (r == i) {
                            t.tokenize = d;
                            break
                        }
                        if ("\\" == r) {
                            e.backUp(1);
                            break
                        }
                    }
                    return "string"
                }), "string";
                if ("." == n && e.match(/.[.\d]+/)) return "keyword";
                if (/[\w\.]/.test(n) && "_" != n) {
                    e.eatWhile(/[\w\.]/);
                    var r = e.current();
                    return a.propertyIsEnumerable(r) ? "atom" : c.propertyIsEnumerable(r) ? (u.propertyIsEnumerable(r) && !e.match(/\s*if(\s+|$)/, !1) && (s = "block"), "keyword") : l.propertyIsEnumerable(r) ? "builtin" : "variable"
                }
                return "%" == n ? (e.skipTo("%") && e.next(), "variable-2") : "<" == n && e.eat("-") ? "arrow" : "=" == n && t.ctx.argList ? "arg-is" : h.test(n) ? "$" == n ? "dollar" : (e.eatWhile(h), "operator") : /[\(\){}\[\];]/.test(n) && ";" == (s = n) ? "semi" : null
            }

            function i(e, t, n) {
                e.ctx = {
                    type: t,
                    indent: e.indent,
                    align: null,
                    column: n.column(),
                    prev: e.ctx
                }
            }

            function f(e) {
                e.indent = e.ctx.indent, e.ctx = e.ctx.prev
            }
            return {
                startState: function() {
                    return {
                        tokenize: d,
                        ctx: {
                            type: "top",
                            indent: -o.indentUnit,
                            align: !1
                        },
                        indent: 0,
                        afterIdent: !1
                    }
                },
                token: function(e, t) {
                    if (e.sol() && (null == t.ctx.align && (t.ctx.align = !1), t.indent = e.indentation()), e.eatSpace()) return null;
                    var n = t.tokenize(e, t);
                    "comment" != n && null == t.ctx.align && (t.ctx.align = !0);
                    var r = t.ctx.type;
                    return ";" != s && "{" != s && "}" != s || "block" != r || f(t), "{" == s ? i(t, "}", e) : "(" == s ? (i(t, ")", e), t.afterIdent && (t.ctx.argList = !0)) : "[" == s ? i(t, "]", e) : "block" == s ? i(t, "block", e) : s == r && f(t), t.afterIdent = "variable" == n || "keyword" == n, n
                },
                indent: function(e, t) {
                    if (e.tokenize != d) return 0;
                    var n = t && t.charAt(0),
                        r = e.ctx,
                        i = n == r.type;
                    return "block" == r.type ? r.indent + ("{" == n ? 0 : o.indentUnit) : r.align ? r.column + (i ? 0 : 1) : r.indent + (i ? 0 : o.indentUnit)
                },
                lineComment: "#"
            }
        }), e.defineMIME("text/x-rsrc", "r")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("ruby", function(o) {
            function e(e) {
                for (var t = {}, n = 0, r = e.length; n < r; ++n) t[e[n]] = !0;
                return t
            }
            var f, s = e(["alias", "and", "BEGIN", "begin", "break", "case", "class", "def", "defined?", "do", "else", "elsif", "END", "end", "ensure", "false", "for", "if", "in", "module", "next", "not", "or", "redo", "rescue", "retry", "return", "self", "super", "then", "true", "undef", "unless", "until", "when", "while", "yield", "nil", "raise", "throw", "catch", "fail", "loop", "callcc", "caller", "lambda", "proc", "public", "protected", "private", "require", "load", "require_relative", "extend", "autoload", "__END__", "__FILE__", "__LINE__", "__dir__"]),
                a = e(["def", "class", "case", "for", "while", "module", "then", "catch", "loop", "proc", "begin"]),
                l = e(["end", "until"]),
                p = {
                    "[": "]",
                    "{": "}",
                    "(": ")"
                };

            function m(e, t, n) {
                return n.tokenize.push(e), e(t, n)
            }

            function c(e, t) {
                if (f = null, e.sol() && e.match("=begin") && e.eol()) return t.tokenize.push(v), "comment";
                if (e.eatSpace()) return null;
                var n, r, i = e.next();
                if ("`" == i || "'" == i || '"' == i) return m(g(i, "string", '"' == i || "`" == i), e, t);
                if ("/" == i) {
                    var o = e.current().length;
                    if (e.skipTo("/")) {
                        var s = e.current().length;
                        e.backUp(e.current().length - o);
                        for (var a = 0; e.current().length < s;) {
                            var l = e.next();
                            if ("(" == l ? a += 1 : ")" == l && (a -= 1), a < 0) break
                        }
                        if (e.backUp(e.current().length - o), 0 == a) return m(g(i, "string-2", !0), e, t)
                    }
                    return "operator"
                }
                if ("%" == i) {
                    var c = "string",
                        u = !0;
                    e.eat("s") ? c = "atom" : e.eat(/[WQ]/) ? c = "string" : e.eat(/[r]/) ? c = "string-2" : e.eat(/[wxq]/) && (u = !(c = "string"));
                    var h = e.eat(/[^\w\s=]/);
                    return h ? (p.propertyIsEnumerable(h) && (h = p[h]), m(g(h, c, u, !0), e, t)) : "operator"
                }
                if ("#" == i) return e.skipToEnd(), "comment";
                if ("<" == i && (n = e.match(/^<-?[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/))) return m((r = n[1], function(e, t) {
                    return e.match(r) ? t.tokenize.pop() : e.skipToEnd(), "string"
                }), e, t);
                if ("0" == i) return e.eat("x") ? e.eatWhile(/[\da-fA-F]/) : e.eat("b") ? e.eatWhile(/[01]/) : e.eatWhile(/[0-7]/), "number";
                if (/\d/.test(i)) return e.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/), "number";
                if ("?" == i) {
                    for (; e.match(/^\\[CM]-/););
                    return e.eat("\\") ? e.eatWhile(/\w/) : e.next(), "string"
                }
                if (":" == i) return e.eat("'") ? m(g("'", "atom", !1), e, t) : e.eat('"') ? m(g('"', "atom", !0), e, t) : e.eat(/[\<\>]/) ? (e.eat(/[\<\>]/), "atom") : e.eat(/[\+\-\*\/\&\|\:\!]/) ? "atom" : e.eat(/[a-zA-Z$@_\xa1-\uffff]/) ? (e.eatWhile(/[\w$\xa1-\uffff]/), e.eat(/[\?\!\=]/), "atom") : "operator";
                if ("@" == i && e.match(/^@?[a-zA-Z_\xa1-\uffff]/)) return e.eat("@"), e.eatWhile(/[\w\xa1-\uffff]/), "variable-2";
                if ("$" == i) return e.eat(/[a-zA-Z_]/) ? e.eatWhile(/[\w]/) : e.eat(/\d/) ? e.eat(/\d/) : e.next(), "variable-3";
                if (/[a-zA-Z_\xa1-\uffff]/.test(i)) return e.eatWhile(/[\w\xa1-\uffff]/), e.eat(/[\?\!]/), e.eat(":") ? "atom" : "ident";
                if ("|" != i || !t.varList && "{" != t.lastTok && "do" != t.lastTok) {
                    if (/[\(\)\[\]{}\\;]/.test(i)) return f = i, null;
                    if ("-" == i && e.eat(">")) return "arrow";
                    if (/[=+\-\/*:\.^%<>~|]/.test(i)) {
                        var d = e.eatWhile(/[=+\-\/*:\.^%<>~|]/);
                        return "." != i || d || (f = "."), "operator"
                    }
                    return null
                }
                return f = "|", null
            }

            function u(n) {
                return n || (n = 1),
                    function(e, t) {
                        if ("}" == e.peek()) {
                            if (1 == n) return t.tokenize.pop(), t.tokenize[t.tokenize.length - 1](e, t);
                            t.tokenize[t.tokenize.length - 1] = u(n - 1)
                        } else "{" == e.peek() && (t.tokenize[t.tokenize.length - 1] = u(n + 1));
                        return c(e, t)
                    }
            }

            function h() {
                var n = !1;
                return function(e, t) {
                    return n ? (t.tokenize.pop(), t.tokenize[t.tokenize.length - 1](e, t)) : (n = !0, c(e, t))
                }
            }

            function g(i, o, s, a) {
                return function(e, t) {
                    var n, r = !1;
                    for ("read-quoted-paused" === t.context.type && (t.context = t.context.prev, e.eat("}")); null != (n = e.next());) {
                        if (n == i && (a || !r)) {
                            t.tokenize.pop();
                            break
                        }
                        if (s && "#" == n && !r) {
                            if (e.eat("{")) {
                                "}" == i && (t.context = {
                                    prev: t.context,
                                    type: "read-quoted-paused"
                                }), t.tokenize.push(u());
                                break
                            }
                            if (/[@\$]/.test(e.peek())) {
                                t.tokenize.push(h());
                                break
                            }
                        }
                        r = !r && "\\" == n
                    }
                    return o
                }
            }

            function v(e, t) {
                return e.sol() && e.match("=end") && e.eol() && t.tokenize.pop(), e.skipToEnd(), "comment"
            }
            return {
                startState: function() {
                    return {
                        tokenize: [c],
                        indented: 0,
                        context: {
                            type: "top",
                            indented: -o.indentUnit
                        },
                        continuedLine: !1,
                        lastTok: null,
                        varList: !1
                    }
                },
                token: function(e, t) {
                    e.sol() && (t.indented = e.indentation());
                    var n, r = t.tokenize[t.tokenize.length - 1](e, t),
                        i = f;
                    if ("ident" == r) {
                        var o = e.current();
                        "keyword" == (r = "." == t.lastTok ? "property" : s.propertyIsEnumerable(e.current()) ? "keyword" : /^[A-Z]/.test(o) ? "tag" : "def" == t.lastTok || "class" == t.lastTok || t.varList ? "def" : "variable") && (i = o, a.propertyIsEnumerable(o) ? n = "indent" : l.propertyIsEnumerable(o) ? n = "dedent" : "if" != o && "unless" != o || e.column() != e.indentation() ? "do" == o && t.context.indented < t.indented && (n = "indent") : n = "indent")
                    }
                    return (f || r && "comment" != r) && (t.lastTok = i), "|" == f && (t.varList = !t.varList), "indent" == n || /[\(\[\{]/.test(f) ? t.context = {
                        prev: t.context,
                        type: f || r,
                        indented: t.indented
                    } : ("dedent" == n || /[\)\]\}]/.test(f)) && t.context.prev && (t.context = t.context.prev), e.eol() && (t.continuedLine = "\\" == f || "operator" == r), r
                },
                indent: function(e, t) {
                    if (e.tokenize[e.tokenize.length - 1] != c) return 0;
                    var n = t && t.charAt(0),
                        r = e.context,
                        i = r.type == p[n] || "keyword" == r.type && /^(?:end|until|else|elsif|when|rescue)\b/.test(t);
                    return r.indented + (i ? 0 : o.indentUnit) + (e.continuedLine ? o.indentUnit : 0)
                },
                electricChars: "}de",
                lineComment: "#"
            }
        }), e.defineMIME("text/x-ruby", "ruby")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        e.defineMode("rust", function() {
            var i, o, e = {
                    if: "if-style",
                    while: "if-style",
                    loop: "else-style",
                    else: "else-style",
                    do: "else-style",
                    ret: "else-style",
                    fail: "else-style",
                    break: "atom",
                    cont: "atom",
                    const: "let",
                    resource: "fn",
                    let: "let",
                    fn: "fn",
                    for: "for",
                    alt: "alt",
                    iface: "iface",
                    impl: "impl",
                    type: "type",
                    enum: "enum",
                    mod: "mod",
                    as: "op",
                    true: "atom",
                    false: "atom",
                    assert: "op",
                    check: "op",
                    claim: "op",
                    native: "ignore",
                    unsafe: "ignore",
                    import: "else-style",
                    export: "else-style",
                    copy: "op",
                    log: "op",
                    log_err: "op",
                    use: "op",
                    bind: "op",
                    self: "atom",
                    struct: "enum"
                },
                t = function() {
                    for (var e = {
                            fn: "fn",
                            block: "fn",
                            obj: "obj"
                        }, t = "bool uint int i8 i16 i32 i64 u8 u16 u32 u64 float f32 f64 str char".split(" "), n = 0, r = t.length; n < r; ++n) e[t[n]] = "atom";
                    return e
                }(),
                s = /[+\-*&%=<>!?|\.@]/;

            function a(e, t) {
                return i = e, t
            }

            function l(e, t) {
                var n = e.next();
                if ('"' == n) return t.tokenize = c, t.tokenize(e, t);
                if ("'" == n) return i = "atom", e.eat("\\") ? e.skipTo("'") ? (e.next(), "string") : "error" : (e.next(), e.eat("'") ? "string" : "error");
                if ("/" == n) {
                    if (e.eat("/")) return e.skipToEnd(), "comment";
                    if (e.eat("*")) return t.tokenize = function i(o) {
                        return function(e, t) {
                            for (var n, r = null; n = e.next();) {
                                if ("/" == n && "*" == r) {
                                    if (1 != o) return t.tokenize = i(o - 1), t.tokenize(e, t);
                                    t.tokenize = l;
                                    break
                                }
                                if ("*" == n && "/" == r) return t.tokenize = i(o + 1), t.tokenize(e, t);
                                r = n
                            }
                            return "comment"
                        }
                    }(1), t.tokenize(e, t)
                }
                if ("#" == n) return e.eat("[") ? (i = "open-attr", null) : (e.eatWhile(/\w/), a("macro", "meta"));
                if (":" == n && e.match(":<")) return a("op", null);
                if (n.match(/\d/) || "." == n && e.eat(/\d/)) {
                    var r = !1;
                    return e.match(/^x[\da-f]+/i) || e.match(/^b[01]+/) || (e.eatWhile(/\d/), e.eat(".") && (r = !0, e.eatWhile(/\d/)), e.match(/^e[+\-]?\d+/i) && (r = !0)), r ? e.match(/^f(?:32|64)/) : e.match(/^[ui](?:8|16|32|64)/), a("atom", "number")
                }
                return n.match(/[()\[\]{}:;,]/) ? a(n, null) : "-" == n && e.eat(">") ? a("->", null) : n.match(s) ? (e.eatWhile(s), a("op", null)) : (e.eatWhile(/\w/), o = e.current(), e.match(/^::\w/) ? (e.backUp(1), a("prefix", "variable-2")) : t.keywords.propertyIsEnumerable(o) ? a(t.keywords[o], o.match(/true|false/) ? "atom" : "keyword") : a("name", "variable"))
            }

            function c(e, t) {
                for (var n, r = !1; n = e.next();) {
                    if ('"' == n && !r) return t.tokenize = l, a("atom", "string");
                    r = !r && "\\" == n
                }
                return a("op", "string")
            }
            var u = {
                state: null,
                stream: null,
                marked: null,
                cc: null
            };

            function h() {
                for (var e = arguments.length - 1; 0 <= e; e--) u.cc.push(arguments[e])
            }

            function d() {
                return h.apply(null, arguments), !0
            }

            function n(t, n) {
                var e = function() {
                    var e = u.state;
                    e.lexical = {
                        indented: e.indented,
                        column: u.stream.column(),
                        type: t,
                        prev: e.lexical,
                        info: n
                    }
                };
                return e.lex = !0, e
            }

            function r() {
                var e = u.state;
                e.lexical.prev && (")" == e.lexical.type && (e.indented = e.lexical.indented), e.lexical = e.lexical.prev)
            }

            function f() {
                u.state.keywords = t
            }

            function p() {
                u.state.keywords = e
            }

            function m(t, n) {
                function r(e) {
                    return "," == e ? d(t, r) : e == n ? d() : d(r)
                }
                return function(e) {
                    return e == n ? d() : h(t, r)
                }
            }

            function g(e, t) {
                return d(n("stat", t), e, r, v)
            }

            function v(e) {
                return "}" == e ? d() : "let" == e ? g(S, "let") : "fn" == e ? g(L) : "type" == e ? d(n("stat"), E, y, r, v) : "enum" == e ? g(N) : "mod" == e ? g(O) : "iface" == e ? g(R) : "impl" == e ? g(D) : "open-attr" == e ? d(n("]"), m(b, "]"), r) : "ignore" == e || e.match(/[\]\);,]/) ? d(v) : h(n("stat"), b, r, y, v)
            }

            function y(e) {
                return ";" == e ? d() : h()
            }

            function b(e) {
                return "atom" == e || "name" == e ? d(x) : "{" == e ? d(n("}"), k, r) : e.match(/[\[\(]/) ? V(e, b) : e.match(/[\]\)\};,]/) ? h() : "if-style" == e ? d(b, b) : "else-style" == e || "op" == e ? d(b) : "for" == e ? d(z, M, A, b, b) : "alt" == e ? d(b, j) : "fn" == e ? d(L) : "macro" == e ? d(K) : d()
            }

            function x(e) {
                return "." == o ? d(w) : "::<" == o ? d(P, x) : "op" == e || ":" == o ? d(b) : "(" == e || "[" == e ? V(e, b) : h()
            }

            function w() {
                return o.match(/^\w+$/) ? (u.marked = "variable", d(x)) : h(b)
            }

            function k(e) {
                if ("op" == e) {
                    if ("|" == o) return d(C, r, n("}", "block"), v);
                    if ("||" == o) return d(r, n("}", "block"), v)
                }
                return "mutable" == o || o.match(/^\w+$/) && ":" == u.stream.peek() && !u.stream.match("::", !1) ? h(_(b)) : h(v)
            }

            function _(n) {
                return function e(t) {
                    return "mutable" == o || "with" == o ? (u.marked = "keyword", d(e)) : o.match(/^\w*$/) ? (u.marked = "variable", d(e)) : ":" == t ? d(n, e) : "}" == t ? d() : d(e)
                }
            }

            function C(e) {
                return "name" == e ? (u.marked = "def", d(C)) : "op" == e && "|" == o ? d() : d(C)
            }

            function S(e) {
                return e.match(/[\]\)\};]/) ? d() : "=" == o ? d(b, T) : "," == e ? d(S) : h(z, M, S)
            }

            function T(e) {
                return e.match(/[\]\)\};,]/) ? h(S) : h(b, T)
            }

            function M(e) {
                return ":" == e ? d(f, H, p) : h()
            }

            function A(e) {
                return "name" == e && "in" == o ? (u.marked = "keyword", d()) : h()
            }

            function L(e) {
                return "@" == o || "~" == o ? (u.marked = "keyword", d(L)) : "name" == e ? (u.marked = "def", d(L)) : "<" == o ? d(P, L) : "{" == e ? h(b) : "(" == e ? d(n(")"), m($, ")"), r, L) : "->" == e ? d(f, H, p, L) : ";" == e ? d() : d(L)
            }

            function E(e) {
                return "name" == e ? (u.marked = "def", d(E)) : "<" == o ? d(P, E) : "=" == o ? d(f, H, p) : d(E)
            }

            function N(e) {
                return "name" == e ? (u.marked = "def", d(N)) : "<" == o ? d(P, N) : "=" == o ? d(f, H, p, y) : "{" == e ? d(n("}"), f, I, p, r) : d(N)
            }

            function I(e) {
                return "}" == e ? d() : "(" == e ? d(n(")"), m(H, ")"), r, I) : (o.match(/^\w+$/) && (u.marked = "def"), d(I))
            }

            function O(e) {
                return "name" == e ? (u.marked = "def", d(O)) : "{" == e ? d(n("}"), v, r) : h()
            }

            function R(e) {
                return "name" == e ? (u.marked = "def", d(R)) : "<" == o ? d(P, R) : "{" == e ? d(n("}"), v, r) : h()
            }

            function D(e) {
                return "<" == o ? d(P, D) : "of" == o || "for" == o ? (u.marked = "keyword", d(H, D)) : "name" == e ? (u.marked = "def", d(D)) : "{" == e ? d(n("}"), v, r) : h()
            }

            function P() {
                return ">" == o ? d() : "," == o ? d(P) : ":" == o ? d(H, P) : h(H, P)
            }

            function $(e) {
                return "name" == e ? (u.marked = "def", d($)) : ":" == e ? d(f, H, p) : h()
            }

            function H(e) {
                return "name" == e ? (u.marked = "variable-3", d(F)) : "mutable" == o ? (u.marked = "keyword", d(H)) : "atom" == e ? d(F) : "op" == e || "obj" == e ? d(H) : "fn" == e ? d(B) : "{" == e ? d(n("{"), _(H), r) : V(e, H)
            }

            function F() {
                return "<" == o ? d(P) : h()
            }

            function B(e) {
                return "(" == e ? d(n("("), m(H, ")"), r, B) : "->" == e ? d(H) : h()
            }

            function z(e) {
                return "name" == e ? (u.marked = "def", d(q)) : "atom" == e ? d(q) : "op" == e ? d(z) : e.match(/[\]\)\};,]/) ? h() : V(e, z)
            }

            function q(e) {
                return "op" == e && "." == o ? d() : "to" == o ? (u.marked = "keyword", d(z)) : h()
            }

            function j(e) {
                return "{" == e ? d(n("}", "alt"), W, r) : h()
            }

            function W(e) {
                return "}" == e ? d() : "|" == e ? d(W) : "when" == o ? (u.marked = "keyword", d(b, U)) : e.match(/[\]\);,]/) ? d(W) : h(z, U)
            }

            function U(e) {
                return "{" == e ? d(n("}", "alt"), v, r, W) : h(W)
            }

            function K(e) {
                return e.match(/[\[\(\{]/) ? V(e, b) : h()
            }

            function V(e, t) {
                return "[" == e ? d(n("]"), m(t, "]"), r) : "(" == e ? d(n(")"), m(t, ")"), r) : "{" == e ? d(n("}"), m(t, "}"), r) : d()
            }
            return r.lex = f.lex = p.lex = !0, {
                startState: function() {
                    return {
                        tokenize: l,
                        cc: [],
                        lexical: {
                            indented: -4,
                            column: 0,
                            type: "top",
                            align: !1
                        },
                        keywords: e,
                        indented: 0
                    }
                },
                token: function(e, t) {
                    if (e.sol() && (t.lexical.hasOwnProperty("align") || (t.lexical.align = !1), t.indented = e.indentation()), e.eatSpace()) return null;
                    i = o = null;
                    var n = t.tokenize(e, t);
                    return "comment" == n ? n : (t.lexical.hasOwnProperty("align") || (t.lexical.align = !0), "prefix" == i ? n : (o || (o = e.current()), function(e, t, n) {
                        var r = e.cc;
                        for (u.state = e, u.stream = t, u.marked = null, u.cc = r;;)
                            if ((r.length ? r.pop() : v)(i)) {
                                for (; r.length && r[r.length - 1].lex;) r.pop()();
                                return u.marked || n
                            }
                    }(t, e, n)))
                },
                indent: function(e, t) {
                    if (e.tokenize != l) return 0;
                    var n = t && t.charAt(0),
                        r = e.lexical,
                        i = r.type,
                        o = n == i;
                    return "stat" == i ? r.indented + 4 : r.align ? r.column + (o ? 0 : 1) : r.indented + (o ? 0 : "alt" == r.info ? 2 : 4)
                },
                electricChars: "{}",
                blockCommentStart: "/*",
                blockCommentEnd: "*/",
                lineComment: "//",
                fold: "brace"
            }
        }), e.defineMIME("text/x-rustsrc", "rust")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(g) {
        "use strict";
        g.defineMode("sql", function(i, e) {
                var s = e.client || {},
                    a = e.atoms || {
                        false: !0,
                        true: !0,
                        null: !0
                    },
                    l = e.builtin || {},
                    c = e.keywords || {},
                    u = e.operatorChars || /^[*+\-%<>!=&|~^]/,
                    h = e.support || {},
                    d = e.hooks || {},
                    f = e.dateSQL || {
                        date: !0,
                        time: !0,
                        timestamp: !0
                    };

                function p(e, t) {
                    var i, n = e.next();
                    if (d[n]) {
                        var r = d[n](e, t);
                        if (!1 !== r) return r
                    }
                    if (1 == h.hexNumber && ("0" == n && e.match(/^[xX][0-9a-fA-F]+/) || ("x" == n || "X" == n) && e.match(/^'[0-9a-fA-F]+'/))) return "number";
                    if (1 == h.binaryNumber && (("b" == n || "B" == n) && e.match(/^'[01]+'/) || "0" == n && e.match(/^b[01]+/))) return "number";
                    if (47 < n.charCodeAt(0) && n.charCodeAt(0) < 58) return e.match(/^[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/), 1 == h.decimallessFloat && e.eat("."), "number";
                    if ("?" == n && (e.eatSpace() || e.eol() || e.eat(";"))) return "variable-3";
                    if ("'" == n || '"' == n && h.doubleQuote) return t.tokenize = (i = n, function(e, t) {
                        for (var n, r = !1; null != (n = e.next());) {
                            if (n == i && !r) {
                                t.tokenize = p;
                                break
                            }
                            r = !r && "\\" == n
                        }
                        return "string"
                    }), t.tokenize(e, t);
                    if ((1 == h.nCharCast && ("n" == n || "N" == n) || 1 == h.charsetCast && "_" == n && e.match(/[a-z][a-z0-9]*/i)) && ("'" == e.peek() || '"' == e.peek())) return "keyword";
                    if (/^[\(\),\;\[\]]/.test(n)) return null;
                    if (h.commentSlashSlash && "/" == n && e.eat("/")) return e.skipToEnd(), "comment";
                    if (h.commentHash && "#" == n || "-" == n && e.eat("-") && (!h.commentSpaceRequired || e.eat(" "))) return e.skipToEnd(), "comment";
                    if ("/" == n && e.eat("*")) return t.tokenize = m, t.tokenize(e, t);
                    if ("." == n) return 1 == h.zerolessFloat && e.match(/^(?:\d+(?:e[+-]?\d+)?)/i) ? "number" : 1 == h.ODBCdotTable && e.match(/^[a-zA-Z_]+/) ? "variable-2" : void 0;
                    if (u.test(n)) return e.eatWhile(u), null;
                    if ("{" == n && (e.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/) || e.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/))) return "number";
                    e.eatWhile(/^[_\w\d]/);
                    var o = e.current().toLowerCase();
                    return f.hasOwnProperty(o) && (e.match(/^( )+'[^']*'/) || e.match(/^( )+"[^"]*"/)) ? "number" : a.hasOwnProperty(o) ? "atom" : l.hasOwnProperty(o) ? "builtin" : c.hasOwnProperty(o) ? "keyword" : s.hasOwnProperty(o) ? "string-2" : null
                }

                function m(e, t) {
                    for (;;) {
                        if (!e.skipTo("*")) {
                            e.skipToEnd();
                            break
                        }
                        if (e.next(), e.eat("/")) {
                            t.tokenize = p;
                            break
                        }
                    }
                    return "comment"
                }

                function o(e, t, n) {
                    t.context = {
                        prev: t.context,
                        indent: e.indentation(),
                        col: e.column(),
                        type: n
                    }
                }
                return {
                    startState: function() {
                        return {
                            tokenize: p,
                            context: null
                        }
                    },
                    token: function(e, t) {
                        if (e.sol() && t.context && null == t.context.align && (t.context.align = !1), e.eatSpace()) return null;
                        var n = t.tokenize(e, t);
                        if ("comment" == n) return n;
                        t.context && null == t.context.align && (t.context.align = !0);
                        var r, i = e.current();
                        return "(" == i ? o(e, t, ")") : "[" == i ? o(e, t, "]") : t.context && t.context.type == i && ((r = t).indent = r.context.indent, r.context = r.context.prev), n
                    },
                    indent: function(e, t) {
                        var n = e.context;
                        if (!n) return g.Pass;
                        var r = t.charAt(0) == n.type;
                        return n.align ? n.col + (r ? 0 : 1) : n.indent + (r ? 0 : i.indentUnit)
                    },
                    blockCommentStart: "/*",
                    blockCommentEnd: "*/",
                    lineComment: h.commentSlashSlash ? "//" : h.commentHash ? "#" : null
                }
            }),
            function() {
                function e(e) {
                    for (var t; null != (t = e.next());)
                        if ("`" == t && !e.eat("`")) return "variable-2";
                    return e.backUp(e.current().length - 1), e.eatWhile(/\w/) ? "variable-2" : null
                }

                function t(e) {
                    return e.eat("@") && (e.match(/^session\./), e.match(/^local\./), e.match(/^global\./)), e.eat("'") ? (e.match(/^.*'/), "variable-2") : e.eat('"') ? (e.match(/^.*"/), "variable-2") : e.eat("`") ? (e.match(/^.*`/), "variable-2") : e.match(/^[0-9a-zA-Z$\.\_]+/) ? "variable-2" : null
                }

                function n(e) {
                    return e.eat("N") ? "atom" : e.match(/^[a-zA-Z.#!?]/) ? "variable-2" : null
                }
                var r = "alter and as asc between by count create delete desc distinct drop from having in insert into is join like not on or order select set table union update values where ";

                function i(e) {
                    for (var t = {}, n = e.split(" "), r = 0; r < n.length; ++r) t[n[r]] = !0;
                    return t
                }
                g.defineMIME("text/x-sql", {
                    name: "sql",
                    keywords: i(r + "begin"),
                    builtin: i("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),
                    atoms: i("false true null unknown"),
                    operatorChars: /^[*+\-%<>!=]/,
                    dateSQL: i("date time timestamp"),
                    support: i("ODBCdotTable doubleQuote binaryNumber hexNumber")
                }), g.defineMIME("text/x-mssql", {
                    name: "sql",
                    client: i("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),
                    keywords: i(r + "begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered"),
                    builtin: i("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),
                    atoms: i("false true null unknown"),
                    operatorChars: /^[*+\-%<>!=]/,
                    dateSQL: i("date datetimeoffset datetime2 smalldatetime datetime time"),
                    hooks: {
                        "@": t
                    }
                }), g.defineMIME("text/x-mysql", {
                    name: "sql",
                    client: i("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),
                    keywords: i(r + "accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group groupby_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),
                    builtin: i("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),
                    atoms: i("false true null unknown"),
                    operatorChars: /^[*+\-%<>!=&|^]/,
                    dateSQL: i("date time timestamp"),
                    support: i("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),
                    hooks: {
                        "@": t,
                        "`": e,
                        "\\": n
                    }
                }), g.defineMIME("text/x-mariadb", {
                    name: "sql",
                    client: i("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),
                    keywords: i(r + "accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),
                    builtin: i("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),
                    atoms: i("false true null unknown"),
                    operatorChars: /^[*+\-%<>!=&|^]/,
                    dateSQL: i("date time timestamp"),
                    support: i("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),
                    hooks: {
                        "@": t,
                        "`": e,
                        "\\": n
                    }
                }), g.defineMIME("text/x-cassandra", {
                    name: "sql",
                    client: {},
                    keywords: i("use select from using consistency where limit first reversed first and in insert into values using consistency ttl update set delete truncate begin batch apply create keyspace with columnfamily primary key index on drop alter type add any one quorum all local_quorum each_quorum"),
                    builtin: i("ascii bigint blob boolean counter decimal double float int text timestamp uuid varchar varint"),
                    atoms: i("false true"),
                    operatorChars: /^[<>=]/,
                    dateSQL: {},
                    support: i("commentSlashSlash decimallessFloat"),
                    hooks: {}
                }), g.defineMIME("text/x-plsql", {
                    name: "sql",
                    client: i("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),
                    keywords: i("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),
                    builtin: i("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least lenght lenghtb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),
                    operatorChars: /^[*+\-%<>!=~]/,
                    dateSQL: i("date time timestamp"),
                    support: i("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")
                }), g.defineMIME("text/x-hive", {
                    name: "sql",
                    keywords: i("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),
                    builtin: i("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),
                    atoms: i("false true null unknown"),
                    operatorChars: /^[*+\-%<>!=]/,
                    dateSQL: i("date timestamp"),
                    support: i("ODBCdotTable doubleQuote binaryNumber hexNumber")
                })
            }()
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";

        function t(e) {
            for (var t = {}, n = 0; n < e.length; n++) t[e[n]] = !0;
            return t
        }
        var a = t(["var", "let", "class", "deinit", "enum", "extension", "func", "import", "init", "protocol", "static", "struct", "subscript", "typealias", "as", "dynamicType", "is", "new", "super", "self", "Self", "Type", "__COLUMN__", "__FILE__", "__FUNCTION__", "__LINE__", "break", "case", "continue", "default", "do", "else", "fallthrough", "if", "in", "for", "return", "switch", "where", "while", "associativity", "didSet", "get", "infix", "inout", "left", "mutating", "none", "nonmutating", "operator", "override", "postfix", "precedence", "prefix", "right", "set", "unowned", "weak", "willSet"]),
            l = t(["var", "let", "class", "enum", "extension", "func", "import", "protocol", "struct", "typealias", "dynamicType", "for"]),
            c = t(["Infinity", "NaN", "undefined", "null", "true", "false", "on", "off", "yes", "no", "nil", "null", "this", "super"]),
            u = t(["String", "bool", "int", "string", "double", "Double", "Int", "Float", "float", "public", "private", "extension"]),
            h = "+-/*%=|&<>#",
            d = ";,.(){}[]",
            f = /^(?:[()\[\]{},:`=;]|\.\.?\.?)/,
            p = /^-?(?:(?:[\d_]+\.[_\d]*|\.[_\d]+|0o[0-7_\.]+|0b[01_\.]+)(?:e-?[\d_]+)?|0x[\d_a-f\.]+(?:p-?[\d_]+)?)/i,
            m = /^[_A-Za-z$][_A-Za-z$0-9]*/,
            g = /^[@\.][_A-Za-z$][_A-Za-z$0-9]*/,
            v = /^\/(?!\s)(?:\/\/)?(?:\\.|[^\/])+\//;

        function o(e, t, n) {
            if (e.eatSpace()) return null;
            var i, r = e.peek();
            if ("/" == r) {
                if (e.match("//")) return e.skipToEnd(), "comment";
                if (e.match("/*")) return t.tokenize.push(b), b(e, t);
                if (e.match(v)) return "string-2"
            }
            if (-1 < h.indexOf(r)) return e.next(), "operator";
            if (-1 < d.indexOf(r)) return e.match(f), "punctuation";
            if ('"' == r || "'" == r) {
                e.next();
                var o = (i = r, function(e, t) {
                    for (var n, r = !1; n = e.next();)
                        if (r) {
                            if ("(" == n) return t.tokenize.push(y()), "string";
                            r = !1
                        } else {
                            if (n == i) break;
                            r = "\\" == n
                        } return t.tokenize.pop(), "string"
                });
                return t.tokenize.push(o), o(e, t)
            }
            if (e.match(p)) return "number";
            if (e.match(g)) return "property";
            if (e.match(m)) {
                var s = e.current();
                return a.hasOwnProperty(s) ? (l.hasOwnProperty(s) && (t.prev = "define"), "keyword") : u.hasOwnProperty(s) ? "variable-2" : c.hasOwnProperty(s) ? "atom" : "define" == n ? "def" : "variable"
            }
            return e.next(), null
        }

        function y() {
            var i = 0;
            return function(e, t, n) {
                var r = o(e, t, n);
                if ("punctuation" == r)
                    if ("(" == e.current()) ++i;
                    else if (")" == e.current()) {
                    if (0 == i) return e.backUp(1), t.tokenize.pop(), t.tokenize[t.tokenize.length - 1](e, t);
                    --i
                }
                return r
            }
        }

        function b(e, t) {
            return e.match(/^(?:[^*]|\*(?!\/))*/), e.match("*/") && t.tokenize.pop(), "comment"
        }
        e.defineMode("swift", function() {
            return {
                startState: function() {
                    return {
                        prev: null,
                        tokenize: []
                    }
                },
                token: function(e, t) {
                    var n = t.prev;
                    t.prev = null;
                    var r = (t.tokenize[t.tokenize.length - 1] || o)(e, t, n);
                    return r && "comment" != r ? t.prev || (t.prev = r) : t.prev = n, r
                },
                lineComment: "//",
                blockCommentStart: "/*",
                blockCommentEnd: "*/"
            }
        }), e.defineMIME("text/x-swift", "swift")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../lib/codemirror"], e) : e(CodeMirror)
    }(function(e) {
        "use strict";
        var l = e.Pos;

        function c(e, t) {
            return e.line == t.line && e.ch == t.ch
        }
        var o = [];

        function s(e) {
            o.push(e), 50 < o.length && o.shift()
        }

        function n(e) {
            return o[o.length - (e ? Math.min(e, 1) : 1)] || ""
        }
        var a = null;

        function u(e, t, n, r, i) {
            null == i && (i = e.getRange(t, n)), r && a && a.cm == e && c(t, a.pos) && e.isClean(a.gen) ? function(e) {
                if (!o.length) return s(e);
                o[o.length - 1] += e
            }(i) : s(i), e.replaceRange("", t, n, "+delete"), a = r ? {
                cm: e,
                pos: t,
                gen: e.changeGeneration()
            } : null
        }

        function t(e, t, n) {
            return e.findPosH(t, n, "char", !0)
        }

        function r(e, t, n) {
            return e.findPosH(t, n, "word", !0)
        }

        function i(e, t, n) {
            return e.findPosV(t, n, "line", e.doc.sel.goalColumn)
        }

        function h(e, t, n) {
            return e.findPosV(t, n, "page", e.doc.sel.goalColumn)
        }

        function d(e, t, n) {
            for (var r = t.line, i = e.getLine(r), o = /\S/.test(n < 0 ? i.slice(0, t.ch) : i.slice(t.ch)), s = e.firstLine(), a = e.lastLine();;) {
                if ((r += n) < s || a < r) return e.clipPos(l(r - n, n < 0 ? 0 : null));
                if (i = e.getLine(r), /\S/.test(i)) o = !0;
                else if (o) return l(r, 0)
            }
        }

        function f(e, t, n) {
            for (var r = t.line, i = t.ch, o = e.getLine(t.line), s = !1;;) {
                var a = o.charAt(i + (n < 0 ? -1 : 0));
                if (a) {
                    if (s && /[!?.]/.test(a)) return l(r, i + (0 < n ? 1 : 0));
                    s || (s = /\w/.test(a)), i += n
                } else {
                    if (r == (n < 0 ? e.firstLine() : e.lastLine())) return l(r, i);
                    if (o = e.getLine(r + n), !/\S/.test(o)) return l(r, i);
                    r += n, i = n < 0 ? o.length : 0
                }
            }
        }

        function p(e, t, n) {
            var r;
            if (e.findMatchingBracket && (r = e.findMatchingBracket(t, !0)) && r.match && (r.forward ? 1 : -1) == n) return 0 < n ? l(r.to.line, r.to.ch + 1) : r.to;
            for (var i = !0;; i = !1) {
                var o = e.getTokenAt(t),
                    s = l(t.line, n < 0 ? o.start : o.end);
                if (!(i && 0 < n && o.end == t.ch) && /\w/.test(o.string)) return s;
                var a = e.findPosH(s, n, "char");
                if (c(s, a)) return t;
                t = a
            }
        }

        function m(e, t) {
            var n = e.state.emacsPrefix;
            return n ? (C(e), "-" == n ? -1 : Number(n)) : t ? null : 1
        }

        function g(t) {
            var r = "string" == typeof t ? function(e) {
                e.execCommand(t)
            } : t;
            return function(e) {
                var t = m(e);
                r(e);
                for (var n = 1; n < t; ++n) r(e)
            }
        }

        function v(e, t, n, r) {
            var i = m(e);
            i < 0 && (r = -r, i = -i);
            for (var o = 0; o < i; ++o) {
                var s = n(e, t, r);
                if (c(s, t)) break;
                t = s
            }
            return t
        }

        function y(t, n) {
            var e = function(e) {
                e.extendSelection(v(e, e.getCursor(), t, n))
            };
            return e.motion = !0, e
        }

        function b(e, t, n) {
            for (var r, i = e.listSelections(), o = i.length; o--;) u(e, r = i[o].head, v(e, r, t, n), !0)
        }

        function x(e) {
            if (e.somethingSelected()) {
                for (var t, n = e.listSelections(), r = n.length; r--;) u(e, (t = n[r]).anchor, t.head);
                return !0
            }
        }

        function w(e, t) {
            e.state.emacsPrefix ? "-" != t && (e.state.emacsPrefix += t) : (e.state.emacsPrefix = t, e.on("keyHandled", _), e.on("inputRead", S))
        }
        var k = {
            "Alt-G": !0,
            "Ctrl-X": !0,
            "Ctrl-Q": !0,
            "Ctrl-U": !0
        };

        function _(e, t) {
            e.state.emacsPrefixMap || k.hasOwnProperty(t) || C(e)
        }

        function C(e) {
            e.state.emacsPrefix = null, e.off("keyHandled", _), e.off("inputRead", S)
        }

        function S(e, t) {
            var n = m(e);
            if (1 < n && "+input" == t.origin) {
                for (var r = t.text.join("\n"), i = "", o = 1; o < n; ++o) i += r;
                e.replaceSelection(i)
            }
        }

        function T(e, t) {
            ("string" != typeof t || !/^\d$/.test(t) && "Ctrl-U" != t) && (e.removeKeyMap(N), e.state.emacsPrefixMap = !1, e.off("keyHandled", T), e.off("inputRead", T))
        }

        function M(e) {
            e.setCursor(e.getCursor()), e.setExtending(!e.getExtending()), e.on("change", function() {
                e.setExtending(!1)
            })
        }

        function A(e) {
            e.setExtending(!1), e.setCursor(e.getCursor())
        }

        function L(e, t) {
            var n = e.getCursor(),
                r = e.findPosH(n, 1, "word");
            e.replaceRange(t(e.getRange(n, r)), n, r), e.setCursor(r)
        }
        var E = e.keyMap.emacs = e.normalizeKeyMap({
                "Ctrl-W": function(e) {
                    u(e, e.getCursor("start"), e.getCursor("end"))
                },
                "Ctrl-K": g(function(e) {
                    var t = e.getCursor(),
                        n = e.clipPos(l(t.line)),
                        r = e.getRange(t, n);
                    /\S/.test(r) || (r += "\n", n = l(t.line + 1, 0)), u(e, t, n, !0, r)
                }),
                "Alt-W": function(e) {
                    s(e.getSelection()), A(e)
                },
                "Ctrl-Y": function(e) {
                    var t = e.getCursor();
                    e.replaceRange(n(m(e)), t, t, "paste"), e.setSelection(t, e.getCursor())
                },
                "Alt-Y": function(e) {
                    e.replaceSelection((1 < o.length && o.pop(), n()), "around", "paste")
                },
                "Ctrl-Space": M,
                "Ctrl-Shift-2": M,
                "Ctrl-F": y(t, 1),
                "Ctrl-B": y(t, -1),
                Right: y(t, 1),
                Left: y(t, -1),
                "Ctrl-D": function(e) {
                    b(e, t, 1)
                },
                Delete: function(e) {
                    x(e) || b(e, t, 1)
                },
                "Ctrl-H": function(e) {
                    b(e, t, -1)
                },
                Backspace: function(e) {
                    x(e) || b(e, t, -1)
                },
                "Alt-F": y(r, 1),
                "Alt-B": y(r, -1),
                "Alt-D": function(e) {
                    b(e, r, 1)
                },
                "Alt-Backspace": function(e) {
                    b(e, r, -1)
                },
                "Ctrl-N": y(i, 1),
                "Ctrl-P": y(i, -1),
                Down: y(i, 1),
                Up: y(i, -1),
                "Ctrl-A": "goLineStart",
                "Ctrl-E": "goLineEnd",
                End: "goLineEnd",
                Home: "goLineStart",
                "Alt-V": y(h, -1),
                "Ctrl-V": y(h, 1),
                PageUp: y(h, -1),
                PageDown: y(h, 1),
                "Ctrl-Up": y(d, -1),
                "Ctrl-Down": y(d, 1),
                "Alt-A": y(f, -1),
                "Alt-E": y(f, 1),
                "Alt-K": function(e) {
                    b(e, f, 1)
                },
                "Ctrl-Alt-K": function(e) {
                    b(e, p, 1)
                },
                "Ctrl-Alt-Backspace": function(e) {
                    b(e, p, -1)
                },
                "Ctrl-Alt-F": y(p, 1),
                "Ctrl-Alt-B": y(p, -1),
                "Shift-Ctrl-Alt-2": function(e) {
                    var t = e.getCursor();
                    e.setSelection(v(e, t, p, 1), t)
                },
                "Ctrl-Alt-T": function(e) {
                    var t = p(e, e.getCursor(), -1),
                        n = p(e, t, 1),
                        r = p(e, n, 1),
                        i = p(e, r, -1);
                    e.replaceRange(e.getRange(i, r) + e.getRange(n, i) + e.getRange(t, n), t, r)
                },
                "Ctrl-Alt-U": g(function(e) {
                    for (var t = e.getCursor(), n = t.line, r = t.ch, i = []; n >= e.firstLine();) {
                        for (var o = e.getLine(n), s = null == r ? o.length : r; 0 < s;)
                            if (")" == (r = o.charAt(--s))) i.push("(");
                            else if ("]" == r) i.push("[");
                        else if ("}" == r) i.push("{");
                        else if (/[\(\{\[]/.test(r) && (!i.length || i.pop() != r)) return e.extendSelection(l(n, s));
                        --n, r = null
                    }
                }),
                "Alt-Space": function(e) {
                    for (var t = e.getCursor(), n = t.ch, r = t.ch, i = e.getLine(t.line); n && /\s/.test(i.charAt(n - 1));) --n;
                    for (; r < i.length && /\s/.test(i.charAt(r));) ++r;
                    e.replaceRange(" ", l(t.line, n), l(t.line, r))
                },
                "Ctrl-O": g(function(e) {
                    e.replaceSelection("\n", "start")
                }),
                "Ctrl-T": g(function(e) {
                    e.execCommand("transposeChars")
                }),
                "Alt-C": g(function(e) {
                    L(e, function(e) {
                        var t = e.search(/\w/);
                        return -1 == t ? e : e.slice(0, t) + e.charAt(t).toUpperCase() + e.slice(t + 1).toLowerCase()
                    })
                }),
                "Alt-U": g(function(e) {
                    L(e, function(e) {
                        return e.toUpperCase()
                    })
                }),
                "Alt-L": g(function(e) {
                    L(e, function(e) {
                        return e.toLowerCase()
                    })
                }),
                "Alt-;": "toggleComment",
                "Ctrl-/": g("undo"),
                "Shift-Ctrl--": g("undo"),
                "Ctrl-Z": g("undo"),
                "Cmd-Z": g("undo"),
                "Shift-Alt-,": "goDocStart",
                "Shift-Alt-.": "goDocEnd",
                "Ctrl-S": "findNext",
                "Ctrl-R": "findPrev",
                "Ctrl-G": function(e) {
                    e.execCommand("clearSearch"), A(e)
                },
                "Shift-Alt-5": "replace",
                "Alt-/": "autocomplete",
                "Ctrl-J": "newlineAndIndent",
                Enter: !1,
                Tab: "indentAuto",
                "Alt-G G": function(n) {
                    var e, t, r, i = m(n, !0);
                    if (null != i && 0 < i) return n.setCursor(i - 1);
                    t = "Goto line", r = function(e) {
                        var t;
                        e && !isNaN(t = Number(e)) && t == t | 0 && 0 < t && n.setCursor(t - 1)
                    }, (e = n).openDialog ? e.openDialog(t + ': <input type="text" style="width: 10em"/>', r, {
                        bottom: !0
                    }) : r(prompt(t, ""))
                },
                "Ctrl-X Tab": function(e) {
                    e.indentSelection(m(e, !0) || e.getOption("indentUnit"))
                },
                "Ctrl-X Ctrl-X": function(e) {
                    e.setSelection(e.getCursor("head"), e.getCursor("anchor"))
                },
                "Ctrl-X Ctrl-S": "save",
                "Ctrl-X Ctrl-W": "save",
                "Ctrl-X S": "saveAll",
                "Ctrl-X F": "open",
                "Ctrl-X U": g("undo"),
                "Ctrl-X K": "close",
                "Ctrl-X Delete": function(e) {
                    u(e, e.getCursor(), f(e, e.getCursor(), 1), !0)
                },
                "Ctrl-X H": "selectAll",
                "Ctrl-Q Tab": g("insertTab"),
                "Ctrl-U": function(e) {
                    e.state.emacsPrefixMap = !0, e.addKeyMap(N), e.on("keyHandled", T), e.on("inputRead", T)
                }
            }),
            N = {
                "Ctrl-G": C
            };

        function I(t) {
            N[t] = function(e) {
                w(e, t)
            }, E["Ctrl-" + t] = function(e) {
                w(e, t)
            }, k["Ctrl-" + t] = !0
        }
        for (var O = 0; O < 10; ++O) I(String(O));
        I("-")
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../lib/codemirror"), require("../addon/search/searchcursor"), require("../addon/edit/matchbrackets")) : "function" == typeof define && define.amd ? define(["../lib/codemirror", "../addon/search/searchcursor", "../addon/edit/matchbrackets"], e) : e(CodeMirror)
    }(function(h) {
        "use strict";
        var e = h.keyMap.sublime = {
                fallthrough: "default"
            },
            t = h.commands,
            d = h.Pos,
            n = h.keyMap.default == h.keyMap.macDefault,
            r = n ? "Cmd-" : "Ctrl-";

        function i(t, n) {
            t.extendSelectionsBy(function(e) {
                return t.display.shift || t.doc.extend || e.empty() ? function(e, t, n) {
                    if (n < 0 && 0 == t.ch) return e.clipPos(d(t.line - 1));
                    var r = e.getLine(t.line);
                    if (0 < n && t.ch >= r.length) return e.clipPos(d(t.line + 1, 0));
                    for (var i, o = "start", s = t.ch, a = n < 0 ? 0 : r.length, l = 0; s != a; s += n, l++) {
                        var c = r.charAt(n < 0 ? s - 1 : s),
                            u = "_" != c && h.isWordChar(c) ? "w" : "o";
                        if ("w" == u && c.toUpperCase() == c && (u = "W"), "start" == o) "o" != u && (o = "in", i = u);
                        else if ("in" == o && i != u) {
                            if ("w" == i && "W" == u && n < 0 && s--, "W" == i && "w" == u && 0 < n) {
                                i = "w";
                                continue
                            }
                            break
                        }
                    }
                    return d(t.line, s)
                }(t.doc, e.head, n) : n < 0 ? e.from() : e.to()
            })
        }

        function o(s, a) {
            s.operation(function() {
                for (var e = s.listSelections().length, t = [], n = -1, r = 0; r < e; r++) {
                    var i = s.listSelections()[r].head;
                    if (!(i.line <= n)) {
                        var o = d(i.line + (a ? 0 : 1), 0);
                        s.replaceRange("\n", o, null, "+insertLine"), s.indentLine(o.line, null, !0), t.push({
                            head: o,
                            anchor: o
                        }), n = i.line + 1
                    }
                }
                s.setSelections(t)
            })
        }

        function c(e, t) {
            for (var n = t.ch, r = n, i = e.getLine(t.line); n && h.isWordChar(i.charAt(n - 1));) --n;
            for (; r < i.length && h.isWordChar(i.charAt(r));) ++r;
            return {
                from: d(t.line, n),
                to: d(t.line, r),
                word: i.slice(n, r)
            }
        }
        t[e["Alt-Left"] = "goSubwordLeft"] = function(e) {
            i(e, -1)
        }, t[e["Alt-Right"] = "goSubwordRight"] = function(e) {
            i(e, 1)
        }, t[e[r + "Up"] = "scrollLineUp"] = function(e) {
            var t = e.getScrollInfo();
            if (!e.somethingSelected()) {
                var n = e.lineAtHeight(t.top + t.clientHeight, "local");
                e.getCursor().line >= n && e.execCommand("goLineUp")
            }
            e.scrollTo(null, t.top - e.defaultTextHeight())
        }, t[e[r + "Down"] = "scrollLineDown"] = function(e) {
            var t = e.getScrollInfo();
            if (!e.somethingSelected()) {
                var n = e.lineAtHeight(t.top, "local") + 1;
                e.getCursor().line <= n && e.execCommand("goLineDown")
            }
            e.scrollTo(null, t.top + e.defaultTextHeight())
        }, t[e["Shift-" + r + "L"] = "splitSelectionByLine"] = function(e) {
            for (var t = e.listSelections(), n = [], r = 0; r < t.length; r++)
                for (var i = t[r].from(), o = t[r].to(), s = i.line; s <= o.line; ++s) o.line > i.line && s == o.line && 0 == o.ch || n.push({
                    anchor: s == i.line ? i : d(s, 0),
                    head: s == o.line ? o : d(s)
                });
            e.setSelections(n, 0)
        }, e["Shift-Tab"] = "indentLess", t[e.Esc = "singleSelectionTop"] = function(e) {
            var t = e.listSelections()[0];
            e.setSelection(t.anchor, t.head, {
                scroll: !1
            })
        }, t[e[r + "L"] = "selectLine"] = function(e) {
            for (var t = e.listSelections(), n = [], r = 0; r < t.length; r++) {
                var i = t[r];
                n.push({
                    anchor: d(i.from().line, 0),
                    head: d(i.to().line + 1, 0)
                })
            }
            e.setSelections(n)
        }, e["Shift-" + r + "K"] = "deleteLine", t[e[r + "Enter"] = "insertLineAfter"] = function(e) {
            o(e, !1)
        }, t[e["Shift-" + r + "Enter"] = "insertLineBefore"] = function(e) {
            o(e, !0)
        }, t[e[r + "D"] = "selectNextOccurrence"] = function(e) {
            var t = e.getCursor("from"),
                n = e.getCursor("to"),
                r = e.state.sublimeFindFullWord == e.doc.sel;
            if (0 == h.cmpPos(t, n)) {
                var i = c(e, t);
                if (!i.word) return;
                e.setSelection(i.from, i.to), r = !0
            } else {
                var o = e.getRange(t, n),
                    s = r ? new RegExp("\\b" + o + "\\b") : o,
                    a = e.getSearchCursor(s, n);
                a.findNext() ? e.addSelection(a.from(), a.to()) : (a = e.getSearchCursor(s, d(e.firstLine(), 0))).findNext() && e.addSelection(a.from(), a.to())
            }
            r && (e.state.sublimeFindFullWord = e.doc.sel)
        };

        function s(e) {
            var t = e.getCursor(),
                n = e.scanForBracket(t, -1);
            if (n)
                for (;;) {
                    var r = e.scanForBracket(t, 1);
                    if (!r) return;
                    if (r.ch == "(){}[]".charAt("(){}[]".indexOf(n.ch) + 1)) return e.setSelection(d(n.pos.line, n.pos.ch + 1), r.pos, !1), !0;
                    t = d(r.pos.line, r.pos.ch + 1)
                }
        }
        t[e["Shift-" + r + "Space"] = "selectScope"] = function(e) {
            s(e) || e.execCommand("selectAll")
        }, t[e["Shift-" + r + "M"] = "selectBetweenBrackets"] = function(e) {
            if (!s(e)) return h.Pass
        }, t[e[r + "M"] = "goToBracket"] = function(r) {
            r.extendSelectionsBy(function(e) {
                var t = r.scanForBracket(e.head, 1);
                if (t && 0 != h.cmpPos(t.pos, e.head)) return t.pos;
                var n = r.scanForBracket(e.head, -1);
                return n && d(n.pos.line, n.pos.ch + 1) || e.head
            })
        };
        var a = n ? "Cmd-Ctrl-" : "Shift-Ctrl-";

        function l(a, l) {
            for (var c, e = a.listSelections(), u = [], t = 0; t < e.length; t++) {
                var n = e[t];
                if (!n.empty()) {
                    for (var r = n.from().line, i = n.to().line; t < e.length - 1 && e[t + 1].from().line == i;) i = n[++t].to().line;
                    u.push(r, i)
                }
            }
            u.length ? c = !0 : u.push(a.firstLine(), a.lastLine()), a.operation(function() {
                for (var e = [], t = 0; t < u.length; t += 2) {
                    var n = u[t],
                        r = u[t + 1],
                        i = d(n, 0),
                        o = d(r),
                        s = a.getRange(i, o, !1);
                    l ? s.sort() : s.sort(function(e, t) {
                        var n = e.toUpperCase(),
                            r = t.toUpperCase();
                        return n != r && (e = n, t = r), e < t ? -1 : e == t ? 0 : 1
                    }), a.replaceRange(s, i, o), c && e.push({
                        anchor: i,
                        head: o
                    })
                }
                c && a.setSelections(e, 0)
            })
        }
        t[e[a + "Up"] = "swapLineUp"] = function(i) {
            for (var e = i.listSelections(), o = [], t = i.firstLine() - 1, s = [], n = 0; n < e.length; n++) {
                var r = e[n],
                    a = r.from().line - 1,
                    l = r.to().line;
                s.push({
                    anchor: d(r.anchor.line - 1, r.anchor.ch),
                    head: d(r.head.line - 1, r.head.ch)
                }), 0 != r.to().ch || r.empty() || --l, t < a ? o.push(a, l) : o.length && (o[o.length - 1] = l), t = l
            }
            i.operation(function() {
                for (var e = 0; e < o.length; e += 2) {
                    var t = o[e],
                        n = o[e + 1],
                        r = i.getLine(t);
                    i.replaceRange("", d(t, 0), d(t + 1, 0), "+swapLine"), n > i.lastLine() ? i.replaceRange("\n" + r, d(i.lastLine()), null, "+swapLine") : i.replaceRange(r + "\n", d(n, 0), null, "+swapLine")
                }
                i.setSelections(s), i.scrollIntoView()
            })
        }, t[e[a + "Down"] = "swapLineDown"] = function(i) {
            for (var e = i.listSelections(), o = [], t = i.lastLine() + 1, n = e.length - 1; 0 <= n; n--) {
                var r = e[n],
                    s = r.to().line + 1,
                    a = r.from().line;
                0 != r.to().ch || r.empty() || s--, s < t ? o.push(s, a) : o.length && (o[o.length - 1] = a), t = a
            }
            i.operation(function() {
                for (var e = o.length - 2; 0 <= e; e -= 2) {
                    var t = o[e],
                        n = o[e + 1],
                        r = i.getLine(t);
                    t == i.lastLine() ? i.replaceRange("", d(t - 1), d(t), "+swapLine") : i.replaceRange("", d(t, 0), d(t + 1, 0), "+swapLine"), i.replaceRange(r + "\n", d(n, 0), null, "+swapLine")
                }
                i.scrollIntoView()
            })
        }, e[r + "/"] = "toggleComment", t[e[r + "J"] = "joinLines"] = function(l) {
            for (var e = l.listSelections(), c = [], t = 0; t < e.length; t++) {
                for (var n = e[t], r = n.from(), i = r.line, o = n.to().line; t < e.length - 1 && e[t + 1].from().line == o;) o = e[++t].to().line;
                c.push({
                    start: i,
                    end: o,
                    anchor: !n.empty() && r
                })
            }
            l.operation(function() {
                for (var e = 0, t = [], n = 0; n < c.length; n++) {
                    for (var r, i = c[n], o = i.anchor && d(i.anchor.line - e, i.anchor.ch), s = i.start; s <= i.end; s++) {
                        var a = s - e;
                        s == i.end && (r = d(a, l.getLine(a).length + 1)), a < l.lastLine() && (l.replaceRange(" ", d(a), d(a + 1, /^\s*/.exec(l.getLine(a + 1))[0].length)), ++e)
                    }
                    t.push({
                        anchor: o || r,
                        head: r
                    })
                }
                l.setSelections(t, 0)
            })
        }, t[e["Shift-" + r + "D"] = "duplicateLine"] = function(r) {
            r.operation(function() {
                for (var e = r.listSelections().length, t = 0; t < e; t++) {
                    var n = r.listSelections()[t];
                    n.empty() ? r.replaceRange(r.getLine(n.head.line) + "\n", d(n.head.line, 0)) : r.replaceRange(r.getRange(n.from(), n.to()), n.from())
                }
                r.scrollIntoView()
            })
        }, e[r + "T"] = "transposeChars", t[e.F9 = "sortLines"] = function(e) {
            l(e, !0)
        }, t[e[r + "F9"] = "sortLinesInsensitive"] = function(e) {
            l(e, !1)
        }, t[e.F2 = "nextBookmark"] = function(e) {
            var t = e.state.sublimeBookmarks;
            if (t)
                for (; t.length;) {
                    var n = t.shift(),
                        r = n.find();
                    if (r) return t.push(n), e.setSelection(r.from, r.to)
                }
        }, t[e["Shift-F2"] = "prevBookmark"] = function(e) {
            var t = e.state.sublimeBookmarks;
            if (t)
                for (; t.length;) {
                    t.unshift(t.pop());
                    var n = t[t.length - 1].find();
                    if (n) return e.setSelection(n.from, n.to);
                    t.pop()
                }
        }, t[e[r + "F2"] = "toggleBookmark"] = function(e) {
            for (var t = e.listSelections(), n = e.state.sublimeBookmarks || (e.state.sublimeBookmarks = []), r = 0; r < t.length; r++) {
                for (var i = t[r].from(), o = t[r].to(), s = e.findMarks(i, o), a = 0; a < s.length; a++)
                    if (s[a].sublimeBookmark) {
                        s[a].clear();
                        for (var l = 0; l < n.length; l++) n[l] == s[a] && n.splice(l--, 1);
                        break
                    } a == s.length && n.push(e.markText(i, o, {
                    sublimeBookmark: !0,
                    clearWhenEmpty: !1
                }))
            }
        }, t[e["Shift-" + r + "F2"] = "clearBookmarks"] = function(e) {
            var t = e.state.sublimeBookmarks;
            if (t)
                for (var n = 0; n < t.length; n++) t[n].clear();
            t.length = 0
        }, t[e["Alt-F2"] = "selectBookmarks"] = function(e) {
            var t = e.state.sublimeBookmarks,
                n = [];
            if (t)
                for (var r = 0; r < t.length; r++) {
                    var i = t[r].find();
                    i ? n.push({
                        anchor: i.from,
                        head: i.to
                    }) : t.splice(r--, 0)
                }
            n.length && e.setSelections(n, 0)
        }, e["Alt-Q"] = "wrapLines";
        var u = r + "K ";

        function f(a, l) {
            a.operation(function() {
                for (var e = a.listSelections(), t = [], n = [], r = 0; r < e.length; r++) {
                    (o = e[r]).empty() ? (t.push(r), n.push("")) : n.push(l(a.getRange(o.from(), o.to())))
                }
                a.replaceSelections(n, "around", "case");
                var i;
                for (r = t.length - 1; 0 <= r; r--) {
                    var o = e[t[r]];
                    if (!(i && 0 < h.cmpPos(o.head, i))) {
                        var s = c(a, o.head);
                        i = s.from, a.replaceRange(l(s.word), s.from, s.to)
                    }
                }
            })
        }

        function p(e) {
            var t = e.getCursor("from"),
                n = e.getCursor("to");
            if (0 == h.cmpPos(t, n)) {
                var r = c(e, t);
                if (!r.word) return;
                t = r.from, n = r.to
            }
            return {
                from: t,
                to: n,
                query: e.getRange(t, n),
                word: r
            }
        }

        function m(e, t) {
            var n = p(e);
            if (n) {
                var r = n.query,
                    i = e.getSearchCursor(r, t ? n.to : n.from);
                (t ? i.findNext() : i.findPrevious()) ? e.setSelection(i.from(), i.to()): (i = e.getSearchCursor(r, t ? d(e.firstLine(), 0) : e.clipPos(d(e.lastLine()))), (t ? i.findNext() : i.findPrevious()) ? e.setSelection(i.from(), i.to()) : n.word && e.setSelection(n.from, n.to))
            }
        }
        e[u + r + "Backspace"] = "delLineLeft", t[e.Backspace = "smartBackspace"] = function(e) {
            if (e.somethingSelected()) return h.Pass;
            var t = e.getCursor(),
                n = e.getRange({
                    line: t.line,
                    ch: 0
                }, t),
                r = h.countColumn(n, null, e.getOption("tabSize"));
            return /\S/.test(n) || r % e.getOption("indentUnit") != 0 ? h.Pass : e.indentSelection("subtract")
        }, t[e[u + r + "K"] = "delLineRight"] = function(n) {
            n.operation(function() {
                for (var e = n.listSelections(), t = e.length - 1; 0 <= t; t--) n.replaceRange("", e[t].anchor, d(e[t].to().line), "+delete");
                n.scrollIntoView()
            })
        }, t[e[u + r + "U"] = "upcaseAtCursor"] = function(e) {
            f(e, function(e) {
                return e.toUpperCase()
            })
        }, t[e[u + r + "L"] = "downcaseAtCursor"] = function(e) {
            f(e, function(e) {
                return e.toLowerCase()
            })
        }, t[e[u + r + "Space"] = "setSublimeMark"] = function(e) {
            e.state.sublimeMark && e.state.sublimeMark.clear(), e.state.sublimeMark = e.setBookmark(e.getCursor())
        }, t[e[u + r + "A"] = "selectToSublimeMark"] = function(e) {
            var t = e.state.sublimeMark && e.state.sublimeMark.find();
            t && e.setSelection(e.getCursor(), t)
        }, t[e[u + r + "W"] = "deleteToSublimeMark"] = function(e) {
            var t = e.state.sublimeMark && e.state.sublimeMark.find();
            if (t) {
                var n = e.getCursor(),
                    r = t;
                if (0 < h.cmpPos(n, r)) {
                    var i = r;
                    r = n, n = i
                }
                e.state.sublimeKilled = e.getRange(n, r), e.replaceRange("", n, r)
            }
        }, t[e[u + r + "X"] = "swapWithSublimeMark"] = function(e) {
            var t = e.state.sublimeMark && e.state.sublimeMark.find();
            t && (e.state.sublimeMark.clear(), e.state.sublimeMark = e.setBookmark(e.getCursor()), e.setCursor(t))
        }, t[e[u + r + "Y"] = "sublimeYank"] = function(e) {
            null != e.state.sublimeKilled && e.replaceSelection(e.state.sublimeKilled, null, "paste")
        }, e[u + r + "G"] = "clearBookmarks", t[e[u + r + "C"] = "showInCenter"] = function(e) {
            var t = e.cursorCoords(null, "local");
            e.scrollTo(null, (t.top + t.bottom) / 2 - e.getScrollInfo().clientHeight / 2)
        }, t[e["Shift-Alt-Up"] = "selectLinesUpward"] = function(r) {
            r.operation(function() {
                for (var e = r.listSelections(), t = 0; t < e.length; t++) {
                    var n = e[t];
                    n.head.line > r.firstLine() && r.addSelection(d(n.head.line - 1, n.head.ch))
                }
            })
        }, t[e["Shift-Alt-Down"] = "selectLinesDownward"] = function(r) {
            r.operation(function() {
                for (var e = r.listSelections(), t = 0; t < e.length; t++) {
                    var n = e[t];
                    n.head.line < r.lastLine() && r.addSelection(d(n.head.line + 1, n.head.ch))
                }
            })
        }, t[e[r + "F3"] = "findUnder"] = function(e) {
            m(e, !0)
        }, t[e["Shift-" + r + "F3"] = "findUnderPrevious"] = function(e) {
            m(e, !1)
        }, t[e["Alt-F3"] = "findAllUnder"] = function(e) {
            var t = p(e);
            if (t) {
                for (var n = e.getSearchCursor(t.query), r = [], i = -1; n.findNext();) r.push({
                    anchor: n.from(),
                    head: n.to()
                }), n.from().line <= t.from.line && n.from().ch <= t.from.ch && i++;
                e.setSelections(r, i)
            }
        }, e["Shift-" + r + "["] = "fold", e["Shift-" + r + "]"] = "unfold", e[u + r + "0"] = e[u + r + "j"] = "unfoldAll", e[r + "I"] = "findIncremental", e["Shift-" + r + "I"] = "findIncrementalReverse", e[r + "H"] = "replace", e.F3 = "findNext", e["Shift-F3"] = "findPrev", h.normalizeKeyMap(e)
    }),
    function(e) {
        "object" == typeof exports && "object" == typeof module ? e(require("../lib/codemirror"), require("../addon/search/searchcursor"), require("../addon/dialog/dialog"), require("../addon/edit/matchbrackets.js")) : "function" == typeof define && define.amd ? define(["../lib/codemirror", "../addon/search/searchcursor", "../addon/dialog/dialog", "../addon/edit/matchbrackets"], e) : e(CodeMirror)
    }(function(qe) {
        "use strict";
        var je = [{
                keys: "<Left>",
                type: "keyToKey",
                toKeys: "h"
            }, {
                keys: "<Right>",
                type: "keyToKey",
                toKeys: "l"
            }, {
                keys: "<Up>",
                type: "keyToKey",
                toKeys: "k"
            }, {
                keys: "<Down>",
                type: "keyToKey",
                toKeys: "j"
            }, {
                keys: "<Space>",
                type: "keyToKey",
                toKeys: "l"
            }, {
                keys: "<BS>",
                type: "keyToKey",
                toKeys: "h",
                context: "normal"
            }, {
                keys: "<C-Space>",
                type: "keyToKey",
                toKeys: "W"
            }, {
                keys: "<C-BS>",
                type: "keyToKey",
                toKeys: "B",
                context: "normal"
            }, {
                keys: "<S-Space>",
                type: "keyToKey",
                toKeys: "w"
            }, {
                keys: "<S-BS>",
                type: "keyToKey",
                toKeys: "b",
                context: "normal"
            }, {
                keys: "<C-n>",
                type: "keyToKey",
                toKeys: "j"
            }, {
                keys: "<C-p>",
                type: "keyToKey",
                toKeys: "k"
            }, {
                keys: "<C-[>",
                type: "keyToKey",
                toKeys: "<Esc>"
            }, {
                keys: "<C-c>",
                type: "keyToKey",
                toKeys: "<Esc>"
            }, {
                keys: "<C-[>",
                type: "keyToKey",
                toKeys: "<Esc>",
                context: "insert"
            }, {
                keys: "<C-c>",
                type: "keyToKey",
                toKeys: "<Esc>",
                context: "insert"
            }, {
                keys: "s",
                type: "keyToKey",
                toKeys: "cl",
                context: "normal"
            }, {
                keys: "s",
                type: "keyToKey",
                toKeys: "xi",
                context: "visual"
            }, {
                keys: "S",
                type: "keyToKey",
                toKeys: "cc",
                context: "normal"
            }, {
                keys: "S",
                type: "keyToKey",
                toKeys: "dcc",
                context: "visual"
            }, {
                keys: "<Home>",
                type: "keyToKey",
                toKeys: "0"
            }, {
                keys: "<End>",
                type: "keyToKey",
                toKeys: "$"
            }, {
                keys: "<PageUp>",
                type: "keyToKey",
                toKeys: "<C-b>"
            }, {
                keys: "<PageDown>",
                type: "keyToKey",
                toKeys: "<C-f>"
            }, {
                keys: "<CR>",
                type: "keyToKey",
                toKeys: "j^",
                context: "normal"
            }, {
                keys: "H",
                type: "motion",
                motion: "moveToTopLine",
                motionArgs: {
                    linewise: !0,
                    toJumplist: !0
                }
            }, {
                keys: "M",
                type: "motion",
                motion: "moveToMiddleLine",
                motionArgs: {
                    linewise: !0,
                    toJumplist: !0
                }
            }, {
                keys: "L",
                type: "motion",
                motion: "moveToBottomLine",
                motionArgs: {
                    linewise: !0,
                    toJumplist: !0
                }
            }, {
                keys: "h",
                type: "motion",
                motion: "moveByCharacters",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: "l",
                type: "motion",
                motion: "moveByCharacters",
                motionArgs: {
                    forward: !0
                }
            }, {
                keys: "j",
                type: "motion",
                motion: "moveByLines",
                motionArgs: {
                    forward: !0,
                    linewise: !0
                }
            }, {
                keys: "k",
                type: "motion",
                motion: "moveByLines",
                motionArgs: {
                    forward: !1,
                    linewise: !0
                }
            }, {
                keys: "gj",
                type: "motion",
                motion: "moveByDisplayLines",
                motionArgs: {
                    forward: !0
                }
            }, {
                keys: "gk",
                type: "motion",
                motion: "moveByDisplayLines",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: "w",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !0,
                    wordEnd: !1
                }
            }, {
                keys: "W",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !0,
                    wordEnd: !1,
                    bigWord: !0
                }
            }, {
                keys: "e",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !0,
                    wordEnd: !0,
                    inclusive: !0
                }
            }, {
                keys: "E",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !0,
                    wordEnd: !0,
                    bigWord: !0,
                    inclusive: !0
                }
            }, {
                keys: "b",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !1,
                    wordEnd: !1
                }
            }, {
                keys: "B",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !1,
                    wordEnd: !1,
                    bigWord: !0
                }
            }, {
                keys: "ge",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !1,
                    wordEnd: !0,
                    inclusive: !0
                }
            }, {
                keys: "gE",
                type: "motion",
                motion: "moveByWords",
                motionArgs: {
                    forward: !1,
                    wordEnd: !0,
                    bigWord: !0,
                    inclusive: !0
                }
            }, {
                keys: "{",
                type: "motion",
                motion: "moveByParagraph",
                motionArgs: {
                    forward: !1,
                    toJumplist: !0
                }
            }, {
                keys: "}",
                type: "motion",
                motion: "moveByParagraph",
                motionArgs: {
                    forward: !0,
                    toJumplist: !0
                }
            }, {
                keys: "<C-f>",
                type: "motion",
                motion: "moveByPage",
                motionArgs: {
                    forward: !0
                }
            }, {
                keys: "<C-b>",
                type: "motion",
                motion: "moveByPage",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: "<C-d>",
                type: "motion",
                motion: "moveByScroll",
                motionArgs: {
                    forward: !0,
                    explicitRepeat: !0
                }
            }, {
                keys: "<C-u>",
                type: "motion",
                motion: "moveByScroll",
                motionArgs: {
                    forward: !1,
                    explicitRepeat: !0
                }
            }, {
                keys: "gg",
                type: "motion",
                motion: "moveToLineOrEdgeOfDocument",
                motionArgs: {
                    forward: !1,
                    explicitRepeat: !0,
                    linewise: !0,
                    toJumplist: !0
                }
            }, {
                keys: "G",
                type: "motion",
                motion: "moveToLineOrEdgeOfDocument",
                motionArgs: {
                    forward: !0,
                    explicitRepeat: !0,
                    linewise: !0,
                    toJumplist: !0
                }
            }, {
                keys: "0",
                type: "motion",
                motion: "moveToStartOfLine"
            }, {
                keys: "^",
                type: "motion",
                motion: "moveToFirstNonWhiteSpaceCharacter"
            }, {
                keys: "+",
                type: "motion",
                motion: "moveByLines",
                motionArgs: {
                    forward: !0,
                    toFirstChar: !0
                }
            }, {
                keys: "-",
                type: "motion",
                motion: "moveByLines",
                motionArgs: {
                    forward: !1,
                    toFirstChar: !0
                }
            }, {
                keys: "_",
                type: "motion",
                motion: "moveByLines",
                motionArgs: {
                    forward: !0,
                    toFirstChar: !0,
                    repeatOffset: -1
                }
            }, {
                keys: "$",
                type: "motion",
                motion: "moveToEol",
                motionArgs: {
                    inclusive: !0
                }
            }, {
                keys: "%",
                type: "motion",
                motion: "moveToMatchedSymbol",
                motionArgs: {
                    inclusive: !0,
                    toJumplist: !0
                }
            }, {
                keys: "f<character>",
                type: "motion",
                motion: "moveToCharacter",
                motionArgs: {
                    forward: !0,
                    inclusive: !0
                }
            }, {
                keys: "F<character>",
                type: "motion",
                motion: "moveToCharacter",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: "t<character>",
                type: "motion",
                motion: "moveTillCharacter",
                motionArgs: {
                    forward: !0,
                    inclusive: !0
                }
            }, {
                keys: "T<character>",
                type: "motion",
                motion: "moveTillCharacter",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: ";",
                type: "motion",
                motion: "repeatLastCharacterSearch",
                motionArgs: {
                    forward: !0
                }
            }, {
                keys: ",",
                type: "motion",
                motion: "repeatLastCharacterSearch",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: "'<character>",
                type: "motion",
                motion: "goToMark",
                motionArgs: {
                    toJumplist: !0,
                    linewise: !0
                }
            }, {
                keys: "`<character>",
                type: "motion",
                motion: "goToMark",
                motionArgs: {
                    toJumplist: !0
                }
            }, {
                keys: "]`",
                type: "motion",
                motion: "jumpToMark",
                motionArgs: {
                    forward: !0
                }
            }, {
                keys: "[`",
                type: "motion",
                motion: "jumpToMark",
                motionArgs: {
                    forward: !1
                }
            }, {
                keys: "]'",
                type: "motion",
                motion: "jumpToMark",
                motionArgs: {
                    forward: !0,
                    linewise: !0
                }
            }, {
                keys: "['",
                type: "motion",
                motion: "jumpToMark",
                motionArgs: {
                    forward: !1,
                    linewise: !0
                }
            }, {
                keys: "]p",
                type: "action",
                action: "paste",
                isEdit: !0,
                actionArgs: {
                    after: !0,
                    isEdit: !0,
                    matchIndent: !0
                }
            }, {
                keys: "[p",
                type: "action",
                action: "paste",
                isEdit: !0,
                actionArgs: {
                    after: !1,
                    isEdit: !0,
                    matchIndent: !0
                }
            }, {
                keys: "]<character>",
                type: "motion",
                motion: "moveToSymbol",
                motionArgs: {
                    forward: !0,
                    toJumplist: !0
                }
            }, {
                keys: "[<character>",
                type: "motion",
                motion: "moveToSymbol",
                motionArgs: {
                    forward: !1,
                    toJumplist: !0
                }
            }, {
                keys: "|",
                type: "motion",
                motion: "moveToColumn"
            }, {
                keys: "o",
                type: "motion",
                motion: "moveToOtherHighlightedEnd",
                context: "visual"
            }, {
                keys: "O",
                type: "motion",
                motion: "moveToOtherHighlightedEnd",
                motionArgs: {
                    sameLine: !0
                },
                context: "visual"
            }, {
                keys: "d",
                type: "operator",
                operator: "delete"
            }, {
                keys: "y",
                type: "operator",
                operator: "yank"
            }, {
                keys: "c",
                type: "operator",
                operator: "change"
            }, {
                keys: ">",
                type: "operator",
                operator: "indent",
                operatorArgs: {
                    indentRight: !0
                }
            }, {
                keys: "<",
                type: "operator",
                operator: "indent",
                operatorArgs: {
                    indentRight: !1
                }
            }, {
                keys: "g~",
                type: "operator",
                operator: "changeCase"
            }, {
                keys: "gu",
                type: "operator",
                operator: "changeCase",
                operatorArgs: {
                    toLower: !0
                },
                isEdit: !0
            }, {
                keys: "gU",
                type: "operator",
                operator: "changeCase",
                operatorArgs: {
                    toLower: !1
                },
                isEdit: !0
            }, {
                keys: "n",
                type: "motion",
                motion: "findNext",
                motionArgs: {
                    forward: !0,
                    toJumplist: !0
                }
            }, {
                keys: "N",
                type: "motion",
                motion: "findNext",
                motionArgs: {
                    forward: !1,
                    toJumplist: !0
                }
            }, {
                keys: "x",
                type: "operatorMotion",
                operator: "delete",
                motion: "moveByCharacters",
                motionArgs: {
                    forward: !0
                },
                operatorMotionArgs: {
                    visualLine: !1
                }
            }, {
                keys: "X",
                type: "operatorMotion",
                operator: "delete",
                motion: "moveByCharacters",
                motionArgs: {
                    forward: !1
                },
                operatorMotionArgs: {
                    visualLine: !0
                }
            }, {
                keys: "D",
                type: "operatorMotion",
                operator: "delete",
                motion: "moveToEol",
                motionArgs: {
                    inclusive: !0
                },
                context: "normal"
            }, {
                keys: "D",
                type: "operator",
                operator: "delete",
                operatorArgs: {
                    linewise: !0
                },
                context: "visual"
            }, {
                keys: "Y",
                type: "operatorMotion",
                operator: "yank",
                motion: "moveToEol",
                motionArgs: {
                    inclusive: !0
                },
                context: "normal"
            }, {
                keys: "Y",
                type: "operator",
                operator: "yank",
                operatorArgs: {
                    linewise: !0
                },
                context: "visual"
            }, {
                keys: "C",
                type: "operatorMotion",
                operator: "change",
                motion: "moveToEol",
                motionArgs: {
                    inclusive: !0
                },
                context: "normal"
            }, {
                keys: "C",
                type: "operator",
                operator: "change",
                operatorArgs: {
                    linewise: !0
                },
                context: "visual"
            }, {
                keys: "~",
                type: "operatorMotion",
                operator: "changeCase",
                motion: "moveByCharacters",
                motionArgs: {
                    forward: !0
                },
                operatorArgs: {
                    shouldMoveCursor: !0
                },
                context: "normal"
            }, {
                keys: "~",
                type: "operator",
                operator: "changeCase",
                context: "visual"
            }, {
                keys: "<C-w>",
                type: "operatorMotion",
                operator: "delete",
                motion: "moveByWords",
                motionArgs: {
                    forward: !1,
                    wordEnd: !1
                },
                context: "insert"
            }, {
                keys: "<C-i>",
                type: "action",
                action: "jumpListWalk",
                actionArgs: {
                    forward: !0
                }
            }, {
                keys: "<C-o>",
                type: "action",
                action: "jumpListWalk",
                actionArgs: {
                    forward: !1
                }
            }, {
                keys: "<C-e>",
                type: "action",
                action: "scroll",
                actionArgs: {
                    forward: !0,
                    linewise: !0
                }
            }, {
                keys: "<C-y>",
                type: "action",
                action: "scroll",
                actionArgs: {
                    forward: !1,
                    linewise: !0
                }
            }, {
                keys: "a",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    insertAt: "charAfter"
                },
                context: "normal"
            }, {
                keys: "A",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    insertAt: "eol"
                },
                context: "normal"
            }, {
                keys: "A",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    insertAt: "endOfSelectedArea"
                },
                context: "visual"
            }, {
                keys: "i",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    insertAt: "inplace"
                },
                context: "normal"
            }, {
                keys: "I",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    insertAt: "firstNonBlank"
                },
                context: "normal"
            }, {
                keys: "I",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    insertAt: "startOfSelectedArea"
                },
                context: "visual"
            }, {
                keys: "o",
                type: "action",
                action: "newLineAndEnterInsertMode",
                isEdit: !0,
                interlaceInsertRepeat: !0,
                actionArgs: {
                    after: !0
                },
                context: "normal"
            }, {
                keys: "O",
                type: "action",
                action: "newLineAndEnterInsertMode",
                isEdit: !0,
                interlaceInsertRepeat: !0,
                actionArgs: {
                    after: !1
                },
                context: "normal"
            }, {
                keys: "v",
                type: "action",
                action: "toggleVisualMode"
            }, {
                keys: "V",
                type: "action",
                action: "toggleVisualMode",
                actionArgs: {
                    linewise: !0
                }
            }, {
                keys: "<C-v>",
                type: "action",
                action: "toggleVisualMode",
                actionArgs: {
                    blockwise: !0
                }
            }, {
                keys: "gv",
                type: "action",
                action: "reselectLastSelection"
            }, {
                keys: "J",
                type: "action",
                action: "joinLines",
                isEdit: !0
            }, {
                keys: "p",
                type: "action",
                action: "paste",
                isEdit: !0,
                actionArgs: {
                    after: !0,
                    isEdit: !0
                }
            }, {
                keys: "P",
                type: "action",
                action: "paste",
                isEdit: !0,
                actionArgs: {
                    after: !1,
                    isEdit: !0
                }
            }, {
                keys: "r<character>",
                type: "action",
                action: "replace",
                isEdit: !0
            }, {
                keys: "@<character>",
                type: "action",
                action: "replayMacro"
            }, {
                keys: "q<character>",
                type: "action",
                action: "enterMacroRecordMode"
            }, {
                keys: "R",
                type: "action",
                action: "enterInsertMode",
                isEdit: !0,
                actionArgs: {
                    replace: !0
                }
            }, {
                keys: "u",
                type: "action",
                action: "undo",
                context: "normal"
            }, {
                keys: "u",
                type: "operator",
                operator: "changeCase",
                operatorArgs: {
                    toLower: !0
                },
                context: "visual",
                isEdit: !0
            }, {
                keys: "U",
                type: "operator",
                operator: "changeCase",
                operatorArgs: {
                    toLower: !1
                },
                context: "visual",
                isEdit: !0
            }, {
                keys: "<C-r>",
                type: "action",
                action: "redo"
            }, {
                keys: "m<character>",
                type: "action",
                action: "setMark"
            }, {
                keys: '"<character>',
                type: "action",
                action: "setRegister"
            }, {
                keys: "zz",
                type: "action",
                action: "scrollToCursor",
                actionArgs: {
                    position: "center"
                }
            }, {
                keys: "z.",
                type: "action",
                action: "scrollToCursor",
                actionArgs: {
                    position: "center"
                },
                motion: "moveToFirstNonWhiteSpaceCharacter"
            }, {
                keys: "zt",
                type: "action",
                action: "scrollToCursor",
                actionArgs: {
                    position: "top"
                }
            }, {
                keys: "z<CR>",
                type: "action",
                action: "scrollToCursor",
                actionArgs: {
                    position: "top"
                },
                motion: "moveToFirstNonWhiteSpaceCharacter"
            }, {
                keys: "z-",
                type: "action",
                action: "scrollToCursor",
                actionArgs: {
                    position: "bottom"
                }
            }, {
                keys: "zb",
                type: "action",
                action: "scrollToCursor",
                actionArgs: {
                    position: "bottom"
                },
                motion: "moveToFirstNonWhiteSpaceCharacter"
            }, {
                keys: ".",
                type: "action",
                action: "repeatLastEdit"
            }, {
                keys: "<C-a>",
                type: "action",
                action: "incrementNumberToken",
                isEdit: !0,
                actionArgs: {
                    increase: !0,
                    backtrack: !1
                }
            }, {
                keys: "<C-x>",
                type: "action",
                action: "incrementNumberToken",
                isEdit: !0,
                actionArgs: {
                    increase: !1,
                    backtrack: !1
                }
            }, {
                keys: "a<character>",
                type: "motion",
                motion: "textObjectManipulation"
            }, {
                keys: "i<character>",
                type: "motion",
                motion: "textObjectManipulation",
                motionArgs: {
                    textObjectInner: !0
                }
            }, {
                keys: "/",
                type: "search",
                searchArgs: {
                    forward: !0,
                    querySrc: "prompt",
                    toJumplist: !0
                }
            }, {
                keys: "?",
                type: "search",
                searchArgs: {
                    forward: !1,
                    querySrc: "prompt",
                    toJumplist: !0
                }
            }, {
                keys: "*",
                type: "search",
                searchArgs: {
                    forward: !0,
                    querySrc: "wordUnderCursor",
                    wholeWordOnly: !0,
                    toJumplist: !0
                }
            }, {
                keys: "#",
                type: "search",
                searchArgs: {
                    forward: !1,
                    querySrc: "wordUnderCursor",
                    wholeWordOnly: !0,
                    toJumplist: !0
                }
            }, {
                keys: "g*",
                type: "search",
                searchArgs: {
                    forward: !0,
                    querySrc: "wordUnderCursor",
                    toJumplist: !0
                }
            }, {
                keys: "g#",
                type: "search",
                searchArgs: {
                    forward: !1,
                    querySrc: "wordUnderCursor",
                    toJumplist: !0
                }
            }, {
                keys: ":",
                type: "ex"
            }],
            We = qe.Pos;
        qe.Vim = function() {
            function e(e, t) {
                var n;
                this == qe.keyMap.vim && qe.rmClass(e.getWrapperElement(), "cm-fat-cursor"), t && t.attach == r || ((n = e).setOption("disableInput", !1), n.off("cursorActivity", Pe), qe.off(n.getInputField(), "paste", i(n)), n.state.vim = null)
            }

            function r(e, t) {
                var n;
                this == qe.keyMap.vim && qe.addClass(e.getWrapperElement(), "cm-fat-cursor"), t && t.attach == r || ((n = e).setOption("disableInput", !0), n.setOption("showCursorWhenSelecting", !1), qe.signal(n, "vim-mode-change", {
                    mode: "normal"
                }), n.on("cursorActivity", Pe), T(n), qe.on(n.getInputField(), "paste", i(n)))
            }

            function t(e, t) {
                if (t) {
                    var n = function(e) {
                        if ("'" == e.charAt(0)) return e.charAt(1);
                        var t = e.split("-");
                        /-$/.test(e) && t.splice(-2, 2, "-");
                        var n = t[t.length - 1];
                        if (1 == t.length && 1 == t[0].length) return !1;
                        if (2 == t.length && "Shift" == t[0] && 1 == n.length) return !1;
                        for (var r = !1, i = 0; i < t.length; i++) {
                            var o = t[i];
                            o in s ? t[i] = s[o] : r = !0, o in a && (t[i] = a[o])
                        }
                        return !!r && (f(n) && (t[t.length - 1] = n.toLowerCase()), "<" + t.join("-") + ">")
                    }(e);
                    if (!n) return !1;
                    var r = qe.Vim.findKey(t, n);
                    return "function" == typeof r && qe.signal(t, "vim-keypress", n), r
                }
            }
            qe.defineOption("vimMode", !1, function(e, t, n) {
                t && "vim" != e.getOption("keyMap") ? e.setOption("keyMap", "vim") : !t && n != qe.Init && /^vim/.test(e.getOption("keyMap")) && e.setOption("keyMap", "default")
            });
            var s = {
                    Shift: "S",
                    Ctrl: "C",
                    Alt: "A",
                    Cmd: "D",
                    Mod: "A"
                },
                a = {
                    Enter: "CR",
                    Backspace: "BS",
                    Delete: "Del"
                };

            function i(e) {
                var t = e.state.vim;
                return t.onPasteFn || (t.onPasteFn = function() {
                    t.insertMode || (e.setCursor(j(e.getCursor(), 0, 1)), B.enterInsertMode(e, {}, t))
                }), t.onPasteFn
            }
            var m = /[\d]/,
                g = [qe.isWordChar, function(e) {
                    return e && !qe.isWordChar(e) && !/\s/.test(e)
                }],
                v = [function(e) {
                    return /\S/.test(e)
                }];

            function n(e, t) {
                for (var n = [], r = e; r < e + t; r++) n.push(String.fromCharCode(r));
                return n
            }
            var o = n(65, 26),
                l = n(97, 26),
                c = n(48, 10),
                u = [].concat(o, l, c, ["<", ">"]),
                h = [].concat(o, l, c, ["-", '"', ".", ":", "/"]);

            function y(e, t) {
                return t >= e.firstLine() && t <= e.lastLine()
            }

            function d(e) {
                return /^[a-z]$/.test(e)
            }

            function f(e) {
                return /^[A-Z]$/.test(e)
            }

            function I(e) {
                return /^\s*$/.test(e)
            }

            function b(e, t) {
                for (var n = 0; n < t.length; n++)
                    if (t[n] == e) return !0;
                return !1
            }
            var p = {};

            function x(e, t, n) {
                if (void 0 === t) throw Error("defaultValue is required");
                n || (n = "string"), p[e] = {
                    type: n,
                    defaultValue: t
                }, w(e, t)
            }

            function w(e, t) {
                var n = p[e];
                if (!n) throw Error("Unknown option: " + e);
                if ("boolean" == n.type) {
                    if (t && !0 !== t) throw Error("Invalid argument: " + e + "=" + t);
                    !1 !== t && (t = !0)
                }
                n.value = "boolean" == n.type ? !!t : t
            }

            function k(e) {
                var t = p[e];
                if (!t) throw Error("Unknown option: " + e);
                return t.value
            }
            var F, _, C = function(e) {
                return e ? {
                    changes: e.changes,
                    expectCursorActivityForChange: e.expectCursorActivityForChange
                } : {
                    changes: [],
                    expectCursorActivityForChange: !1
                }
            };

            function S() {
                this.latestRegister = void 0, this.isPlaying = !1, this.isRecording = !1, this.replaySearchQueries = [], this.onRecordingDone = void 0, this.lastInsertModeChanges = C()
            }

            function T(e) {
                return e.state.vim || (e.state.vim = {
                    inputState: new L,
                    lastEditInputState: void 0,
                    lastEditActionCommand: void 0,
                    lastHPos: -1,
                    lastHSPos: -1,
                    lastMotion: null,
                    marks: {},
                    fakeCursor: null,
                    insertMode: !1,
                    insertModeRepeat: void 0,
                    visualMode: !1,
                    visualLine: !1,
                    visualBlock: !1,
                    lastSelection: null,
                    lastPastedText: null,
                    sel: {}
                }), e.state.vim
            }

            function M() {
                var s, a, l, c;
                for (var e in F = {
                        searchQuery: null,
                        searchIsReversed: !1,
                        lastSubstituteReplacePart: void 0,
                        jumpList: (s = -1, a = 0, l = 0, c = new Array(100), {
                            cachedCursor: void 0,
                            add: function(r, e, t) {
                                var n = c[s % 100];

                                function i(e) {
                                    var t = ++s % 100,
                                        n = c[t];
                                    n && n.clear(), c[t] = r.setBookmark(e)
                                }
                                if (n) {
                                    var o = n.find();
                                    o && !V(o, e) && i(e)
                                } else i(e);
                                i(t), (l = (a = s) - 100 + 1) < 0 && (l = 0)
                            },
                            move: function(e, t) {
                                a < (s += t) ? s = a : s < l && (s = l);
                                var n = c[(100 + s) % 100];
                                if (n && !n.find()) {
                                    var r, i = 0 < t ? 1 : -1,
                                        o = e.getCursor();
                                    do {
                                        if ((n = c[(100 + (s += i)) % 100]) && (r = n.find()) && !V(o, r)) break
                                    } while (s < a && l < s)
                                }
                                return n
                            }
                        }),
                        macroModeState: new S,
                        lastChararacterSearch: {
                            increment: 0,
                            forward: !0,
                            selectedCharacter: ""
                        },
                        registerController: new N({}),
                        searchHistoryController: new R({}),
                        exCommandHistoryController: new R({})
                    }, p) {
                    var t = p[e];
                    t.value = t.defaultValue
                }
            }
            var A = {
                buildKeyMap: function() {},
                getRegisterController: function() {
                    return F.registerController
                },
                resetVimGlobalState_: M,
                getVimGlobalState_: function() {
                    return F
                },
                maybeInitVimState_: T,
                suppressErrorLogging: (S.prototype = {
                    exitMacroRecordMode: function() {
                        var e = F.macroModeState;
                        e.onRecordingDone && e.onRecordingDone(), e.onRecordingDone = void 0, e.isRecording = !1
                    },
                    enterMacroRecordMode: function(e, t) {
                        var n = F.registerController.getRegister(t);
                        n && (n.clear(), this.latestRegister = t, e.openDialog && (this.onRecordingDone = e.openDialog("(recording)[" + t + "]", null, {
                            bottom: !0
                        })), this.isRecording = !0)
                    }
                }, !1),
                InsertModeKey: He,
                map: function(e, t, n) {
                    Ne.map(e, t, n)
                },
                setOption: w,
                getOption: k,
                defineOption: x,
                defineEx: function(e, t, n) {
                    if (0 !== e.indexOf(t)) throw new Error('(Vim.defineEx) "' + t + '" is not a prefix of "' + e + '", command not registered');
                    Ee[e] = n, Ne.commandMap_[t] = {
                        name: e,
                        shortName: t,
                        type: "api"
                    }
                },
                handleKey: function(e, t, n) {
                    var r = this.findKey(e, t, n);
                    if ("function" == typeof r) return r()
                },
                findKey: function(o, s, t) {
                    var e, a = T(o);

                    function i() {
                        var e = F.macroModeState;
                        if (e.isRecording) {
                            if ("q" == s) return e.exitMacroRecordMode(), O(o), !0;
                            "mapping" != t && function(e, t) {
                                if (!e.isPlaying) {
                                    var n = e.latestRegister,
                                        r = F.registerController.getRegister(n);
                                    r && r.pushText(t)
                                }
                            }(e, s)
                        }
                    }

                    function l() {
                        if ("<Esc>" == s) return O(o), a.visualMode ? oe(o) : a.insertMode && Ie(o), !0
                    }
                    return !1 === (e = a.insertMode ? function() {
                        if (l()) return !0;
                        for (var e = a.inputState.keyBuffer = a.inputState.keyBuffer + s, t = 1 == s.length, n = D.matchCommand(e, je, a.inputState, "insert"); 1 < e.length && "full" != n.type;) {
                            e = a.inputState.keyBuffer = e.slice(1);
                            var r = D.matchCommand(e, je, a.inputState, "insert");
                            "none" != r.type && (n = r)
                        }
                        if ("none" == n.type) return O(o), !1;
                        if ("partial" == n.type) return _ && window.clearTimeout(_), _ = window.setTimeout(function() {
                            a.insertMode && a.inputState.keyBuffer && O(o)
                        }, k("insertModeEscKeysTimeout")), !t;
                        if (_ && window.clearTimeout(_), t) {
                            var i = o.getCursor();
                            o.replaceRange("", j(i, 0, -(e.length - 1)), i, "+input")
                        }
                        return O(o), n.command
                    }() : function() {
                        if (i() || l()) return !0;
                        var e = a.inputState.keyBuffer = a.inputState.keyBuffer + s;
                        if (/^[1-9]\d*$/.test(e)) return !0;
                        if (!(t = /^(\d*)(.*)$/.exec(e))) return O(o), !1;
                        var t, n = a.visualMode ? "visual" : "normal",
                            r = D.matchCommand(t[2] || t[1], je, a.inputState, n);
                        return "none" == r.type ? (O(o), !1) : "partial" == r.type || (a.inputState.keyBuffer = "", (t = /^(\d*)(.*)$/.exec(e))[1] && "0" != t[1] && a.inputState.pushRepeatDigit(t[1]), r.command)
                    }()) ? void 0 : !0 === e ? function() {} : function() {
                        return o.operation(function() {
                            o.curOp.isVimOp = !0;
                            try {
                                "keyToKey" == e.type ? function(e) {
                                    for (var t; e;) t = /<\w+-.+?>|<\w+>|./.exec(e), s = t[0], e = e.substring(t.index + s.length), qe.Vim.handleKey(o, s, "mapping")
                                }(e.toKeys) : D.processCommand(o, a, e)
                            } catch (e) {
                                throw o.state.vim = void 0, T(o), qe.Vim.suppressErrorLogging || console.log(e), e
                            }
                            return !0
                        })
                    }
                },
                handleEx: function(e, t) {
                    Ne.processCommand(e, t)
                },
                defineMotion: function(e, t) {
                    P[e] = t
                },
                defineAction: function(e, t) {
                    B[e] = t
                },
                defineOperator: function(e, t) {
                    H[e] = t
                },
                mapCommand: function(e, t, n, r, i) {
                    var o = {
                        keys: e,
                        type: t
                    };
                    for (var s in o[t] = n, o[t + "Args"] = r, i) o[s] = i[s];
                    Oe(o)
                },
                _mapCommand: Oe,
                exitVisualMode: oe,
                exitInsertMode: Ie
            };

            function L() {
                this.prefixRepeat = [], this.motionRepeat = [], this.operator = null, this.operatorArgs = null, this.motion = null, this.motionArgs = null, this.keyBuffer = [], this.registerName = null
            }

            function O(e, t) {
                e.state.vim.inputState = new L, qe.signal(e, "vim-command-done", t)
            }

            function E(e, t, n) {
                this.clear(), this.keyBuffer = [e || ""], this.insertModeChanges = [], this.searchQueries = [], this.linewise = !!t, this.blockwise = !!n
            }

            function N(e) {
                this.registers = e, this.unnamedRegister = e['"'] = new E, e["."] = new E, e[":"] = new E, e["/"] = new E
            }

            function R() {
                this.historyBuffer = [], this.iterator, this.initialPrefix = null
            }
            L.prototype.pushRepeatDigit = function(e) {
                this.operator ? this.motionRepeat = this.motionRepeat.concat(e) : this.prefixRepeat = this.prefixRepeat.concat(e)
            }, L.prototype.getRepeat = function() {
                var e = 0;
                return (0 < this.prefixRepeat.length || 0 < this.motionRepeat.length) && (e = 1, 0 < this.prefixRepeat.length && (e *= parseInt(this.prefixRepeat.join(""), 10)), 0 < this.motionRepeat.length && (e *= parseInt(this.motionRepeat.join(""), 10))), e
            }, E.prototype = {
                setText: function(e, t, n) {
                    this.keyBuffer = [e || ""], this.linewise = !!t, this.blockwise = !!n
                },
                pushText: function(e, t) {
                    t && (this.linewise || this.keyBuffer.push("\n"), this.linewise = !0), this.keyBuffer.push(e)
                },
                pushInsertModeChanges: function(e) {
                    this.insertModeChanges.push(C(e))
                },
                pushSearchQuery: function(e) {
                    this.searchQueries.push(e)
                },
                clear: function() {
                    this.keyBuffer = [], this.insertModeChanges = [], this.searchQueries = [], this.linewise = !1
                },
                toString: function() {
                    return this.keyBuffer.join("")
                }
            }, N.prototype = {
                pushText: function(e, t, n, r, i) {
                    r && "\n" == n.charAt(0) && (n = n.slice(1) + "\n"), r && "\n" !== n.charAt(n.length - 1) && (n += "\n");
                    var o = this.isValidRegister(e) ? this.getRegister(e) : null;
                    if (o) f(e) ? o.pushText(n, r) : o.setText(n, r, i), this.unnamedRegister.setText(o.toString(), r);
                    else {
                        switch (t) {
                            case "yank":
                                this.registers[0] = new E(n, r, i);
                                break;
                            case "delete":
                            case "change":
                                -1 == n.indexOf("\n") ? this.registers["-"] = new E(n, r) : (this.shiftNumericRegisters_(), this.registers[1] = new E(n, r))
                        }
                        this.unnamedRegister.setText(n, r, i)
                    }
                },
                getRegister: function(e) {
                    return this.isValidRegister(e) ? (e = e.toLowerCase(), this.registers[e] || (this.registers[e] = new E), this.registers[e]) : this.unnamedRegister
                },
                isValidRegister: function(e) {
                    return e && b(e, h)
                },
                shiftNumericRegisters_: function() {
                    for (var e = 9; 2 <= e; e--) this.registers[e] = this.getRegister("" + (e - 1))
                }
            }, R.prototype = {
                nextMatch: function(e, t) {
                    var n = this.historyBuffer,
                        r = t ? -1 : 1;
                    null === this.initialPrefix && (this.initialPrefix = e);
                    for (var i = this.iterator + r; t ? 0 <= i : i < n.length; i += r)
                        for (var o = n[i], s = 0; s <= o.length; s++)
                            if (this.initialPrefix == o.substring(0, s)) return this.iterator = i, o;
                    return i >= n.length ? (this.iterator = n.length, this.initialPrefix) : i < 0 ? e : void 0
                },
                pushInput: function(e) {
                    var t = this.historyBuffer.indexOf(e); - 1 < t && this.historyBuffer.splice(t, 1), e.length && this.historyBuffer.push(e)
                },
                reset: function() {
                    this.initialPrefix = null, this.iterator = this.historyBuffer.length
                }
            };
            var D = {
                    matchCommand: function(e, t, n, r) {
                        var i, o = function(e, t, n, r) {
                            for (var i, o = [], s = [], a = 0; a < t.length; a++) {
                                var l = t[a];
                                "insert" == n && "insert" != l.context || l.context && l.context != n || r.operator && "action" == l.type || !(i = W(e, l.keys)) || ("partial" == i && o.push(l), "full" == i && s.push(l))
                            }
                            return {
                                partial: o.length && o,
                                full: s.length && s
                            }
                        }(e, t, r, n);
                        if (!o.full && !o.partial) return {
                            type: "none"
                        };
                        if (!o.full && o.partial) return {
                            type: "partial"
                        };
                        for (var s = 0; s < o.full.length; s++) {
                            var a = o.full[s];
                            i || (i = a)
                        }
                        return "<character>" == i.keys.slice(-11) && (n.selectedCharacter = function(e) {
                            var t = /^.*(<[\w\-]+>)$/.exec(e),
                                n = t ? t[1] : e.slice(-1);
                            if (1 < n.length) switch (n) {
                                case "<CR>":
                                    n = "\n";
                                    break;
                                case "<Space>":
                                    n = " "
                            }
                            return n
                        }(e)), {
                            type: "full",
                            command: i
                        }
                    },
                    processCommand: function(e, t, n) {
                        switch (t.inputState.repeatOverride = n.repeatOverride, n.type) {
                            case "motion":
                                this.processMotion(e, t, n);
                                break;
                            case "operator":
                                this.processOperator(e, t, n);
                                break;
                            case "operatorMotion":
                                this.processOperatorMotion(e, t, n);
                                break;
                            case "action":
                                this.processAction(e, t, n);
                                break;
                            case "search":
                                this.processSearch(e, t, n);
                                break;
                            case "ex":
                            case "keyToEx":
                                this.processEx(e, t, n)
                        }
                    },
                    processMotion: function(e, t, n) {
                        t.inputState.motion = n.motion, t.inputState.motionArgs = q(n.motionArgs), this.evalInput(e, t)
                    },
                    processOperator: function(e, t, n) {
                        var r = t.inputState;
                        if (r.operator) {
                            if (r.operator == n.operator) return r.motion = "expandToLine", r.motionArgs = {
                                linewise: !0
                            }, void this.evalInput(e, t);
                            O(e)
                        }
                        r.operator = n.operator, r.operatorArgs = q(n.operatorArgs), t.visualMode && this.evalInput(e, t)
                    },
                    processOperatorMotion: function(e, t, n) {
                        var r = t.visualMode,
                            i = q(n.operatorMotionArgs);
                        i && r && i.visualLine && (t.visualLine = !0), this.processOperator(e, t, n), r || this.processMotion(e, t, n)
                    },
                    processAction: function(e, t, n) {
                        var r = t.inputState,
                            i = r.getRepeat(),
                            o = !!i,
                            s = q(n.actionArgs) || {};
                        r.selectedCharacter && (s.selectedCharacter = r.selectedCharacter), n.operator && this.processOperator(e, t, n), n.motion && this.processMotion(e, t, n), (n.motion || n.operator) && this.evalInput(e, t), s.repeat = i || 1, s.repeatIsExplicit = o, s.registerName = r.registerName, O(e), t.lastMotion = null, n.isEdit && this.recordLastEdit(t, r, n), B[n.action](e, s, t)
                    },
                    processSearch: function(s, r, i) {
                        if (s.getSearchCursor) {
                            var a = i.searchArgs.forward,
                                e = i.searchArgs.wholeWordOnly;
                            ve(s).setReversed(!a);
                            var t = a ? "/" : "?",
                                o = ve(s).getQuery(),
                                l = s.getScrollInfo();
                            switch (i.searchArgs.querySrc) {
                                case "prompt":
                                    var n = F.macroModeState;
                                    n.isPlaying ? d(h = n.replaySearchQueries.shift(), !0, !1) : ke(s, {
                                        onClose: function(e) {
                                            s.scrollTo(l.left, l.top), d(e, !0, !0);
                                            var t = F.macroModeState;
                                            t.isRecording && function(e, t) {
                                                if (!e.isPlaying) {
                                                    var n = e.latestRegister,
                                                        r = F.registerController.getRegister(n);
                                                    r && r.pushSearchQuery(t)
                                                }
                                            }(t, e)
                                        },
                                        prefix: t,
                                        desc: we,
                                        onKeyUp: function(e, t, n) {
                                            var r, i, o = qe.keyName(e);
                                            "Up" == o || "Down" == o ? (r = "Up" == o, n(t = F.searchHistoryController.nextMatch(t, r) || "")) : "Left" != o && "Right" != o && "Ctrl" != o && "Alt" != o && "Shift" != o && F.searchHistoryController.reset();
                                            try {
                                                i = _e(s, t, !0, !0)
                                            } catch (e) {}
                                            i ? s.scrollIntoView(Se(s, !a, i), 30) : (Te(s), s.scrollTo(l.left, l.top))
                                        },
                                        onKeyDown: function(e, t, n) {
                                            var r = qe.keyName(e);
                                            "Esc" != r && "Ctrl-C" != r && "Ctrl-[" != r || (F.searchHistoryController.pushInput(t), F.searchHistoryController.reset(), _e(s, o), Te(s), s.scrollTo(l.left, l.top), qe.e_stop(e), O(s), n(), s.focus())
                                        }
                                    });
                                    break;
                                case "wordUnderCursor":
                                    var c = ae(s, !1, 0, !1, !0),
                                        u = !0;
                                    if (c || (c = ae(s, !1, 0, !1, !1), u = !1), !c) return;
                                    var h = s.getLine(c.start.line).substring(c.start.ch, c.end.ch);
                                    h = u && e ? "\\b" + h + "\\b" : h.replace(/([.?*+$\[\]\/\\(){}|\-])/g, "\\$1"), F.jumpList.cachedCursor = s.getCursor(), s.setCursor(c.start), d(h, !0, !1)
                            }
                        }

                        function d(t, e, n) {
                            F.searchHistoryController.pushInput(t), F.searchHistoryController.reset();
                            try {
                                _e(s, t, e, n)
                            } catch (e) {
                                return xe(s, "Invalid regex: " + t), void O(s)
                            }
                            D.processMotion(s, r, {
                                type: "motion",
                                motion: "findNext",
                                motionArgs: {
                                    forward: !0,
                                    toJumplist: i.searchArgs.toJumplist
                                }
                            })
                        }
                    },
                    processEx: function(o, e, t) {
                        function n(e) {
                            F.exCommandHistoryController.pushInput(e), F.exCommandHistoryController.reset(), Ne.processCommand(o, e)
                        }

                        function r(e, t, n) {
                            var r, i = qe.keyName(e);
                            "Esc" != i && "Ctrl-C" != i && "Ctrl-[" != i || (F.exCommandHistoryController.pushInput(t), F.exCommandHistoryController.reset(), qe.e_stop(e), O(o), n(), o.focus()), "Up" == i || "Down" == i ? (r = "Up" == i, n(t = F.exCommandHistoryController.nextMatch(t, r) || "")) : "Left" != i && "Right" != i && "Ctrl" != i && "Alt" != i && "Shift" != i && F.exCommandHistoryController.reset()
                        }
                        "keyToEx" == t.type ? Ne.processCommand(o, t.exArgs.input) : e.visualMode ? ke(o, {
                            onClose: n,
                            prefix: ":",
                            value: "'<,'>",
                            onKeyDown: r
                        }) : ke(o, {
                            onClose: n,
                            prefix: ":",
                            onKeyDown: r
                        })
                    },
                    evalInput: function(e, t) {
                        var n, r, i, o, s = t.inputState,
                            a = s.motion,
                            l = s.motionArgs || {},
                            c = s.operator,
                            u = s.operatorArgs || {},
                            h = s.registerName,
                            d = t.sel,
                            f = K(t.visualMode ? d.head : e.getCursor("head")),
                            p = K(t.visualMode ? d.anchor : e.getCursor("anchor")),
                            m = K(f),
                            g = K(p);
                        if (c && this.recordLastEdit(t, s), 0 < (i = void 0 !== s.repeatOverride ? s.repeatOverride : s.getRepeat()) && l.explicitRepeat ? l.repeatIsExplicit = !0 : (l.noRepeat || !l.explicitRepeat && 0 === i) && (i = 1, l.repeatIsExplicit = !1), s.selectedCharacter && (l.selectedCharacter = u.selectedCharacter = s.selectedCharacter), l.repeat = i, O(e), a) {
                            var v = P[a](e, f, l, t);
                            if (t.lastMotion = P[a], !v) return;
                            if (l.toJumplist) {
                                var y = F.jumpList,
                                    b = y.cachedCursor;
                                b ? (le(e, b, v), delete y.cachedCursor) : le(e, f, v)
                            }(n = v instanceof Array ? (r = v[0], v[1]) : v) || (n = K(f)), t.visualMode ? (t.visualBlock && n.ch === 1 / 0 || (n = z(e, n, t.visualBlock)), r && (r = z(e, r, !0)), r = r || g, d.anchor = r, d.head = n, re(e), pe(e, t, "<", G(r, n) ? r : n), pe(e, t, ">", G(r, n) ? n : r)) : c || (n = z(e, n), e.setCursor(n.line, n.ch))
                        }
                        if (c) {
                            if (u.lastSel) {
                                r = g;
                                var x = u.lastSel,
                                    w = Math.abs(x.head.line - x.anchor.line),
                                    k = Math.abs(x.head.ch - x.anchor.ch);
                                n = x.visualLine ? We(g.line + w, g.ch) : x.visualBlock ? We(g.line + w, g.ch + k) : x.head.line == x.anchor.line ? We(g.line, g.ch + k) : We(g.line + w, g.ch), t.visualMode = !0, t.visualLine = x.visualLine, t.visualBlock = x.visualBlock, d = t.sel = {
                                    anchor: r,
                                    head: n
                                }, re(e)
                            } else t.visualMode && (u.lastSel = {
                                anchor: K(d.anchor),
                                head: K(d.head),
                                visualBlock: t.visualBlock,
                                visualLine: t.visualLine
                            });
                            var _, C, S, T, M;
                            if (t.visualMode) {
                                if (_ = Y(d.head, d.anchor), C = X(d.head, d.anchor), S = t.visualLine || u.linewise, M = ie(e, {
                                        anchor: _,
                                        head: C
                                    }, T = t.visualBlock ? "block" : S ? "line" : "char"), S) {
                                    var A = M.ranges;
                                    if ("block" == T)
                                        for (var L = 0; L < A.length; L++) A[L].head.ch = J(e, A[L].head.line);
                                    else "line" == T && (A[0].head = We(A[0].head.line + 1, 0))
                                }
                            } else {
                                if (_ = K(r || g), G(C = K(n || m), _)) {
                                    var E = _;
                                    _ = C, C = E
                                }(S = l.linewise || u.linewise) ? (o = C, _.ch = 0, o.ch = 0, o.line++) : l.forward && function(e, t, n) {
                                    var r = e.getRange(t, n);
                                    if (/\n\s*$/.test(r)) {
                                        var i = r.split("\n");
                                        i.pop();
                                        for (var o = i.pop(); 0 < i.length && o && I(o); o = i.pop()) n.line--, n.ch = 0;
                                        n.ch = o ? (n.line--, J(e, n.line)) : 0
                                    }
                                }(e, _, C), M = ie(e, {
                                    anchor: _,
                                    head: C
                                }, T = "char", !l.inclusive || S)
                            }
                            e.setSelections(M.ranges, M.primary), t.lastMotion = null, u.repeat = i, u.registerName = h, u.linewise = S;
                            var N = H[c](e, u, M.ranges, g, n);
                            t.visualMode && oe(e, null != N), N && e.setCursor(N)
                        }
                    },
                    recordLastEdit: function(e, t, n) {
                        var r = F.macroModeState;
                        r.isPlaying || (e.lastEditInputState = t, e.lastEditActionCommand = n, r.lastInsertModeChanges.changes = [], r.lastInsertModeChanges.expectCursorActivityForChange = !1)
                    }
                },
                P = {
                    moveToTopLine: function(e, t, n) {
                        var r = Me(e).top + n.repeat - 1;
                        return We(r, se(e.getLine(r)))
                    },
                    moveToMiddleLine: function(e) {
                        var t = Me(e),
                            n = Math.floor(.5 * (t.top + t.bottom));
                        return We(n, se(e.getLine(n)))
                    },
                    moveToBottomLine: function(e, t, n) {
                        var r = Me(e).bottom - n.repeat + 1;
                        return We(r, se(e.getLine(r)))
                    },
                    expandToLine: function(e, t, n) {
                        return We(t.line + n.repeat - 1, 1 / 0)
                    },
                    findNext: function(e, t, n) {
                        var r = ve(e),
                            i = r.getQuery();
                        if (i) {
                            var o = !n.forward;
                            return o = r.isReversed() ? !o : o, Ce(e, i), Se(e, o, i, n.repeat)
                        }
                    },
                    goToMark: function(e, t, n, r) {
                        var i = r.marks[n.selectedCharacter];
                        if (i) {
                            var o = i.find();
                            return n.linewise ? {
                                line: o.line,
                                ch: se(e.getLine(o.line))
                            } : o
                        }
                        return null
                    },
                    moveToOtherHighlightedEnd: function(e, t, n, r) {
                        if (r.visualBlock && n.sameLine) {
                            var i = r.sel;
                            return [z(e, We(i.anchor.line, i.head.ch)), z(e, We(i.head.line, i.anchor.ch))]
                        }
                        return [r.sel.head, r.sel.anchor]
                    },
                    jumpToMark: function(e, t, n, r) {
                        for (var i = t, o = 0; o < n.repeat; o++) {
                            var s = i;
                            for (var a in r.marks)
                                if (d(a)) {
                                    var l = r.marks[a].find();
                                    if (!((n.forward ? G(l, s) : G(s, l)) || n.linewise && l.line == s.line)) {
                                        var c = V(s, i),
                                            u = n.forward ? Q(s, l, i) : Q(i, l, s);
                                        (c || u) && (i = l)
                                    }
                                }
                        }
                        return n.linewise && (i = We(i.line, se(e.getLine(i.line)))), i
                    },
                    moveByCharacters: function(e, t, n) {
                        var r = t,
                            i = n.repeat,
                            o = n.forward ? r.ch + i : r.ch - i;
                        return We(r.line, o)
                    },
                    moveByLines: function(e, t, n, r) {
                        var i = t,
                            o = i.ch;
                        switch (r.lastMotion) {
                            case this.moveByLines:
                            case this.moveByDisplayLines:
                            case this.moveByScroll:
                            case this.moveToColumn:
                            case this.moveToEol:
                                o = r.lastHPos;
                                break;
                            default:
                                r.lastHPos = o
                        }
                        var s = n.repeat + (n.repeatOffset || 0),
                            a = n.forward ? i.line + s : i.line - s,
                            l = e.firstLine(),
                            c = e.lastLine();
                        if (!(a < l && i.line == l || c < a && i.line == c)) return n.toFirstChar && (o = se(e.getLine(a)), r.lastHPos = o), r.lastHSPos = e.charCoords(We(a, o), "div").left, We(a, o)
                    },
                    moveByDisplayLines: function(e, t, n, r) {
                        var i = t;
                        switch (r.lastMotion) {
                            case this.moveByDisplayLines:
                            case this.moveByScroll:
                            case this.moveByLines:
                            case this.moveToColumn:
                            case this.moveToEol:
                                break;
                            default:
                                r.lastHSPos = e.charCoords(i, "div").left
                        }
                        var o = n.repeat;
                        if ((a = e.findPosV(i, n.forward ? o : -o, "line", r.lastHSPos)).hitSide)
                            if (n.forward) var s = {
                                    top: e.charCoords(a, "div").top + 8,
                                    left: r.lastHSPos
                                },
                                a = e.coordsChar(s, "div");
                            else {
                                var l = e.charCoords(We(e.firstLine(), 0), "div");
                                l.left = r.lastHSPos, a = e.coordsChar(l, "div")
                            } return r.lastHPos = a.ch, a
                    },
                    moveByPage: function(e, t, n) {
                        var r = t,
                            i = n.repeat;
                        return e.findPosV(r, n.forward ? i : -i, "page")
                    },
                    moveByParagraph: function(e, t, n) {
                        var r = n.forward ? 1 : -1;
                        return me(e, t, n.repeat, r)
                    },
                    moveByScroll: function(e, t, n, r) {
                        var i = e.getScrollInfo(),
                            o = null,
                            s = n.repeat;
                        s || (s = i.clientHeight / (2 * e.defaultTextHeight()));
                        var a = e.charCoords(t, "local");
                        if (n.repeat = s, !(o = P.moveByDisplayLines(e, t, n, r))) return null;
                        var l = e.charCoords(o, "local");
                        return e.scrollTo(null, i.top + l.top - a.top), o
                    },
                    moveByWords: function(e, t, n) {
                        return function(e, t, n, r, i, o) {
                            var s = K(t),
                                a = [];
                            (r && !i || !r && i) && n++;
                            for (var l = !(r && i), c = 0; c < n; c++) {
                                var u = de(e, t, r, o, l);
                                if (!u) {
                                    var h = J(e, e.lastLine());
                                    a.push(r ? {
                                        line: e.lastLine(),
                                        from: h,
                                        to: h
                                    } : {
                                        line: 0,
                                        from: 0,
                                        to: 0
                                    });
                                    break
                                }
                                a.push(u), t = We(u.line, r ? u.to - 1 : u.from)
                            }
                            var d = a.length != n,
                                f = a[0],
                                p = a.pop();
                            return r && !i ? (d || f.from == s.ch && f.line == s.line || (p = a.pop()), We(p.line, p.from)) : r && i ? We(p.line, p.to - 1) : !r && i ? (d || f.to == s.ch && f.line == s.line || (p = a.pop()), We(p.line, p.to)) : We(p.line, p.from)
                        }(e, t, n.repeat, !!n.forward, !!n.wordEnd, !!n.bigWord)
                    },
                    moveTillCharacter: function(e, t, n) {
                        var r = fe(e, n.repeat, n.forward, n.selectedCharacter),
                            i = n.forward ? -1 : 1;
                        return ce(i, n), r ? (r.ch += i, r) : null
                    },
                    moveToCharacter: function(e, t, n) {
                        var r = n.repeat;
                        return ce(0, n), fe(e, r, n.forward, n.selectedCharacter) || t
                    },
                    moveToSymbol: function(e, t, n) {
                        return function(e, t, n, r) {
                            var i = K(e.getCursor()),
                                o = n ? 1 : -1,
                                s = n ? e.lineCount() : -1,
                                a = i.ch,
                                l = i.line,
                                c = e.getLine(l),
                                u = {
                                    lineText: c,
                                    nextCh: c.charAt(a),
                                    lastCh: null,
                                    index: a,
                                    symb: r,
                                    reverseSymb: (n ? {
                                        ")": "(",
                                        "}": "{"
                                    } : {
                                        "(": ")",
                                        "{": "}"
                                    })[r],
                                    forward: n,
                                    depth: 0,
                                    curMoveThrough: !1
                                },
                                h = ue[r];
                            if (!h) return i;
                            var d = he[h].init,
                                f = he[h].isComplete;
                            for (d && d(u); l !== s && t;) {
                                if (u.index += o, u.nextCh = u.lineText.charAt(u.index), !u.nextCh) {
                                    if (l += o, u.lineText = e.getLine(l) || "", 0 < o) u.index = 0;
                                    else {
                                        var p = u.lineText.length;
                                        u.index = 0 < p ? p - 1 : 0
                                    }
                                    u.nextCh = u.lineText.charAt(u.index)
                                }
                                f(u) && (i.line = l, i.ch = u.index, t--)
                            }
                            return u.nextCh || u.curMoveThrough ? We(l, u.index) : i
                        }(e, n.repeat, n.forward, n.selectedCharacter) || t
                    },
                    moveToColumn: function(e, t, n, r) {
                        var i, o, s, a = n.repeat;
                        return r.lastHPos = a - 1, r.lastHSPos = e.charCoords(t, "div").left, o = a, s = (i = e).getCursor().line, z(i, We(s, o - 1))
                    },
                    moveToEol: function(e, t, n, r) {
                        var i = t;
                        r.lastHPos = 1 / 0;
                        var o = We(i.line + n.repeat - 1, 1 / 0),
                            s = e.clipPos(o);
                        return s.ch--, r.lastHSPos = e.charCoords(s, "div").left, o
                    },
                    moveToFirstNonWhiteSpaceCharacter: function(e, t) {
                        var n = t;
                        return We(n.line, se(e.getLine(n.line)))
                    },
                    moveToMatchedSymbol: function(e, t) {
                        var n, r = t,
                            i = r.line,
                            o = r.ch,
                            s = e.getLine(i);
                        do {
                            if ((n = s.charAt(o++)) && -1 != "()[]{}".indexOf(n)) {
                                var a = e.getTokenTypeAt(We(i, o));
                                if ("string" !== a && "comment" !== a) break
                            }
                        } while (n);
                        return n ? e.findMatchingBracket(We(i, o)).to : r
                    },
                    moveToStartOfLine: function(e, t) {
                        return We(t.line, 0)
                    },
                    moveToLineOrEdgeOfDocument: function(e, t, n) {
                        var r = n.forward ? e.lastLine() : e.firstLine();
                        return n.repeatIsExplicit && (r = n.repeat - e.getOption("firstLineNumber")), We(r, se(e.getLine(r)))
                    },
                    textObjectManipulation: function(e, t, n, r) {
                        var i = n.selectedCharacter;
                        "b" == i ? i = "(" : "B" == i && (i = "{");
                        var o, s, a, l, c, u, h, d, f = !n.textObjectInner;
                        if ({
                                "(": ")",
                                ")": "(",
                                "{": "}",
                                "}": "{",
                                "[": "]",
                                "]": "["
                            } [i]) o = function(e, t, n, r) {
                            var i, o, s = t,
                                a = {
                                    "(": /[()]/,
                                    ")": /[()]/,
                                    "[": /[[\]]/,
                                    "]": /[[\]]/,
                                    "{": /[{}]/,
                                    "}": /[{}]/
                                } [n],
                                l = {
                                    "(": "(",
                                    ")": "(",
                                    "[": "[",
                                    "]": "[",
                                    "{": "{",
                                    "}": "{"
                                } [n],
                                c = e.getLine(s.line).charAt(s.ch) === l ? 1 : 0;
                            if (i = e.scanForBracket(We(s.line, s.ch + c), -1, null, {
                                    bracketRegex: a
                                }), o = e.scanForBracket(We(s.line, s.ch + c), 1, null, {
                                    bracketRegex: a
                                }), !i || !o) return {
                                start: s,
                                end: s
                            };
                            if (i = i.pos, o = o.pos, i.line == o.line && i.ch > o.ch || i.line > o.line) {
                                var u = i;
                                i = o, o = u
                            }
                            return r ? o.ch += 1 : i.ch += 1, {
                                start: i,
                                end: o
                            }
                        }(e, t, i, f);
                        else if ({
                                "'": !0,
                                '"': !0
                            } [i]) o = function(e, t, n, r) {
                            var i, o, s, a, l = K(t),
                                c = e.getLine(l.line).split(""),
                                u = c.indexOf(n);
                            if (l.ch < u ? l.ch = u : u < l.ch && c[l.ch] == n && (o = l.ch, --l.ch), c[l.ch] != n || o)
                                for (s = l.ch; - 1 < s && !i; s--) c[s] == n && (i = s + 1);
                            else i = l.ch + 1;
                            if (i && !o)
                                for (s = i, a = c.length; s < a && !o; s++) c[s] == n && (o = s);
                            return i && o ? (r && (--i, ++o), {
                                start: We(l.line, i),
                                end: We(l.line, o)
                            }) : {
                                start: l,
                                end: l
                            }
                        }(e, t, i, f);
                        else if ("W" === i) o = ae(e, f, 0, !0);
                        else if ("w" === i) o = ae(e, f, 0, !1);
                        else {
                            if ("p" !== i) return null;
                            if (o = me(e, t, n.repeat, 0, f), n.linewise = !0, r.visualMode) r.visualLine || (r.visualLine = !0);
                            else {
                                var p = r.inputState.operatorArgs;
                                p && (p.linewise = !0), o.end.line--
                            }
                        }
                        return e.state.vim.visualMode ? (s = e, a = o.start, l = o.end, u = s.state.vim.sel, h = u.head, d = u.anchor, G(l, a) && (c = l, l = a, a = c), G(h, d) ? (h = Y(a, h), d = X(d, l)) : (d = Y(a, d), -1 == (h = j(h = X(h, l), 0, -1)).ch && h.line != s.firstLine() && (h = We(h.line - 1, J(s, h.line - 1)))), [d, h]) : [o.start, o.end]
                    },
                    repeatLastCharacterSearch: function(e, t, n) {
                        var r = F.lastChararacterSearch,
                            i = n.repeat,
                            o = n.forward === r.forward,
                            s = (r.increment ? 1 : 0) * (o ? -1 : 1);
                        e.moveH(-s, "char"), n.inclusive = !!o;
                        var a = fe(e, i, o, r.selectedCharacter);
                        return a ? (a.ch += s, a) : (e.moveH(s, "char"), t)
                    }
                };

            function $(e, t) {
                for (var n = [], r = 0; r < t; r++) n.push(e);
                return n
            }
            var H = {
                change: function(e, t, n) {
                    var r, i, o = e.state.vim;
                    if (F.macroModeState.lastInsertModeChanges.inVisualBlock = o.visualBlock, o.visualMode) {
                        i = e.getSelection();
                        var s = $("", n.length);
                        e.replaceSelections(s), r = Y(n[0].head, n[0].anchor)
                    } else {
                        var a = n[0].anchor,
                            l = n[0].head;
                        if (!I(i = e.getRange(a, l))) {
                            var c = /\s+$/.exec(i);
                            c && (l = j(l, 0, -c[0].length), i = i.slice(0, -c[0].length))
                        }
                        var u = l.line - 1 == e.lastLine();
                        e.replaceRange("", a, l), t.linewise && !u && (qe.commands.newlineAndIndent(e), a.ch = null), r = a
                    }
                    F.registerController.pushText(t.registerName, "change", i, t.linewise, 1 < n.length), B.enterInsertMode(e, {
                        head: r
                    }, e.state.vim)
                },
                delete: function(e, t, n) {
                    var r, i, o = e.state.vim;
                    if (o.visualBlock) {
                        i = e.getSelection();
                        var s = $("", n.length);
                        e.replaceSelections(s), r = n[0].anchor
                    } else {
                        var a = n[0].anchor,
                            l = n[0].head;
                        t.linewise && l.line != e.firstLine() && a.line == e.lastLine() && a.line == l.line - 1 && (a.line == e.firstLine() ? a.ch = 0 : a = We(a.line - 1, J(e, a.line - 1))), i = e.getRange(a, l), e.replaceRange("", a, l), r = a, t.linewise && (r = P.moveToFirstNonWhiteSpaceCharacter(e, a))
                    }
                    return F.registerController.pushText(t.registerName, "delete", i, t.linewise, o.visualBlock), z(e, r)
                },
                indent: function(e, t, n) {
                    var r = e.state.vim,
                        i = n[0].anchor.line,
                        o = r.visualBlock ? n[n.length - 1].anchor.line : n[0].head.line,
                        s = r.visualMode ? t.repeat : 1;
                    t.linewise && o--;
                    for (var a = i; a <= o; a++)
                        for (var l = 0; l < s; l++) e.indentLine(a, t.indentRight);
                    return P.moveToFirstNonWhiteSpaceCharacter(e, n[0].anchor)
                },
                changeCase: function(e, t, n, r, i) {
                    for (var o = e.getSelections(), s = [], a = t.toLower, l = 0; l < o.length; l++) {
                        var c = o[l],
                            u = "";
                        if (!0 === a) u = c.toLowerCase();
                        else if (!1 === a) u = c.toUpperCase();
                        else
                            for (var h = 0; h < c.length; h++) {
                                var d = c.charAt(h);
                                u += f(d) ? d.toLowerCase() : d.toUpperCase()
                            }
                        s.push(u)
                    }
                    return e.replaceSelections(s), t.shouldMoveCursor ? i : !e.state.vim.visualMode && t.linewise && n[0].anchor.line + 1 == n[0].head.line ? P.moveToFirstNonWhiteSpaceCharacter(e, r) : t.linewise ? r : Y(n[0].anchor, n[0].head)
                },
                yank: function(e, t, n, r) {
                    var i = e.state.vim,
                        o = e.getSelection(),
                        s = i.visualMode ? Y(i.sel.anchor, i.sel.head, n[0].head, n[0].anchor) : r;
                    return F.registerController.pushText(t.registerName, "yank", o, t.linewise, i.visualBlock), s
                }
            };
            var B = {
                jumpListWalk: function(e, t, n) {
                    if (!n.visualMode) {
                        var r = t.repeat,
                            i = t.forward,
                            o = F.jumpList.move(e, i ? r : -r),
                            s = o ? o.find() : void 0;
                        s = s || e.getCursor(), e.setCursor(s)
                    }
                },
                scroll: function(e, t, n) {
                    if (!n.visualMode) {
                        var r = t.repeat || 1,
                            i = e.defaultTextHeight(),
                            o = e.getScrollInfo().top,
                            s = i * r,
                            a = t.forward ? o + s : o - s,
                            l = K(e.getCursor()),
                            c = e.charCoords(l, "local");
                        if (t.forward) a > c.top ? (l.line += (a - c.top) / i, l.line = Math.ceil(l.line), e.setCursor(l), c = e.charCoords(l, "local"), e.scrollTo(null, c.top)) : e.scrollTo(null, a);
                        else {
                            var u = a + e.getScrollInfo().clientHeight;
                            u < c.bottom ? (l.line -= (c.bottom - u) / i, l.line = Math.floor(l.line), e.setCursor(l), c = e.charCoords(l, "local"), e.scrollTo(null, c.bottom - e.getScrollInfo().clientHeight)) : e.scrollTo(null, a)
                        }
                    }
                },
                scrollToCursor: function(e, t) {
                    var n = e.getCursor().line,
                        r = e.charCoords(We(n, 0), "local"),
                        i = e.getScrollInfo().clientHeight,
                        o = r.top,
                        s = r.bottom - o;
                    switch (t.position) {
                        case "center":
                            o = o - i / 2 + s;
                            break;
                        case "bottom":
                            o = o - i + 1.4 * s;
                            break;
                        case "top":
                            o += .4 * s
                    }
                    e.scrollTo(null, o)
                },
                replayMacro: function(e, t, n) {
                    var r = t.selectedCharacter,
                        i = t.repeat,
                        o = F.macroModeState;
                    for ("@" == r && (r = o.latestRegister); i--;) Re(e, n, o, r)
                },
                enterMacroRecordMode: function(e, t) {
                    var n = F.macroModeState,
                        r = t.selectedCharacter;
                    n.enterMacroRecordMode(e, r)
                },
                enterInsertMode: function(e, t, n) {
                    if (!e.getOption("readOnly")) {
                        n.insertMode = !0, n.insertModeRepeat = t && t.repeat || 1;
                        var r = t ? t.insertAt : null,
                            i = n.sel,
                            o = t.head || e.getCursor("head"),
                            s = e.listSelections().length;
                        if ("eol" == r) o = We(o.line, J(e, o.line));
                        else if ("charAfter" == r) o = j(o, 0, 1);
                        else if ("firstNonBlank" == r) o = P.moveToFirstNonWhiteSpaceCharacter(e, o);
                        else if ("startOfSelectedArea" == r) n.visualBlock ? (o = We(Math.min(i.head.line, i.anchor.line), Math.min(i.head.ch, i.anchor.ch)), s = Math.abs(i.head.line - i.anchor.line) + 1) : o = i.head.line < i.anchor.line ? i.head : We(i.anchor.line, 0);
                        else if ("endOfSelectedArea" == r) n.visualBlock ? (o = We(Math.min(i.head.line, i.anchor.line), Math.max(i.head.ch + 1, i.anchor.ch)), s = Math.abs(i.head.line - i.anchor.line) + 1) : o = i.head.line >= i.anchor.line ? j(i.head, 0, 1) : We(i.anchor.line, 0);
                        else if ("inplace" == r && n.visualMode) return;
                        e.setOption("keyMap", "vim-insert"), e.setOption("disableInput", !1), t && t.replace ? (e.toggleOverwrite(!0), e.setOption("keyMap", "vim-replace"), qe.signal(e, "vim-mode-change", {
                            mode: "replace"
                        })) : (e.setOption("keyMap", "vim-insert"), qe.signal(e, "vim-mode-change", {
                            mode: "insert"
                        })), F.macroModeState.isPlaying || (e.on("change", De), qe.on(e.getInputField(), "keydown", Fe)), n.visualMode && oe(e), te(e, o, s)
                    }
                },
                toggleVisualMode: function(e, t, n) {
                    var r, i = t.repeat,
                        o = e.getCursor();
                    n.visualMode ? n.visualLine ^ t.linewise || n.visualBlock ^ t.blockwise ? (n.visualLine = !!t.linewise, n.visualBlock = !!t.blockwise, qe.signal(e, "vim-mode-change", {
                        mode: "visual",
                        subMode: n.visualLine ? "linewise" : n.visualBlock ? "blockwise" : ""
                    }), re(e)) : oe(e) : (n.visualMode = !0, n.visualLine = !!t.linewise, n.visualBlock = !!t.blockwise, r = z(e, We(o.line, o.ch + i - 1), !0), n.sel = {
                        anchor: o,
                        head: r
                    }, qe.signal(e, "vim-mode-change", {
                        mode: "visual",
                        subMode: n.visualLine ? "linewise" : n.visualBlock ? "blockwise" : ""
                    }), re(e), pe(e, n, "<", Y(o, r)), pe(e, n, ">", X(o, r)))
                },
                reselectLastSelection: function(e, t, n) {
                    var r = n.lastSelection;
                    if (n.visualMode && ne(e, n), r) {
                        var i = r.anchorMark.find(),
                            o = r.headMark.find();
                        if (!i || !o) return;
                        n.sel = {
                            anchor: i,
                            head: o
                        }, n.visualMode = !0, n.visualLine = r.visualLine, n.visualBlock = r.visualBlock, re(e), pe(e, n, "<", Y(i, o)), pe(e, n, ">", X(i, o)), qe.signal(e, "vim-mode-change", {
                            mode: "visual",
                            subMode: n.visualLine ? "linewise" : n.visualBlock ? "blockwise" : ""
                        })
                    }
                },
                joinLines: function(e, t, n) {
                    var r, i;
                    if (n.visualMode) {
                        if (r = e.getCursor("anchor"), G(i = e.getCursor("head"), r)) {
                            var o = i;
                            i = r, r = o
                        }
                        i.ch = J(e, i.line) - 1
                    } else {
                        var s = Math.max(t.repeat, 2);
                        r = e.getCursor(), i = z(e, We(r.line + s - 1, 1 / 0))
                    }
                    for (var a = 0, l = r.line; l < i.line; l++) {
                        a = J(e, r.line), o = We(r.line + 1, J(e, r.line + 1));
                        var c = e.getRange(r, o);
                        c = c.replace(/\n\s*/g, " "), e.replaceRange(c, r, o)
                    }
                    var u = We(r.line, a);
                    n.visualMode && oe(e, !1), e.setCursor(u)
                },
                newLineAndEnterInsertMode: function(e, t, n) {
                    n.insertMode = !0;
                    var r = K(e.getCursor());
                    r.line !== e.firstLine() || t.after ? (r.line = t.after ? r.line : r.line - 1, r.ch = J(e, r.line), e.setCursor(r), (qe.commands.newlineAndIndentContinueComment || qe.commands.newlineAndIndent)(e)) : (e.replaceRange("\n", We(e.firstLine(), 0)), e.setCursor(e.firstLine(), 0)), this.enterInsertMode(e, {
                        repeat: t.repeat
                    }, n)
                },
                paste: function(r, e, t) {
                    var n, i, o, s, a, l = K(r.getCursor()),
                        c = F.registerController.getRegister(e.registerName);
                    if (v = c.toString()) {
                        if (e.matchIndent) {
                            var u = r.getOption("tabSize"),
                                h = function(e) {
                                    var t = e.split("\t").length - 1,
                                        n = e.split(" ").length - 1;
                                    return t * u + 1 * n
                                },
                                d = r.getLine(r.getCursor().line),
                                f = h(d.match(/^\s*/)[0]),
                                p = v.replace(/\n$/, ""),
                                m = v !== p,
                                g = h(v.match(/^\s*/)[0]),
                                v = p.replace(/^\s*/gm, function(e) {
                                    var t = f + (h(e) - g);
                                    if (t < 0) return "";
                                    if (r.getOption("indentWithTabs")) {
                                        var n = Math.floor(t / u);
                                        return Array(n + 1).join("\t")
                                    }
                                    return Array(t + 1).join(" ")
                                });
                            v += m ? "\n" : ""
                        }
                        1 < e.repeat && (v = Array(e.repeat + 1).join(v));
                        var y, b, x, w, k, _, C, S, T, M, A = c.linewise,
                            L = c.blockwise;
                        if (A) t.visualMode ? v = t.visualLine ? v.slice(0, -1) : "\n" + v.slice(0, v.length - 1) + "\n" : e.after ? (v = "\n" + v.slice(0, v.length - 1), l.ch = J(r, l.line)) : l.ch = 0;
                        else {
                            if (L) {
                                v = v.split("\n");
                                for (var E = 0; E < v.length; E++) v[E] = "" == v[E] ? " " : v[E]
                            }
                            l.ch += e.after ? 1 : 0
                        }
                        if (t.visualMode) {
                            var N;
                            t.lastPastedText = v;
                            var I = (x = r, k = (w = t).lastSelection, w.visualMode ? (_ = x.listSelections(), C = _[0], S = _[_.length - 1], T = G(C.anchor, C.head) ? C.anchor : C.head, M = G(S.anchor, S.head) ? S.head : S.anchor, [T, M]) : function() {
                                    var e = x.getCursor(),
                                        t = x.getCursor(),
                                        n = k.visualBlock;
                                    if (n) {
                                        var r = n.width,
                                            i = n.height;
                                        t = We(e.line + i, e.ch + r);
                                        for (var o = [], s = e.line; s < t.line; s++) {
                                            var a = We(s, e.ch),
                                                l = We(s, t.ch),
                                                c = {
                                                    anchor: a,
                                                    head: l
                                                };
                                            o.push(c)
                                        }
                                        x.setSelections(o)
                                    } else {
                                        var u = k.anchorMark.find(),
                                            h = k.headMark.find(),
                                            d = h.line - u.line,
                                            f = h.ch - u.ch;
                                        t = {
                                            line: t.line + d,
                                            ch: d ? t.ch : f + t.ch
                                        }, k.visualLine && (e = We(e.line, 0), t = We(t.line, J(x, t.line))), x.setSelection(e, t)
                                    }
                                    return [e, t]
                                }()),
                                O = I[0],
                                R = I[1],
                                D = r.getSelection(),
                                P = r.listSelections(),
                                $ = new Array(P.length).join("1").split("1");
                            t.lastSelection && (N = t.lastSelection.headMark.find()), F.registerController.unnamedRegister.setText(D), y = L ? (r.replaceSelections($), R = We(O.line + v.length - 1, O.ch), r.setCursor(O), ee(r, R), r.replaceSelections(v), O) : t.visualBlock ? (r.replaceSelections($), r.setCursor(O), r.replaceRange(v, O, O), O) : (r.replaceRange(v, O, R), r.posFromIndex(r.indexFromPos(O) + v.length - 1)), N && (t.lastSelection.headMark = r.setBookmark(N)), A && (y.ch = 0)
                        } else if (L) {
                            for (r.setCursor(l), E = 0; E < v.length; E++) {
                                var H = l.line + E;
                                H > r.lastLine() && r.replaceRange("\n", We(H, 0)), J(r, H) < l.ch && (n = r, i = H, o = l.ch, void 0, s = J(n, i), a = new Array(o - s + 1).join(" "), n.setCursor(We(i, s)), n.replaceRange(a, n.getCursor()))
                            }
                            r.setCursor(l), ee(r, We(l.line + v.length - 1, l.ch)), r.replaceSelections(v), y = l
                        } else r.replaceRange(v, l), y = A && e.after ? We(l.line + 1, se(r.getLine(l.line + 1))) : A && !e.after ? We(l.line, se(r.getLine(l.line))) : !A && e.after ? (b = r.indexFromPos(l), r.posFromIndex(b + v.length - 1)) : (b = r.indexFromPos(l), r.posFromIndex(b + v.length));
                        t.visualMode && oe(r, !1), r.setCursor(y)
                    }
                },
                undo: function(e, t) {
                    e.operation(function() {
                        U(e, qe.commands.undo, t.repeat)(), e.setCursor(e.getCursor("anchor"))
                    })
                },
                redo: function(e, t) {
                    U(e, qe.commands.redo, t.repeat)()
                },
                setRegister: function(e, t, n) {
                    n.inputState.registerName = t.selectedCharacter
                },
                setMark: function(e, t, n) {
                    pe(e, n, t.selectedCharacter, e.getCursor())
                },
                replace: function(e, t, n) {
                    var r, i, o = t.selectedCharacter,
                        s = e.getCursor(),
                        a = e.listSelections();
                    if (n.visualMode) s = e.getCursor("start"), i = e.getCursor("end");
                    else {
                        var l = e.getLine(s.line);
                        (r = s.ch + t.repeat) > l.length && (r = l.length), i = We(s.line, r)
                    }
                    if ("\n" == o) n.visualMode || e.replaceRange("", s, i), (qe.commands.newlineAndIndentContinueComment || qe.commands.newlineAndIndent)(e);
                    else {
                        var c = e.getRange(s, i);
                        if (c = c.replace(/[^\n]/g, o), n.visualBlock) {
                            var u = new Array(e.getOption("tabSize") + 1).join(" ");
                            c = (c = e.getSelection()).replace(/\t/g, u).replace(/[^\n]/g, o).split("\n"), e.replaceSelections(c)
                        } else e.replaceRange(c, s, i);
                        n.visualMode ? (s = G(a[0].anchor, a[0].head) ? a[0].anchor : a[0].head, e.setCursor(s), oe(e, !1)) : e.setCursor(j(i, 0, -1))
                    }
                },
                incrementNumberToken: function(e, t) {
                    for (var n, r, i, o, s, a = e.getCursor(), l = e.getLine(a.line), c = /-?\d+/g; null !== (n = c.exec(l)) && (s = n[0], i = (r = n.index) + s.length, !(a.ch < i)););
                    if ((t.backtrack || !(i <= a.ch)) && s) {
                        var u = t.increase ? 1 : -1,
                            h = parseInt(s) + u * t.repeat,
                            d = We(a.line, r),
                            f = We(a.line, i);
                        o = h.toString(), e.replaceRange(o, d, f), e.setCursor(We(a.line, r + o.length - 1))
                    }
                },
                repeatLastEdit: function(e, t, n) {
                    if (n.lastEditInputState) {
                        var r = t.repeat;
                        r && t.repeatIsExplicit ? n.lastEditInputState.repeatOverride = r : r = n.lastEditInputState.repeatOverride || r, Be(e, n, r, !1)
                    }
                },
                exitInsertMode: Ie
            };

            function z(e, t, n) {
                var r = Math.min(Math.max(e.firstLine(), t.line), e.lastLine()),
                    i = J(e, r) - 1;
                i = n ? i + 1 : i;
                var o = Math.min(Math.max(0, t.ch), i);
                return We(r, o)
            }

            function q(e) {
                var t = {};
                for (var n in e) e.hasOwnProperty(n) && (t[n] = e[n]);
                return t
            }

            function j(e, t, n) {
                return "object" == typeof t && (n = t.ch, t = t.line), We(e.line + t, e.ch + n)
            }

            function W(e, t) {
                if ("<character>" != t.slice(-11)) return e == t ? "full" : 0 == t.indexOf(e) && "partial";
                var n = t.length - 11,
                    r = e.slice(0, n),
                    i = t.slice(0, n);
                return r == i && e.length > n ? "full" : 0 == i.indexOf(r) && "partial"
            }

            function U(t, n, r) {
                return function() {
                    for (var e = 0; e < r; e++) n(t)
                }
            }

            function K(e) {
                return We(e.line, e.ch)
            }

            function V(e, t) {
                return e.ch == t.ch && e.line == t.line
            }

            function G(e, t) {
                return e.line < t.line || e.line == t.line && e.ch < t.ch
            }

            function Y(e, t) {
                return 2 < arguments.length && (t = Y.apply(void 0, Array.prototype.slice.call(arguments, 1))), G(e, t) ? e : t
            }

            function X(e, t) {
                return 2 < arguments.length && (t = X.apply(void 0, Array.prototype.slice.call(arguments, 1))), G(e, t) ? t : e
            }

            function Q(e, t, n) {
                var r = G(e, t),
                    i = G(t, n);
                return r && i
            }

            function J(e, t) {
                return e.getLine(t).length
            }

            function Z(e) {
                return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "")
            }

            function ee(e, t) {
                var n = [],
                    r = e.listSelections(),
                    i = K(e.clipPos(t)),
                    o = !V(t, i),
                    s = function(e, t, n) {
                        for (var r = 0; r < e.length; r++) {
                            var i = "head" != n && V(e[r].anchor, t),
                                o = "anchor" != n && V(e[r].head, t);
                            if (i || o) return r
                        }
                        return -1
                    }(r, e.getCursor("head")),
                    a = V(r[s].head, r[s].anchor),
                    l = r.length - 1,
                    c = s < l - s ? l : 0,
                    u = r[c].anchor,
                    h = Math.min(u.line, i.line),
                    d = Math.max(u.line, i.line),
                    f = u.ch,
                    p = i.ch,
                    m = r[c].head.ch - f,
                    g = p - f;
                0 < m && g <= 0 ? (f++, o || p--) : m < 0 && 0 <= g ? (f--, a || p++) : m < 0 && -1 == g && (f--, p++);
                for (var v = h; v <= d; v++) {
                    var y = {
                        anchor: new We(v, f),
                        head: new We(v, p)
                    };
                    n.push(y)
                }
                return s = i.line == d ? n.length - 1 : 0, e.setSelections(n), t.ch = p, u.ch = f, u
            }

            function te(e, t, n) {
                for (var r = [], i = 0; i < n; i++) {
                    var o = j(t, i, 0);
                    r.push({
                        anchor: o,
                        head: o
                    })
                }
                e.setSelections(r, 0)
            }

            function ne(e, t) {
                var n = t.sel.anchor,
                    r = t.sel.head;
                t.lastPastedText && (r = e.posFromIndex(e.indexFromPos(n) + t.lastPastedText.length), t.lastPastedText = null), t.lastSelection = {
                    anchorMark: e.setBookmark(n),
                    headMark: e.setBookmark(r),
                    anchor: K(n),
                    head: K(r),
                    visualMode: t.visualMode,
                    visualLine: t.visualLine,
                    visualBlock: t.visualBlock
                }
            }

            function re(e, t, n) {
                var r = e.state.vim,
                    i = ie(e, t = t || r.sel, n = n || r.visualLine ? "line" : r.visualBlock ? "block" : "char");
                e.setSelections(i.ranges, i.primary), $e(e)
            }

            function ie(e, t, n, r) {
                var i = K(t.head),
                    o = K(t.anchor);
                if ("char" == n) {
                    var s = r || G(t.head, t.anchor) ? 0 : 1,
                        a = G(t.head, t.anchor) ? 1 : 0;
                    return i = j(t.head, 0, s), {
                        ranges: [{
                            anchor: o = j(t.anchor, 0, a),
                            head: i
                        }],
                        primary: 0
                    }
                }
                if ("line" == n) {
                    if (G(t.head, t.anchor)) i.ch = 0, o.ch = J(e, o.line);
                    else {
                        o.ch = 0;
                        var l = e.lastLine();
                        i.line > l && (i.line = l), i.ch = J(e, i.line)
                    }
                    return {
                        ranges: [{
                            anchor: o,
                            head: i
                        }],
                        primary: 0
                    }
                }
                if ("block" == n) {
                    for (var c = Math.min(o.line, i.line), u = Math.min(o.ch, i.ch), h = Math.max(o.line, i.line), d = Math.max(o.ch, i.ch) + 1, f = h - c + 1, p = i.line == c ? 0 : f - 1, m = [], g = 0; g < f; g++) m.push({
                        anchor: We(c + g, u),
                        head: We(c + g, d)
                    });
                    return {
                        ranges: m,
                        primary: p
                    }
                }
            }

            function oe(e, t) {
                var n = e.state.vim;
                !1 !== t && e.setCursor(z(e, n.sel.head)), ne(e, n), n.visualMode = !1, n.visualLine = !1, n.visualBlock = !1, qe.signal(e, "vim-mode-change", {
                    mode: "normal"
                }), n.fakeCursor && n.fakeCursor.clear()
            }

            function se(e) {
                if (!e) return 0;
                var t = e.search(/\S/);
                return -1 == t ? e.length : t
            }

            function ae(e, t, n, r, i) {
                for (var o, s, a = (s = (o = e).getCursor("head"), 1 == o.getSelection().length && (s = Y(s, o.getCursor("anchor"))), s), l = e.getLine(a.line), c = a.ch, u = i ? g[0] : v[0]; !u(l.charAt(c));)
                    if (++c >= l.length) return null;
                r ? u = v[0] : (u = g[0])(l.charAt(c)) || (u = g[1]);
                for (var h = c, d = c; u(l.charAt(h)) && h < l.length;) h++;
                for (; u(l.charAt(d)) && 0 <= d;) d--;
                if (d++, t) {
                    for (var f = h;
                        /\s/.test(l.charAt(h)) && h < l.length;) h++;
                    if (f == h) {
                        for (var p = d;
                            /\s/.test(l.charAt(d - 1)) && 0 < d;) d--;
                        d || (d = p)
                    }
                }
                return {
                    start: We(a.line, d),
                    end: We(a.line, h)
                }
            }

            function le(e, t, n) {
                V(t, n) || F.jumpList.add(e, t, n)
            }

            function ce(e, t) {
                F.lastChararacterSearch.increment = e, F.lastChararacterSearch.forward = t.forward, F.lastChararacterSearch.selectedCharacter = t.selectedCharacter
            }
            var ue = {
                    "(": "bracket",
                    ")": "bracket",
                    "{": "bracket",
                    "}": "bracket",
                    "[": "section",
                    "]": "section",
                    "*": "comment",
                    "/": "comment",
                    m: "method",
                    M: "method",
                    "#": "preprocess"
                },
                he = {
                    bracket: {
                        isComplete: function(e) {
                            if (e.nextCh === e.symb) {
                                if (e.depth++, 1 <= e.depth) return !0
                            } else e.nextCh === e.reverseSymb && e.depth--;
                            return !1
                        }
                    },
                    section: {
                        init: function(e) {
                            e.curMoveThrough = !0, e.symb = (e.forward ? "]" : "[") === e.symb ? "{" : "}"
                        },
                        isComplete: function(e) {
                            return 0 === e.index && e.nextCh === e.symb
                        }
                    },
                    comment: {
                        isComplete: function(e) {
                            var t = "*" === e.lastCh && "/" === e.nextCh;
                            return e.lastCh = e.nextCh, t
                        }
                    },
                    method: {
                        init: function(e) {
                            e.symb = "m" === e.symb ? "{" : "}", e.reverseSymb = "{" === e.symb ? "}" : "{"
                        },
                        isComplete: function(e) {
                            return e.nextCh === e.symb
                        }
                    },
                    preprocess: {
                        init: function(e) {
                            e.index = 0
                        },
                        isComplete: function(e) {
                            if ("#" === e.nextCh) {
                                var t = e.lineText.match(/#(\w+)/)[1];
                                if ("endif" === t) {
                                    if (e.forward && 0 === e.depth) return !0;
                                    e.depth++
                                } else if ("if" === t) {
                                    if (!e.forward && 0 === e.depth) return !0;
                                    e.depth--
                                }
                                if ("else" === t && 0 === e.depth) return !0
                            }
                            return !1
                        }
                    }
                };

            function de(e, t, n, r, i) {
                var o = t.line,
                    s = t.ch,
                    a = e.getLine(o),
                    l = n ? 1 : -1,
                    c = r ? v : g;
                if (i && "" == a) {
                    if (o += l, a = e.getLine(o), !y(e, o)) return null;
                    s = n ? 0 : a.length
                }
                for (;;) {
                    if (i && "" == a) return {
                        from: 0,
                        to: 0,
                        line: o
                    };
                    for (var u = 0 < l ? a.length : -1, h = u, d = u; s != u;) {
                        for (var f = !1, p = 0; p < c.length && !f; ++p)
                            if (c[p](a.charAt(s))) {
                                for (h = s; s != u && c[p](a.charAt(s));) s += l;
                                if (f = h != (d = s), h == t.ch && o == t.line && d == h + l) continue;
                                return {
                                    from: Math.min(h, d + 1),
                                    to: Math.max(h, d),
                                    line: o
                                }
                            } f || (s += l)
                    }
                    if (!y(e, o += l)) return null;
                    a = e.getLine(o), s = 0 < l ? 0 : a.length
                }
                throw new Error("The impossible happened.")
            }

            function fe(e, t, n, r) {
                for (var i, o = e.getCursor(), s = o.ch, a = 0; a < t; a++) {
                    if (-1 == (l = s, c = e.getLine(o.line), u = r, h = !0, d = void 0, n ? -1 == (d = c.indexOf(u, l + 1)) || h || (d -= 1) : -1 == (d = c.lastIndexOf(u, l - 1)) || h || (d += 1), i = d)) return null;
                    s = i
                }
                var l, c, u, h, d;
                return We(e.getCursor().line, i)
            }

            function pe(e, t, n, r) {
                b(n, u) && (t.marks[n] && t.marks[n].clear(), t.marks[n] = e.setBookmark(r))
            }

            function me(t, e, n, r, i) {
                var o, s = e.line,
                    a = t.firstLine(),
                    l = t.lastLine(),
                    c = s;

                function u(e) {
                    return !t.getLine(e)
                }

                function h(e, t, n) {
                    return n ? u(e) != u(e + t) : !u(e) && u(e + t)
                }
                if (r) {
                    for (; a <= c && c <= l && 0 < n;) h(c, r) && n--, c += r;
                    return new We(c, 0)
                }
                var d = t.state.vim;
                if (d.visualLine && h(s, 1, !0)) {
                    var f = d.sel.anchor;
                    h(f.line, -1, !0) && (i && f.line == s || (s += 1))
                }
                var p = u(s);
                for (c = s; c <= l && n; c++) h(c, 1, !0) && (i && u(c) == p || n--);
                for (o = new We(c, 0), l < c && !p ? p = !0 : i = !1, c = s; a < c && (i && u(c) != p && c != s || !h(c, -1, !0)); c--);
                return {
                    start: new We(c, 0),
                    end: o
                }
            }

            function ge() {}

            function ve(e) {
                var t = e.state.vim;
                return t.searchState_ || (t.searchState_ = new ge)
            }

            function ye(e) {
                var t = be(e) || [];
                if (!t.length) return [];
                var n = [];
                if (0 === t[0]) {
                    for (var r = 0; r < t.length; r++) "number" == typeof t[r] && n.push(e.substring(t[r] + 1, t[r + 1]));
                    return n
                }
            }

            function be(e) {
                for (var t = !1, n = [], r = 0; r < e.length; r++) {
                    var i = e.charAt(r);
                    t || "/" != i || n.push(r), t = !t && "\\" == i
                }
                return n
            }

            function xe(e, t) {
                e.openNotification ? e.openNotification('<span style="color: red">' + t + "</span>", {
                    bottom: !0,
                    duration: 5e3
                }) : alert(t)
            }
            x("pcre", !0, "boolean"), ge.prototype = {
                getQuery: function() {
                    return F.query
                },
                setQuery: function(e) {
                    F.query = e
                },
                getOverlay: function() {
                    return this.searchOverlay
                },
                setOverlay: function(e) {
                    this.searchOverlay = e
                },
                isReversed: function() {
                    return F.isReversed
                },
                setReversed: function(e) {
                    F.isReversed = e
                },
                getScrollbarAnnotate: function() {
                    return this.annotate
                },
                setScrollbarAnnotate: function(e) {
                    this.annotate = e
                }
            };
            var we = "(Javascript regexp)";

            function ke(e, t) {
                var n, r, i, o, s, a, l, c, u = (t.prefix || "") + " " + (t.desc || ""),
                    h = (n = t.prefix, r = t.desc, i = "", n && (i += '<span style="font-family: monospace">' + n + "</span>"), i += '<input type="text"/> <span style="color: #888">', r && (i += '<span style="color: #888">', i += r, i += "</span>"), i);
                o = e, s = h, a = u, l = t.onClose, c = t, o.openDialog ? o.openDialog(s, l, {
                    bottom: !0,
                    value: c.value,
                    onKeyDown: c.onKeyDown,
                    onKeyUp: c.onKeyUp,
                    selectValueOnOpen: !1
                }) : l(prompt(a, ""))
            }

            function _e(e, t, n, r) {
                if (t) {
                    var i = ve(e),
                        o = function(e, t, n) {
                            if (F.registerController.getRegister("/").setText(e), e instanceof RegExp) return e;
                            var r, i, o = be(e);
                            return o.length ? (r = e.substring(0, o[0]), i = -1 != e.substring(o[0]).indexOf("i")) : r = e, r ? (k("pcre") || (r = function(e) {
                                for (var t = !1, n = [], r = -1; r < e.length; r++) {
                                    var i = e.charAt(r) || "",
                                        o = e.charAt(r + 1) || "",
                                        s = o && -1 != "|(){".indexOf(o);
                                    t ? ("\\" === i && s || n.push(i), t = !1) : "\\" === i ? (t = !0, o && -1 != "}".indexOf(o) && (s = !0), s && "\\" !== o || n.push(i)) : (n.push(i), s && "\\" !== o && n.push("\\"))
                                }
                                return n.join("")
                            }(r)), n && (t = /^[^A-Z]*$/.test(r)), new RegExp(r, t || i ? "i" : void 0)) : null
                        }(t, !!n, !!r);
                    if (o) return Ce(e, o),
                        function(e, t) {
                            if (e instanceof RegExp && t instanceof RegExp) {
                                for (var n = ["global", "multiline", "ignoreCase", "source"], r = 0; r < n.length; r++) {
                                    var i = n[r];
                                    if (e[i] !== t[i]) return !1
                                }
                                return !0
                            }
                            return !1
                        }(o, i.getQuery()) || i.setQuery(o), o
                }
            }

            function Ce(e, t) {
                var n = ve(e),
                    r = n.getOverlay();
                r && t == r.query || (r && e.removeOverlay(r), r = function(n) {
                    if ("^" == n.source.charAt(0)) var r = !0;
                    return {
                        token: function(e) {
                            if (!r || e.sol()) {
                                var t = e.match(n, !1);
                                if (t) return 0 == t[0].length ? (e.next(), "searching") : e.sol() || (e.backUp(1), n.exec(e.next() + t[0])) ? (e.match(n), "searching") : (e.next(), null);
                                for (; !e.eol() && (e.next(), !e.match(n, !1)););
                            } else e.skipToEnd()
                        },
                        query: n
                    }
                }(t), e.addOverlay(r), e.showMatchesOnScrollbar && (n.getScrollbarAnnotate() && n.getScrollbarAnnotate().clear(), n.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))), n.setOverlay(r))
            }

            function Se(i, o, s, a) {
                return void 0 === a && (a = 1), i.operation(function() {
                    for (var e = i.getCursor(), t = i.getSearchCursor(s, e), n = 0; n < a; n++) {
                        var r = t.find(o);
                        if (0 == n && r && V(t.from(), e) && (r = t.find(o)), !r && !(t = i.getSearchCursor(s, o ? We(i.lastLine()) : We(i.firstLine(), 0))).find(o)) return
                    }
                    return t.from()
                })
            }

            function Te(e) {
                var t = ve(e);
                e.removeOverlay(ve(e).getOverlay()), t.setOverlay(null), t.getScrollbarAnnotate() && (t.getScrollbarAnnotate().clear(), t.setScrollbarAnnotate(null))
            }

            function Me(e) {
                var t = e.getScrollInfo(),
                    n = e.coordsChar({
                        left: 0,
                        top: 6 + t.top
                    }, "local"),
                    r = t.clientHeight - 10 + t.top,
                    i = e.coordsChar({
                        left: 0,
                        top: r
                    }, "local");
                return {
                    top: n.line,
                    bottom: i.line
                }
            }
            var Ae = [{
                    name: "map"
                }, {
                    name: "imap",
                    shortName: "im"
                }, {
                    name: "nmap",
                    shortName: "nm"
                }, {
                    name: "vmap",
                    shortName: "vm"
                }, {
                    name: "unmap"
                }, {
                    name: "write",
                    shortName: "w"
                }, {
                    name: "undo",
                    shortName: "u"
                }, {
                    name: "redo",
                    shortName: "red"
                }, {
                    name: "set",
                    shortName: "set"
                }, {
                    name: "sort",
                    shortName: "sor"
                }, {
                    name: "substitute",
                    shortName: "s",
                    possiblyAsync: !0
                }, {
                    name: "nohlsearch",
                    shortName: "noh"
                }, {
                    name: "delmarks",
                    shortName: "delm"
                }, {
                    name: "registers",
                    shortName: "reg",
                    excludeFromCommandHistory: !0
                }, {
                    name: "global",
                    shortName: "g"
                }],
                Le = function() {
                    this.buildCommandMap_()
                };
            Le.prototype = {
                processCommand: function(e, t, n) {
                    var r = this;
                    e.operation(function() {
                        e.curOp.isVimOp = !0, r._processCommand(e, t, n)
                    })
                },
                _processCommand: function(t, e, n) {
                    var r = t.state.vim,
                        i = F.registerController.getRegister(":"),
                        o = i.toString();
                    r.visualMode && oe(t);
                    var s = new qe.StringStream(e);
                    i.setText(e);
                    var a, l, c = n || {};
                    c.input = e;
                    try {
                        this.parseInput_(t, s, c)
                    } catch (e) {
                        throw xe(t, e), e
                    }
                    if (c.commandName) {
                        if (a = this.matchCommand_(c.commandName)) {
                            if (l = a.name, a.excludeFromCommandHistory && i.setText(o), this.parseCommandArgs_(s, c, a), "exToKey" == a.type) {
                                for (var u = 0; u < a.toKeys.length; u++) qe.Vim.handleKey(t, a.toKeys[u], "mapping");
                                return
                            }
                            if ("exToEx" == a.type) return void this.processCommand(t, a.toInput)
                        }
                    } else void 0 !== c.line && (l = "move");
                    if (l) try {
                        Ee[l](t, c), a && a.possiblyAsync || !c.callback || c.callback()
                    } catch (e) {
                        throw xe(t, e), e
                    } else xe(t, 'Not an editor command ":' + e + '"')
                },
                parseInput_: function(e, t, n) {
                    t.eatWhile(":"), t.eat("%") ? (n.line = e.firstLine(), n.lineEnd = e.lastLine()) : (n.line = this.parseLineSpec_(e, t), void 0 !== n.line && t.eat(",") && (n.lineEnd = this.parseLineSpec_(e, t)));
                    var r = t.match(/^(\w+)/);
                    return n.commandName = r ? r[1] : t.match(/.*/)[0], n
                },
                parseLineSpec_: function(e, t) {
                    var n = t.match(/^(\d+)/);
                    if (n) return parseInt(n[1], 10) - 1;
                    switch (t.next()) {
                        case ".":
                            return e.getCursor().line;
                        case "$":
                            return e.lastLine();
                        case "'":
                            var r = e.state.vim.marks[t.next()];
                            if (r && r.find()) return r.find().line;
                            throw new Error("Mark not set");
                        default:
                            return void t.backUp(1)
                    }
                },
                parseCommandArgs_: function(e, t, n) {
                    if (!e.eol()) {
                        t.argString = e.match(/.*/)[0];
                        var r = n.argDelimiter || /\s+/,
                            i = Z(t.argString).split(r);
                        i.length && i[0] && (t.args = i)
                    }
                },
                matchCommand_: function(e) {
                    for (var t = e.length; 0 < t; t--) {
                        var n = e.substring(0, t);
                        if (this.commandMap_[n]) {
                            var r = this.commandMap_[n];
                            if (0 === r.name.indexOf(e)) return r
                        }
                    }
                    return null
                },
                buildCommandMap_: function() {
                    this.commandMap_ = {};
                    for (var e = 0; e < Ae.length; e++) {
                        var t = Ae[e],
                            n = t.shortName || t.name;
                        this.commandMap_[n] = t
                    }
                },
                map: function(e, t, n) {
                    if (":" != e && ":" == e.charAt(0)) {
                        if (n) throw Error("Mode not supported for ex mappings");
                        var r = e.substring(1);
                        ":" != t && ":" == t.charAt(0) ? this.commandMap_[r] = {
                            name: r,
                            type: "exToEx",
                            toInput: t.substring(1),
                            user: !0
                        } : this.commandMap_[r] = {
                            name: r,
                            type: "exToKey",
                            toKeys: t,
                            user: !0
                        }
                    } else if (":" != t && ":" == t.charAt(0)) {
                        var i = {
                            keys: e,
                            type: "keyToEx",
                            exArgs: {
                                input: t.substring(1)
                            },
                            user: !0
                        };
                        n && (i.context = n), je.unshift(i)
                    } else i = {
                        keys: e,
                        type: "keyToKey",
                        toKeys: t,
                        user: !0
                    }, n && (i.context = n), je.unshift(i)
                },
                unmap: function(e, t) {
                    if (":" != e && ":" == e.charAt(0)) {
                        if (t) throw Error("Mode not supported for ex mappings");
                        var n = e.substring(1);
                        if (this.commandMap_[n] && this.commandMap_[n].user) return void delete this.commandMap_[n]
                    } else
                        for (var r = e, i = 0; i < je.length; i++)
                            if (r == je[i].keys && je[i].context === t && je[i].user) return void je.splice(i, 1);
                    throw Error("No such mapping.")
                }
            };
            var Ee = {
                    map: function(e, t, n) {
                        var r = t.args;
                        !r || r.length < 2 ? e && xe(e, "Invalid mapping: " + t.input) : Ne.map(r[0], r[1], n)
                    },
                    imap: function(e, t) {
                        this.map(e, t, "insert")
                    },
                    nmap: function(e, t) {
                        this.map(e, t, "normal")
                    },
                    vmap: function(e, t) {
                        this.map(e, t, "visual")
                    },
                    unmap: function(e, t, n) {
                        var r = t.args;
                        !r || r.length < 1 ? e && xe(e, "No such mapping: " + t.input) : Ne.unmap(r[0], n)
                    },
                    move: function(e, t) {
                        D.processCommand(e, e.state.vim, {
                            type: "motion",
                            motion: "moveToLineOrEdgeOfDocument",
                            motionArgs: {
                                forward: !1,
                                explicitRepeat: !0,
                                linewise: !0
                            },
                            repeatOverride: t.line + 1
                        })
                    },
                    set: function(e, t) {
                        var n = t.args;
                        if (!n || n.length < 1) e && xe(e, "Invalid mapping: " + t.input);
                        else {
                            var r = n[0].split("="),
                                i = r[0],
                                o = r[1],
                                s = !1;
                            if ("?" == i.charAt(i.length - 1)) {
                                if (o) throw Error("Trailing characters: " + t.argString);
                                i = i.substring(0, i.length - 1), s = !0
                            }
                            void 0 === o && "no" == i.substring(0, 2) && (i = i.substring(2), o = !1);
                            var a = p[i] && "boolean" == p[i].type;
                            if (a && null == o && (o = !0), !a && !o || s) {
                                var l = k(i);
                                xe(e, !0 === l || !1 === l ? " " + (l ? "" : "no") + i : "  " + i + "=" + l)
                            } else w(i, o)
                        }
                    },
                    registers: function(e, t) {
                        var n = t.args,
                            r = F.registerController.registers,
                            i = "----------Registers----------<br><br>";
                        if (n) {
                            n = n.join("");
                            for (var o = 0; o < n.length; o++) s = n.charAt(o), F.registerController.isValidRegister(s) && (i += '"' + s + "    " + (r[s] || new E).toString() + "<br>")
                        } else
                            for (var s in r) {
                                var a = r[s].toString();
                                a.length && (i += '"' + s + "    " + a + "<br>")
                            }
                        xe(e, i)
                    },
                    sort: function(e, o) {
                        var s, a, l, c, t = function() {
                            if (o.argString) {
                                var e = new qe.StringStream(o.argString);
                                if (e.eat("!") && (s = !0), e.eol()) return;
                                if (!e.eatSpace()) return "Invalid arguments";
                                var t = e.match(/[a-z]+/);
                                if (t) {
                                    t = t[0], a = -1 != t.indexOf("i"), l = -1 != t.indexOf("u");
                                    var n = -1 != t.indexOf("d") && 1,
                                        r = -1 != t.indexOf("x") && 1,
                                        i = -1 != t.indexOf("o") && 1;
                                    if (1 < n + r + i) return "Invalid arguments";
                                    c = (n ? "decimal" : r && "hex") || i && "octal"
                                }
                                e.eatSpace() && e.match(/\/.*\//)
                            }
                        }();
                        if (t) xe(e, t + ": " + o.argString);
                        else {
                            var n = o.line || e.firstLine(),
                                r = o.lineEnd || o.line || e.lastLine();
                            if (n != r) {
                                var i = We(n, 0),
                                    u = We(r, J(e, r)),
                                    h = e.getRange(i, u).split("\n"),
                                    d = "decimal" == c ? /(-?)([\d]+)/ : "hex" == c ? /(-?)(?:0x)?([0-9a-f]+)/i : "octal" == c ? /([0-7]+)/ : null,
                                    f = "decimal" == c ? 10 : "hex" == c ? 16 : "octal" == c ? 8 : null,
                                    p = [],
                                    m = [];
                                if (c)
                                    for (var g = 0; g < h.length; g++) d.exec(h[g]) ? p.push(h[g]) : m.push(h[g]);
                                else m = h;
                                if (p.sort(b), m.sort(b), h = s ? p.concat(m) : m.concat(p), l) {
                                    var v, y = h;
                                    for (h = [], g = 0; g < y.length; g++) y[g] != v && h.push(y[g]), v = y[g]
                                }
                                e.replaceRange(h.join("\n"), i, u)
                            }
                        }

                        function b(e, t) {
                            var n;
                            s && (n = e, e = t, t = n), a && (e = e.toLowerCase(), t = t.toLowerCase());
                            var r = c && d.exec(e),
                                i = c && d.exec(t);
                            return r ? (r = parseInt((r[1] + r[2]).toLowerCase(), f)) - (i = parseInt((i[1] + i[2]).toLowerCase(), f)) : e < t ? -1 : 1
                        }
                    },
                    global: function(t, e) {
                        var n = e.argString;
                        if (n) {
                            var r, i = void 0 !== e.line ? e.line : t.firstLine(),
                                o = e.lineEnd || e.line || t.lastLine(),
                                s = ye(n),
                                a = n;
                            if (s.length && (a = s[0], r = s.slice(1, s.length).join("/")), a) try {
                                _e(t, a, !0, !0)
                            } catch (e) {
                                return void xe(t, "Invalid regex: " + a)
                            }
                            for (var l = ve(t).getQuery(), c = [], u = "", h = i; h <= o; h++) l.test(t.getLine(h)) && (c.push(h + 1), u += t.getLine(h) + "<br>");
                            if (r) {
                                var d = 0,
                                    f = function() {
                                        if (d < c.length) {
                                            var e = c[d] + r;
                                            Ne.processCommand(t, e, {
                                                callback: f
                                            })
                                        }
                                        d++
                                    };
                                f()
                            } else xe(t, u)
                        } else xe(t, "Regular Expression missing from global")
                    },
                    substitute: function(t, e) {
                        if (!t.getSearchCursor) throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");
                        var n, r, i, o, s = e.argString,
                            a = s ? ye(s) : [],
                            l = "",
                            c = !1,
                            u = !1;
                        if (a.length) n = a[0], void 0 !== (l = a[1]) && (l = k("pcre") ? function(e) {
                            for (var t = new qe.StringStream(e), n = []; !t.eol();) {
                                for (; t.peek() && "\\" != t.peek();) n.push(t.next());
                                t.match("\\/", !0) ? n.push("/") : t.match("\\\\", !0) ? n.push("\\") : n.push(t.next())
                            }
                            return n.join("")
                        }(l) : function(e) {
                            for (var t, n = !1, r = [], i = -1; i < e.length; i++) {
                                var o = e.charAt(i) || "",
                                    s = e.charAt(i + 1) || "";
                                n ? (r.push(o), n = !1) : "\\" === o ? (n = !0, t = s, m.test(t) || "$" === s ? r.push("$") : "/" !== s && "\\" !== s && r.push("\\")) : ("$" === o && r.push("$"), r.push(o), "/" === s && r.push("\\"))
                            }
                            return r.join("")
                        }(l), F.lastSubstituteReplacePart = l), r = a[2] ? a[2].split(" ") : [];
                        else if (s && s.length) return void xe(t, "Substitutions should be of the form :s/pattern/replace/");
                        if (r && (i = r[0], o = parseInt(r[1]), i && (-1 != i.indexOf("c") && (c = !0, i.replace("c", "")), -1 != i.indexOf("g") && (u = !0, i.replace("g", "")), n = n + "/" + i)), n) try {
                            _e(t, n, !0, !0)
                        } catch (e) {
                            return void xe(t, "Invalid regex: " + n)
                        }
                        if (void 0 !== (l = l || F.lastSubstituteReplacePart)) {
                            var h = ve(t).getQuery(),
                                d = void 0 !== e.line ? e.line : t.getCursor().line,
                                f = e.lineEnd || d;
                            o && (f = (d = f) + o - 1);
                            var p = z(t, We(d, 0));
                            ! function(i, e, r, o, s, a, n, l, c) {
                                var u = !(i.state.vim.exMode = !0),
                                    h = a.from();

                                function d() {
                                    i.operation(function() {
                                        for (; !u;) f(), p();
                                        m()
                                    })
                                }

                                function f() {
                                    var e = i.getRange(a.from(), a.to()),
                                        t = e.replace(n, l);
                                    a.replace(t)
                                }

                                function p() {
                                    for (var e, t, n; a.findNext() && (e = a.from(), t = o, n = s, "number" != typeof e && (e = e.line), t instanceof Array ? b(e, t) : n ? t <= e && e <= n : e == t);)
                                        if (r || !h || a.from().line != h.line) return i.scrollIntoView(a.from(), 30), i.setSelection(a.from(), a.to()), h = a.from(), void(u = !1);
                                    u = !0
                                }

                                function m(e) {
                                    if (e && e(), i.focus(), h) {
                                        i.setCursor(h);
                                        var t = i.state.vim;
                                        t.exMode = !1, t.lastHPos = t.lastHSPos = h.ch
                                    }
                                    c && c()
                                }
                                p(), u ? xe(i, "No matches for " + n.source) : e ? ke(i, {
                                    prefix: "replace with <strong>" + l + "</strong> (y/n/a/q/l)",
                                    onKeyDown: function(e, t, n) {
                                        switch (qe.e_stop(e), qe.keyName(e)) {
                                            case "Y":
                                                f(), p();
                                                break;
                                            case "N":
                                                p();
                                                break;
                                            case "A":
                                                var r = c;
                                                c = void 0, i.operation(d), c = r;
                                                break;
                                            case "L":
                                                f();
                                            case "Q":
                                            case "Esc":
                                            case "Ctrl-C":
                                            case "Ctrl-[":
                                                m(n)
                                        }
                                        return u && m(n), !0
                                    }
                                }) : (d(), c && c())
                            }(t, c, u, d, f, t.getSearchCursor(h, p), h, l, e.callback)
                        } else xe(t, "No previous substitute regular expression")
                    },
                    redo: qe.commands.redo,
                    undo: qe.commands.undo,
                    write: function(e) {
                        qe.commands.save ? qe.commands.save(e) : e.save()
                    },
                    nohlsearch: function(e) {
                        Te(e)
                    },
                    delmarks: function(e, t) {
                        if (t.argString && Z(t.argString))
                            for (var n = e.state.vim, r = new qe.StringStream(Z(t.argString)); !r.eol();) {
                                r.eatSpace();
                                var i = r.pos;
                                if (!r.match(/[a-zA-Z]/, !1)) return void xe(e, "Invalid argument: " + t.argString.substring(i));
                                var o = r.next();
                                if (r.match("-", !0)) {
                                    if (!r.match(/[a-zA-Z]/, !1)) return void xe(e, "Invalid argument: " + t.argString.substring(i));
                                    var s = o,
                                        a = r.next();
                                    if (!(d(s) && d(a) || f(s) && f(a))) return void xe(e, "Invalid argument: " + s + "-");
                                    var l = s.charCodeAt(0),
                                        c = a.charCodeAt(0);
                                    if (c <= l) return void xe(e, "Invalid argument: " + t.argString.substring(i));
                                    for (var u = 0; u <= c - l; u++) {
                                        var h = String.fromCharCode(l + u);
                                        delete n.marks[h]
                                    }
                                } else delete n.marks[o]
                            } else xe(e, "Argument required")
                    }
                },
                Ne = new Le;

            function Ie(e) {
                var t = e.state.vim,
                    n = F.macroModeState,
                    r = F.registerController.getRegister("."),
                    i = n.isPlaying,
                    o = n.lastInsertModeChanges,
                    s = [];
                if (!i) {
                    for (var a = o.inVisualBlock ? t.lastSelection.visualBlock.height : 1, l = o.changes, c = (s = [], 0); c < l.length;) s.push(l[c]), l[c] instanceof He ? c++ : c += a;
                    o.changes = s, e.off("change", De), qe.off(e.getInputField(), "keydown", Fe)
                }!i && 1 < t.insertModeRepeat && (Be(e, t, t.insertModeRepeat - 1, !0), t.lastEditInputState.repeatOverride = t.insertModeRepeat), delete t.insertModeRepeat, t.insertMode = !1, e.setCursor(e.getCursor().line, e.getCursor().ch - 1), e.setOption("keyMap", "vim"), e.setOption("disableInput", !0), e.toggleOverwrite(!1), r.setText(o.changes.join("")), qe.signal(e, "vim-mode-change", {
                    mode: "normal"
                }), n.isRecording && function(e) {
                    if (!e.isPlaying) {
                        var t = e.latestRegister,
                            n = F.registerController.getRegister(t);
                        n && n.pushInsertModeChanges(e.lastInsertModeChanges)
                    }
                }(n)
            }

            function Oe(e) {
                je.push(e)
            }

            function Re(e, t, n, r) {
                var i = F.registerController.getRegister(r),
                    o = i.keyBuffer,
                    s = 0;
                n.isPlaying = !0, n.replaySearchQueries = i.searchQueries.slice(0);
                for (var a = 0; a < o.length; a++)
                    for (var l, c, u = o[a]; u;)
                        if (c = (l = /<\w+-.+?>|<\w+>|./.exec(u))[0], u = u.substring(l.index + c.length), qe.Vim.handleKey(e, c, "macro"), t.insertMode) {
                            var h = i.insertModeChanges[s++].changes;
                            ze(e, F.macroModeState.lastInsertModeChanges.changes = h, 1), Ie(e)
                        } n.isPlaying = !1
            }

            function De(e, t) {
                var n = F.macroModeState,
                    r = n.lastInsertModeChanges;
                if (!n.isPlaying)
                    for (; t;) {
                        if (r.expectCursorActivityForChange = !0, "+input" == t.origin || "paste" == t.origin || void 0 === t.origin) {
                            var i = t.text.join("\n");
                            r.changes.push(i)
                        }
                        t = t.next
                    }
            }

            function Pe(e) {
                var t = e.state.vim;
                if (t.insertMode) {
                    var n = F.macroModeState;
                    if (n.isPlaying) return;
                    var r = n.lastInsertModeChanges;
                    r.expectCursorActivityForChange ? r.expectCursorActivityForChange = !1 : r.changes = []
                } else e.curOp.isVimOp || function(e, t) {
                    var n = e.getCursor("anchor"),
                        r = e.getCursor("head");
                    if (t.visualMode && !e.somethingSelected() ? oe(e, !1) : t.visualMode || t.insertMode || !e.somethingSelected() || (t.visualMode = !0, t.visualLine = !1, qe.signal(e, "vim-mode-change", {
                            mode: "visual"
                        })), t.visualMode) {
                        var i = G(r, n) ? 0 : -1,
                            o = G(r, n) ? -1 : 0;
                        r = j(r, 0, i), n = j(n, 0, o), t.sel = {
                            anchor: n,
                            head: r
                        }, pe(e, t, "<", Y(r, n)), pe(e, t, ">", X(r, n))
                    } else t.insertMode || (t.lastHPos = e.getCursor().ch)
                }(e, t);
                t.visualMode && $e(e)
            }

            function $e(e) {
                var t = e.state.vim,
                    n = K(t.sel.head),
                    r = j(n, 0, 1);
                t.fakeCursor && t.fakeCursor.clear(), t.fakeCursor = e.markText(n, r, {
                    className: "cm-animate-fat-cursor"
                })
            }

            function He(e) {
                this.keyName = e
            }

            function Fe(e) {
                var t = F.macroModeState.lastInsertModeChanges,
                    n = qe.keyName(e);
                n && (-1 == n.indexOf("Delete") && -1 == n.indexOf("Backspace") || qe.lookupKey(n, "vim-insert", function() {
                    return t.changes.push(new He(n)), !0
                }))
            }

            function Be(n, r, e, t) {
                var i = F.macroModeState;
                i.isPlaying = !0;
                var o = !!r.lastEditActionCommand,
                    s = r.inputState;

                function a() {
                    o ? D.processAction(n, r, r.lastEditActionCommand) : D.evalInput(n, r)
                }

                function l(e) {
                    if (0 < i.lastInsertModeChanges.changes.length) {
                        e = r.lastEditActionCommand ? e : 1;
                        var t = i.lastInsertModeChanges;
                        ze(n, t.changes, e)
                    }
                }
                if (r.inputState = r.lastEditInputState, o && r.lastEditActionCommand.interlaceInsertRepeat)
                    for (var c = 0; c < e; c++) a(), l(1);
                else t || a(), l(e);
                r.inputState = s, r.insertMode && !t && Ie(n), i.isPlaying = !1
            }

            function ze(t, e, n) {
                function r(e) {
                    return "string" == typeof e ? qe.commands[e](t) : e(t), !0
                }
                var i, o, s = t.getCursor("head"),
                    a = F.macroModeState.lastInsertModeChanges.inVisualBlock;
                if (a) {
                    var l = t.state.vim.lastSelection,
                        c = (i = l.anchor, {
                            line: (o = l.head).line - i.line,
                            ch: o.line - i.line
                        });
                    te(t, s, c.line + 1), n = t.listSelections().length, t.setCursor(s)
                }
                for (var u = 0; u < n; u++) {
                    a && t.setCursor(j(s, u, 0));
                    for (var h = 0; h < e.length; h++) {
                        var d = e[h];
                        if (d instanceof He) qe.lookupKey(d.keyName, "vim-insert", r);
                        else {
                            var f = t.getCursor();
                            t.replaceRange(d, f, f)
                        }
                    }
                }
                a && t.setCursor(j(s, 0, 1))
            }
            return qe.keyMap.vim = {
                attach: r,
                detach: e,
                call: t
            }, x("insertModeEscKeysTimeout", 200, "number"), qe.keyMap["vim-insert"] = {
                "Ctrl-N": "autocomplete",
                "Ctrl-P": "autocomplete",
                Enter: function(e) {
                    (qe.commands.newlineAndIndentContinueComment || qe.commands.newlineAndIndent)(e)
                },
                fallthrough: ["default"],
                attach: r,
                detach: e,
                call: t
            }, qe.keyMap["vim-replace"] = {
                Backspace: "goCharLeft",
                fallthrough: ["vim-insert"],
                attach: r,
                detach: e,
                call: t
            }, M(), A
        }()
    }),
    function(e, t, n) {
        "undefined" != typeof module && module.exports ? module.exports = t() : "function" == typeof n.define && n.define.amd ? define(t) : n.Firepad = t()
    }(0, function() {
        (D = D || {}).utils = {}, D.utils.makeEventEmitter = function(e, t) {
            e.prototype.allowedEvents_ = t, e.prototype.on = function(e, t, n) {
                this.validateEventType_(e), this.eventListeners_ = this.eventListeners_ || {}, this.eventListeners_[e] = this.eventListeners_[e] || [], this.eventListeners_[e].push({
                    callback: t,
                    context: n
                })
            }, e.prototype.off = function(e, t) {
                this.validateEventType_(e), this.eventListeners_ = this.eventListeners_ || {};
                for (var n = this.eventListeners_[e] || [], r = 0; r < n.length; r++)
                    if (n[r].callback === t) return void n.splice(r, 1)
            }, e.prototype.trigger = function(e) {
                this.eventListeners_ = this.eventListeners_ || {};
                for (var t = this.eventListeners_[e] || [], n = 0; n < t.length; n++) t[n].callback.apply(t[n].context, Array.prototype.slice.call(arguments, 1))
            }, e.prototype.validateEventType_ = function(e) {
                if (this.allowedEvents_) {
                    for (var t = !1, n = 0; n < this.allowedEvents_.length; n++)
                        if (this.allowedEvents_[n] === e) {
                            t = !0;
                            break
                        } if (!t) throw new Error('Unknown event "' + e + '"')
                }
            }
        }, D.utils.elt = function(e, t, n) {
            var r = document.createElement(e);
            if ("string" == typeof t) D.utils.setTextContent(r, t);
            else if (t)
                for (var i = 0; i < t.length; ++i) r.appendChild(t[i]);
            for (var o in n || {}) r.setAttribute(o, n[o]);
            return r
        }, D.utils.setTextContent = function(e, t) {
            e.innerHTML = "", e.appendChild(document.createTextNode(t))
        }, D.utils.on = function(e, t, n, r) {
            e.addEventListener ? e.addEventListener(t, n, r || !1) : e.attachEvent && e.attachEvent("on" + t, n)
        }, D.utils.off = function(e, t, n, r) {
            e.removeEventListener ? e.removeEventListener(t, n, r || !1) : e.detachEvent && e.detachEvent("on" + t, n)
        }, D.utils.preventDefault = function(e) {
            e.preventDefault ? e.preventDefault() : e.returnValue = !1
        }, D.utils.stopPropagation = function(e) {
            e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0
        }, D.utils.stopEvent = function(e) {
            D.utils.preventDefault(e), D.utils.stopPropagation(e)
        }, D.utils.stopEventAnd = function(t) {
            return function(e) {
                return t(e), D.utils.stopEvent(e), !1
            }
        }, D.utils.trim = function(e) {
            return e.replace(/^\s+/g, "").replace(/\s+$/g, "")
        }, D.utils.stringEndsWith = function(e, t) {
            for (var n = "string" == typeof t ? [t] : t, r = 0; r < n.length; r++) {
                t = n[r];
                if (-1 !== e.indexOf(t, e.length - t.length)) return !0
            }
            return !1
        }, D.utils.assert = function(e, t) {
            if (!e) throw new Error(t || "assertion error")
        }, D.utils.log = function() {
            if ("undefined" != typeof console && void 0 !== console.log) {
                for (var e = ["Firepad:"], t = 0; t < arguments.length; t++) e.push(arguments[t]);
                console.log.apply(console, e)
            }
        }, (D = D || {}).Span = function() {
            function e(e, t) {
                this.pos = e, this.length = t
            }
            return e.prototype.end = function() {
                return this.pos + this.length
            }, e
        }(), (D = D || {}).TextOp = function() {
            var t = D.utils;

            function e(e) {
                this.type = e, this.chars = null, this.text = null, this.attributes = null, "insert" === e ? (this.text = arguments[1], t.assert("string" == typeof this.text), this.attributes = arguments[2] || {}, t.assert("object" == typeof this.attributes)) : "delete" === e ? (this.chars = arguments[1], t.assert("number" == typeof this.chars)) : "retain" === e && (this.chars = arguments[1], t.assert("number" == typeof this.chars), this.attributes = arguments[2] || {}, t.assert("object" == typeof this.attributes))
            }
            return e.prototype.isInsert = function() {
                return "insert" === this.type
            }, e.prototype.isDelete = function() {
                return "delete" === this.type
            }, e.prototype.isRetain = function() {
                return "retain" === this.type
            }, e.prototype.equals = function(e) {
                return this.type === e.type && this.text === e.text && this.chars === e.chars && this.attributesEqual(e.attributes)
            }, e.prototype.attributesEqual = function(e) {
                for (var t in this.attributes)
                    if (this.attributes[t] !== e[t]) return !1;
                for (t in e)
                    if (this.attributes[t] !== e[t]) return !1;
                return !0
            }, e.prototype.hasEmptyAttributes = function() {
                var e = !0;
                for (var t in this.attributes) {
                    e = !1;
                    break
                }
                return e
            }, e
        }(), (D = D || {}).TextOperation = function() {
            "use strict";
            var i = D.TextOp,
                g = D.utils;

            function d() {
                if (!this || this.constructor !== d) return new d;
                this.ops = [], this.baseLength = 0, this.targetLength = 0
            }

            function o(e) {
                var t = e.ops;
                switch (t.length) {
                    case 1:
                        return t[0];
                    case 2:
                        return t[0].isRetain() ? t[1] : t[1].isRetain() ? t[0] : null;
                    case 3:
                        if (t[0].isRetain() && t[2].isRetain()) return t[1]
                }
                return null
            }

            function s(e) {
                return e.ops[0].isRetain() ? e.ops[0].chars : 0
            }
            return d.prototype.equals = function(e) {
                if (this.baseLength !== e.baseLength) return !1;
                if (this.targetLength !== e.targetLength) return !1;
                if (this.ops.length !== e.ops.length) return !1;
                for (var t = 0; t < this.ops.length; t++)
                    if (!this.ops[t].equals(e.ops[t])) return !1;
                return !0
            }, d.prototype.retain = function(e, t) {
                if ("number" != typeof e || e < 0) throw new Error("retain expects a positive integer.");
                if (0 === e) return this;
                this.baseLength += e, this.targetLength += e, t = t || {};
                var n = 0 < this.ops.length ? this.ops[this.ops.length - 1] : null;
                return n && n.isRetain() && n.attributesEqual(t) ? n.chars += e : this.ops.push(new i("retain", e, t)), this
            }, d.prototype.insert = function(e, t) {
                if ("string" != typeof e) throw new Error("insert expects a string");
                if ("" === e) return this;
                t = t || {}, this.targetLength += e.length;
                var n = 0 < this.ops.length ? this.ops[this.ops.length - 1] : null,
                    r = 1 < this.ops.length ? this.ops[this.ops.length - 2] : null;
                return n && n.isInsert() && n.attributesEqual(t) ? n.text += e : n && n.isDelete() ? r && r.isInsert() && r.attributesEqual(t) ? r.text += e : (this.ops[this.ops.length - 1] = new i("insert", e, t), this.ops.push(n)) : this.ops.push(new i("insert", e, t)), this
            }, d.prototype.delete = function(e) {
                if ("string" == typeof e && (e = e.length), "number" != typeof e || e < 0) throw new Error("delete expects a positive integer or a string");
                if (0 === e) return this;
                this.baseLength += e;
                var t = 0 < this.ops.length ? this.ops[this.ops.length - 1] : null;
                return t && t.isDelete() ? t.chars += e : this.ops.push(new i("delete", e)), this
            }, d.prototype.isNoop = function() {
                return 0 === this.ops.length || 1 === this.ops.length && this.ops[0].isRetain() && this.ops[0].hasEmptyAttributes()
            }, d.prototype.clone = function() {
                for (var e = new d, t = 0; t < this.ops.length; t++) this.ops[t].isRetain() ? e.retain(this.ops[t].chars, this.ops[t].attributes) : this.ops[t].isInsert() ? e.insert(this.ops[t].text, this.ops[t].attributes) : e.delete(this.ops[t].chars);
                return e
            }, d.prototype.toString = function() {
                return (Array.prototype.map || function(e) {
                    for (var t = [], n = 0, r = this.length; n < r; n++) t[n] = e(this[n]);
                    return t
                }).call(this.ops, function(e) {
                    return e.isRetain() ? "retain " + e.chars : e.isInsert() ? "insert '" + e.text + "'" : "delete " + e.chars
                }).join(", ")
            }, d.prototype.toJSON = function() {
                for (var e = [], t = 0; t < this.ops.length; t++) this.ops[t].hasEmptyAttributes() || e.push(this.ops[t].attributes), "retain" === this.ops[t].type ? e.push(this.ops[t].chars) : "insert" === this.ops[t].type ? e.push(this.ops[t].text) : "delete" === this.ops[t].type && e.push(-this.ops[t].chars);
                return 0 === e.length && e.push(0), e
            }, d.fromJSON = function(e) {
                for (var t = new d, n = 0, r = e.length; n < r; n++) {
                    var i = e[n],
                        o = {};
                    "object" == typeof i && (o = i, i = e[++n]), "number" == typeof i ? 0 < i ? t.retain(i, o) : t.delete(-i) : (g.assert("string" == typeof i), t.insert(i, o))
                }
                return t
            }, d.prototype.apply = function(e, t, n) {
                if (t = t || [], n = n || [], e.length !== this.baseLength) throw new Error("The operation's base length must be equal to the string's length.");
                for (var r, i, o = [], s = 0, a = 0, l = this.ops, c = 0, u = l.length; c < u; c++) {
                    var h = l[c];
                    if (h.isRetain()) {
                        if (a + h.chars > e.length) throw new Error("Operation can't retain more characters than are left in the string.");
                        for (o[s++] = e.slice(a, a + h.chars), r = 0; r < h.chars; r++) {
                            var d = t[a + r] || {},
                                f = {};
                            for (i in d) f[i] = d[i], g.assert(!1 !== f[i]);
                            for (i in h.attributes) !1 === h.attributes[i] ? delete f[i] : f[i] = h.attributes[i], g.assert(!1 !== f[i]);
                            n.push(f)
                        }
                        a += h.chars
                    } else if (h.isInsert())
                        for (o[s++] = h.text, r = 0; r < h.text.length; r++) {
                            var p = {};
                            for (i in h.attributes) p[i] = h.attributes[i], g.assert(!1 !== p[i]);
                            n.push(p)
                        } else a += h.chars
                }
                if (a !== e.length) throw new Error("The operation didn't operate on the whole string.");
                var m = o.join("");
                return g.assert(m.length === n.length), m
            }, d.prototype.invert = function(e) {
                for (var t = 0, n = new d, r = this.ops, i = 0, o = r.length; i < o; i++) {
                    var s = r[i];
                    s.isRetain() ? (n.retain(s.chars), t += s.chars) : s.isInsert() ? n.delete(s.text.length) : (n.insert(e.slice(t, t + s.chars)), t += s.chars)
                }
                return n
            }, d.prototype.compose = function(e) {
                if (this.targetLength !== e.baseLength) throw new Error("The base length of the second operation has to be the target length of the first operation");

                function t(e, t, n) {
                    var r, i = {};
                    for (r in e) i[r] = e[r];
                    for (r in t) n && !1 === t[r] ? delete i[r] : i[r] = t[r];
                    return i
                }
                for (var n, r = new d, i = this.clone().ops, o = e.clone().ops, s = 0, a = 0, l = i[s++], c = o[a++]; void 0 !== l || void 0 !== c;)
                    if (l && l.isDelete()) r.delete(l.chars), l = i[s++];
                    else if (c && c.isInsert()) r.insert(c.text, c.attributes), c = o[a++];
                else {
                    if (void 0 === l) throw new Error("Cannot compose operations: first operation is too short.");
                    if (void 0 === c) throw new Error("Cannot compose operations: first operation is too long.");
                    if (l.isRetain() && c.isRetain()) n = t(l.attributes, c.attributes), l.chars > c.chars ? (r.retain(c.chars, n), l.chars -= c.chars, c = o[a++]) : l.chars === c.chars ? (r.retain(l.chars, n), l = i[s++], c = o[a++]) : (r.retain(l.chars, n), c.chars -= l.chars, l = i[s++]);
                    else if (l.isInsert() && c.isDelete()) l.text.length > c.chars ? (l.text = l.text.slice(c.chars), c = o[a++]) : l.text.length === c.chars ? (l = i[s++], c = o[a++]) : (c.chars -= l.text.length, l = i[s++]);
                    else if (l.isInsert() && c.isRetain()) n = t(l.attributes, c.attributes, !0), l.text.length > c.chars ? (r.insert(l.text.slice(0, c.chars), n), l.text = l.text.slice(c.chars), c = o[a++]) : l.text.length === c.chars ? (r.insert(l.text, n), l = i[s++], c = o[a++]) : (r.insert(l.text, n), c.chars -= l.text.length, l = i[s++]);
                    else {
                        if (!l.isRetain() || !c.isDelete()) throw new Error("This shouldn't happen: op1: " + JSON.stringify(l) + ", op2: " + JSON.stringify(c));
                        l.chars > c.chars ? (r.delete(c.chars), l.chars -= c.chars, c = o[a++]) : l.chars === c.chars ? (r.delete(c.chars), l = i[s++], c = o[a++]) : (r.delete(l.chars), c.chars -= l.chars, l = i[s++])
                    }
                }
                return r
            }, d.prototype.shouldBeComposedWith = function(e) {
                if (this.isNoop() || e.isNoop()) return !0;
                var t = s(this),
                    n = s(e),
                    r = o(this),
                    i = o(e);
                return !(!r || !i) && (r.isInsert() && i.isInsert() ? t + r.text.length === n : !(!r.isDelete() || !i.isDelete()) && (n + i.chars === t || t === n))
            }, d.prototype.shouldBeComposedWithInverted = function(e) {
                if (this.isNoop() || e.isNoop()) return !0;
                var t = s(this),
                    n = s(e),
                    r = o(this),
                    i = o(e);
                return !(!r || !i) && (r.isInsert() && i.isInsert() ? t + r.text.length === n || t === n : !(!r.isDelete() || !i.isDelete()) && n + i.chars === t)
            }, d.transformAttributes = function(e, t) {
                var n, r = {},
                    i = {},
                    o = {};
                for (n in e) o[n] = !0;
                for (n in t) o[n] = !0;
                for (n in o) {
                    var s = e[n],
                        a = t[n];
                    g.assert(null != s || null != a), null == s ? i[n] = a : null == a ? r[n] = s : s === a || (r[n] = s)
                }
                return [r, i]
            }, d.transform = function(e, t) {
                if (e.baseLength !== t.baseLength) throw new Error("Both operations have to have the same base length");
                for (var n = new d, r = new d, i = e.clone().ops, o = t.clone().ops, s = 0, a = 0, l = i[s++], c = o[a++]; void 0 !== l || void 0 !== c;)
                    if (l && l.isInsert()) n.insert(l.text, l.attributes), r.retain(l.text.length), l = i[s++];
                    else if (c && c.isInsert()) n.retain(c.text.length), r.insert(c.text, c.attributes), c = o[a++];
                else {
                    if (void 0 === l) throw new Error("Cannot transform operations: first operation is too short.");
                    if (void 0 === c) throw new Error("Cannot transform operations: first operation is too long.");
                    var u;
                    if (l.isRetain() && c.isRetain()) {
                        var h = d.transformAttributes(l.attributes, c.attributes);
                        l.chars > c.chars ? (u = c.chars, l.chars -= c.chars, c = o[a++]) : l.chars === c.chars ? (u = c.chars, l = i[s++], c = o[a++]) : (u = l.chars, c.chars -= l.chars, l = i[s++]), n.retain(u, h[0]), r.retain(u, h[1])
                    } else if (l.isDelete() && c.isDelete()) l.chars > c.chars ? (l.chars -= c.chars, c = o[a++]) : l.chars === c.chars ? (l = i[s++], c = o[a++]) : (c.chars -= l.chars, l = i[s++]);
                    else if (l.isDelete() && c.isRetain()) l.chars > c.chars ? (u = c.chars, l.chars -= c.chars, c = o[a++]) : l.chars === c.chars ? (u = c.chars, l = i[s++], c = o[a++]) : (u = l.chars, c.chars -= l.chars, l = i[s++]), n.delete(u);
                    else {
                        if (!l.isRetain() || !c.isDelete()) throw new Error("The two operations aren't compatible");
                        l.chars > c.chars ? (u = c.chars, l.chars -= c.chars, c = o[a++]) : l.chars === c.chars ? (u = l.chars, l = i[s++], c = o[a++]) : (u = l.chars, c.chars -= l.chars, l = i[s++]), r.delete(u)
                    }
                }
                return [n, r]
            }, d
        }(), (D = D || {}).AnnotationList = function() {
            var l = D.Span;

            function u(e, t) {
                if (!e) throw new Error("AnnotationList assertion failed" + (t ? ": " + t : ""))
            }

            function d(e, t) {
                this.pos = e, this.length = t.length, this.annotation = t.annotation, this.attachedObject_ = t.attachedObject
            }

            function f(e, t) {
                this.pos = e, this.length = t.length, this.annotation = t.annotation, this.node_ = t
            }
            d.prototype.getAttachedObject = function() {
                return this.attachedObject_
            }, f.prototype.attachObject = function(e) {
                this.node_.attachedObject = e
            };
            var h = {
                equals: function() {
                    return !1
                }
            };

            function e(e) {
                this.head_ = new p(0, h), this.changeHandler_ = e
            }

            function p(e, t) {
                this.length = e, this.annotation = t, this.attachedObject = null, this.next = null
            }
            return e.prototype.insertAnnotatedSpan = function(i, o) {
                this.wrapOperation_(new l(i.pos, 0), function(e, t) {
                    u(!t || null === t.next);
                    var n = new p(i.length, o);
                    if (t) {
                        u(i.pos > e && i.pos < e + t.length);
                        var r = new p(0, h);
                        return r.next = new p(i.pos - e, t.annotation), (r.next.next = n).next = new p(e + t.length - i.pos, t.annotation), r.next
                    }
                    return n
                })
            }, e.prototype.removeSpan = function(o) {
                0 !== o.length && this.wrapOperation_(o, function(e, t) {
                    u(null !== t);
                    var n = new p(0, h),
                        r = n;
                    for (o.pos > e && (r.next = new p(o.pos - e, t.annotation), r = r.next); o.end() > e + t.length;) e += t.length, t = t.next;
                    var i = e + t.length - o.end();
                    return 0 < i && (r.next = new p(i, t.annotation)), n.next
                })
            }, e.prototype.updateSpan = function(l, c) {
                0 !== l.length && this.wrapOperation_(l, function(e, t) {
                    u(null !== t);
                    var n = new p(0, h),
                        r = n,
                        i = e,
                        o = l.pos - i;
                    for (u(o < t.length), 0 < o && (r.next = new p(o, t.annotation), i += (r = r.next).length); null !== t && l.end() >= e + t.length;) {
                        var s = e + t.length - i;
                        r.next = new p(s, c(t.annotation, s)), r = r.next, e += t.length, t = t.next, i = e
                    }
                    var a = l.end() - i;
                    return 0 < a && (u(a < t.length), r.next = new p(a, c(t.annotation, a)), i += (r = r.next).length, r.next = new p(e + t.length - i, t.annotation)), n.next
                })
            }, e.prototype.wrapOperation_ = function(e, t) {
                if (e.pos < 0) throw new Error("Span start cannot be negative.");
                var n, r = [],
                    i = [],
                    o = this.getAffectedNodes_(e);
                null !== o.start ? (n = o.end.next, o.end.next = null) : n = o.succ;
                var s = t(o.startPos, o.start),
                    a = !1,
                    l = !1;
                if (s) {
                    var c;
                    for (this.mergeNodesWithSameAnnotations_(s), c = o.pred && o.pred.annotation.equals(s.annotation) ? (a = !0, s.length += o.pred.length, o.beforePred.next = s, o.predPos) : (o.beforeStart.next = s, o.startPos); s.next;) i.push(new f(c, s)), c += s.length, s = s.next;
                    o.succ && o.succ.annotation.equals(s.annotation) ? (s.length += o.succ.length, l = !0, s.next = o.succ.next) : s.next = n, i.push(new f(c, s))
                } else o.pred && o.succ && o.pred.annotation.equals(o.succ.annotation) ? (l = a = !0, s = new p(o.pred.length + o.succ.length, o.pred.annotation), (o.beforePred.next = s).next = o.succ.next, i.push(new f(o.startPos - o.pred.length, s))) : o.beforeStart.next = n;
                a && r.push(new d(o.predPos, o.pred));
                for (var u = o.startPos, h = o.start; null !== h;) r.push(new d(u, h)), u += h.length, h = h.next;
                l && r.push(new d(u, o.succ)), this.changeHandler_(r, i)
            }, e.prototype.getAffectedNodes_ = function(e) {
                for (var t = {}, n = null, r = this.head_, i = r.next, o = 0; null !== i && e.pos >= o + i.length;) o += i.length, n = r, i = (r = i).next;
                if (null === i && (0 !== e.length || e.pos !== o)) throw new Error("Span start exceeds the bounds of the AnnotationList.");
                for (t.startPos = o, 0 === e.length && e.pos === o ? t.start = null : t.start = i, t.beforeStart = r, o === e.pos && 0 < o ? (t.pred = r, t.predPos = o - r.length, t.beforePred = n) : t.pred = null; null !== i && e.end() > o;) o += i.length, i = (r = i).next;
                if (e.end() > o) throw new Error("Span end exceeds the bounds of the AnnotationList.");
                return 0 === e.length && e.end() === o ? t.end = null : t.end = r, t.succ = o === e.end() ? i : null, t
            }, e.prototype.mergeNodesWithSameAnnotations_ = function(e) {
                if (e)
                    for (var t = null, n = e; n;) t && t.annotation.equals(n.annotation) ? (t.length += n.length, t.next = n.next) : t = n, n = n.next
            }, e.prototype.forEach = function(e) {
                for (var t = this.head_.next; null !== t;) e(t.length, t.annotation, t.attachedObject), t = t.next
            }, e.prototype.getAnnotatedSpansForPos = function(e) {
                for (var t = 0, n = this.head_.next, r = null; null !== n && t + n.length <= e;) t += n.length, n = (r = n).next;
                if (null === n && t !== e) throw new Error("pos exceeds the bounds of the AnnotationList");
                var i = [];
                return t === e && r && i.push(new d(t - r.length, r)), n && i.push(new d(t, n)), i
            }, e.prototype.getAnnotatedSpansForSpan = function(e) {
                if (0 === e.length) return [];
                for (var t = [], n = this.getAffectedNodes_(e), r = n.startPos, i = n.start; null !== i && r < e.end();) {
                    var o = Math.max(r, e.pos),
                        s = Math.min(r + i.length, e.end()),
                        a = new l(o, s - o);
                    a.annotation = i.annotation, t.push(a), r += i.length, i = i.next
                }
                return t
            }, e.prototype.count = function() {
                for (var e = 0, t = this.head_.next, n = null; null !== t;) n && u(!n.annotation.equals(t.annotation)), t = (n = t).next, e++;
                return e
            }, p.prototype.clone = function() {
                var e = new p(this.spanLength, this.annotation);
                return e.next = this.next, e
            }, e
        }(), (D = D || {}).Cursor = function() {
            "use strict";

            function n(e, t) {
                this.position = e, this.selectionEnd = t
            }
            return n.fromJSON = function(e) {
                return new n(e.position, e.selectionEnd)
            }, n.prototype.equals = function(e) {
                return this.position === e.position && this.selectionEnd === e.selectionEnd
            }, n.prototype.compose = function(e) {
                return e
            }, n.prototype.transform = function(o) {
                function e(e) {
                    for (var t = e, n = o.ops, r = 0, i = o.ops.length; r < i && (n[r].isRetain() ? e -= n[r].chars : n[r].isInsert() ? t += n[r].text.length : (t -= Math.min(e, n[r].chars), e -= n[r].chars), !(e < 0)); r++);
                    return t
                }
                var t = e(this.position);
                return this.position === this.selectionEnd ? new n(t, t) : new n(t, e(this.selectionEnd))
            }, n
        }(), (D = D || {}).FirebaseAdapter = function(e) {
            "function" == typeof require && "function" != typeof Firebase && (Firebase = require("firebase"));
            var i = D.TextOperation,
                l = D.utils;

            function t(e, t, n) {
                this.ref_ = e, this.ready_ = !1, this.firebaseCallbacks_ = [], this.zombie_ = !1, this.document_ = new i, this.revision_ = 0, this.pendingReceivedRevisions_ = {};
                var r = this;
                t ? (this.setUserId(t), this.setColor(n), this.firebaseOn_(e.root.child(".info/connected"), "value", function(e) {
                    !0 === e.val() && r.initializeUserData_()
                }, this), this.on("ready", function() {
                    r.monitorCursors_()
                })) : this.userId_ = e.push().key, setTimeout(function() {
                    r.monitorHistory_()
                }, 0)
            }

            function c(e, t) {
                if (!e) throw new Error(t || "assertion error")
            }
            l.makeEventEmitter(t, ["ready", "cursor", "operation", "ack", "retry"]), t.prototype.dispose = function() {
                this.removeFirebaseCallbacks_(), this.userRef_.child("cursor").remove(), this.userRef_.child("color").remove(), this.ref_ = null, this.document_ = null, this.zombie_ = !0
            }, t.prototype.setReadOnly = function(e) {
                this.readOnly_ = e
            }, t.prototype.setUserId = function(e) {
                this.userRef_ && (this.userRef_.child("cursor").remove(), this.userRef_.child("cursor").onDisconnect().cancel(), this.userRef_.child("color").remove(), this.userRef_.child("color").onDisconnect().cancel()), this.userId_ = e, this.userRef_ = this.ref_.child("users").child(e), this.initializeUserData_()
            }, t.prototype.isHistoryEmpty = function() {
                return c(this.ready_, "Not ready yet."), 0 === this.revision_
            }, t.prototype.sendOperation = function(e, o) {
                var s = this;
                if (this.ready_) {
                    c(this.document_.targetLength === e.baseLength, "sendOperation() called with invalid operation.");
                    var t = u(this.revision_);
                    if (this.sent_ = {
                            id: t,
                            op: e
                        }, hasStartTS) {
                        var n = TSDIFF + (new Date).getTime();
                        a(t, {
                            a: s.userId_,
                            o: e.toJSON(),
                            t: n
                        })
                    } else a(t, {
                        a: s.userId_,
                        o: e.toJSON(),
                        t: Firebase.ServerValue.TIMESTAMP
                    })
                } else this.on("ready", function() {
                    s.trigger("retry")
                });

                function a(r, i) {
                    s.ref_.child("history").child(r).transaction(function(e) {
                        if (null === e) return i
                    }, function(e, t, n) {
                        if (e) {
                            if ("disconnect" !== e.message) throw l.log("Transaction failure!", e), e;
                            s.sent_ && s.sent_.id === r ? setTimeout(function() {
                                a(r, i)
                            }, 0) : o && o(e, !1)
                        } else o && o(null, t)
                    }, !1)
                }
            }, t.prototype.sendCursor = function(e) {
                this.readOnly_ || (this.userRef_.child("cursor").set(e), this.cursor_ = e)
            }, t.prototype.setColor = function(e) {
                this.userRef_.child("color").set(e), this.color_ = e
            }, t.prototype.getDocument = function() {
                return this.document_
            }, t.prototype.registerCallbacks = function(e) {
                for (var t in e) this.on(t, e[t])
            }, t.prototype.initializeUserData_ = function() {
                this.userRef_.child("cursor").onDisconnect().remove(), this.userRef_.child("color").onDisconnect().remove(), this.sendCursor(this.cursor_ || null), this.setColor(this.color_ || null)
            }, t.prototype.monitorCursors_ = function() {
                var e = this.ref_.child("users"),
                    r = this;

                function t(e) {
                    var t = e.key,
                        n = e.val();
                    r.trigger("cursor", t, n.cursor, n.color)
                }
                this.firebaseOn_(e, "child_added", t), this.firebaseOn_(e, "child_changed", t), this.firebaseOn_(e, "child_removed", function(e) {
                    var t = e.key;
                    r.trigger("cursor", t, null)
                })
            }, t.prototype.monitorHistory_ = function() {
                var i = this;
                this.ref_.child("checkpoint").once("value", function(e) {
                    if (!i.zombie_) {
                        var t = e.child("id").val(),
                            n = e.child("o").val(),
                            r = e.child("a").val();
                        null != n && null != t && null !== r ? (i.pendingReceivedRevisions_[t] = {
                            o: n,
                            a: r
                        }, i.checkpointRevision_ = function(e) {
                            c(0 < e.length && e[0] === o[e.length + 8]);
                            for (var t = 0, n = 1; n < e.length; n++) t *= o.length, t += o.indexOf(e[n]);
                            return t
                        }(t), i.monitorHistoryStartingAt_(i.checkpointRevision_ + 1)) : (i.checkpointRevision_ = 0, i.monitorHistoryStartingAt_(i.checkpointRevision_))
                    }
                })
            }, t.prototype.monitorHistoryStartingAt_ = function(e) {
                var t = this.ref_.child("history").startAt(null, u(e)),
                    n = this;
                setTimeout(function() {
                    n.firebaseOn_(t, "child_added", function(e) {
                        var t = e.key;
                        n.pendingReceivedRevisions_[t] = e.val(), n.ready_ && n.handlePendingReceivedRevisions_()
                    }), t.once("value", function() {
                        n.handleInitialRevisions_()
                    })
                }, 0)
            }, t.prototype.handleInitialRevisions_ = function() {
                c(!this.ready_, "Should not be called multiple times."), this.revision_ = this.checkpointRevision_;
                for (var e = u(this.revision_), t = this.pendingReceivedRevisions_; null != t[e];) {
                    var n = this.parseRevision_(t[e]);
                    n ? this.document_ = this.document_.compose(n.operation) : l.log("Invalid operation.", this.ref_.toString(), e, t[e]), delete t[e], this.revision_++, e = u(this.revision_)
                }
                this.trigger("operation", this.document_), this.ready_ = !0;
                var r = this;
                setTimeout(function() {
                    r.trigger("ready")
                }, 0)
            }, t.prototype.handlePendingReceivedRevisions_ = function() {
                for (var e = this.pendingReceivedRevisions_, t = u(this.revision_), n = !1; null != e[t];) {
                    this.revision_++;
                    var r = this.parseRevision_(e[t]);
                    r ? (this.document_ = this.document_.compose(r.operation), this.sent_ && t === this.sent_.id ? this.sent_.op.equals(r.operation) && r.author === this.userId_ ? (this.revision_ % 100 == 0 && this.saveCheckpoint_(), this.sent_ = null, this.trigger("ack")) : (n = !0, this.trigger("operation", r.operation)) : this.trigger("operation", r.operation)) : l.log("Invalid operation.", this.ref_.toString(), t, e[t]), delete e[t], t = u(this.revision_)
                }
                n && (this.sent_ = null, this.trigger("retry"))
            }, t.prototype.parseRevision_ = function(e) {
                if ("object" != typeof e) return null;
                if ("string" != typeof e.a || "object" != typeof e.o) return null;
                var t = null;
                try {
                    t = i.fromJSON(e.o)
                } catch (e) {
                    return null
                }
                return t.baseLength !== this.document_.targetLength ? null : {
                    author: e.a,
                    operation: t
                }
            }, t.prototype.saveCheckpoint_ = function() {
                this.ref_.child("checkpoint").set({
                    a: this.userId_,
                    o: this.document_.toJSON(),
                    id: u(this.revision_ - 1)
                })
            }, t.prototype.firebaseOn_ = function(e, t, n, r) {
                return this.firebaseCallbacks_.push({
                    ref: e,
                    eventType: t,
                    callback: n,
                    context: r
                }), e.on(t, n, r), n
            }, t.prototype.firebaseOff_ = function(e, t, n, r) {
                e.off(t, n, r);
                for (var i = 0; i < this.firebaseCallbacks_.length; i++) {
                    var o = this.firebaseCallbacks_[i];
                    if (o.ref === e && o.eventType === t && o.callback === n && o.context === r) {
                        this.firebaseCallbacks_.splice(i, 1);
                        break
                    }
                }
            }, t.prototype.removeFirebaseCallbacks_ = function() {
                for (var e = 0; e < this.firebaseCallbacks_.length; e++) {
                    var t = this.firebaseCallbacks_[e];
                    t.ref.off(t.eventType, t.callback, t.context)
                }
                this.firebaseCallbacks_ = []
            };
            var o = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

            function u(e) {
                if (0 === e) return "A0";
                for (var t = ""; 0 < e;) {
                    var n = e % o.length;
                    t = o[n] + t, e -= n, e /= o.length
                }
                return o[t.length + 9] + t
            }
            return t
        }(), (D = D || {}).RichTextToolbar = function(e) {
            var d = D.utils;

            function t(e) {
                this.imageInsertionUI = e, this.element_ = this.makeElement_()
            }
            return d.makeEventEmitter(t, ["bold", "italic", "underline", "strike", "font", "font-size", "color", "left", "center", "right", "unordered-list", "ordered-list", "todo-list", "indent-increase", "indent-decrease", "undo", "redo", "insert-image"]), t.prototype.element = function() {
                return this.element_
            }, t.prototype.makeButton_ = function(e, t) {
                var n = this;
                t = t || e;
                var r = d.elt("a", [d.elt("span", "", {
                    class: "firepad-tb-" + t
                })], {
                    class: "firepad-btn"
                });
                return d.on(r, "click", d.stopEventAnd(function() {
                    n.trigger(e)
                })), r
            }, t.prototype.makeElement_ = function() {
                var e = this,
                    t = this.makeFontDropdown_(),
                    n = this.makeFontSizeDropdown_(),
                    r = this.makeColorDropdown_(),
                    i = [d.elt("div", [t], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [n], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [r], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [e.makeButton_("bold"), e.makeButton_("italic"), e.makeButton_("underline"), e.makeButton_("strike", "strikethrough")], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [e.makeButton_("unordered-list", "list-2"), e.makeButton_("ordered-list", "numbered-list"), e.makeButton_("todo-list", "list")], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [e.makeButton_("indent-decrease"), e.makeButton_("indent-increase")], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [e.makeButton_("left", "paragraph-left"), e.makeButton_("center", "paragraph-center"), e.makeButton_("right", "paragraph-right")], {
                        class: "firepad-btn-group"
                    }), d.elt("div", [e.makeButton_("undo"), e.makeButton_("redo")], {
                        class: "firepad-btn-group"
                    })];
                e.imageInsertionUI && i.push(d.elt("div", [e.makeButton_("insert-image")], {
                    class: "firepad-btn-group"
                }));
                var o = d.elt("div", i, {
                        class: "firepad-toolbar-wrapper"
                    }),
                    s = d.elt("div", null, {
                        class: "firepad-toolbar"
                    });
                return s.appendChild(o), s
            }, t.prototype.makeFontDropdown_ = function() {
                for (var e = ["Arial", "Comic Sans MS", "Courier New", "Impact", "Times New Roman", "Verdana"], t = [], n = 0; n < e.length; n++) {
                    var r = d.elt("span", e[n]);
                    r.setAttribute("style", "font-family:" + e[n]), t.push({
                        content: r,
                        value: e[n]
                    })
                }
                return this.makeDropdown_("Font", "font", t)
            }, t.prototype.makeFontSizeDropdown_ = function() {
                for (var e = [9, 10, 12, 14, 18, 24, 32, 42], t = [], n = 0; n < e.length; n++) {
                    var r = d.elt("span", e[n].toString());
                    r.setAttribute("style", "font-size:" + e[n] + "px; line-height:" + (e[n] - 6) + "px;"), t.push({
                        content: r,
                        value: e[n]
                    })
                }
                return this.makeDropdown_("Size", "font-size", t, "px")
            }, t.prototype.makeColorDropdown_ = function() {
                for (var e = ["black", "red", "green", "blue", "yellow", "cyan", "magenta", "grey"], t = [], n = 0; n < e.length; n++) {
                    var r = d.elt("div");
                    r.className = "firepad-color-dropdown-item", r.setAttribute("style", "background-color:" + e[n]), t.push({
                        content: r,
                        value: e[n]
                    })
                }
                return this.makeDropdown_("Color", "color", t)
            }, t.prototype.makeDropdown_ = function(e, r, t, i) {
                i = i || "";
                var o = this,
                    n = d.elt("a", e + " â–¾", {
                        class: "firepad-btn firepad-dropdown"
                    }),
                    s = d.elt("ul", [], {
                        class: "firepad-dropdown-menu"
                    });
                n.appendChild(s);
                var a = !1;
                var l = !1;

                function c() {
                    a && (s.style.display = "", d.off(document, "click", c, !0), a = !1), l = !0, setTimeout(function() {
                        l = !1
                    }, 0)
                }

                function u(e, t) {
                    "object" != typeof e && (e = document.createTextNode(String(e)));
                    var n = d.elt("a", [e]);
                    d.on(n, "click", d.stopEventAnd(function() {
                        c(), o.trigger(r, t + i)
                    })), s.appendChild(n)
                }
                for (var h = 0; h < t.length; h++) {
                    u(t[h].content, t[h].value)
                }
                return d.on(n, "click", d.stopEventAnd(function() {
                    l || a || (s.style.display = "block", d.on(document, "click", c, !0), a = !0)
                })), n
            }, t
        }(), (D = D || {}).WrappedOperation = function(e) {
            "use strict";

            function r(e, t) {
                this.wrapped = e, this.meta = t
            }

            function i(e, t) {
                for (var n in e) e.hasOwnProperty(n) && (t[n] = e[n])
            }

            function o(e, t) {
                return e && "object" == typeof e && "function" == typeof e.transform ? e.transform(t) : e
            }
            return r.prototype.apply = function() {
                return this.wrapped.apply.apply(this.wrapped, arguments)
            }, r.prototype.invert = function() {
                var e = this.meta;
                return new r(this.wrapped.invert.apply(this.wrapped, arguments), e && "object" == typeof e && "function" == typeof e.invert ? e.invert.apply(e, arguments) : e)
            }, r.prototype.compose = function(e) {
                return new r(this.wrapped.compose(e.wrapped), function(e, t) {
                    if (e && "object" == typeof e) {
                        if ("function" == typeof e.compose) return e.compose(t);
                        var n = {};
                        return i(e, n), i(t, n), n
                    }
                    return t
                }(this.meta, e.meta))
            }, r.transform = function(e, t) {
                var n = (0, e.wrapped.constructor.transform)(e.wrapped, t.wrapped);
                return [new r(n[0], o(e.meta, t.wrapped)), new r(n[1], o(t.meta, e.wrapped))]
            }, r
        }(), (D = D || {}).UndoManager = function() {
            "use strict";
            var t = "normal",
                r = "undoing",
                i = "redoing";

            function e(e) {
                this.maxItems = e || 50, this.state = t, this.dontCompose = !1, this.undoStack = [], this.redoStack = []
            }

            function n(e, t) {
                for (var n = [], r = t.constructor, i = e.length - 1; 0 <= i; i--) {
                    var o = r.transform(e[i], t);
                    "function" == typeof o[0].isNoop && o[0].isNoop() || n.push(o[0]), t = o[1]
                }
                return n.reverse()
            }
            return e.prototype.add = function(e, t) {
                if (this.state === r) this.redoStack.push(e), this.dontCompose = !0;
                else if (this.state === i) this.undoStack.push(e), this.dontCompose = !0;
                else {
                    var n = this.undoStack;
                    !this.dontCompose && t && 0 < n.length ? n.push(e.compose(n.pop())) : (n.push(e), n.length > this.maxItems && n.shift()), this.dontCompose = !1, this.redoStack = []
                }
            }, e.prototype.transform = function(e) {
                this.undoStack = n(this.undoStack, e), this.redoStack = n(this.redoStack, e)
            }, e.prototype.performUndo = function(e) {
                if (this.state = r, 0 === this.undoStack.length) throw new Error("undo not possible");
                e(this.undoStack.pop()), this.state = t
            }, e.prototype.performRedo = function(e) {
                if (this.state = i, 0 === this.redoStack.length) throw new Error("redo not possible");
                e(this.redoStack.pop()), this.state = t
            }, e.prototype.canUndo = function() {
                return 0 !== this.undoStack.length
            }, e.prototype.canRedo = function() {
                return 0 !== this.redoStack.length
            }, e.prototype.isUndoing = function() {
                return this.state === r
            }, e.prototype.isRedoing = function() {
                return this.state === i
            }, e
        }(), (D = D || {}).Client = function() {
            "use strict";

            function e() {
                this.state = n
            }

            function t() {}
            e.prototype.setState = function(e) {
                this.state = e
            }, e.prototype.applyClient = function(e) {
                this.setState(this.state.applyClient(this, e))
            }, e.prototype.applyServer = function(e) {
                this.setState(this.state.applyServer(this, e))
            }, e.prototype.serverAck = function() {
                this.setState(this.state.serverAck(this))
            }, e.prototype.serverRetry = function() {
                this.setState(this.state.serverRetry(this))
            }, e.prototype.sendOperation = function(e) {
                throw new Error("sendOperation must be defined in child class")
            }, e.prototype.applyOperation = function(e) {
                throw new Error("applyOperation must be defined in child class")
            }, (e.Synchronized = t).prototype.applyClient = function(e, t) {
                return e.sendOperation(t), new r(t)
            }, t.prototype.applyServer = function(e, t) {
                return e.applyOperation(t), this
            }, t.prototype.serverAck = function(e) {
                throw new Error("There is no pending operation.")
            }, t.prototype.serverRetry = function(e) {
                throw new Error("There is no pending operation.")
            };
            var n = new t;

            function r(e) {
                this.outstanding = e
            }

            function o(e, t) {
                this.outstanding = e, this.buffer = t
            }
            return (e.AwaitingConfirm = r).prototype.applyClient = function(e, t) {
                return new o(this.outstanding, t)
            }, r.prototype.applyServer = function(e, t) {
                var n = t.constructor.transform(this.outstanding, t);
                return e.applyOperation(n[1]), new r(n[0])
            }, r.prototype.serverAck = function(e) {
                return n
            }, r.prototype.serverRetry = function(e) {
                return e.sendOperation(this.outstanding), this
            }, (e.AwaitingWithBuffer = o).prototype.applyClient = function(e, t) {
                var n = this.buffer.compose(t);
                return new o(this.outstanding, n)
            }, o.prototype.applyServer = function(e, t) {
                var n = t.constructor.transform,
                    r = n(this.outstanding, t),
                    i = n(this.buffer, r[1]);
                return e.applyOperation(i[1]), new o(r[0], i[0])
            }, o.prototype.serverRetry = function(e) {
                var t = this.outstanding.compose(this.buffer);
                return e.sendOperation(t), new r(t)
            }, o.prototype.serverAck = function(e) {
                return e.sendOperation(this.buffer), new r(this.buffer)
            }, e
        }(), (D = D || {}).EditorClient = function() {
            "use strict";
            var o = D.Client,
                s = D.Cursor,
                n = D.UndoManager,
                a = D.WrappedOperation;

            function l(e, t) {
                this.cursorBefore = e, this.cursorAfter = t
            }

            function r(e, t) {
                this.id = e, this.editorAdapter = t, this.li = document.createElement("li")
            }

            function e(e, t) {
                o.call(this), this.serverAdapter = e, this.editorAdapter = t, this.undoManager = new n, this.clients = {};
                var i = this;
                this.editorAdapter.registerCallbacks({
                    change: function(e, t) {
                        i.onChange(e, t)
                    },
                    cursorActivity: function() {
                        i.onCursorActivity()
                    },
                    blur: function() {
                        i.onBlur()
                    },
                    focus: function() {
                        i.onFocus()
                    }
                }), this.editorAdapter.registerUndo(function() {
                    i.undo()
                }), this.editorAdapter.registerRedo(function() {
                    i.redo()
                }), this.serverAdapter.registerCallbacks({
                    ack: function() {
                        i.serverAck(), i.focused && i.state instanceof o.Synchronized && (i.updateCursor(), i.sendCursor(i.cursor)), i.emitStatus()
                    },
                    retry: function() {
                        i.serverRetry()
                    },
                    operation: function(e) {
                        i.applyServer(e)
                    },
                    cursor: function(e, t, n) {
                        if (i.serverAdapter.userId_ !== e && i.state instanceof o.Synchronized) {
                            var r = i.getClientObject(e);
                            t ? (n && r.setColor(n), r.updateCursor(s.fromJSON(t))) : r.removeCursor()
                        }
                    }
                })
            }
            return l.prototype.invert = function() {
                    return new l(this.cursorAfter, this.cursorBefore)
                }, l.prototype.compose = function(e) {
                    return new l(this.cursorBefore, e.cursorAfter)
                }, l.prototype.transform = function(e) {
                    return new l(this.cursorBefore ? this.cursorBefore.transform(e) : null, this.cursorAfter ? this.cursorAfter.transform(e) : null)
                }, r.prototype.setColor = function(e) {
                    this.color = e
                }, r.prototype.updateCursor = function(e) {
                    this.removeCursor(), this.cursor = e, this.mark = this.editorAdapter.setOtherCursor(e, this.color, this.id)
                }, r.prototype.removeCursor = function() {
                    this.mark && this.mark.clear()
                },
                function(e, t) {
                    function n() {}
                    n.prototype = t.prototype, e.prototype = new n, e.prototype.constructor = e
                }(e, o), e.prototype.getClientObject = function(e) {
                    var t = this.clients[e];
                    return t || (this.clients[e] = new r(e, this.editorAdapter))
                }, e.prototype.applyUnredo = function(e) {
                    this.undoManager.add(this.editorAdapter.invertOperation(e)), this.editorAdapter.applyOperation(e.wrapped), this.cursor = e.meta.cursorAfter, this.cursor && this.editorAdapter.setCursor(this.cursor), this.applyClient(e.wrapped)
                }, e.prototype.undo = function() {
                    var t = this;
                    this.undoManager.canUndo() && this.undoManager.performUndo(function(e) {
                        t.applyUnredo(e)
                    })
                }, e.prototype.redo = function() {
                    var t = this;
                    this.undoManager.canRedo() && this.undoManager.performRedo(function(e) {
                        t.applyUnredo(e)
                    })
                }, e.prototype.onChange = function(e, t) {
                    var n = this.cursor;
                    this.updateCursor();
                    var r, i = 0 < this.undoManager.undoStack.length && t.shouldBeComposedWithInverted((r = this.undoManager.undoStack, r[r.length - 1]).wrapped),
                        o = new l(this.cursor, n);
                    this.undoManager.add(new a(t, o), i), this.applyClient(e)
                }, e.prototype.updateCursor = function() {
                    this.cursor = this.editorAdapter.getCursor()
                }, e.prototype.onCursorActivity = function() {
                    var e = this.cursor;
                    this.updateCursor(), !this.focused || e && this.cursor.equals(e) || this.sendCursor(this.cursor)
                }, e.prototype.onBlur = function() {
                    this.cursor = null, this.sendCursor(null), this.focused = !1
                }, e.prototype.onFocus = function() {
                    this.focused = !0, this.onCursorActivity()
                }, e.prototype.sendCursor = function(e) {
                    this.state instanceof o.AwaitingWithBuffer || this.serverAdapter.sendCursor(e)
                }, e.prototype.sendOperation = function(e) {
                    this.serverAdapter.sendOperation(e), this.emitStatus()
                }, e.prototype.applyOperation = function(e) {
                    this.editorAdapter.applyOperation(e), this.updateCursor(), this.undoManager.transform(new a(e, null))
                }, e.prototype.emitStatus = function() {
                    var e = this;
                    setTimeout(function() {
                        e.trigger("synced", e.state instanceof o.Synchronized)
                    }, 0)
                }, e
        }(), D.utils.makeEventEmitter(D.EditorClient, ["synced"]);
        var D, n = function(e, t) {
                return function() {
                    return e.apply(t, arguments)
                }
            },
            i = [].slice;
        return null == D && (D = {}), D.ACEAdapter = function() {
            function e(e) {
                var t;
                this.onCursorActivity = n(this.onCursorActivity, this), this.onFocus = n(this.onFocus, this), this.onBlur = n(this.onBlur, this), this.onChange = n(this.onChange, this), this.ace = e, this.aceSession = this.ace.getSession(), this.aceDoc = this.aceSession.getDocument(), this.aceDoc.setNewLineMode("unix"), this.grabDocumentState(), this.ace.on("change", this.onChange), this.ace.on("blur", this.onBlur), this.ace.on("focus", this.onFocus), this.aceSession.selection.on("changeCursor", this.onCursorActivity), null == this.aceRange && (this.aceRange = (null != (t = ace.require) ? t : require)("ace/range").Range)
            }
            return e.prototype.ignoreChanges = !1, e.prototype.grabDocumentState = function() {
                return this.lastDocLines = this.aceDoc.getAllLines(), this.lastCursorRange = this.aceSession.selection.getRange()
            }, e.prototype.detach = function() {
                return this.ace.removeListener("change", this.onChange), this.ace.removeListener("blur", this.onBlur), this.ace.removeListener("focus", this.onCursorActivity), this.aceSession.selection.removeListener("changeCursor", this.onCursorActivity)
            }, e.prototype.onChange = function(e) {
                var t;
                if (!this.ignoreChanges) return t = this.operationFromACEChange(e), this.trigger.apply(this, ["change"].concat(i.call(t))), this.grabDocumentState()
            }, e.prototype.onBlur = function() {
                if (this.ace.selection.isEmpty()) return this.trigger("blur")
            }, e.prototype.onFocus = function() {
                return this.trigger("focus")
            }, e.prototype.onCursorActivity = function() {
                var e = this;
                return setTimeout(function() {
                    return e.trigger("cursorActivity")
                }, 0)
            }, e.prototype.operationFromACEChange = function(e) {
                var t, n, r, i, o, s, a, l, c;
                return t = "insertLines" === (l = (n = e.data).action) || "removeLines" === l ? (a = n.lines.join("\n") + "\n", n.action.replace("Lines", "")) : (a = n.text.replace(this.aceDoc.getNewLineCharacter(), "\n"), n.action.replace("Text", "")), s = this.indexFromPos(n.range.start), o = this.lastDocLines.join("\n").length - s, "remove" === t && (o -= a.length), i = (new D.TextOperation).retain(s).insert(a).retain(o), r = (new D.TextOperation).retain(s).delete(a).retain(o), "remove" === t && (i = (c = [r, i])[0], r = c[1]), [i, r]
            }, e.prototype.applyOperationToACE = function(e) {
                var t, n, r, i, o, s, a, l;
                for (s = n = 0, a = (l = e.ops).length; s < a; s++)(r = l[s]).isRetain() ? n += r.chars : r.isInsert() ? (this.aceDoc.insert(this.posFromIndex(n), r.text), n += r.text.length) : r.isDelete() && (t = this.posFromIndex(n), o = this.posFromIndex(n + r.chars), i = this.aceRange.fromPoints(t, o), this.aceDoc.remove(i));
                return this.grabDocumentState()
            }, e.prototype.posFromIndex = function(e) {
                var t, n, r, i, o;
                for (n = r = 0, i = (o = this.aceDoc.$lines).length; r < i && !(e <= (t = o[n]).length); n = ++r) e -= t.length + 1;
                return {
                    row: n,
                    column: e
                }
            }, e.prototype.indexFromPos = function(e, t) {
                var n, r, i, o;
                for (null == t && (t = this.lastDocLines), n = i = r = 0, o = e.row; 0 <= o ? i < o : o < i; n = 0 <= o ? ++i : --i) r += this.lastDocLines[n].length + 1;
                return r + e.column
            }, e.prototype.getValue = function() {
                return this.aceDoc.getValue()
            }, e.prototype.getCursor = function() {
                var t, n, r, i, e;
                try {
                    r = this.indexFromPos(this.aceSession.selection.getRange().start, this.aceDoc.$lines), n = this.indexFromPos(this.aceSession.selection.getRange().end, this.aceDoc.$lines)
                } catch (e) {
                    e;
                    try {
                        r = this.indexFromPos(this.lastCursorRange.start), n = this.indexFromPos(this.lastCursorRange.end)
                    } catch (e) {
                        t = e, console.log("Couldn't figure out the cursor range:", t, "-- setting it to 0:0."), r = (i = [0, 0])[0], n = i[1]
                    }
                }
                return n < r && (r = (e = [n, r])[0], n = e[1]), new D.Cursor(r, n)
            }, e.prototype.setCursor = function(e) {
                var t, n, r;
                return n = this.posFromIndex(e.position), t = this.posFromIndex(e.selectionEnd), e.position > e.selectionEnd && (n = (r = [t, n])[0], t = r[1]), this.aceSession.selection.setSelectionRange(new this.aceRange(n.row, n.column, t.row, t.column))
            }, e.prototype.setOtherCursor = function(e, t, n) {
                var r, i, o, s, a, l, c, u, h = this;
                return null == this.otherCursors && (this.otherCursors = {}), (o = this.otherCursors[n]) && (o.start.detach(), o.end.detach(), this.aceSession.removeMarker(o.id)), c = this.posFromIndex(e.position), s = this.posFromIndex(e.selectionEnd), e.selectionEnd < e.position && (c = (u = [s, c])[0], s = u[1]), r = "other-client-selection-" + t.replace("#", ""), (a = e.position === e.selectionEnd) && (r = r.replace("selection", "cursor")), i = "." + r + " {\n  position: absolute;\n  background-color: " + (a ? "transparent" : t) + ";\n  border-left: 2px solid " + t + ";\n}", this.addStyleRule(i), this.otherCursors[n] = o = new this.aceRange(c.row, c.column, s.row, s.column), l = this, o.clipRows = function() {
                    var e;
                    return (e = l.aceRange.prototype.clipRows.apply(this, arguments)).isEmpty = function() {
                        return !1
                    }, e
                }, o.start = this.aceDoc.createAnchor(o.start), o.end = this.aceDoc.createAnchor(o.end), o.id = this.aceSession.addMarker(o, r, "text"), {
                    clear: function() {
                        return o.start.detach(), o.end.detach(), h.aceSession.removeMarker(o.id)
                    }
                }
            }, e.prototype.addStyleRule = function(e) {
                var t;
                if ("undefined" != typeof document && null !== document && (this.addedStyleRules || (this.addedStyleRules = {}, t = document.createElement("style"), document.documentElement.getElementsByTagName("head")[0].appendChild(t), this.addedStyleSheet = t.sheet), !this.addedStyleRules[e])) return this.addedStyleRules[e] = !0, this.addedStyleSheet.insertRule(e, 0)
            }, e.prototype.registerCallbacks = function(e) {
                this.callbacks = e
            }, e.prototype.trigger = function() {
                var e, t, n, r;
                return t = arguments[0], e = 2 <= arguments.length ? i.call(arguments, 1) : [], null != (n = this.callbacks) && null != (r = n[t]) ? r.apply(this, e) : void 0
            }, e.prototype.applyOperation = function(e) {
                return e.isNoop() || (this.ignoreChanges = !0), this.applyOperationToACE(e), this.ignoreChanges = !1
            }, e.prototype.registerUndo = function(e) {
                return this.ace.undo = e
            }, e.prototype.registerRedo = function(e) {
                return this.ace.redo = e
            }, e.prototype.invertOperation = function(e) {
                return e.invert(this.getValue())
            }, e
        }(), (D = D || {}).AttributeConstants = {
            BOLD: "b",
            ITALIC: "i",
            UNDERLINE: "u",
            STRIKE: "s",
            FONT: "f",
            FONT_SIZE: "fs",
            COLOR: "c",
            BACKGROUND_COLOR: "bc",
            ENTITY_SENTINEL: "ent",
            LINE_SENTINEL: "l",
            LINE_INDENT: "li",
            LINE_ALIGN: "la",
            LIST_TYPE: "lt"
        }, D.sentinelConstants = {
            LINE_SENTINEL_CHARACTER: "î€€",
            ENTITY_SENTINEL_CHARACTER: "î€"
        }, (D = D || {}).EntityManager = function() {
            var o = D.utils;

            function e() {
                this.entities_ = {};
                var i = ["src", "alt", "width", "height", "style", "class"];
                this.register("img", {
                    render: function(e) {
                        o.assert(e.src, "image entity should have 'src'!");
                        for (var t = ["src", "alt", "width", "height", "style", "class"], n = "<img ", r = 0; r < t.length; r++) {
                            var i = t[r];
                            i in e && (n += " " + i + '="' + e[i] + '"')
                        }
                        return n += ">"
                    },
                    fromElement: function(e) {
                        for (var t = {}, n = 0; n < i.length; n++) {
                            var r = i[n];
                            e.hasAttribute(r) && (t[r] = e.getAttribute(r))
                        }
                        return t
                    }
                })
            }
            return e.prototype.register = function(e, t) {
                D.utils.assert(t.render, "Entity options should include a 'render' function!"), D.utils.assert(t.fromElement, "Entity options should include a 'fromElement' function!"), this.entities_[e] = t
            }, e.prototype.renderToElement = function(e, t) {
                return this.tryRenderToElement_(e, "render", t)
            }, e.prototype.exportToElement = function(e) {
                var t = this.tryRenderToElement_(e, "export") || this.tryRenderToElement_(e, "getHtml") || this.tryRenderToElement_(e, "render");
                return t.setAttribute("data-firepad-entity", e.type), t
            }, e.prototype.updateElement = function(e, t) {
                var n = e.type,
                    r = e.info;
                this.entities_[n] && void 0 !== this.entities_[n].update && this.entities_[n].update(r, t)
            }, e.prototype.fromElement = function(e) {
                var t = e.getAttribute("data-firepad-entity");
                if (t || (t = e.nodeName.toLowerCase()), t && this.entities_[t]) {
                    var n = this.entities_[t].fromElement(e);
                    return new D.Entity(t, n)
                }
            }, e.prototype.tryRenderToElement_ = function(e, t, n) {
                var r = e.type,
                    i = e.info;
                if (this.entities_[r] && this.entities_[r][t]) {
                    var o = D.document || window && window.document,
                        s = this.entities_[r][t](i, n, o);
                    if (s) {
                        if ("string" == typeof s) {
                            var a = (D.document || document).createElement("div");
                            return a.innerHTML = s, a.childNodes[0]
                        }
                        if ("object" == typeof s) return D.utils.assert(void 0 !== s.nodeType, "Error rendering " + r + " entity.  render() function must return an html string or a DOM element."), s
                    }
                }
            }, e.prototype.entitySupportsUpdate = function(e) {
                return this.entities_[e] && this.entities_[e].update
            }, e
        }(), (D = D || {}).Entity = function() {
            var i = D.AttributeConstants.ENTITY_SENTINEL,
                o = i + "_";

            function s(e, t) {
                if (!(this instanceof s)) return new s(e, t);
                this.type = e, this.info = t || {}
            }
            return s.prototype.toAttributes = function() {
                var e = {};
                for (var t in e[i] = this.type, this.info) e[o + t] = this.info[t];
                return e
            }, s.fromAttributes = function(e) {
                var t = e[i],
                    n = {};
                for (var r in e) 0 === r.indexOf(o) && (n[r.substr(o.length)] = e[r]);
                return new s(t, n)
            }, s
        }(), (D = D || {}).RichTextCodeMirror = function() {
            var i = D.AnnotationList,
                g = D.Span,
                o = D.utils,
                f = D.AttributeConstants,
                c = {
                    c: "color",
                    bc: "background-color",
                    fs: "font-size",
                    li: function(e) {
                        return "padding-left: " + 40 * e + "px"
                    }
                },
                u = {};

            function e(e, t, n) {
                this.codeMirror = e, this.options_ = n || {}, this.entityManager_ = t, this.currentAttributes_ = null;
                var r = this;
                this.annotationList_ = new i(function(e, t) {
                    r.onAnnotationsChanged_(e, t)
                }), this.initAnnotationList_(), a(this, "onCodeMirrorBeforeChange_"), a(this, "onCodeMirrorChange_"), a(this, "onCursorActivity_"), /^5\./.test(CodeMirror.version) ? this.codeMirror.on("changes", this.onCodeMirrorChange_) : this.codeMirror.on("change", this.onCodeMirrorChange_), this.codeMirror.on("beforeChange", this.onCodeMirrorBeforeChange_), this.codeMirror.on("cursorActivity", this.onCursorActivity_), this.changeId_ = 0, this.outstandingChanges_ = {}, this.dirtyLines_ = []
            }
            o.makeEventEmitter(e, ["change", "attributesChange", "newLine"]);
            var d = D.sentinelConstants.LINE_SENTINEL_CHARACTER,
                s = D.sentinelConstants.ENTITY_SENTINEL_CHARACTER;

            function n(e, t) {
                return e.line - t.line || e.ch - t.ch
            }

            function h(e, t) {
                return n(e, t) <= 0
            }

            function p(e) {
                if (0 === e.length) return 0;
                for (var t = 0, n = 0; n < e.length; n++) t += e[n].length;
                return t + e.length - 1
            }

            function v(e) {
                this.attributes = e || {}
            }

            function a(e, t) {
                var n = e[t];
                e[t] = function() {
                    n.apply(e, arguments)
                }
            }
            return e.prototype.detach = function() {
                this.codeMirror.off("beforeChange", this.onCodeMirrorBeforeChange_), this.codeMirror.off("change", this.onCodeMirrorChange_), this.codeMirror.off("changes", this.onCodeMirrorChange_), this.codeMirror.off("cursorActivity", this.onCursorActivity_), this.clearAnnotations_()
            }, e.prototype.toggleAttribute = function(e, t) {
                var n = t || !0;
                if (this.emptySelection_()) {
                    var r = this.getCurrentAttributes_();
                    r[e] === n ? delete r[e] : r[e] = n, this.currentAttributes_ = r
                } else {
                    var i = this.getCurrentAttributes_()[e] !== n && n;
                    this.setAttribute(e, i)
                }
            }, e.prototype.setAttribute = function(t, n) {
                var e = this.codeMirror;
                if (this.emptySelection_()) {
                    var r = this.getCurrentAttributes_();
                    !1 === n ? delete r[t] : r[t] = n, this.currentAttributes_ = r
                } else this.updateTextAttributes(e.indexFromPos(e.getCursor("start")), e.indexFromPos(e.getCursor("end")), function(e) {
                    !1 === n ? delete e[t] : e[t] = n
                }), this.updateCurrentAttributes_()
            }, e.prototype.updateTextAttributes = function(e, t, s, a, l) {
                var c = [],
                    u = e,
                    h = this;
                this.annotationList_.updateSpan(new g(e, t - e), function(e, t) {
                    var n = {};
                    for (var r in e.attributes) n[r] = e.attributes[r];
                    n[f.LINE_SENTINEL] && !l || s(n);
                    var i = {},
                        o = {};
                    return h.computeChangedAttributes_(e.attributes, n, i, o),
                        function(e) {
                            for (var t in e) return !1;
                            return !0
                        }(i) || c.push({
                            start: u,
                            end: u + t,
                            attributes: i,
                            attributesInverse: o,
                            origin: a
                        }), u += t, new v(n)
                }), 0 < c.length && this.trigger("attributesChange", this, c)
            }, e.prototype.computeChangedAttributes_ = function(e, t, n, r) {
                var i, o = {};
                for (i in e) o[i] = !0;
                for (i in t) o[i] = !0;
                for (i in o) i in t ? i in e ? e[i] !== t[i] && (n[i] = t[i], r[i] = e[i]) : (n[i] = t[i], r[i] = !1) : (n[i] = !1, r[i] = e[i])
            }, e.prototype.toggleLineAttribute = function(e, t) {
                var n, r = this.getCurrentLineAttributes_();
                n = !(e in r && r[e] === t) && t, this.setLineAttribute(e, n)
            }, e.prototype.setLineAttribute = function(t, n) {
                this.updateLineAttributesForSelection(function(e) {
                    !1 === n ? delete e[t] : e[t] = n
                })
            }, e.prototype.updateLineAttributesForSelection = function(e) {
                var t = this.codeMirror,
                    n = t.getCursor("start"),
                    r = t.getCursor("end"),
                    i = n.line,
                    o = r.line,
                    s = t.getLine(o),
                    a = this.areLineSentinelCharacters_(s.substr(0, r.ch));
                i < o && a && o--, this.updateLineAttributes(i, o, e)
            }, e.prototype.updateLineAttributes = function(e, t, n) {
                for (var r = e; r <= t; r++) {
                    var i = this.codeMirror.getLine(r),
                        o = this.codeMirror.indexFromPos({
                            line: r,
                            ch: 0
                        });
                    if (i[0] !== d) {
                        var s = {};
                        s[f.LINE_SENTINEL] = !0, n(s), this.insertText(o, d, s)
                    } else this.updateTextAttributes(o, o + 1, n, null, !0)
                }
            }, e.prototype.replaceText = function(e, t, n, r, i) {
                this.changeId_++;
                var o = "cmrt-" + this.changeId_;
                this.outstandingChanges_[o] = {
                    origOrigin: i,
                    attributes: r
                };
                var s = this.codeMirror,
                    a = s.posFromIndex(e),
                    l = "number" == typeof t ? s.posFromIndex(t) : null;
                s.replaceRange(n, a, l, o)
            }, e.prototype.insertText = function(e, t, n, r) {
                var i = this.codeMirror,
                    o = i.getCursor(),
                    s = "RTCMADAPTER" == r && !i.somethingSelected() && e == i.indexFromPos(o);
                this.replaceText(e, null, t, n, r), s && i.setCursor(o)
            }, e.prototype.removeText = function(e, t, n) {
                var r = this.codeMirror;
                r.replaceRange("", r.posFromIndex(e), r.posFromIndex(t), n)
            }, e.prototype.insertEntityAtCursor = function(e, t, n) {
                var r = this.codeMirror,
                    i = r.indexFromPos(r.getCursor("head"));
                this.insertEntityAt(i, e, t, n)
            }, e.prototype.insertEntityAt = function(e, t, n, r) {
                this.codeMirror;
                this.insertEntity_(e, new D.Entity(t, n), r)
            }, e.prototype.insertEntity_ = function(e, t, n) {
                this.replaceText(e, null, s, t.toAttributes(), n)
            }, e.prototype.getAttributeSpans = function(e, t) {
                for (var n = [], r = this.annotationList_.getAnnotatedSpansForSpan(new g(e, t - e)), i = 0; i < r.length; i++) n.push({
                    length: r[i].length,
                    attributes: r[i].annotation.attributes
                });
                return n
            }, e.prototype.end = function() {
                var e = this.codeMirror.lineCount() - 1;
                return this.codeMirror.indexFromPos({
                    line: e,
                    ch: this.codeMirror.getLine(e).length
                })
            }, e.prototype.getRange = function(e, t) {
                var n = this.codeMirror.posFromIndex(e),
                    r = this.codeMirror.posFromIndex(t);
                return this.codeMirror.getRange(n, r)
            }, e.prototype.initAnnotationList_ = function() {
                var e = this.end();
                0 !== e && this.annotationList_.insertAnnotatedSpan(new g(0, e), new v)
            }, e.prototype.onAnnotationsChanged_ = function(e, t) {
                var n, r = {};
                this.tryToUpdateEntitiesInPlace(e, t);
                for (var i = 0; i < e.length; i++) {
                    var o = e[i].annotation.attributes;
                    f.LINE_SENTINEL in o && (r[this.codeMirror.posFromIndex(e[i].pos).line] = !0), (n = e[i].getAttachedObject()) && n.clear()
                }
                for (i = 0; i < t.length; i++) {
                    var s = t[i].annotation,
                        a = f.LINE_SENTINEL in s.attributes,
                        l = f.ENTITY_SENTINEL in s.attributes,
                        c = this.codeMirror.posFromIndex(t[i].pos);
                    if (a) r[c.line] = !0;
                    else if (l) this.markEntity_(t[i]);
                    else {
                        var u = this.getClassNameForAttributes_(s.attributes);
                        if ("" !== u) {
                            var h = this.codeMirror.posFromIndex(t[i].pos + t[i].length);
                            n = this.codeMirror.markText(c, h, {
                                className: u
                            }), t[i].attachObject(n)
                        }
                    }
                }
                for (var d in r) this.dirtyLines_.push(this.codeMirror.getLineHandle(Number(d))), this.queueLineMarking_()
            }, e.prototype.tryToUpdateEntitiesInPlace = function(e, t) {
                for (var n = e.length; n--;)
                    for (var r = e[n], i = t.length; i--;) {
                        var o = t[i];
                        if (r.pos == o.pos && r.annotation.attributes.ent && r.annotation.attributes.ent == o.annotation.attributes.ent) {
                            var s = o.annotation.attributes.ent;
                            if (this.entityManager_.entitySupportsUpdate(s)) {
                                e.splice(n, 1), t.splice(i, 1);
                                var a = r.getAttachedObject();
                                a.update(o.annotation.attributes), o.attachObject(a)
                            }
                        }
                    }
            }, e.prototype.queueLineMarking_ = function() {
                if (null == this.lineMarkTimeout_) {
                    var o = this;
                    this.lineMarkTimeout_ = setTimeout(function() {
                        o.lineMarkTimeout_ = null;
                        for (var e = [], t = 0; t < o.dirtyLines_.length; t++) {
                            var n = o.codeMirror.getLineNumber(o.dirtyLines_[t]);
                            e.push(Number(n))
                        }
                        o.dirtyLines_ = [], e.sort(function(e, t) {
                            return e - t
                        });
                        var r = -1;
                        for (t = 0; t < e.length; t++) {
                            var i = e[t];
                            r < i && (r = o.markLineSentinelCharactersForChangedLines_(i, i))
                        }
                    }, 0)
                }
            }, e.prototype.addStyleWithCSS_ = function(e) {
                var t = document.getElementsByTagName("head")[0],
                    n = document.createElement("style");
                n.type = "text/css", n.styleSheet ? n.styleSheet.cssText = e : n.appendChild(document.createTextNode(e)), t.appendChild(n)
            }, e.prototype.getClassNameForAttributes_ = function(e) {
                var t = "";
                for (var n in e) {
                    var r = e[n];
                    if (n === f.LINE_SENTINEL) D.utils.assert(!0 === r, "LINE_SENTINEL attribute should be true if it exists.");
                    else {
                        var i = (this.options_.cssPrefix || "cmrt-") + n;
                        if (!0 !== r) {
                            n === f.FONT_SIZE && "string" != typeof r && (r += "px");
                            var o = r.toString().toLowerCase().replace(/[^a-z0-9-_]/g, "-");
                            if (i += "-" + o, c[n] && (u[n] || (u[n] = {}), !u[n][o])) {
                                u[n][o] = !0;
                                var s = c[n],
                                    a = "function" == typeof s ? s(r) : s + ": " + r,
                                    l = n == f.LINE_INDENT ? "pre." + i : "." + i;
                                this.addStyleWithCSS_(l + " { " + a + " }")
                            }
                        }
                        t = t + " " + i
                    }
                }
                return t
            }, e.prototype.markEntity_ = function(e) {
                for (var t = e.annotation.attributes, n = D.Entity.fromAttributes(t), r = this.codeMirror, i = this, o = [], s = 0; s < e.length; s++) {
                    var a = r.posFromIndex(e.pos + s),
                        l = r.posFromIndex(e.pos + s + 1),
                        c = {
                            collapsed: !0,
                            atomic: !0,
                            inclusiveLeft: !1,
                            inclusiveRight: !1
                        },
                        u = this.createEntityHandle_(n, e.pos),
                        h = this.entityManager_.renderToElement(n, u);
                    h && (c.replacedWith = h);
                    var d = r.markText(a, l, c);
                    o.push(d), u.setMarker(d)
                }
                e.attachObject({
                    clear: function() {
                        for (var e = 0; e < o.length; e++) o[e].clear()
                    },
                    update: function(e) {
                        for (var t = D.Entity.fromAttributes(e), n = 0; n < o.length; n++) i.entityManager_.updateElement(t, o[n].replacedWith)
                    }
                }), this.queueRefresh_()
            }, e.prototype.queueRefresh_ = function() {
                var e = this;
                this.refreshTimer_ || (this.refreshTimer_ = setTimeout(function() {
                    e.codeMirror.refresh(), e.refreshTimer_ = null
                }, 0))
            }, e.prototype.createEntityHandle_ = function(s, t) {
                var n = null,
                    a = this;

                function l() {
                    if (n) {
                        var e = n.find();
                        return e ? a.codeMirror.indexFromPos(e.from) : null
                    }
                    return t
                }
                return {
                    find: l,
                    remove: function() {
                        var e = l();
                        null != e && (a.codeMirror.focus(), a.removeText(e, e + 1))
                    },
                    replace: function(r) {
                        var i = D.AttributeConstants.ENTITY_SENTINEL,
                            o = i + "_",
                            e = l();
                        a.updateTextAttributes(e, e + 1, function(e) {
                            for (var t in e) delete e[t];
                            for (var n in e[i] = s.type, r) e[o + n] = r[n]
                        })
                    },
                    setMarker: function(e) {
                        n = e
                    }
                }
            }, e.prototype.lineClassRemover_ = function(e) {
                var t = this.codeMirror,
                    n = t.getLineHandle(e);
                return {
                    clear: function() {
                        t.removeLineClass(n, "text", ".*")
                    }
                }
            }, e.prototype.emptySelection_ = function() {
                var e = this.codeMirror.getCursor("start"),
                    t = this.codeMirror.getCursor("end");
                return e.line === t.line && e.ch === t.ch
            }, e.prototype.onCodeMirrorBeforeChange_ = function(e, t) {
                if ("+input" === t.origin || "paste" === t.origin) {
                    for (var n = [], r = 0; r < t.text.length; r++) {
                        var i = t.text[r];
                        i = i.replace(new RegExp("[" + d + s + "]", "g"), ""), n.push(i)
                    }
                    t.update(t.from, t.to, n)
                }
            }, e.prototype.onCodeMirrorChange_ = function(e, t) {
                if ("object" == typeof t.from) {
                    for (var n = []; t;) n.push(t), t = t.next;
                    t = n
                }
                for (var r = this.convertCoordinateSystemForChanges_(t), i = [], o = 0; o < r.length; o++) {
                    var s, a = r[o],
                        l = a.start,
                        c = (a.end, a.text),
                        u = a.removed,
                        h = a.origin;
                    if (0 < u.length) {
                        for (var d = this.annotationList_.getAnnotatedSpansForSpan(new g(l, u.length)), f = 0, p = 0; p < d.length; p++) {
                            var m = d[p];
                            i.push({
                                start: l,
                                end: l + m.length,
                                removedAttributes: m.annotation.attributes,
                                removed: u.substr(f, m.length),
                                attributes: {},
                                text: "",
                                origin: a.origin
                            }), f += m.length
                        }
                        this.annotationList_.removeSpan(new g(l, u.length))
                    }
                    if (0 < c.length) "+input" === a.origin || "paste" === a.origin ? s = this.currentAttributes_ || {} : h in this.outstandingChanges_ ? (s = this.outstandingChanges_[h].attributes, h = this.outstandingChanges_[h].origOrigin, delete this.outstandingChanges_[h]) : s = {}, this.annotationList_.insertAnnotatedSpan(new g(l, c.length), new v(s)), i.push({
                        start: l,
                        end: l,
                        removedAttributes: {},
                        removed: "",
                        text: c,
                        attributes: s,
                        origin: h
                    })
                }
                this.markLineSentinelCharactersForChanges_(t), 0 < i.length && this.trigger("change", this, i)
            }, e.prototype.convertCoordinateSystemForChanges_ = function(e) {
                var t = this,
                    n = function(e) {
                        return t.codeMirror.indexFromPos(e)
                    };

                function r(n, r) {
                    return function(e) {
                        return h(e, r.from) ? n(e) : h(r.to, e) ? n({
                            line: e.line + r.text.length - 1 - (r.to.line - r.from.line),
                            ch: r.to.line < e.line ? e.ch : r.text.length <= 1 ? e.ch - (r.to.ch - r.from.ch) + p(r.text) : e.ch - r.to.ch + (t = r.text, t[t.length - 1]).length
                        }) + p(r.removed) - p(r.text) : r.from.line === e.line ? n(r.from) + e.ch - r.from.ch : n(r.from) + p(r.removed.slice(0, e.line - r.from.line)) + 1 + e.ch;
                        var t
                    }
                }
                for (var i = [], o = e.length - 1; 0 <= o; o--) {
                    var s = e[o],
                        a = (n = r(n, s))(s.from),
                        l = s.removed.join("\n"),
                        c = s.text.join("\n");
                    i.unshift({
                        start: a,
                        end: a + l.length,
                        removed: l,
                        text: c,
                        origin: s.origin
                    })
                }
                return i
            }, e.prototype.markLineSentinelCharactersForChanges_ = function(e) {
                for (var t = Number.MAX_VALUE, n = -1, r = 0; r < e.length; r++) {
                    var i = e[r],
                        o = i.from.line;
                    i.from.ch;
                    (1 < i.removed.length || 0 <= i.removed[0].indexOf(d)) && (t = Math.min(t, o), n = Math.max(n, o)), 1 < i.text.length ? (t = Math.min(t, o), n = Math.max(n, o + i.text.length - 1)) : 0 <= i.text[0].indexOf(d) && (t = Math.min(t, o), n = Math.max(n, o))
                }
                n = Math.min(n, this.codeMirror.lineCount() - 1), this.markLineSentinelCharactersForChangedLines_(t, n)
            }, e.prototype.markLineSentinelCharactersForChangedLines_ = function(e, t) {
                if (e < Number.MAX_VALUE)
                    for (; 0 < e && this.lineIsListItemOrIndented_(e - 1);) e--;
                if (-1 < t)
                    for (var n = this.codeMirror.lineCount(); t + 1 < n && this.lineIsListItemOrIndented_(t + 1);) t++;
                for (var r = [], i = this.codeMirror, o = e; o <= t; o++) {
                    var s = i.getLine(o),
                        a = i.getLineHandle(o);
                    if (i.removeLineClass(a, "text", ".*"), 0 < s.length)
                        for (var l = s.indexOf(d); 0 <= l;) {
                            for (var c = l; l < s.length && s[l] === d;) {
                                for (var u = i.findMarksAt({
                                        line: o,
                                        ch: l
                                    }), h = 0; h < u.length; h++) u[h].isForLineSentinel && u[h].clear();
                                l++
                            }
                            this.markLineSentinelCharacters_(o, c, l, r), l = s.indexOf(d, l)
                        } else r = []
                }
                return t
            }, e.prototype.markLineSentinelCharacters_ = function(e, t, n, r) {
                var i = this.codeMirror,
                    o = null,
                    s = null,
                    a = function() {
                        var e = s.find();
                        return e ? e.from.line : null
                    };
                if (0 === t) {
                    var l = this.getLineAttributes_(e),
                        c = l[f.LIST_TYPE],
                        u = l[f.LINE_INDENT] || 0;
                    for (c && 0 === u && (u = 1); u >= r.length;) r.push(1);
                    "o" === c ? (o = this.makeOrderedListElement_(r[u]), r[u]++) : "u" === c ? (o = this.makeUnorderedListElement_(), r[u] = 1) : "t" === c ? (o = this.makeTodoListElement_(!1, a), r[u] = 1) : "tc" === c && (o = this.makeTodoListElement_(!0, a), r[u] = 1);
                    var h = this.getClassNameForAttributes_(l);
                    "" !== h && this.codeMirror.addLineClass(e, "text", h), r = r.slice(0, u + 1)
                }
                var d = {
                    inclusiveLeft: !0,
                    collapsed: !0
                };
                o && (d.replacedWith = o), (s = i.markText({
                    line: e,
                    ch: t
                }, {
                    line: e,
                    ch: n
                }, d)).isForLineSentinel = !0
            }, e.prototype.makeOrderedListElement_ = function(e) {
                return o.elt("div", e + ".", {
                    class: "firepad-list-left"
                })
            }, e.prototype.makeUnorderedListElement_ = function() {
                return o.elt("div", "â€¢", {
                    class: "firepad-list-left"
                })
            }, e.prototype.toggleTodo = function(e) {
                var t, n = f.LIST_TYPE,
                    r = this.getCurrentLineAttributes_();
                n in r && ("t" === r[n] || "tc" === r[n]) ? "t" === r[n] ? t = "tc" : "tc" === r[n] && (t = !!e && "t") : t = "t", this.setLineAttribute(n, t)
            }, e.prototype.makeTodoListElement_ = function(e, t) {
                var n = {
                    type: "checkbox",
                    class: "firepad-todo-left"
                };
                e && (n.checked = !0);
                var r = o.elt("input", !1, n),
                    i = this;
                return o.on(r, "click", o.stopEventAnd(function(e) {
                    i.codeMirror.setCursor({
                        line: t(),
                        ch: 1
                    }), i.toggleTodo(!0)
                })), r
            }, e.prototype.lineIsListItemOrIndented_ = function(e) {
                var t = this.getLineAttributes_(e);
                return !1 !== (t[f.LIST_TYPE] || !1) || 0 !== (t[f.LINE_INDENT] || 0)
            }, e.prototype.onCursorActivity_ = function() {
                var e = this;
                clearTimeout(e.cursorTimeout), e.cursorTimeout = setTimeout(function() {
                    e.updateCurrentAttributes_()
                }, 1)
            }, e.prototype.getCurrentAttributes_ = function() {
                return this.currentAttributes_ || this.updateCurrentAttributes_(), this.currentAttributes_
            }, e.prototype.updateCurrentAttributes_ = function() {
                var e = this.codeMirror,
                    t = e.indexFromPos(e.getCursor("anchor")),
                    n = e.indexFromPos(e.getCursor("head")),
                    r = n;
                if (n < t) {
                    for (; r < this.end();) {
                        var i = this.getRange(r, r + 1);
                        if ("\n" !== i && i !== d) break;
                        r++
                    }
                    r < this.end() && r++
                } else
                    for (; 0 < r && ("\n" === (i = this.getRange(r - 1, r)) || i === d);) r--;
                var o = this.annotationList_.getAnnotatedSpansForPos(r);
                this.currentAttributes_ = {};
                var s = {};
                for (var a in 0 < o.length && !(f.LINE_SENTINEL in o[0].annotation.attributes) ? s = o[0].annotation.attributes : 1 < o.length && (D.utils.assert(!(f.LINE_SENTINEL in o[1].annotation.attributes), "Cursor can't be between two line sentinel characters."), s = o[1].annotation.attributes), s) "l" !== a && "lt" !== a && "li" !== a && 0 !== a.indexOf(f.ENTITY_SENTINEL) && (this.currentAttributes_[a] = s[a])
            }, e.prototype.getCurrentLineAttributes_ = function() {
                var e = this.codeMirror,
                    t = e.getCursor("anchor"),
                    n = e.getCursor("head"),
                    r = n.line;
                return 0 === n.ch && t.line < n.line && r--, this.getLineAttributes_(r)
            }, e.prototype.getLineAttributes_ = function(e) {
                var t = {},
                    n = this.codeMirror.getLine(e);
                if (0 < n.length && n[0] === d) {
                    var r = this.codeMirror.indexFromPos({
                            line: e,
                            ch: 0
                        }),
                        i = this.annotationList_.getAnnotatedSpansForSpan(new g(r, 1));
                    for (var o in D.utils.assert(1 === i.length), i[0].annotation.attributes) t[o] = i[0].annotation.attributes[o]
                }
                return t
            }, e.prototype.clearAnnotations_ = function() {
                this.annotationList_.updateSpan(new g(0, this.end()), function(e, t) {
                    return new v({})
                })
            }, e.prototype.newline = function() {
                var e = this.codeMirror,
                    n = this;
                if (this.emptySelection_()) {
                    var r = e.getCursor("head").line,
                        i = this.getLineAttributes_(r),
                        o = i[f.LIST_TYPE];
                    o && 1 === e.getLine(r).length ? this.updateLineAttributes(r, r, function(e) {
                        delete e[f.LIST_TYPE], delete e[f.LINE_INDENT]
                    }) : (e.replaceSelection("\n", "end", "+input"), this.updateLineAttributes(r + 1, r + 1, function(e) {
                        for (var t in i) e[t] = i[t];
                        "tc" === o && (e[f.LIST_TYPE] = "t"), n.trigger("newLine", {
                            line: r + 1,
                            attr: e
                        })
                    }))
                } else e.replaceSelection("\n", "end", "+input")
            }, e.prototype.deleteLeft = function() {
                var e = this.codeMirror,
                    t = e.getCursor("head"),
                    n = this.getLineAttributes_(t.line),
                    r = n[f.LIST_TYPE],
                    i = n[f.LINE_INDENT],
                    o = this.emptySelection_() && 1 === t.ch;
                o && r ? this.updateLineAttributes(t.line, t.line, function(e) {
                    delete e[f.LIST_TYPE], delete e[f.LINE_INDENT]
                }) : o && i && 0 < i ? this.updateLineAttributes(t.line, t.line, function(e) {
                    e[f.LINE_INDENT]--
                }) : e.deleteH(-1, "char")
            }, e.prototype.deleteRight = function() {
                var e = this.codeMirror,
                    t = e.getCursor("head"),
                    n = e.getLine(t.line),
                    r = this.areLineSentinelCharacters_(n),
                    i = t.line + 1 < e.lineCount() ? e.getLine(t.line + 1) : "";
                this.emptySelection_() && r && i[0] === d ? e.replaceRange("", {
                    line: t.line,
                    ch: 0
                }, {
                    line: t.line + 1,
                    ch: 0
                }, "+input") : e.deleteH(1, "char")
            }, e.prototype.indent = function() {
                this.updateLineAttributesForSelection(function(e) {
                    var t = e[f.LINE_INDENT],
                        n = e[f.LIST_TYPE];
                    t ? e[f.LINE_INDENT]++ : e[f.LINE_INDENT] = n ? 2 : 1
                })
            }, e.prototype.unindent = function() {
                this.updateLineAttributesForSelection(function(e) {
                    var t = e[f.LINE_INDENT];
                    t && 1 < t ? e[f.LINE_INDENT] = t - 1 : (delete e[f.LIST_TYPE], delete e[f.LINE_INDENT])
                })
            }, e.prototype.getText = function() {
                return this.codeMirror.getValue().replace(new RegExp(d, "g"), "")
            }, e.prototype.areLineSentinelCharacters_ = function(e) {
                for (var t = 0; t < e.length; t++)
                    if (e[t] !== d) return !1;
                return !0
            }, v.prototype.equals = function(e) {
                if (!(e instanceof v)) return !1;
                var t;
                for (t in this.attributes)
                    if (e.attributes[t] !== this.attributes[t]) return !1;
                for (t in e.attributes)
                    if (e.attributes[t] !== this.attributes[t]) return !1;
                return !0
            }, e
        }(), (D = D || {}).RichTextCodeMirrorAdapter = function() {
            "use strict";
            var p = D.TextOperation,
                m = D.WrappedOperation,
                s = D.Cursor;

            function r(e) {
                this.rtcm = e, this.cm = e.codeMirror, t(this, "onChange"), t(this, "onAttributesChange"), t(this, "onCursorActivity"), t(this, "onFocus"), t(this, "onBlur"), this.rtcm.on("change", this.onChange), this.rtcm.on("attributesChange", this.onAttributesChange), this.cm.on("cursorActivity", this.onCursorActivity), this.cm.on("focus", this.onFocus), this.cm.on("blur", this.onBlur)
            }

            function a(e, t) {
                return e.line < t.line ? -1 : e.line > t.line ? 1 : e.ch < t.ch ? -1 : e.ch > t.ch ? 1 : 0
            }

            function u(e) {
                var t = e.lineCount() - 1;
                return e.indexFromPos({
                    line: t,
                    ch: e.getLine(t).length
                })
            }

            function h(e, t) {
                if (!e) throw new Error(t || "assertion error")
            }

            function t(e, t) {
                var n = e[t];
                e[t] = function() {
                    n.apply(e, arguments)
                }
            }

            function g(e) {
                for (var t in e) return !1;
                return !0
            }
            return r.prototype.detach = function() {
                this.rtcm.off("change", this.onChange), this.rtcm.off("attributesChange", this.onAttributesChange), this.cm.off("cursorActivity", this.onCursorActivity), this.cm.off("focus", this.onFocus), this.cm.off("blur", this.onBlur)
            }, r.operationFromCodeMirrorChanges = function(e, t) {
                for (var n = u(t), r = (new p).retain(n), i = (new p).retain(n), o = e.length - 1; 0 <= o; o--) {
                    var s = e[o],
                        a = s.start,
                        l = n - a - s.text.length;
                    r = (new p).retain(a).delete(s.removed.length).insert(s.text, s.attributes).retain(l).compose(r), i = i.compose((new p).retain(a).delete(s.text.length).insert(s.removed, s.removedAttributes).retain(l)), n += s.removed.length - s.text.length
                }
                return [r, i]
            }, r.operationFromAttributesChanges = function(e, t) {
                for (var n = u(t), r = new p, i = new p, o = 0, s = 0; s < e.length; s++) {
                    var a = e[s],
                        l = a.start - o;
                    h(0 <= l), r.retain(l), i.retain(l);
                    var c = a.end - a.start;
                    r.retain(c, a.attributes), i.retain(c, a.attributesInverse), o = a.start + c
                }
                return r.retain(n - o), i.retain(n - o), [r, i]
            }, r.applyOperationToCodeMirror = function(e, t) {
                10 < e.ops.length && t.codeMirror.getWrapperElement().setAttribute("style", "display: none");
                for (var n = e.ops, r = 0, i = 0, o = n.length; i < o; i++) {
                    var s = n[i];
                    s.isRetain() ? (g(s.attributes) || t.updateTextAttributes(r, r + s.chars, function(e) {
                        for (var t in s.attributes) !1 === s.attributes[t] ? delete e[t] : e[t] = s.attributes[t]
                    }, "RTCMADAPTER", !0), r += s.chars) : s.isInsert() ? (t.insertText(r, s.text, s.attributes, "RTCMADAPTER"), r += s.text.length) : s.isDelete() && t.removeText(r, r + s.chars, "RTCMADAPTER")
                }
                10 < e.ops.length && (t.codeMirror.getWrapperElement().setAttribute("style", ""), t.codeMirror.refresh())
            }, r.prototype.registerCallbacks = function(e) {
                this.callbacks = e
            }, r.prototype.onChange = function(e, t) {
                if ("RTCMADAPTER" !== t[0].origin) {
                    var n = r.operationFromCodeMirrorChanges(t, this.cm);
                    this.trigger("change", n[0], n[1])
                }
            }, r.prototype.onAttributesChange = function(e, t) {
                if ("RTCMADAPTER" !== t[0].origin) {
                    var n = r.operationFromAttributesChanges(t, this.cm);
                    this.trigger("change", n[0], n[1])
                }
            }, r.prototype.onCursorActivity = function() {
                this.trigger("cursorActivity")
            }, r.prototype.onFocus = function() {
                this.trigger("focus")
            }, r.prototype.onBlur = function() {
                this.cm.somethingSelected() || this.trigger("blur")
            }, r.prototype.getValue = function() {
                return this.cm.getValue()
            }, r.prototype.getCursor = function() {
                var e, t = this.cm,
                    n = t.getCursor(),
                    r = t.indexFromPos(n);
                if (t.somethingSelected()) {
                    var i = t.getCursor(!0),
                        o = 0 === a(n, i) ? t.getCursor(!1) : i;
                    e = t.indexFromPos(o)
                } else e = r;
                return new s(r, e)
            }, r.prototype.setCursor = function(e) {
                this.cm.setSelection(this.cm.posFromIndex(e.position), this.cm.posFromIndex(e.selectionEnd))
            }, r.prototype.addStyleRule = function(e) {
                if ("undefined" != typeof document && null !== document) {
                    if (!this.addedStyleRules) {
                        this.addedStyleRules = {};
                        var t = document.createElement("style");
                        document.documentElement.getElementsByTagName("head")[0].appendChild(t), this.addedStyleSheet = t.sheet
                    }
                    if (!this.addedStyleRules[e]) return this.addedStyleRules[e] = !0, this.addedStyleSheet.insertRule(e, 0)
                }
            }, r.prototype.setOtherCursor = function(e, t, n) {
                var r = this.cm.posFromIndex(e.position);
                if ("string" == typeof t && t.match(/^#[a-fA-F0-9]{3,6}$/)) {
                    var i = this.rtcm.end();
                    if ("object" == typeof e && "number" == typeof e.position && "number" == typeof e.selectionEnd && !(e.position < 0 || e.position > i || e.selectionEnd < 0 || e.selectionEnd > i)) {
                        if (e.position === e.selectionEnd) {
                            var o = this.cm.cursorCoords(r),
                                s = document.createElement("span");
                            return s.className = "other-client", s.style.borderLeftWidth = "2px", s.style.borderLeftStyle = "solid", s.style.borderLeftColor = t, s.style.marginLeft = s.style.marginRight = "-1px", s.style.height = .9 * (o.bottom - o.top) + "px", s.setAttribute("data-clientid", n), s.style.zIndex = 0, this.cm.setBookmark(r, {
                                widget: s,
                                insertLeft: !0
                            })
                        }
                        var a, l, c = "selection-" + t.replace("#", ""),
                            u = "." + c + " { background: " + t + "; }";
                        return this.addStyleRule(u), l = e.selectionEnd > e.position ? (a = r, this.cm.posFromIndex(e.selectionEnd)) : (a = this.cm.posFromIndex(e.selectionEnd), r), this.cm.markText(a, l, {
                            className: c
                        })
                    }
                }
            }, r.prototype.trigger = function(e) {
                var t = Array.prototype.slice.call(arguments, 1),
                    n = this.callbacks && this.callbacks[e];
                n && n.apply(this, t)
            }, r.prototype.applyOperation = function(e) {
                r.applyOperationToCodeMirror(e, this.rtcm)
            }, r.prototype.registerUndo = function(e) {
                this.cm.undo = e
            }, r.prototype.registerRedo = function(e) {
                this.cm.redo = e
            }, r.prototype.invertOperation = function(e) {
                for (var t, n, r = 0, i = this.rtcm.codeMirror, o = new p, s = 0; s < e.wrapped.ops.length; s++) {
                    var a = e.wrapped.ops[s];
                    if (a.isRetain())
                        if (g(a.attributes)) o.retain(a.chars), r += a.chars;
                        else
                            for (t = this.rtcm.getAttributeSpans(r, r + a.chars), n = 0; n < t.length; n++) {
                                var l = {};
                                for (var c in a.attributes) {
                                    var u = a.attributes[c],
                                        h = t[n].attributes[c];
                                    !1 === u ? h && (l[c] = h) : u !== h && (l[c] = h || !1)
                                }
                                o.retain(t[n].length, l), r += t[n].length
                            } else if (a.isInsert()) o.delete(a.text.length);
                            else if (a.isDelete()) {
                        var d = i.getRange(i.posFromIndex(r), i.posFromIndex(r + a.chars));
                        t = this.rtcm.getAttributeSpans(r, r + a.chars);
                        var f = 0;
                        for (n = 0; n < t.length; n++) o.insert(d.substr(f, t[n].length), t[n].attributes), f += t[n].length;
                        r += a.chars
                    }
                }
                return new m(o, e.meta.invert())
            }, r
        }(), (D = D || {}).Formatting = function() {
            var t = D.AttributeConstants;

            function i(e) {
                if (!(this instanceof i)) return new i(e);
                this.attributes = e || {}
            }
            return i.prototype.cloneWithNewAttribute_ = function(e, t) {
                var n = {};
                for (var r in this.attributes) n[r] = this.attributes[r];
                return !1 === t ? delete n[e] : n[e] = t, new i(n)
            }, i.prototype.bold = function(e) {
                return this.cloneWithNewAttribute_(t.BOLD, e)
            }, i.prototype.italic = function(e) {
                return this.cloneWithNewAttribute_(t.ITALIC, e)
            }, i.prototype.underline = function(e) {
                return this.cloneWithNewAttribute_(t.UNDERLINE, e)
            }, i.prototype.strike = function(e) {
                return this.cloneWithNewAttribute_(t.STRIKE, e)
            }, i.prototype.font = function(e) {
                return this.cloneWithNewAttribute_(t.FONT, e)
            }, i.prototype.fontSize = function(e) {
                return this.cloneWithNewAttribute_(t.FONT_SIZE, e)
            }, i.prototype.color = function(e) {
                return this.cloneWithNewAttribute_(t.COLOR, e)
            }, i.prototype.backgroundColor = function(e) {
                return this.cloneWithNewAttribute_(t.BACKGROUND_COLOR, e)
            }, i
        }(), (D = D || {}).Text = function e(t, n) {
            if (!(this instanceof e)) return new e(t, n);
            this.text = t, this.formatting = n || D.Formatting()
        }, (D = D || {}).LineFormatting = function() {
            var t = D.AttributeConstants;

            function i(e) {
                if (!(this instanceof i)) return new i(e);
                this.attributes = e || {}, this.attributes[t.LINE_SENTINEL] = !0
            }
            return i.LIST_TYPE = {
                NONE: !1,
                ORDERED: "o",
                UNORDERED: "u",
                TODO: "t",
                TODOCHECKED: "tc"
            }, i.prototype.cloneWithNewAttribute_ = function(e, t) {
                var n = {};
                for (var r in this.attributes) n[r] = this.attributes[r];
                return !1 === t ? delete n[e] : n[e] = t, new i(n)
            }, i.prototype.indent = function(e) {
                return this.cloneWithNewAttribute_(t.LINE_INDENT, e)
            }, i.prototype.align = function(e) {
                return this.cloneWithNewAttribute_(t.LINE_ALIGN, e)
            }, i.prototype.listItem = function(e) {
                return D.utils.assert(!1 === e || "u" === e || "o" === e || "t" === e || "tc" === e), this.cloneWithNewAttribute_(t.LIST_TYPE, e)
            }, i.prototype.getIndent = function() {
                return this.attributes[t.LINE_INDENT] || 0
            }, i.prototype.getAlign = function() {
                return this.attributes[t.LINE_ALIGN] || 0
            }, i.prototype.getListItem = function() {
                return this.attributes[t.LIST_TYPE] || !1
            }, i
        }(), (D = D || {}).Line = function e(t, n) {
            if (!(this instanceof e)) return new e(t, n);
            "[object Array]" !== Object.prototype.toString.call(t) && (t = void 0 === t ? [] : [t]), this.textPieces = t, this.formatting = n || D.LineFormatting()
        }, (D = D || {}).ParseHtml = function() {
            var c, u = D.LineFormatting.LIST_TYPE;

            function i(e, t, n) {
                this.listType = e || u.UNORDERED, this.lineFormatting = t || D.LineFormatting(), this.textFormatting = n || D.Formatting()
            }

            function o() {
                this.lines = [], this.currentLine = [], this.currentLineListItemType = null
            }
            i.prototype.withTextFormatting = function(e) {
                return new i(this.listType, this.lineFormatting, e)
            }, i.prototype.withLineFormatting = function(e) {
                return new i(this.listType, e, this.textFormatting)
            }, i.prototype.withListType = function(e) {
                return new i(e, this.lineFormatting, this.textFormatting)
            }, i.prototype.withIncreasedIndent = function() {
                var e = this.lineFormatting.indent(this.lineFormatting.getIndent() + 1);
                return new i(this.listType, e, this.textFormatting)
            }, i.prototype.withAlign = function(e) {
                var t = this.lineFormatting.align(e);
                return new i(this.listType, t, this.textFormatting)
            }, o.prototype.newlineIfNonEmpty = function(e) {
                this.cleanLine_(), 0 < this.currentLine.length && this.newline(e)
            }, o.prototype.newlineIfNonEmptyOrListItem = function(e) {
                this.cleanLine_(), (0 < this.currentLine.length || null !== this.currentLineListItemType) && this.newline(e)
            }, o.prototype.newline = function(e) {
                this.cleanLine_();
                var t = e.lineFormatting;
                null !== this.currentLineListItemType && (t = t.listItem(this.currentLineListItemType), this.currentLineListItemType = null), this.lines.push(D.Line(this.currentLine, t)), this.currentLine = []
            }, o.prototype.makeListItem = function(e) {
                this.currentLineListItemType = e
            }, o.prototype.cleanLine_ = function() {
                if (0 < this.currentLine.length) {
                    var e = this.currentLine.length - 1;
                    this.currentLine[0].text = this.currentLine[0].text.replace(/^ +/, ""), this.currentLine[e].text = this.currentLine[e].text.replace(/ +$/g, "");
                    for (var t = 0; t < this.currentLine.length; t++) this.currentLine[t].text = this.currentLine[t].text.replace(/\u00a0/g, " ")
                }
                1 === this.currentLine.length && "" === this.currentLine[0].text && (this.currentLine = [])
            };
            var h = h || {
                ELEMENT_NODE: 1,
                TEXT_NODE: 3
            };

            function s(e, t, n) {
                if (e.nodeType === h.ELEMENT_NODE) {
                    var r = c.fromElement(e);
                    if (r) return void n.currentLine.push(new D.Text(D.sentinelConstants.ENTITY_SENTINEL_CHARACTER, new D.Formatting(r.toAttributes())))
                }
                switch (e.nodeType) {
                    case h.TEXT_NODE:
                        var i = e.nodeValue.replace(/[ \n\t]+/g, " ");
                        n.currentLine.push(D.Text(i, t.textFormatting));
                        break;
                    case h.ELEMENT_NODE:
                        switch (t = function(e, t) {
                            for (var n = e.textFormatting, r = e.lineFormatting, i = t.split(";"), o = 0; o < i.length; o++) {
                                var s = i[o].split(":");
                                if (2 === s.length) {
                                    var a = D.utils.trim(s[0]).toLowerCase(),
                                        l = D.utils.trim(s[1]).toLowerCase();
                                    switch (a) {
                                        case "text-decoration":
                                            var c = 0 <= l.indexOf("underline"),
                                                u = 0 <= l.indexOf("line-through");
                                            n = n.underline(c).strike(u);
                                            break;
                                        case "font-weight":
                                            var h = "bold" === l || 600 <= parseInt(l);
                                            n = n.bold(h);
                                            break;
                                        case "font-style":
                                            var d = "italic" === l || "oblique" === l;
                                            n = n.italic(d);
                                            break;
                                        case "color":
                                            n = n.color(l);
                                            break;
                                        case "background-color":
                                            n = n.backgroundColor(l);
                                            break;
                                        case "text-align":
                                            r = r.align(l);
                                            break;
                                        case "font-size":
                                            var f = null;
                                            D.utils.stringEndsWith(l, ["px", "pt", "%", "em", "xx-small", "x-small", "small", "medium", "large", "x-large", "xx-large", "smaller", "larger"]) ? f = l : parseInt(l) && (f = parseInt(l) + "px"), f && (n = n.fontSize(f));
                                            break;
                                        case "font-family":
                                            var p = D.utils.trim(l.split(",")[0]);
                                            p = (p = p.replace(/['"]/g, "")).replace(/\w\S*/g, function(e) {
                                                return e.charAt(0).toUpperCase() + e.substr(1).toLowerCase()
                                            }), n = n.font(p)
                                    }
                                }
                            }
                            return e.withLineFormatting(r).withTextFormatting(n)
                        }(t, e.getAttribute("style") || ""), e.nodeName.toLowerCase()) {
                            case "div":
                            case "h1":
                            case "h2":
                            case "h3":
                            case "p":
                                n.newlineIfNonEmpty(t), d(e, t, n), n.newlineIfNonEmpty(t);
                                break;
                            case "center":
                                t = t.withAlign("center"), n.newlineIfNonEmpty(t), d(e, t.withAlign("center"), n), n.newlineIfNonEmpty(t);
                                break;
                            case "b":
                            case "strong":
                                d(e, t.withTextFormatting(t.textFormatting.bold(!0)), n);
                                break;
                            case "u":
                                d(e, t.withTextFormatting(t.textFormatting.underline(!0)), n);
                                break;
                            case "i":
                            case "em":
                                d(e, t.withTextFormatting(t.textFormatting.italic(!0)), n);
                                break;
                            case "s":
                                d(e, t.withTextFormatting(t.textFormatting.strike(!0)), n);
                                break;
                            case "font":
                                var o = e.getAttribute("face"),
                                    s = e.getAttribute("color"),
                                    a = parseInt(e.getAttribute("size"));
                                o && (t = t.withTextFormatting(t.textFormatting.font(o))), s && (t = t.withTextFormatting(t.textFormatting.color(s))), a && (t = t.withTextFormatting(t.textFormatting.fontSize(a))), d(e, t, n);
                                break;
                            case "br":
                                n.newline(t);
                                break;
                            case "ul":
                                n.newlineIfNonEmptyOrListItem(t);
                                var l = "firepad-todo" === e.getAttribute("class") ? u.TODO : u.UNORDERED;
                                d(e, t.withListType(l).withIncreasedIndent(), n), n.newlineIfNonEmpty(t);
                                break;
                            case "ol":
                                n.newlineIfNonEmptyOrListItem(t), d(e, t.withListType(u.ORDERED).withIncreasedIndent(), n), n.newlineIfNonEmpty(t);
                                break;
                            case "li":
                                ! function(e, t, n) {
                                    n.newlineIfNonEmptyOrListItem(t);
                                    var r = "firepad-checked" === e.getAttribute("class") ? u.TODOCHECKED : t.listType;
                                    n.makeListItem(r);
                                    var i = n.currentLine;
                                    d(e, t, n), (i === n.currentLine || 0 < n.currentLine.length) && n.newline(t)
                                }(e, t, n);
                                break;
                            case "style":
                                break;
                            default:
                                d(e, t, n)
                        }
                }
            }

            function d(e, t, n) {
                if (e.hasChildNodes())
                    for (var r = 0; r < e.childNodes.length; r++) s(e.childNodes[r], t, n)
            }
            return function(e, t) {
                var n = (D.document || document).createElement("div");
                n.innerHTML = e, c = t;
                var r = new o;
                return s(n, new i, r), r.lines
            }
        }(), (D = D || {}).SerializeHtml = function() {
            var N = D.utils,
                I = D.AttributeConstants,
                O = D.LineFormatting.LIST_TYPE;

            function R(e) {
                return e === O.ORDERED ? "</ol>" : "</ul>"
            }
            return function(e, t) {
                for (var n, r, i, o = "", s = !0, a = [], l = !1, c = !0, u = !0, h = 0, d = e.ops[h], f = !1; d;) {
                    N.assert(d.isInsert());
                    var p = d.attributes;
                    if (s) {
                        s = !1;
                        var m = 0,
                            g = null,
                            v = "left";
                        I.LINE_SENTINEL in p && (m = p[I.LINE_INDENT] || 0, g = p[I.LIST_TYPE] || null, v = p[I.LINE_ALIGN] || "left"), g && (m = m || 1), l ? (o += "</li>", l = !1) : c || (u && (o += "<br/>"), o += "</div>"), c = !1, N.assert(0 <= m, "Indent must not be negative.");
                        for (; a.length > m || m === a.length && null !== g && (r = g, i = a[a.length - 1], !(r === i || r === O.TODO && i === O.TODOCHECKED || r === O.TODOCHECKED && i === O.TODO));) o += R(a.pop());
                        for (; a.length < m;) {
                            var y = g || O.UNORDERED;
                            f = g == O.TODO || g == O.TODOCHECKED || f, o += (n = y) === O.ORDERED ? "<ol>" : n === O.UNORDERED ? "<ul>" : '<ul class="firepad-todo">', a.push(y)
                        }
                        var b = "left" !== v ? ' style="text-align:' + v + '"' : "";
                        if (g) {
                            var x = "";
                            switch (g) {
                                case O.TODOCHECKED:
                                    x = ' class="firepad-checked"';
                                    break;
                                case O.TODO:
                                    x = ' class="firepad-unchecked"'
                            }
                            o += "<li" + x + b + ">", l = !0
                        } else o += "<div" + b + ">";
                        u = !0
                    }
                    if (I.LINE_SENTINEL in p) d = e.ops[++h];
                    else if (I.ENTITY_SENTINEL in p) {
                        for (var w = 0; w < d.text.length; w++) {
                            var k = D.Entity.fromAttributes(p);
                            o += t.exportToElement(k).outerHTML
                        }
                        d = e.ops[++h]
                    } else {
                        var _ = "",
                            C = "";
                        for (var S in p) {
                            var T, M, A = p[S];
                            S === I.BOLD || S === I.ITALIC || S === I.UNDERLINE || S === I.STRIKE ? (N.assert(!0 === A), T = M = S) : S === I.FONT_SIZE ? (T = 'span style="font-size: ' + A, T += "string" != typeof A || -1 === A.indexOf("px", A.length - 2) ? 'px"' : '"', M = "span") : S === I.FONT ? (T = 'span style="font-family: ' + A + '"', M = "span") : S === I.COLOR ? (T = 'span style="color: ' + A + '"', M = "span") : S === I.BACKGROUND_COLOR ? (T = 'span style="background-color: ' + A + '"', M = "span") : N.log(!1, "Encountered unknown attribute while rendering html: " + S), T && (_ += "<" + T + ">"), M && (C = "</" + M + ">" + C)
                        }
                        var L = d.text,
                            E = L.indexOf("\n");
                        0 <= E ? (s = !0, d = E < L.length - 1 ? new D.TextOp("insert", L.substr(E + 1), p) : e.ops[++h], L = L.substr(0, E)) : d = e.ops[++h], 0 < (L = L.replace(/  +/g, function(e) {
                            return new Array(e.length + 1).join("Â ")
                        }).replace(/^ /, "Â ").replace(/ $/, "Â ")).length && (u = !1), o += _ + L.replace(/&/g, "&amp;").replace(/"/g, "&quot;").replace(/'/g, "&#39;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\u00a0/g, "&nbsp;") + C
                    }
                }
                for (l ? o += "</li>" : c || (u && (o += "&nbsp;"), o += "</div>"); 0 < a.length;) o += R(a.pop());
                return f && (o = '<style>ul.firepad-todo { list-style: none; margin-left: 0; padding-left: 0; } ul.firepad-todo > li { padding-left: 1em; text-indent: -1em; } ul.firepad-todo > li:before { content: "\\2610"; padding-right: 5px; } ul.firepad-todo > li.firepad-checked:before { content: "\\2611"; padding-right: 5px; }</style>\n' + o), o
            }
        }(), (D = D || {}).textPiecesToInserts = function(n, e) {
            var r = [];

            function i(e, t) {
                e instanceof D.Text && (t = e.formatting.attributes, e = e.text), r.push({
                    string: e,
                    attributes: t
                }), n = "\n" === e[e.length - 1]
            }

            function t(e) {
                n && i(D.sentinelConstants.LINE_SENTINEL_CHARACTER, e.formatting.attributes);
                for (var t = 0; t < e.textPieces.length; t++) i(e.textPieces[t]);
                i("\n")
            }
            for (var o = 0; o < e.length; o++) e[o] instanceof D.Line ? t(e[o]) : i(e[o]);
            return r
        }, (D = D || {}).Headless = function() {
            var a = D.TextOperation,
                t = D.FirebaseAdapter,
                n = D.EntityManager,
                l = D.ParseHtml;

            function r(e) {
                if (!(this instanceof r)) return new r(e);
                this.adapter = new t(e), this.ready = !1, this.entityManager = new n
            }
            return r.prototype.getDocument = function(e) {
                var t = this;
                if (t.ready) return e(t.adapter.getDocument());
                t.adapter.on("ready", function() {
                    t.ready = !0, e(t.adapter.getDocument())
                })
            }, r.prototype.getText = function(n) {
                this.getDocument(function(e) {
                    var t = e.apply("");
                    for (key in D.sentinelConstants) t = t.replace(new RegExp(D.sentinelConstants[key], "g"), "");
                    n(t)
                })
            }, r.prototype.setText = function(e, t) {
                var n = a().insert(e);
                this.sendOperationWithRetry(n, t)
            }, r.prototype.initializeFakeDom = function(n) {
                "object" == typeof document || "object" == typeof D.document ? n() : require("jsdom").env("<head></head><body></body>", function(e, t) {
                    if (D.document) return t.close(), n();
                    D.document = t.document, n()
                })
            }, r.prototype.getHtml = function(t) {
                var e = this;
                e.initializeFakeDom(function() {
                    e.getDocument(function(e) {
                        t(D.SerializeHtml(e, this.entityManager))
                    })
                })
            }, r.prototype.setHtml = function(i, o) {
                var s = this;
                s.initializeFakeDom(function() {
                    for (var e = l(i, s.entityManager), t = D.textPiecesToInserts(!0, e), n = new a, r = 0; r < t.length; r++) n.insert(t[r].string, t[r].attributes);
                    s.sendOperationWithRetry(n, o)
                })
            }, r.prototype.sendOperationWithRetry = function(n, r) {
                var i = this;
                i.getDocument(function(e) {
                    var t = n.clone().delete(e.targetLength);
                    i.adapter.sendOperation(t, function(e, t) {
                        t ? void 0 !== r && r(null, t) : i.sendOperationWithRetry(n, r)
                    })
                })
            }, r
        }(), (D = D || {}).Firepad = function(e) {
            if (!D.RichTextCodeMirrorAdapter) throw new Error("Oops! It looks like you're trying to include lib/firepad.js directly.  This is actually one of many source files that make up firepad.  You want dist/firepad.js instead.");
            var l = D.RichTextCodeMirrorAdapter,
                c = D.RichTextCodeMirror,
                t = D.RichTextToolbar,
                u = D.ACEAdapter,
                h = D.FirebaseAdapter,
                d = D.EditorClient,
                f = D.EntityManager,
                n = D.AttributeConstants,
                p = D.utils,
                m = (D.LineFormatting.LIST_TYPE, e.CodeMirror),
                g = e.ace;

            function v(e, t, n) {
                if (!(this instanceof v)) return new v(e, t, n);
                if (!m && !g) throw new Error("Couldn't find CodeMirror or ACE.  Did you forget to include codemirror.js or ace.js?");
                if (m && t instanceof m) {
                    this.codeMirror_ = this.editor_ = t;
                    var r = this.codeMirror_.getValue();
                    if ("" !== r) throw new Error("Can't initialize Firepad with a CodeMirror instance that already contains text.")
                } else if (g && t && t.session instanceof g.EditSession) {
                    if (this.ace_ = this.editor_ = t, "" !== (r = this.ace_.getValue())) throw new Error("Can't initialize Firepad with an ACE instance that already contains text.")
                } else this.codeMirror_ = this.editor_ = new m(t);
                var i = this.codeMirror_ ? this.codeMirror_.getWrapperElement() : this.ace_.container;
                this.firepadWrapper_ = p.elt("div", null, {
                    class: "firepad"
                }), i.parentNode.replaceChild(this.firepadWrapper_, i), this.firepadWrapper_.appendChild(i), p.on(i, "dragstart", p.stopEvent), (this.editor_.firepad = this).options_ = n || {}, this.getOption("richTextShortcuts", !1) && (m.keyMap.richtext || this.initializeKeyMap_(), this.codeMirror_.setOption("keyMap", "richtext"), this.firepadWrapper_.className += " firepad-richtext"), this.imageInsertionUI = this.getOption("imageInsertionUI", !0), this.getOption("richTextToolbar", !1) && (this.addToolbar_(), this.firepadWrapper_.className += " firepad-richtext firepad-with-toolbar"), this.addPoweredByLogo_(), this.codeMirror_ && this.codeMirror_.refresh();
                var o = this.getOption("userId", e.push().key),
                    s = this.getOption("userColor", function(e) {
                        for (var t = 1, n = 0; n < e.length; n++) t = 17 * (t + e.charCodeAt(n)) % 360;
                        return function(e, t, n) {
                            if (0 === t) return y(n, n, n);
                            var r = n < .5 ? n * (1 + t) : n + t - t * n,
                                i = 2 * n - r,
                                o = function(e) {
                                    return e < 0 && (e += 1), 1 < e && (e -= 1), 6 * e < 1 ? i + 6 * (r - i) * e : 2 * e < 1 ? r : 3 * e < 2 ? i + 6 * (r - i) * (2 / 3 - e) : i
                                };
                            return y(o(e + 1 / 3), o(e), o(e - 1 / 3))
                        }(t / 360, 1, .85)
                    }(o));
                this.entityManager_ = new f, this.firebaseAdapter_ = new h(e, o, s), this.codeMirror_ ? (this.richTextCodeMirror_ = new c(this.codeMirror_, this.entityManager_, {
                    cssPrefix: "firepad-"
                }), this.editorAdapter_ = new l(this.richTextCodeMirror_)) : this.editorAdapter_ = new u(this.ace_), this.client_ = new d(this.firebaseAdapter_, this.editorAdapter_);
                var a = this;
                this.firebaseAdapter_.on("cursor", function() {
                    a.trigger.apply(a, ["cursor"].concat([].slice.call(arguments)))
                }), this.codeMirror_ && this.richTextCodeMirror_.on("newLine", function() {
                    a.trigger.apply(a, ["newLine"].concat([].slice.call(arguments)))
                }), this.firebaseAdapter_.on("ready", function() {
                    a.ready_ = !0, this.ace_ && this.editorAdapter_.grabDocumentState();
                    var e = a.getOption("defaultText", null);
                    e && a.isHistoryEmpty() && a.setText(e), a.trigger("ready")
                }), this.client_.on("synced", function(e) {
                    a.trigger("synced", e)
                }), "Microsoft Internet Explorer" == navigator.appName && navigator.userAgent.match(/MSIE 8\./) && (window.onload = function() {
                    var e = document.getElementsByTagName("head")[0],
                        t = document.createElement("style");
                    t.type = "text/css", t.styleSheet.cssText = ":before,:after{content:none !important;}", e.appendChild(t), setTimeout(function() {
                        e.removeChild(t)
                    }, 0)
                })
            }

            function y(e, t, n) {
                function r(e) {
                    var t = Math.round(255 * e).toString(16);
                    return 1 === t.length ? "0" + t : t
                }
                return "#" + r(e) + r(t) + r(n)
            }
            return p.makeEventEmitter(v), ((v.fromCodeMirror = v).fromACE = v).prototype.dispose = function() {
                this.zombie_ = !0;
                var e = this.codeMirror_ ? this.codeMirror_.getWrapperElement() : this.ace_.container;
                this.firepadWrapper_.removeChild(e), this.firepadWrapper_.parentNode.replaceChild(e, this.firepadWrapper_), this.editor_.firepad = null, this.codeMirror_ && "richtext" === this.codeMirror_.getOption("keyMap") && this.codeMirror_.setOption("keyMap", "default"), this.firebaseAdapter_.dispose(), this.editorAdapter_.detach(), this.richTextCodeMirror_ && this.richTextCodeMirror_.detach()
            }, v.prototype.setReadOnly = function(e) {
                this.firebaseAdapter_.setReadOnly(e)
            }, v.prototype.setUserId = function(e) {
                this.firebaseAdapter_.setUserId(e)
            }, v.prototype.setUserColor = function(e) {
                this.firebaseAdapter_.setColor(e)
            }, v.prototype.getText = function() {
                return this.assertReady_("getText"), this.codeMirror_ ? this.richTextCodeMirror_.getText() : this.ace_.getSession().getDocument().getValue()
            }, v.prototype.setText = function(e) {
                if (this.ace_) return this.ace_.getSession().getDocument().setValue(e);
                this.codeMirror_.getWrapperElement().setAttribute("style", "display: none"), this.codeMirror_.setValue(""), this.insertText(0, e), this.codeMirror_.getWrapperElement().setAttribute("style", ""), this.codeMirror_.refresh()
            }, v.prototype.insertTextAtCursor = function(e) {
                this.insertText(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()), e)
            }, v.prototype.insertText = function(e, t) {
                p.assert(!this.ace_, "Not supported for ace yet."), this.assertReady_("insertText"), "[object Array]" !== Object.prototype.toString.call(t) && (t = [t]);
                for (var n = 0 === e, r = D.textPiecesToInserts(n, t), i = 0; i < r.length; i++) {
                    var o = r[i].string,
                        s = r[i].attributes;
                    this.richTextCodeMirror_.insertText(e, o, s), e += o.length
                }
            }, v.prototype.getOperationForSpan = function(e, t) {
                for (var n = this.richTextCodeMirror_.getRange(e, t), r = this.richTextCodeMirror_.getAttributeSpans(e, t), i = 0, o = new D.TextOperation, s = 0; s < r.length; s++) o.insert(n.substr(i, r[s].length), r[s].attributes), i += r[s].length;
                return o
            }, v.prototype.getHtml = function() {
                return this.getHtmlFromRange(null, null)
            }, v.prototype.getHtmlFromSelection = function() {
                var e = this.codeMirror_.getCursor("start"),
                    t = this.codeMirror_.getCursor("end"),
                    n = this.codeMirror_.indexFromPos(e),
                    r = this.codeMirror_.indexFromPos(t);
                return this.getHtmlFromRange(n, r)
            }, v.prototype.getHtmlFromRange = function(e, t) {
                var n = null != e && null != t ? this.getOperationForSpan(e, t) : this.getOperationForSpan(0, this.codeMirror_.getValue().length);
                return D.SerializeHtml(n, this.entityManager_)
            }, v.prototype.insertHtml = function(e, t) {
                var n = D.ParseHtml(t, this.entityManager_);
                this.insertText(e, n)
            }, v.prototype.insertHtmlAtCursor = function(e) {
                this.insertHtml(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()), e)
            }, v.prototype.setHtml = function(e) {
                var t = D.ParseHtml(e, this.entityManager_);
                this.setText(t)
            }, v.prototype.isHistoryEmpty = function() {
                return this.assertReady_("isHistoryEmpty"), this.firebaseAdapter_.isHistoryEmpty()
            }, v.prototype.bold = function() {
                this.richTextCodeMirror_.toggleAttribute(n.BOLD), this.codeMirror_.focus()
            }, v.prototype.italic = function() {
                this.richTextCodeMirror_.toggleAttribute(n.ITALIC), this.codeMirror_.focus()
            }, v.prototype.underline = function() {
                this.richTextCodeMirror_.toggleAttribute(n.UNDERLINE), this.codeMirror_.focus()
            }, v.prototype.strike = function() {
                this.richTextCodeMirror_.toggleAttribute(n.STRIKE), this.codeMirror_.focus()
            }, v.prototype.fontSize = function(e) {
                this.richTextCodeMirror_.setAttribute(n.FONT_SIZE, e), this.codeMirror_.focus()
            }, v.prototype.font = function(e) {
                this.richTextCodeMirror_.setAttribute(n.FONT, e), this.codeMirror_.focus()
            }, v.prototype.color = function(e) {
                this.richTextCodeMirror_.setAttribute(n.COLOR, e), this.codeMirror_.focus()
            }, v.prototype.highlight = function() {
                this.richTextCodeMirror_.toggleAttribute(n.BACKGROUND_COLOR, "rgba(255,255,0,.65)"), this.codeMirror_.focus()
            }, v.prototype.align = function(e) {
                if ("left" !== e && "center" !== e && "right" !== e) throw new Error('align() must be passed "left", "center", or "right".');
                this.richTextCodeMirror_.setLineAttribute(n.LINE_ALIGN, e), this.codeMirror_.focus()
            }, v.prototype.orderedList = function() {
                this.richTextCodeMirror_.toggleLineAttribute(n.LIST_TYPE, "o"), this.codeMirror_.focus()
            }, v.prototype.unorderedList = function() {
                this.richTextCodeMirror_.toggleLineAttribute(n.LIST_TYPE, "u"), this.codeMirror_.focus()
            }, v.prototype.todo = function() {
                this.richTextCodeMirror_.toggleTodo(), this.codeMirror_.focus()
            }, v.prototype.newline = function() {
                this.richTextCodeMirror_.newline()
            }, v.prototype.deleteLeft = function() {
                this.richTextCodeMirror_.deleteLeft()
            }, v.prototype.deleteRight = function() {
                this.richTextCodeMirror_.deleteRight()
            }, v.prototype.indent = function() {
                this.richTextCodeMirror_.indent(), this.codeMirror_.focus()
            }, v.prototype.unindent = function() {
                this.richTextCodeMirror_.unindent(), this.codeMirror_.focus()
            }, v.prototype.undo = function() {
                this.codeMirror_.undo()
            }, v.prototype.redo = function() {
                this.codeMirror_.redo()
            }, v.prototype.insertEntity = function(e, t, n) {
                this.richTextCodeMirror_.insertEntityAtCursor(e, t, n)
            }, v.prototype.insertEntityAt = function(e, t, n, r) {
                this.richTextCodeMirror_.insertEntityAt(e, t, n, r)
            }, v.prototype.registerEntity = function(e, t) {
                this.entityManager_.register(e, t)
            }, v.prototype.getOption = function(e, t) {
                return e in this.options_ ? this.options_[e] : t
            }, v.prototype.assertReady_ = function(e) {
                if (!this.ready_) throw new Error('You must wait for the "ready" event before calling ' + e + ".");
                if (this.zombie_) throw new Error("You can't use a Firepad after calling dispose()!")
            }, v.prototype.makeImageDialog_ = function() {
                this.makeDialog_("img", "Insert image url")
            }, v.prototype.makeDialog_ = function(n, e) {
                var r = this,
                    t = p.elt("input", null, {
                        class: "firepad-dialog-input",
                        id: n,
                        type: "text",
                        placeholder: e,
                        autofocus: "autofocus"
                    }),
                    i = p.elt("a", "Submit", {
                        class: "firepad-btn",
                        id: "submitbtn"
                    });
                p.on(i, "click", p.stopEventAnd(function() {
                    var e = document.getElementById("overlay");
                    e.style.visibility = "hidden";
                    var t = document.getElementById(n).value;
                    null !== t && r.insertEntity(n, {
                        src: t
                    }), r.firepadWrapper_.removeChild(e)
                }));
                var o = p.elt("a", "Cancel", {
                    class: "firepad-btn"
                });
                p.on(o, "click", p.stopEventAnd(function() {
                    var e = document.getElementById("overlay");
                    e.style.visibility = "hidden", r.firepadWrapper_.removeChild(e)
                }));
                var s = p.elt("div", [i, o], {
                        class: "firepad-btn-group"
                    }),
                    a = p.elt("div", [t, s], {
                        class: "firepad-dialog-div"
                    }),
                    l = p.elt("div", [a], {
                        class: "firepad-dialog",
                        id: "overlay"
                    });
                this.firepadWrapper_.appendChild(l)
            }, v.prototype.addToolbar_ = function() {
                this.toolbar = new t(this.imageInsertionUI), this.toolbar.on("undo", this.undo, this), this.toolbar.on("redo", this.redo, this), this.toolbar.on("bold", this.bold, this), this.toolbar.on("italic", this.italic, this), this.toolbar.on("underline", this.underline, this), this.toolbar.on("strike", this.strike, this), this.toolbar.on("font-size", this.fontSize, this), this.toolbar.on("font", this.font, this), this.toolbar.on("color", this.color, this), this.toolbar.on("left", function() {
                    this.align("left")
                }, this), this.toolbar.on("center", function() {
                    this.align("center")
                }, this), this.toolbar.on("right", function() {
                    this.align("right")
                }, this), this.toolbar.on("ordered-list", this.orderedList, this), this.toolbar.on("unordered-list", this.unorderedList, this), this.toolbar.on("todo-list", this.todo, this), this.toolbar.on("indent-increase", this.indent, this), this.toolbar.on("indent-decrease", this.unindent, this), this.toolbar.on("insert-image", this.makeImageDialog_, this), this.firepadWrapper_.insertBefore(this.toolbar.element(), this.firepadWrapper_.firstChild)
            }, v.prototype.addPoweredByLogo_ = function() {
                var e = p.elt("span", null, {
                    class: "partner-logo"
                });
                this.firepadWrapper_.appendChild(e)
            }, v.prototype.initializeKeyMap_ = function() {
                function e(t) {
                    return function(e) {
                        setTimeout(function() {
                            t.call(e.firepad)
                        }, 0)
                    }
                }
                m.keyMap.richtext = {
                    "Ctrl-B": e(this.bold),
                    "Cmd-B": e(this.bold),
                    "Ctrl-I": e(this.italic),
                    "Cmd-I": e(this.italic),
                    "Ctrl-U": e(this.underline),
                    "Cmd-U": e(this.underline),
                    "Ctrl-H": e(this.highlight),
                    "Cmd-H": e(this.highlight),
                    Enter: e(this.newline),
                    Delete: e(this.deleteRight),
                    Backspace: e(this.deleteLeft),
                    Tab: e(this.indent),
                    "Shift-Tab": e(this.unindent),
                    fallthrough: ["default"]
                }
            }, v
        }(this), D.Firepad.Formatting = D.Formatting, D.Firepad.Text = D.Text, D.Firepad.Entity = D.Entity, D.Firepad.LineFormatting = D.LineFormatting, D.Firepad.Line = D.Line, D.Firepad.TextOperation = D.TextOperation, D.Firepad.Headless = D.Headless, D.Firepad.RichTextCodeMirrorAdapter = D.RichTextCodeMirrorAdapter, D.Firepad.ACEAdapter = D.ACEAdapter, (firepad_ = D).Firepad
    }, this),
    function(u, n, e) {
        e.documentElement.className = e.documentElement.className + " dk_fouc";
        var t = {},
            h = [],
            d = 38,
            f = 40,
            p = 13,
            m = ['<div class="dk_container {{ classname }}" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">', '<a class="dk_toggle">', '<span class="dk_label">{{ label }}</span>', '<span class="select-icon"></span>', "</a>", '<div class="dk_options">', '<ul class="dk_options_inner">', "</ul>", "</div>", "</div>"].join(""),
            r = {
                startSpeed: 100,
                theme: !1,
                change: !1
            };

        function g(e, t, n) {
            var r, i, o;
            r = e.attr("data-dk-dropdown-value"), i = e.text(), o = t.data("dropkick"), $select = o.$select, $select.val(r), t.find(".dk_label").text(i), n = n || !1, o.settings.change && !n && o.settings.change.call($select, r, i)
        }

        function v(e, t) {
            var n, r, i;
            t.find(".dk_option_current").removeClass("dk_option_current"), e.addClass("dk_option_current"), n = t, i = (r = e).prevAll("li").outerHeight() * r.prevAll("li").length, n.find(".dk_options_inner").animate({
                scrollTop: i + "px"
            }, 0)
        }

        function y(e) {
            e.removeClass("dk_open")
        }

        function b(e) {
            e.data("dropkick");
            e.find(".dk_options").css({
                top: e.find(".dk_toggle").outerHeight() - 1
            }), e.toggleClass("dk_open")
        }

        function x(e) {
            return 0 < u.trim(e).length && e
        }
        t.init = function(c) {
            return c = u.extend({}, r, c), this.each(function() {
                var e, t = u(this),
                    n = t.find(":selected").first(),
                    r = t.find("option"),
                    i = t.data("dropkick") || {},
                    o = t.attr("id") || t.attr("name"),
                    s = (c.width || t.outerWidth(), t.attr("tabindex") ? t.attr("tabindex") : ""),
                    a = t.attr("class") ? t.attr("class") : "",
                    l = !1;
                if (i.id) return t;
                i.settings = c, i.tabindex = s, i.classname = a, i.id = o, i.$original = n, i.$select = t, i.value = x(t.val()) || x(n.attr("value")), i.label = n.text(), i.options = r, (l = function(e, t) {
                    var n, r = e,
                        i = [];
                    if (r = (r = (r = (r = r.replace("{{ id }}", t.id)).replace("{{ label }}", t.label)).replace("{{ tabindex }}", t.tabindex)).replace("{{ classname }}", t.classname), t.options && t.options.length)
                        for (var o = 0, s = t.options.length; o < s; o++) {
                            var a = u(t.options[o]),
                                l = '<li class="{{ current }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>';
                            l = (l = (l = l.replace("{{ value }}", a.val())).replace("{{ current }}", x(a.val()) === t.value ? "dk_option_current" : "")).replace("{{ text }}", a.text()), i[i.length] = l
                        }
                    return (n = u(r)).find(".dk_options_inner").html(i.join("")), n
                }(m, i)).find(".dk_toggle").css({}), t.before(l), l = u("#dk_container_" + o).addClass("dk_shown"), e = c.theme ? c.theme : "default", l.addClass("dk_theme_" + e), i.theme = e, i.$dk = l, t.data("dropkick", i), l.data("dropkick", i), h[h.length] = t, l.bind("focus.dropkick", function(e) {
                    l.addClass("dk_focus")
                }).bind("blur.dropkick", function(e) {
                    l.removeClass("dk_open dk_focus")
                }), setTimeout(function() {
                    t.hide()
                }, 0)
            })
        }, t.theme = function(e) {
            var t = u(this).data("dropkick"),
                n = t.$dk,
                r = "dk_theme_" + t.theme;
            n.removeClass(r).addClass("dk_theme_" + e), t.theme = e
        }, t.reset = function() {
            for (var e = 0, t = h.length; e < t; e++) {
                var n = h[e].data("dropkick"),
                    r = n.$dk,
                    i = r.find("li").first();
                r.find(".dk_label").text(n.label), r.find(".dk_options_inner").animate({
                    scrollTop: 0
                }, 0), v(i, r), g(i, r, !0)
            }
        }, u.fn.dropkick = function(e) {
            return t[e] ? t[e].apply(this, Array.prototype.slice.call(arguments, 1)) : "object" != typeof e && e ? void 0 : t.init.apply(this, arguments)
        }, u(function() {
            u(e).on("click", ".dk_toggle", function(e) {
                var t = u(this).parents(".dk_container").first();
                return b(t), "ontouchstart" in n && (t.addClass("dk_touch"), t.find(".dk_options_inner").addClass("scrollable vertical")), e.preventDefault(), !1
            }), u(e).on("click", ".dk_options a", function(e) {
                var t = u(this),
                    n = t.parents(".dk_container").first();
                n.data("dropkick");
                return y(n), g(t, n), v(t.parent(), n), e.preventDefault(), !1
            }), u(e).bind("keydown.dk_nav", function(e) {
                var t = u(".dk_container.dk_open"),
                    n = u(".dk_container.dk_focus"),
                    r = null;
                t.length ? r = t : n.length && !t.length && (r = n), r && function(e, t) {
                    var n, r, i = e.keyCode,
                        o = (t.data("dropkick"), t.find(".dk_options")),
                        s = t.hasClass("dk_open"),
                        a = t.find(".dk_option_current"),
                        l = o.find("li").first(),
                        c = o.find("li").last();
                    switch (i) {
                        case p:
                            s ? (g(a.find("a"), t), y(t)) : b(t), e.preventDefault();
                            break;
                        case d:
                            r = a.prev("li"), s ? r.length ? v(r, t) : v(c, t) : b(t), e.preventDefault();
                            break;
                        case f:
                            s ? (n = a.next("li").first()).length ? v(n, t) : v(l, t) : b(t), e.preventDefault()
                    }
                }(e, r)
            })
        })
    }(jQuery, window, document),
    function() {
        function e(e, t, n) {
            e.addEventListener ? e.addEventListener(t, n, !1) : e.attachEvent("on" + t, n)
        }

        function h(e) {
            if ("keypress" != e.type) return o[e.which] ? o[e.which] : n[e.which] ? n[e.which] : String.fromCharCode(e.which).toLowerCase();
            var t = String.fromCharCode(e.which);
            return e.shiftKey || (t = t.toLowerCase()), t
        }

        function d(e, t) {
            e = e || {};
            var n, r = !1;
            for (n in _) e[n] && _[n] > t ? r = !0 : _[n] = 0;
            r || (S = !1)
        }

        function f(e, t, n, r, i) {
            var o, s, a = [],
                l = n.type;
            if (!w[e]) return [];
            for ("keyup" == l && m(e) && (t = [e]), o = 0; o < w[e].length; ++o)(s = w[e][o]).seq && _[s.seq] != s.level || l != s.action || ("keypress" != l || n.metaKey || n.ctrlKey) && t.sort().join(",") !== s.modifiers.sort().join(",") || (r && s.combo == i && w[e].splice(o, 1), a.push(s));
            return a
        }

        function p(e, t, n) {
            s.stopCallback(t, t.target || t.srcElement, n) || !1 !== e(t, n) || (t.preventDefault && t.preventDefault(), t.stopPropagation && t.stopPropagation(), t.returnValue = !1, t.cancelBubble = !0)
        }

        function t(e) {
            "number" != typeof e.which && (e.which = e.keyCode);
            var t = h(e);
            if (t)
                if ("keyup" == e.type && C == t) C = !1;
                else {
                    var n = [];
                    e.shiftKey && n.push("shift"), e.altKey && n.push("alt"), e.ctrlKey && n.push("ctrl"), e.metaKey && n.push("meta");
                    n = f(t, n, e);
                    var r, i = {},
                        o = 0,
                        s = !1;
                    for (r = 0; r < n.length; ++r) n[r].seq ? (s = !0, o = Math.max(o, n[r].level), i[n[r].seq] = 1, p(n[r].callback, e, n[r].combo)) : !s && !S && p(n[r].callback, e, n[r].combo);
                    e.type == S && !m(t) && d(i, o)
                }
        }

        function m(e) {
            return "shift" == e || "ctrl" == e || "alt" == e || "meta" == e
        }

        function g(e, t, n) {
            if (!n) {
                if (!i)
                    for (var r in i = {}, o) 95 < r && r < 112 || o.hasOwnProperty(r) && (i[o[r]] = r);
                n = i[e] ? "keydown" : "keypress"
            }
            return "keypress" == n && t.length && (n = "keydown"), n
        }

        function v(e, t, n, r, i) {
            k[e + ":" + n] = t;
            var o, s, a = (e = e.replace(/\s+/g, " ")).split(" "),
                l = [];
            if (1 < a.length) {
                var c = e,
                    u = n;
                for (_[c] = 0, u || (u = g(a[0], [])), e = function() {
                        S = u, ++_[c], clearTimeout(y), y = setTimeout(d, 1e3)
                    }, n = function(e) {
                        p(t, e, c), "keyup" !== u && (C = h(e)), setTimeout(d, 10)
                    }, r = 0; r < a.length; ++r) v(a[r], r < a.length - 1 ? e : n, u, c, r)
            } else {
                for (s = "+" === e ? ["+"] : e.split("+"), a = 0; a < s.length; ++a) o = s[a], x[o] && (o = x[o]), n && "keypress" != n && b[o] && (o = b[o], l.push("shift")), m(o) && l.push(o);
                n = g(o, l, n), w[o] || (w[o] = []), f(o, l, {
                    type: n
                }, !r, e), w[o][r ? "unshift" : "push"]({
                    callback: t,
                    modifiers: l,
                    action: n,
                    seq: r,
                    level: i,
                    combo: e
                })
            }
        }
        for (var i, y, o = {
                8: "backspace",
                9: "tab",
                13: "enter",
                16: "shift",
                17: "ctrl",
                18: "alt",
                20: "capslock",
                27: "esc",
                32: "space",
                33: "pageup",
                34: "pagedown",
                35: "end",
                36: "home",
                37: "left",
                38: "up",
                39: "right",
                40: "down",
                45: "ins",
                46: "del",
                91: "meta",
                93: "meta",
                224: "meta"
            }, n = {
                106: "*",
                107: "+",
                109: "-",
                110: ".",
                111: "/",
                186: ";",
                187: "=",
                188: ",",
                189: "-",
                190: ".",
                191: "/",
                192: "`",
                219: "[",
                220: "\\",
                221: "]",
                222: "'"
            }, b = {
                "~": "`",
                "!": "1",
                "@": "2",
                "#": "3",
                $: "4",
                "%": "5",
                "^": "6",
                "&": "7",
                "*": "8",
                "(": "9",
                ")": "0",
                _: "-",
                "+": "=",
                ":": ";",
                '"': "'",
                "<": ",",
                ">": ".",
                "?": "/",
                "|": "\\"
            }, x = {
                option: "alt",
                command: "meta",
                return: "enter",
                escape: "esc"
            }, w = {}, k = {}, _ = {}, C = !1, S = !1, r = 1; r < 20; ++r) o[111 + r] = "f" + r;
        for (r = 0; r <= 9; ++r) o[r + 96] = r;
        e(document, "keypress", t), e(document, "keydown", t), e(document, "keyup", t);
        var s = {
            bind: function(e, t, n) {
                e = e instanceof Array ? e : [e];
                for (var r = 0; r < e.length; ++r) v(e[r], t, n);
                return this
            },
            unbind: function(e, t) {
                return s.bind(e, function() {}, t)
            },
            trigger: function(e, t) {
                return k[e + ":" + t] && k[e + ":" + t]({}, e), this
            },
            reset: function() {
                return w = {}, k = {}, this
            },
            stopCallback: function(e, t) {
                return !(-1 < (" " + t.className + " ").indexOf(" mousetrap ")) && ("INPUT" == t.tagName || "SELECT" == t.tagName || t.contentEditable && "true" == t.contentEditable)
            }
        };
        window.Mousetrap = s, "function" == typeof define && define.amd && define(s)
    }(),
    function(e) {
        "function" == typeof define && define.amd ? define(["jquery"], e) : "object" == typeof exports ? e(require("jquery")) : e(jQuery)
    }(function(c) {
        function u(e, t) {
            var n;
            if (h.raw) n = e;
            else e: {
                var r = e;0 === r.indexOf('"') && (r = r.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\"));
                try {
                    r = decodeURIComponent(r.replace(i, " ")), n = h.json ? JSON.parse(r) : r;
                    break e
                } catch (e) {}
                n = void 0
            }
            return c.isFunction(t) ? t(n) : n
        }
        var i = /\+/g,
            h = c.cookie = function(e, t, n) {
                if (void 0 !== t && !c.isFunction(t)) {
                    if ("number" == typeof(n = c.extend({}, h.defaults, n)).expires) {
                        var r = n.expires;
                        (o = n.expires = new Date).setTime(+o + 864e5 * r)
                    }
                    return document.cookie = [h.raw ? e : encodeURIComponent(e), "=", (i = t, i = h.json ? JSON.stringify(i) : String(i), h.raw ? i : encodeURIComponent(i)), n.expires ? "; expires=" + n.expires.toUTCString() : "", n.path ? "; path=" + n.path : "", n.domain ? "; domain=" + n.domain : "", n.secure ? "; secure" : ""].join("")
                }
                var i;
                n = e ? void 0 : {};
                for (var o = 0, s = (r = document.cookie ? document.cookie.split("; ") : []).length; o < s; o++) {
                    var a, l = r[o].split("=");
                    if (a = l.shift(), a = h.raw ? a : decodeURIComponent(a), l = l.join("="), e && e === a) {
                        n = u(l, t);
                        break
                    }
                    e || void 0 === (l = u(l)) || (n[a] = l)
                }
                return n
            };
        h.defaults = {}, c.removeCookie = function(e, t) {
            return void 0 !== c.cookie(e) && (c.cookie(e, "", c.extend({}, t, {
                expires: -1
            })), !c.cookie(e))
        }
    }), "object" != typeof JSON && (JSON = {}),
    function() {
        "use strict";

        function f(e) {
            return e < 10 ? "0" + e : e
        }

        function quote(e) {
            return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function(e) {
                var t = meta[e];
                return "string" == typeof t ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4)
            }) + '"' : '"' + e + '"'
        }

        function str(e, t) {
            var n, r, i, o, s, a = gap,
                l = t[e];
            switch (l && "object" == typeof l && "function" == typeof l.toJSON && (l = l.toJSON(e)), "function" == typeof rep && (l = rep.call(t, e, l)), typeof l) {
                case "string":
                    return quote(l);
                case "number":
                    return isFinite(l) ? String(l) : "null";
                case "boolean":
                case "null":
                    return String(l);
                case "object":
                    if (!l) return "null";
                    if (gap += indent, s = [], "[object Array]" === Object.prototype.toString.apply(l)) {
                        for (o = l.length, n = 0; n < o; n += 1) s[n] = str(n, l) || "null";
                        return i = 0 === s.length ? "[]" : gap ? "[\n" + gap + s.join(",\n" + gap) + "\n" + a + "]" : "[" + s.join(",") + "]", gap = a, i
                    }
                    if (rep && "object" == typeof rep)
                        for (o = rep.length, n = 0; n < o; n += 1) "string" == typeof rep[n] && ((i = str(r = rep[n], l)) && s.push(quote(r) + (gap ? ": " : ":") + i));
                    else
                        for (r in l) Object.prototype.hasOwnProperty.call(l, r) && ((i = str(r, l)) && s.push(quote(r) + (gap ? ": " : ":") + i));
                    return i = 0 === s.length ? "{}" : gap ? "{\n" + gap + s.join(",\n" + gap) + "\n" + a + "}" : "{" + s.join(",") + "}", gap = a, i
            }
        }
        "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function(e) {
            return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null
        }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function(e) {
            return this.valueOf()
        });
        var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
            escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
            gap, indent, meta = {
                "\b": "\\b",
                "\t": "\\t",
                "\n": "\\n",
                "\f": "\\f",
                "\r": "\\r",
                '"': '\\"',
                "\\": "\\\\"
            },
            rep;
        "function" != typeof JSON.stringify && (JSON.stringify = function(e, t, n) {
            var r;
            if (indent = gap = "", "number" == typeof n)
                for (r = 0; r < n; r += 1) indent += " ";
            else "string" == typeof n && (indent = n);
            if (!(rep = t) || "function" == typeof t || "object" == typeof t && "number" == typeof t.length) return str("", {
                "": e
            });
            throw new Error("JSON.stringify")
        }), "function" != typeof JSON.parse && (JSON.parse = function(text, reviver) {
            function walk(e, t) {
                var n, r, i = e[t];
                if (i && "object" == typeof i)
                    for (n in i) Object.prototype.hasOwnProperty.call(i, n) && (void 0 !== (r = walk(i, n)) ? i[n] = r : delete i[n]);
                return reviver.call(e, t, i)
            }
            var j;
            if (text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function(e) {
                    return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4)
                })), /^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({
                "": j
            }, "") : j;
            throw new SyntaxError("JSON.parse")
        })
    }(),
    function(e, t) {
        "use strict";
        var n = e.History = e.History || {},
            r = e.jQuery;
        if (void 0 !== n.Adapter) throw new Error("History.js Adapter has already been loaded...");
        n.Adapter = {
            bind: function(e, t, n) {
                r(e).bind(t, n)
            },
            trigger: function(e, t, n) {
                r(e).trigger(t, n)
            },
            extractEventData: function(e, t, n) {
                return t && t.originalEvent && t.originalEvent[e] || n && n[e] || void 0
            },
            onDomLoad: function(e) {
                r(e)
            }
        }, void 0 !== n.init && n.init()
    }(window),
    function(u, e) {
        "use strict";
        var t = u.document,
            n = u.setTimeout || n,
            r = u.clearTimeout || r,
            a = u.setInterval || a,
            h = u.History = u.History || {};
        if (void 0 !== h.initHtml4) throw new Error("History.js HTML4 Support has already been loaded...");
        h.initHtml4 = function() {
            if (void 0 !== h.initHtml4.initialized) return !1;
            h.initHtml4.initialized = !0, h.enabled = !0, h.savedHashes = [], h.isLastHash = function(e) {
                return e === h.getHashByIndex()
            }, h.isHashEqual = function(e, t) {
                return (e = encodeURIComponent(e).replace(/%25/g, "%")) === (t = encodeURIComponent(t).replace(/%25/g, "%"))
            }, h.saveHash = function(e) {
                return !h.isLastHash(e) && (h.savedHashes.push(e), !0)
            }, h.getHashByIndex = function(e) {
                return void 0 === e ? h.savedHashes[h.savedHashes.length - 1] : e < 0 ? h.savedHashes[h.savedHashes.length + e] : h.savedHashes[e]
            }, h.discardedHashes = {}, h.discardedStates = {}, h.discardState = function(e, t, n) {
                var r, i = h.getHashByState(e);
                return r = {
                    discardedState: e,
                    backState: n,
                    forwardState: t
                }, h.discardedStates[i] = r, !0
            }, h.discardHash = function(e, t, n) {
                var r = {
                    discardedHash: e,
                    backState: n,
                    forwardState: t
                };
                return h.discardedHashes[e] = r, !0
            }, h.discardedState = function(e) {
                var t = h.getHashByState(e);
                return h.discardedStates[t] || !1
            }, h.discardedHash = function(e) {
                return h.discardedHashes[e] || !1
            }, h.recycleState = function(e) {
                var t = h.getHashByState(e);
                return h.discardedState(e) && delete h.discardedStates[t], !0
            }, h.emulated.hashChange && (h.hashChangeInit = function() {
                h.checkerFunction = null;
                var n, r, i, o = "",
                    s = Boolean(h.getHash());
                return h.isInternetExplorer() ? ("historyjs-iframe", (n = t.createElement("iframe")).setAttribute("id", "historyjs-iframe"), n.setAttribute("src", "#"), n.style.display = "none", t.body.appendChild(n), n.contentWindow.document.open(), n.contentWindow.document.close(), r = "", i = !1, h.checkerFunction = function() {
                    if (i) return !1;
                    i = !0;
                    var e = h.getHash(),
                        t = h.getHash(n.contentWindow.document);
                    return e !== o ? (t !== (o = e) && (r = t = e, n.contentWindow.document.open(), n.contentWindow.document.close(), n.contentWindow.document.location.hash = h.escapeHash(e)), h.Adapter.trigger(u, "hashchange")) : t !== r && (r = t, s && "" === t ? h.back() : h.setHash(t, !1)), !(i = !1)
                }) : h.checkerFunction = function() {
                    var e = h.getHash() || "";
                    return e !== o && (o = e, h.Adapter.trigger(u, "hashchange")), !0
                }, h.intervalList.push(a(h.checkerFunction, h.options.hashChangeInterval)), !0
            }, h.Adapter.onDomLoad(h.hashChangeInit)), h.emulated.pushState && (h.onHashChange = function(e) {
                var t, n = e && e.newURL || h.getLocationHref(),
                    r = h.getHashByUrl(n),
                    i = null;
                return h.isLastHash(r) ? (h.busy(!1), !1) : (h.doubleCheckComplete(), h.saveHash(r), r && h.isTraditionalAnchor(r) ? (h.Adapter.trigger(u, "anchorchange"), h.busy(!1), !1) : (i = h.extractState(h.getFullUrl(r || h.getLocationHref()), !0), h.isLastSavedState(i) ? (h.busy(!1), !1) : (h.getHashByState(i), (t = h.discardedState(i)) ? (h.getHashByIndex(-2) === h.getHashByState(t.forwardState) ? h.back(!1) : h.forward(!1), !1) : (h.pushState(i.data, i.title, encodeURI(i.url), !1), !0))))
            }, h.Adapter.bind(u, "hashchange", h.onHashChange), h.pushState = function(e, t, n, r) {
                if (n = encodeURI(n).replace(/%25/g, "%"), h.getHashByUrl(n)) throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");
                if (!1 !== r && h.busy()) return h.pushQueue({
                    scope: h,
                    callback: h.pushState,
                    args: arguments,
                    queue: r
                }), !1;
                h.busy(!0);
                var i = h.createStateObject(e, t, n),
                    o = h.getHashByState(i),
                    s = h.getState(!1),
                    a = h.getHashByState(s),
                    l = h.getHash(),
                    c = h.expectedStateId == i.id;
                return h.storeState(i), h.expectedStateId = i.id, h.recycleState(i), h.setTitle(i), o === a ? (h.busy(!1), !1) : (h.saveState(i), c || h.Adapter.trigger(u, "statechange"), !h.isHashEqual(o, l) && !h.isHashEqual(o, h.getShortUrl(h.getLocationHref())) && h.setHash(o, !1), h.busy(!1), !0)
            }, h.replaceState = function(e, t, n, r) {
                if (n = encodeURI(n).replace(/%25/g, "%"), h.getHashByUrl(n)) throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");
                if (!1 !== r && h.busy()) return h.pushQueue({
                    scope: h,
                    callback: h.replaceState,
                    args: arguments,
                    queue: r
                }), !1;
                h.busy(!0);
                var i = h.createStateObject(e, t, n),
                    o = h.getHashByState(i),
                    s = h.getState(!1),
                    a = h.getHashByState(s),
                    l = h.getStateByIndex(-2);
                return h.discardState(s, i, l), o === a ? (h.storeState(i), h.expectedStateId = i.id, h.recycleState(i), h.setTitle(i), h.saveState(i), h.Adapter.trigger(u, "statechange"), h.busy(!1)) : h.pushState(i.data, i.title, i.url, !1), !0
            }), h.emulated.pushState && h.getHash() && !h.emulated.hashChange && h.Adapter.onDomLoad(function() {
                h.Adapter.trigger(u, "hashchange")
            })
        }, void 0 !== h.init && h.init()
    }(window),
    function(s, n) {
        "use strict";
        var a = s.console || n,
            l = s.document,
            r = s.navigator,
            i = !1,
            o = s.setTimeout,
            c = s.clearTimeout,
            u = s.setInterval,
            h = s.clearInterval,
            d = s.JSON,
            f = s.alert,
            p = s.History = s.History || {},
            m = s.history;
        try {
            (i = s.sessionStorage).setItem("TEST", "1"), i.removeItem("TEST")
        } catch (e) {
            i = !1
        }
        if (d.stringify = d.stringify || d.encode, d.parse = d.parse || d.decode, void 0 !== p.init) throw new Error("History.js Core has already been loaded...");
        p.init = function(e) {
            return void 0 !== p.Adapter && (void 0 !== p.initCore && p.initCore(), void 0 !== p.initHtml4 && p.initHtml4(), !0)
        }, p.initCore = function(e) {
            if (void 0 !== p.initCore.initialized) return !1;
            if (p.initCore.initialized = !0, p.options = p.options || {}, p.options.hashChangeInterval = p.options.hashChangeInterval || 100, p.options.safariPollInterval = p.options.safariPollInterval || 500, p.options.doubleCheckInterval = p.options.doubleCheckInterval || 500, p.options.disableSuid = p.options.disableSuid || !1, p.options.storeInterval = p.options.storeInterval || 1e3, p.options.busyDelay = p.options.busyDelay || 250, p.options.debug = p.options.debug || !1, p.options.initialTitle = p.options.initialTitle || l.title, p.options.html4Mode = p.options.html4Mode || !1, p.options.delayInit = p.options.delayInit || !1, p.intervalList = [], p.clearAllIntervals = function() {
                    var e, t = p.intervalList;
                    if (null != t) {
                        for (e = 0; e < t.length; e++) h(t[e]);
                        p.intervalList = null
                    }
                }, p.debug = function() {
                    p.options.debug && p.log.apply(p, arguments)
                }, p.log = function() {
                    var e, t, n, r, i, o = void 0 !== a && void 0 !== a.log && void 0 !== a.log.apply,
                        s = l.getElementById("log");
                    for (o ? (e = (r = Array.prototype.slice.call(arguments)).shift(), void 0 !== a.debug ? a.debug.apply(a, [e, r]) : a.log.apply(a, [e, r])) : e = "\n" + arguments[0] + "\n", t = 1, n = arguments.length; t < n; ++t) {
                        if ("object" == typeof(i = arguments[t]) && void 0 !== d) try {
                            i = d.stringify(i)
                        } catch (e) {}
                        e += "\n" + i + "\n"
                    }
                    return s ? (s.value += e + "\n-----\n", s.scrollTop = s.scrollHeight - s.clientHeight) : o || f(e), !0
                }, p.getInternetExplorerMajorVersion = function() {
                    return p.getInternetExplorerMajorVersion.cached = void 0 !== p.getInternetExplorerMajorVersion.cached ? p.getInternetExplorerMajorVersion.cached : function() {
                        for (var e = 3, t = l.createElement("div"), n = t.getElementsByTagName("i");
                            (t.innerHTML = "\x3c!--[if gt IE " + ++e + "]><i></i><![endif]--\x3e") && n[0];);
                        return 4 < e && e
                    }()
                }, p.isInternetExplorer = function() {
                    return p.isInternetExplorer.cached = void 0 !== p.isInternetExplorer.cached ? p.isInternetExplorer.cached : Boolean(p.getInternetExplorerMajorVersion())
                }, p.options.html4Mode ? p.emulated = {
                    pushState: !0,
                    hashChange: !0
                } : p.emulated = {
                    pushState: !Boolean(s.history && s.history.pushState && s.history.replaceState && !/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(r.userAgent) && !/AppleWebKit\/5([0-2]|3[0-2])/i.test(r.userAgent)),
                    hashChange: Boolean(!("onhashchange" in s || "onhashchange" in l) || p.isInternetExplorer() && p.getInternetExplorerMajorVersion() < 8)
                }, p.enabled = !p.emulated.pushState, p.bugs = {
                    setHash: Boolean(!p.emulated.pushState && "Apple Computer, Inc." === r.vendor && /AppleWebKit\/5([0-2]|3[0-3])/.test(r.userAgent)),
                    safariPoll: Boolean(!p.emulated.pushState && "Apple Computer, Inc." === r.vendor && /AppleWebKit\/5([0-2]|3[0-3])/.test(r.userAgent)),
                    ieDoubleCheck: Boolean(p.isInternetExplorer() && p.getInternetExplorerMajorVersion() < 8),
                    hashEscape: Boolean(p.isInternetExplorer() && p.getInternetExplorerMajorVersion() < 7)
                }, p.isEmptyObject = function(e) {
                    for (var t in e)
                        if (e.hasOwnProperty(t)) return !1;
                    return !0
                }, p.cloneObject = function(e) {
                    var t;
                    return e ? (t = d.stringify(e), d.parse(t)) : {}
                }, p.getRootUrl = function() {
                    var e = l.location.protocol + "//" + (l.location.hostname || l.location.host);
                    return l.location.port && (e += ":" + l.location.port), e += "/"
                }, p.getBaseHref = function() {
                    var e = l.getElementsByTagName("base"),
                        t = "";
                    return 1 === e.length && (t = e[0].href.replace(/[^\/]+$/, "")), (t = t.replace(/\/+$/, "")) && (t += "/"), t
                }, p.getBaseUrl = function() {
                    return p.getBaseHref() || p.getBasePageUrl() || p.getRootUrl()
                }, p.getPageUrl = function() {
                    return ((p.getState(!1, !1) || {}).url || p.getLocationHref()).replace(/\/+$/, "").replace(/[^\/]+$/, function(e, t, n) {
                        return /\./.test(e) ? e : e + "/"
                    })
                }, p.getBasePageUrl = function() {
                    return p.getLocationHref().replace(/[#\?].*/, "").replace(/[^\/]+$/, function(e, t, n) {
                        return /[^\/]$/.test(e) ? "" : e
                    }).replace(/\/+$/, "") + "/"
                }, p.getFullUrl = function(e, t) {
                    var n = e,
                        r = e.substring(0, 1);
                    return t = void 0 === t || t, /[a-z]+\:\/\//.test(e) || (n = "/" === r ? p.getRootUrl() + e.replace(/^\/+/, "") : "#" === r ? p.getPageUrl().replace(/#.*/, "") + e : "?" === r ? p.getPageUrl().replace(/[\?#].*/, "") + e : t ? p.getBaseUrl() + e.replace(/^(\.\/)+/, "") : p.getBasePageUrl() + e.replace(/^(\.\/)+/, "")), n.replace(/\#$/, "")
                }, p.getShortUrl = function(e) {
                    var t = e,
                        n = p.getBaseUrl(),
                        r = p.getRootUrl();
                    return p.emulated.pushState && (t = t.replace(n, "")), t = t.replace(r, "/"), p.isTraditionalAnchor(t) && (t = "./" + t), t = t.replace(/^(\.\/)+/g, "./").replace(/\#$/, "")
                }, p.getLocationHref = function(e) {
                    return (e = e || l).URL === e.location.href ? e.location.href : e.location.href === decodeURIComponent(e.URL) ? e.URL : e.location.hash && decodeURIComponent(e.location.href.replace(/^[^#]+/, "")) === e.location.hash ? e.location.href : -1 == e.URL.indexOf("#") && -1 != e.location.href.indexOf("#") ? e.location.href : e.URL || e.location.href
                }, p.store = {}, p.idToState = p.idToState || {}, p.stateToId = p.stateToId || {}, p.urlToId = p.urlToId || {}, p.storedStates = p.storedStates || [], p.savedStates = p.savedStates || [], p.normalizeStore = function() {
                    p.store.idToState = p.store.idToState || {}, p.store.urlToId = p.store.urlToId || {}, p.store.stateToId = p.store.stateToId || {}
                }, p.getState = function(e, t) {
                    void 0 === e && (e = !0), void 0 === t && (t = !0);
                    var n = p.getLastSavedState();
                    return !n && t && (n = p.createStateObject()), e && ((n = p.cloneObject(n)).url = n.cleanUrl || n.url), n
                }, p.getIdByState = function(e) {
                    var t, n = p.extractId(e.url);
                    if (!n)
                        if (t = p.getStateString(e), void 0 !== p.stateToId[t]) n = p.stateToId[t];
                        else if (void 0 !== p.store.stateToId[t]) n = p.store.stateToId[t];
                    else {
                        for (; n = (new Date).getTime() + String(Math.random()).replace(/\D/g, ""), void 0 !== p.idToState[n] || void 0 !== p.store.idToState[n];);
                        p.stateToId[t] = n, p.idToState[n] = e
                    }
                    return n
                }, p.normalizeState = function(e) {
                    var t, n;
                    return e && "object" == typeof e || (e = {}), void 0 !== e.normalized ? e : (e.data && "object" == typeof e.data || (e.data = {}), (t = {
                        normalized: !0
                    }).title = e.title || "", t.url = p.getFullUrl(e.url ? e.url : p.getLocationHref()), t.hash = p.getShortUrl(t.url), t.data = p.cloneObject(e.data), t.id = p.getIdByState(t), t.cleanUrl = t.url.replace(/\??\&_suid.*/, ""), t.url = t.cleanUrl, n = !p.isEmptyObject(t.data), (t.title || n) && !0 !== p.options.disableSuid && (t.hash = p.getShortUrl(t.url).replace(/\??\&_suid.*/, ""), /\?/.test(t.hash) || (t.hash += "?"), t.hash += "&_suid=" + t.id), t.hashedUrl = p.getFullUrl(t.hash), (p.emulated.pushState || p.bugs.safariPoll) && p.hasUrlDuplicate(t) && (t.url = t.hashedUrl), t)
                }, p.createStateObject = function(e, t, n) {
                    var r = {
                        data: e,
                        title: t,
                        url: n
                    };
                    return r = p.normalizeState(r)
                }, p.getStateById = function(e) {
                    return e = String(e), p.idToState[e] || p.store.idToState[e] || n
                }, p.getStateString = function(e) {
                    var t;
                    return t = {
                        data: p.normalizeState(e).data,
                        title: e.title,
                        url: e.url
                    }, d.stringify(t)
                }, p.getStateId = function(e) {
                    return p.normalizeState(e).id
                }, p.getHashByState = function(e) {
                    return p.normalizeState(e).hash
                }, p.extractId = function(e) {
                    var t, n;
                    return n = -1 != e.indexOf("#") ? e.split("#")[0] : e, (t = /(.*)\&_suid=([0-9]+)$/.exec(n)) && t[1] || e, (t ? String(t[2] || "") : "") || !1
                }, p.isTraditionalAnchor = function(e) {
                    return !/[\/\?\.]/.test(e)
                }, p.extractState = function(e, t) {
                    var n, r, i = null;
                    return t = t || !1, (n = p.extractId(e)) && (i = p.getStateById(n)), i || (r = p.getFullUrl(e), (n = p.getIdByUrl(r) || !1) && (i = p.getStateById(n)), !i && t && !p.isTraditionalAnchor(e) && (i = p.createStateObject(null, null, r))), i
                }, p.getIdByUrl = function(e) {
                    return p.urlToId[e] || p.store.urlToId[e] || n
                }, p.getLastSavedState = function() {
                    return p.savedStates[p.savedStates.length - 1] || n
                }, p.getLastStoredState = function() {
                    return p.storedStates[p.storedStates.length - 1] || n
                }, p.hasUrlDuplicate = function(e) {
                    var t;
                    return (t = p.extractState(e.url)) && t.id !== e.id
                }, p.storeState = function(e) {
                    return p.urlToId[e.url] = e.id, p.storedStates.push(p.cloneObject(e)), e
                }, p.isLastSavedState = function(e) {
                    var t = !1;
                    return p.savedStates.length && (t = e.id === p.getLastSavedState().id), t
                }, p.saveState = function(e) {
                    return !p.isLastSavedState(e) && (p.savedStates.push(p.cloneObject(e)), !0)
                }, p.getStateByIndex = function(e) {
                    return void 0 === e ? p.savedStates[p.savedStates.length - 1] : e < 0 ? p.savedStates[p.savedStates.length + e] : p.savedStates[e]
                }, p.getCurrentIndex = function() {
                    return p.savedStates.length < 1 ? 0 : p.savedStates.length - 1
                }, p.getHash = function(e) {
                    var t = p.getLocationHref(e);
                    return p.getHashByUrl(t)
                }, p.unescapeHash = function(e) {
                    var t = p.normalizeHash(e);
                    return t = decodeURIComponent(t)
                }, p.normalizeHash = function(e) {
                    return e.replace(/[^#]*#/, "").replace(/#.*/, "")
                }, p.setHash = function(e, t) {
                    var n, r;
                    return !1 !== t && p.busy() ? (p.pushQueue({
                        scope: p,
                        callback: p.setHash,
                        args: arguments,
                        queue: t
                    }), !1) : (p.busy(!0), (n = p.extractState(e, !0)) && !p.emulated.pushState ? p.pushState(n.data, n.title, n.url, !1) : p.getHash() !== e && (p.bugs.setHash ? (r = p.getPageUrl(), p.pushState(null, null, r + "#" + e, !1)) : l.location.hash = e), p)
                }, p.escapeHash = function(e) {
                    var t = p.normalizeHash(e);
                    return t = s.encodeURIComponent(t), p.bugs.hashEscape || (t = t.replace(/\%21/g, "!").replace(/\%26/g, "&").replace(/\%3D/g, "=").replace(/\%3F/g, "?")), t
                }, p.getHashByUrl = function(e) {
                    var t = String(e).replace(/([^#]*)#?([^#]*)#?(.*)/, "$2");
                    return t = p.unescapeHash(t)
                }, p.setTitle = function(e) {
                    var t, n = e.title;
                    n || (t = p.getStateByIndex(0)) && t.url === e.url && (n = t.title || p.options.initialTitle);
                    try {
                        l.getElementsByTagName("title")[0].innerHTML = n.replace("<", "&lt;").replace(">", "&gt;").replace(" & ", " &amp; ")
                    } catch (e) {}
                    return l.title = n, p
                }, p.queues = [], p.busy = function(e) {
                    if (void 0 !== e ? p.busy.flag = e : void 0 === p.busy.flag && (p.busy.flag = !1), !p.busy.flag) {
                        c(p.busy.timeout);
                        var r = function() {
                            var e, t, n;
                            if (!p.busy.flag)
                                for (e = p.queues.length - 1; 0 <= e; --e) 0 !== (t = p.queues[e]).length && (n = t.shift(), p.fireQueueItem(n), p.busy.timeout = o(r, p.options.busyDelay))
                        };
                        p.busy.timeout = o(r, p.options.busyDelay)
                    }
                    return p.busy.flag
                }, p.busy.flag = !1, p.fireQueueItem = function(e) {
                    return e.callback.apply(e.scope || p, e.args || [])
                }, p.pushQueue = function(e) {
                    return p.queues[e.queue || 0] = p.queues[e.queue || 0] || [], p.queues[e.queue || 0].push(e), p
                }, p.queue = function(e, t) {
                    return "function" == typeof e && (e = {
                        callback: e
                    }), void 0 !== t && (e.queue = t), p.busy() ? p.pushQueue(e) : p.fireQueueItem(e), p
                }, p.clearQueue = function() {
                    return p.busy.flag = !1, p.queues = [], p
                }, p.stateChanged = !1, p.doubleChecker = !1, p.doubleCheckComplete = function() {
                    return p.stateChanged = !0, p.doubleCheckClear(), p
                }, p.doubleCheckClear = function() {
                    return p.doubleChecker && (c(p.doubleChecker), p.doubleChecker = !1), p
                }, p.doubleCheck = function(e) {
                    return p.stateChanged = !1, p.doubleCheckClear(), p.bugs.ieDoubleCheck && (p.doubleChecker = o(function() {
                        return p.doubleCheckClear(), p.stateChanged || e(), !0
                    }, p.options.doubleCheckInterval)), p
                }, p.safariStatePoll = function() {
                    var e = p.extractState(p.getLocationHref());
                    if (!p.isLastSavedState(e)) return e || p.createStateObject(), p.Adapter.trigger(s, "popstate"), p
                }, p.back = function(e) {
                    return !1 !== e && p.busy() ? (p.pushQueue({
                        scope: p,
                        callback: p.back,
                        args: arguments,
                        queue: e
                    }), !1) : (p.busy(!0), p.doubleCheck(function() {
                        p.back(!1)
                    }), m.go(-1), !0)
                }, p.forward = function(e) {
                    return !1 !== e && p.busy() ? (p.pushQueue({
                        scope: p,
                        callback: p.forward,
                        args: arguments,
                        queue: e
                    }), !1) : (p.busy(!0), p.doubleCheck(function() {
                        p.forward(!1)
                    }), m.go(1), !0)
                }, p.go = function(e, t) {
                    var n;
                    if (0 < e)
                        for (n = 1; n <= e; ++n) p.forward(t);
                    else {
                        if (!(e < 0)) throw new Error("History.go: History.go requires a positive or negative integer passed.");
                        for (n = -1; e <= n; --n) p.back(t)
                    }
                    return p
                }, p.emulated.pushState) {
                var t = function() {};
                p.pushState = p.pushState || t, p.replaceState = p.replaceState || t
            } else p.onPopState = function(e, t) {
                var n, r, i = !1,
                    o = !1;
                return p.doubleCheckComplete(), (n = p.getHash()) ? ((r = p.extractState(n || p.getLocationHref(), !0)) ? p.replaceState(r.data, r.title, r.url, !1) : (p.Adapter.trigger(s, "anchorchange"), p.busy(!1)), p.expectedStateId = !1) : ((o = (i = p.Adapter.extractEventData("state", e, t) || !1) ? p.getStateById(i) : p.expectedStateId ? p.getStateById(p.expectedStateId) : p.extractState(p.getLocationHref())) || (o = p.createStateObject(null, null, p.getLocationHref())), p.expectedStateId = !1, p.isLastSavedState(o) ? (p.busy(!1), !1) : (p.storeState(o), p.saveState(o), p.setTitle(o), p.Adapter.trigger(s, "statechange"), p.busy(!1), !0))
            }, p.Adapter.bind(s, "popstate", p.onPopState), p.pushState = function(e, t, n, r) {
                if (p.getHashByUrl(n) && p.emulated.pushState) throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
                if (!1 !== r && p.busy()) return p.pushQueue({
                    scope: p,
                    callback: p.pushState,
                    args: arguments,
                    queue: r
                }), !1;
                p.busy(!0);
                var i = p.createStateObject(e, t, n);
                return p.isLastSavedState(i) ? p.busy(!1) : (p.storeState(i), p.expectedStateId = i.id, m.pushState(i.id, i.title, i.url), p.Adapter.trigger(s, "popstate")), !0
            }, p.replaceState = function(e, t, n, r) {
                if (p.getHashByUrl(n) && p.emulated.pushState) throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
                if (!1 !== r && p.busy()) return p.pushQueue({
                    scope: p,
                    callback: p.replaceState,
                    args: arguments,
                    queue: r
                }), !1;
                p.busy(!0);
                var i = p.createStateObject(e, t, n);
                return p.isLastSavedState(i) ? p.busy(!1) : (p.storeState(i), p.expectedStateId = i.id, m.replaceState(i.id, i.title, i.url), p.Adapter.trigger(s, "popstate")), !0
            };
            if (i) {
                try {
                    p.store = d.parse(i.getItem("History.store")) || {}
                } catch (e) {
                    p.store = {}
                }
                p.normalizeStore()
            } else p.store = {}, p.normalizeStore();
            p.Adapter.bind(s, "unload", p.clearAllIntervals), p.saveState(p.storeState(p.extractState(p.getLocationHref(), !0))), i && (p.onUnload = function() {
                var t, e, n;
                try {
                    t = d.parse(i.getItem("History.store")) || {}
                } catch (e) {
                    t = {}
                }
                for (e in t.idToState = t.idToState || {}, t.urlToId = t.urlToId || {}, t.stateToId = t.stateToId || {}, p.idToState) p.idToState.hasOwnProperty(e) && (t.idToState[e] = p.idToState[e]);
                for (e in p.urlToId) p.urlToId.hasOwnProperty(e) && (t.urlToId[e] = p.urlToId[e]);
                for (e in p.stateToId) p.stateToId.hasOwnProperty(e) && (t.stateToId[e] = p.stateToId[e]);
                p.store = t, p.normalizeStore(), n = d.stringify(t);
                try {
                    i.setItem("History.store", n)
                } catch (e) {
                    if (e.code !== DOMException.QUOTA_EXCEEDED_ERR) throw e;
                    i.length && (i.removeItem("History.store"), i.setItem("History.store", n))
                }
            }, p.intervalList.push(u(p.onUnload, p.options.storeInterval)), p.Adapter.bind(s, "beforeunload", p.onUnload), p.Adapter.bind(s, "unload", p.onUnload)), p.emulated.pushState || (p.bugs.safariPoll && p.intervalList.push(u(p.safariStatePoll, p.options.safariPollInterval)), "Apple Computer, Inc." !== r.vendor && "Mozilla" !== (r.appCodeName || "") || (p.Adapter.bind(s, "hashchange", function() {
                p.Adapter.trigger(s, "popstate")
            }), p.getHash() && p.Adapter.onDomLoad(function() {
                p.Adapter.trigger(s, "hashchange")
            })))
        }, (!p.options || !p.options.delayInit) && p.init()
    }(window),
    function(g) {
        g.fn.splitter = function(m) {
            return m = m || {}, this.each(function() {
                var n;

                function r(e) {
                    var t = c._posSplit + e[s.eventPos];
                    s.outline ? (t = Math.max(0, Math.min(t, a._DA - d._DA)), d.css(s.origin, t)) : o(t)
                }

                function i(e) {
                    d.removeClass(s.activeClass);
                    var t = c._posSplit + e[s.eventPos];
                    s.outline && (n.remove(), n = null, o(t)), l.css("-webkit-user-select", "text"), g(document).unbind("mousemove", r).unbind("mouseup", i)
                }

                function o(e) {
                    e = Math.max(c._min, a._DA - u._max, Math.min(e, c._max, a._DA - d._DA - u._min)), d._DA = d[0][s.pxSplit], d.css(s.origin, e).css(s.fixed, a._DF), c.css(s.origin, 0).css(s.split, e).css(s.fixed, a._DF), u.css(s.origin, e + d._DA).css(s.split, a._DA - d._DA - e).css(s.fixed, a._DF), g.browser.msie || l.trigger("resize")
                }

                function e(e, t) {
                    for (var n = 0, r = 1; r < arguments.length; r++) n += Math.max(parseInt(e.css(arguments[r])) || 0, 0);
                    return n
                }
                var t = (m.splitHorizontal ? "h" : m.splitVertical ? "v" : m.type) || "v",
                    s = g.extend({
                        activeClass: "active",
                        pxPerKey: 8,
                        tabIndex: 0,
                        accessKey: ""
                    }, {
                        v: {
                            keyLeft: 39,
                            keyRight: 37,
                            cursor: "col-resize",
                            splitbarClass: "vsplitbar",
                            outlineClass: "voutline",
                            type: "v",
                            eventPos: "pageX",
                            origin: "left",
                            split: "width",
                            pxSplit: "offsetWidth",
                            side1: "Left",
                            side2: "Right",
                            fixed: "height",
                            pxFixed: "offsetHeight",
                            side3: "Top",
                            side4: "Bottom"
                        },
                        h: {
                            keyTop: 40,
                            keyBottom: 38,
                            cursor: "n-resize",
                            splitbarClass: "hsplitbar",
                            outlineClass: "houtline",
                            type: "h",
                            eventPos: "pageY",
                            origin: "top",
                            split: "height",
                            pxSplit: "offsetHeight",
                            side1: "Top",
                            side2: "Bottom",
                            fixed: "width",
                            pxFixed: "offsetWidth",
                            side3: "Left",
                            side4: "Right"
                        }
                    } [t], m),
                    a = g(this).css({
                        position: "relative"
                    }),
                    l = g(">*", a[0]).css({
                        position: "absolute",
                        "z-index": "1",
                        "-moz-outline-style": "none"
                    }),
                    c = g(l[0]),
                    u = g(l[1]),
                    h = g('<a href="javascript:void(0)"></a>').attr({
                        accessKey: s.accessKey,
                        tabIndex: s.tabIndex,
                        title: s.splitbarClass
                    }).bind(g.browser.opera ? "click" : "focus", function() {
                        this.focus(), d.addClass(s.activeClass)
                    }).bind("keydown", function(e) {
                        var t = e.which || e.keyCode,
                            n = t == s["key" + s.side1] ? 1 : t == s["key" + s.side2] ? -1 : 0;
                        n && o(c[0][s.pxSplit] + n * s.pxPerKey)
                    }).bind("blur", function() {
                        d.removeClass(s.activeClass)
                    }),
                    d = g(l[2] || "<div></div>").insertAfter(c).css("z-index", "100").append(h).attr({
                        class: s.splitbarClass,
                        unselectable: "on"
                    }).css({
                        position: "absolute",
                        "user-select": "none",
                        "-webkit-user-select": "none",
                        "-khtml-user-select": "none",
                        "-moz-user-select": "none"
                    }).bind("mousedown", function(e) {
                        s.outline && (n = n || d.clone(!1).insertAfter(c)), l.css("-webkit-user-select", "none"), d.addClass(s.activeClass), c._posSplit = c[0][s.pxSplit] - e[s.eventPos], g(document).bind("mousemove", r).bind("mouseup", i)
                    });
                /^(auto|default|)$/.test(d.css("cursor")) && d.css("cursor", s.cursor), d._DA = d[0][s.pxSplit], a._PBF = g.boxModel ? e(a, "border" + s.side3 + "Width", "border" + s.side4 + "Width") : 0, a._PBA = g.boxModel ? e(a, "border" + s.side1 + "Width", "border" + s.side2 + "Width") : 0, c._pane = s.side1, u._pane = s.side2, g.each([c, u], function() {
                    this._min = s["min" + this._pane] || e(this, "min-" + s.split), this._max = s["max" + this._pane] || e(this, "max-" + s.split) || 9999, this._init = !0 === s["size" + this._pane] ? parseInt(g.curCSS(this[0], s.split)) : s["size" + this._pane]
                });
                var f = c._init;
                if (isNaN(u._init) || (f = a[0][s.pxSplit] - a._PBA - u._init - d._DA), s.cookie) {
                    g.cookie || alert("jQuery.splitter(): jQuery cookie plugin required");
                    var p = parseInt(g.cookie(s.cookie));
                    isNaN(p) || (f = p), g(window).bind("unload", function() {
                        var e = String(d.css(s.origin));
                        g.cookie(s.cookie, e, {
                            expires: s.cookieExpires || 365,
                            path: s.cookiePath || document.location.pathname
                        })
                    })
                }
                isNaN(f) && (f = Math.round((a[0][s.pxSplit] - a._PBA - d._DA) / 2)), s.anchorToWindow ? (a._hadjust = e(a, "borderTopWidth", "borderBottomWidth", "marginBottom"), a._hmin = Math.max(e(a, "minHeight"), 20), g(window).bind("resize", function() {
                    var e = a.offset().top,
                        t = g(window).height();
                    a.css("height", Math.max(t - e - a._hadjust, a._hmin) + "px"), g.browser.msie || a.trigger("resize")
                }).trigger("resize")) : s.resizeToWidth && !g.browser.msie && g(window).bind("resize", function() {
                    a.trigger("resize")
                }), a.bind("resize", function(e, t) {
                    e.target == this && (a._DF = a[0][s.pxFixed] - a._PBF, a._DA = a[0][s.pxSplit] - a._PBA, a._DF <= 0 || a._DA <= 0 || o(isNaN(t) ? s.sizeRight || s.sizeBottom ? a._DA - u[0][s.pxSplit] - d._DA : c[0][s.pxSplit] : t))
                }).trigger("resize", [f])
            })
        }
    }(jQuery),
    function(f) {
        var p, e = {
                className: "autosizejs",
                id: "autosizejs",
                append: "\n",
                callback: !1,
                resizeDelay: 10,
                placeholder: !0
            },
            m = ["fontFamily", "fontSize", "fontWeight", "fontStyle", "letterSpacing", "textTransform", "wordSpacing", "textIndent"],
            g = f('<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>').data("autosize", !0)[0];
        (g.style.lineHeight = "99px") === f(g).css("lineHeight") && m.push("lineHeight"), g.style.lineHeight = "", f.fn.autosize = function(d) {
            return this.length ? (d = f.extend({}, e, d || {}), g.parentNode !== document.body && f(document.body).append(g), this.each(function() {
                var r, n, e, i = this,
                    o = f(i),
                    s = 0,
                    a = f.isFunction(d.callback),
                    t = {
                        height: i.style.height,
                        overflow: i.style.overflow,
                        overflowY: i.style.overflowY,
                        wordWrap: i.style.wordWrap,
                        resize: i.style.resize
                    },
                    l = o.width();

                function c() {
                    var n, r = !!window.getComputedStyle && window.getComputedStyle(i, null);
                    r ? (0 !== (n = i.getBoundingClientRect().width) && "number" == typeof n || (n = parseInt(r.width, 10)), f.each(["paddingLeft", "paddingRight", "borderLeftWidth", "borderRightWidth"], function(e, t) {
                        n -= parseInt(r[t], 10)
                    })) : n = Math.max(o.width(), 0), g.style.width = n + "px"
                }

                function u() {
                    var e, t;
                    p !== i ? function() {
                        var n = {};
                        if (p = i, g.className = d.className, g.id = d.id, r = parseInt(o.css("maxHeight"), 10), f.each(m, function(e, t) {
                                n[t] = o.css(t)
                            }), f(g).css(n).attr("wrap", o.attr("wrap")), c(), window.chrome) {
                            var e = i.style.width;
                            i.style.width = "0px", i.offsetWidth, i.style.width = e
                        }
                    }() : c(), !i.value && d.placeholder ? g.value = (o.attr("placeholder") || "") + d.append : g.value = i.value + d.append, g.style.overflowY = i.style.overflowY, t = parseInt(i.style.height, 10), g.scrollTop = 0, g.scrollTop = 9e4, e = g.scrollTop, r && r < e ? (i.style.overflowY = "scroll", e = r) : (i.style.overflowY = "hidden", e < n && (e = n)), t !== (e += s) && (i.style.height = e + "px", a && d.callback.call(i, i))
                }

                function h() {
                    clearTimeout(e), e = setTimeout(function() {
                        var e = o.width();
                        e !== l && (l = e, u())
                    }, parseInt(d.resizeDelay, 10))
                }
                o.data("autosize") || (o.data("autosize", !0), "border-box" !== o.css("box-sizing") && "border-box" !== o.css("-moz-box-sizing") && "border-box" !== o.css("-webkit-box-sizing") || (s = o.outerHeight() - o.height()), n = Math.max(parseInt(o.css("minHeight"), 10) - s || 0, o.height()), o.css({
                    overflow: "hidden",
                    overflowY: "hidden",
                    wordWrap: "break-word",
                    resize: "none" === o.css("resize") || "vertical" === o.css("resize") ? "none" : "horizontal"
                }), "onpropertychange" in i ? "oninput" in i ? o.on("input.autosize keyup.autosize", u) : o.on("propertychange.autosize", function() {
                    "value" === event.propertyName && u()
                }) : o.on("input.autosize", u), !1 !== d.resizeDelay && f(window).on("resize.autosize", h), o.on("autosize.resize", u), o.on("autosize.resizeIncludeStyle", function() {
                    p = null, u()
                }), o.on("autosize.destroy", function() {
                    p = null, clearTimeout(e), f(window).off("resize", h), o.off("autosize").off(".autosize").css(t).removeData("autosize")
                }), u())
            })) : this
        }
    }(window.jQuery || window.$),
    function() {
        "use strict";
        var r = this.document;

        function i() {
            this._events = this._events || {}
        }
        i.prototype.on = i.prototype.addListener = function(e, t) {
            this._events[e] = this._events[e] || [], this._events[e].push(t)
        }, i.prototype.off = i.prototype.removeListener = function(e, t) {
            if (this._events[e])
                for (var n = this._events[e], r = n.length; r--;)
                    if (n[r] === t || n[r].listener === t) return void n.splice(r, 1)
        }, i.prototype.removeAllListeners = function(e) {
            this._events[e] && delete this._events[e]
        }, i.prototype.once = function(t, n) {
            function r() {
                var e = Array.prototype.slice.call(arguments);
                return this.removeListener(t, r), n.apply(this, e)
            }
            return r.listener = n, this.on(t, r)
        }, i.prototype.emit = function(e) {
            if (this._events[e])
                for (var t = Array.prototype.slice.call(arguments, 1), n = this._events[e], r = n.length, i = 0; i < r; i++) n[i].apply(this, t)
        }, i.prototype.listeners = function(e) {
            return this._events[e] = this._events[e] || []
        };

        function g(t) {
            var n = this;
            if (!(this instanceof g)) return new g(arguments[0], arguments[1], arguments[2]);
            i.call(this), "number" == typeof t && (t = {
                cols: arguments[0],
                rows: arguments[1],
                handler: arguments[2]
            }), t = t || {}, s(a(g.defaults), function(e) {
                null == t[e] && (t[e] = g.options[e], g[e] !== g.defaults[e] && (t[e] = g[e])), n[e] = t[e]
            }), 8 === t.colors.length ? t.colors = t.colors.concat(g._colors.slice(8)) : 16 === t.colors.length ? t.colors = t.colors.concat(g._colors.slice(16)) : 10 === t.colors.length ? t.colors = t.colors.slice(0, -2).concat(g._colors.slice(8, -2), t.colors.slice(-2)) : 18 === t.colors.length && (t.colors = t.colors.slice(0, -2).concat(g._colors.slice(16, -2), t.colors.slice(-2))), this.colors = t.colors, this.options = t, this.parent = t.body || t.parent || (r ? r.getElementsByTagName("body")[0] : null), this.cols = t.cols || t.geometry[0], this.rows = t.rows || t.geometry[1], t.handler && this.on("data", t.handler), this.ybase = 0, this.ydisp = 0, this.x = 0, this.y = 0, this.cursorState = 0, this.cursorHidden = !1, this.convertEol, this.state = 0, this.queue = "", this.scrollTop = 0, this.scrollBottom = this.rows - 1, this.applicationKeypad = !1, this.applicationCursor = !1, this.originMode = !1, this.insertMode = !1, this.wraparoundMode = !1, this.normal = null, this.prefixMode = !1, this.selectMode = !1, this.visualMode = !1, this.searchMode = !1, this.searchDown, this.entry = "", this.entryPrefix = "Search: ", this._real, this._selected, this._textarea, this.charset = null, this.gcharset = null, this.glevel = 0, this.charsets = [null], this.decLocator, this.x10Mouse, this.vt200Mouse, this.vt300Mouse, this.normalMouse, this.mouseEvents, this.sendFocus, this.utfMouse, this.sgrMouse, this.urxvtMouse, this.element, this.children, this.refreshStart, this.refreshEnd, this.savedX, this.savedY, this.savedCols, this.readable = !0, this.writable = !0, this.defAttr = 131840, this.curAttr = this.defAttr, this.params = [], this.currentParam = 0, this.prefix = "", this.postfix = "", this.lines = [];
            for (var e = this.rows; e--;) this.lines.push(this.blankLine());
            this.tabs, this.setupStops()
        }

        function u(e, t, n, r) {
            e.addEventListener(t, n, r || !1)
        }

        function h(e, t, n, r) {
            e.removeEventListener(t, n, r || !1)
        }

        function d(e) {
            return e.preventDefault && e.preventDefault(), e.returnValue = !1, e.stopPropagation && e.stopPropagation(), !(e.cancelBubble = !0)
        }

        function e(e, t) {
            function n() {
                this.constructor = e
            }
            n.prototype = t.prototype, e.prototype = new n
        }
        e(g, i), g.prototype.eraseAttr = function() {
            return -512 & this.defAttr | 511 & this.curAttr
        }, g.tangoColors = ["#2e3436", "#cc0000", "#4e9a06", "#c4a000", "#3465a4", "#75507b", "#06989a", "#d3d7cf", "#555753", "#ef2929", "#8ae234", "#fce94f", "#729fcf", "#ad7fa8", "#34e2e2", "#eeeeec"], g.xtermColors = ["#000000", "#cd0000", "#00cd00", "#cdcd00", "#0000ee", "#cd00cd", "#00cdcd", "#e5e5e5", "#7f7f7f", "#ff0000", "#00ff00", "#ffff00", "#5c5cff", "#ff00ff", "#00ffff", "#ffffff"], (g.colors = function() {
            var e, r = g.tangoColors.slice(),
                t = [0, 95, 135, 175, 215, 255];
            for (e = 0; e < 216; e++) n(t[e / 36 % 6 | 0], t[e / 6 % 6 | 0], t[e % 6]);
            for (e = 0; e < 24; e++) n(t = 8 + 10 * e, t, t);

            function n(e, t, n) {
                r.push("#" + i(e) + i(t) + i(n))
            }

            function i(e) {
                return (e = e.toString(16)).length < 2 ? "0" + e : e
            }
            return r
        }())[256] = "#000000", g.colors[257] = "#f0f0f0", g._colors = g.colors.slice(), g.vcolors = function() {
            for (var e, t = [], n = g.colors, r = 0; r < 256; r++) e = parseInt(n[r].substring(1), 16), t.push([e >> 16 & 255, e >> 8 & 255, 255 & e]);
            return t
        }(), g.defaults = {
            colors: g.colors,
            convertEol: !1,
            termName: "xterm",
            geometry: [80, 24],
            cursorBlink: !0,
            visualBell: !1,
            popOnBell: !1,
            scrollback: 1e3,
            screenKeys: !1,
            debug: !1,
            useStyle: !1
        }, g.options = {}, s(a(g.defaults), function(e) {
            g[e] = g.defaults[e], g.options[e] = g.defaults[e]
        }), g.focus = null, g.prototype.focus = function() {
            g.focus !== this && (g.focus && g.focus.blur(), this.sendFocus && this.send("[I"), this.showCursor(), g.focus = this)
        }, g.prototype.blur = function() {
            g.focus === this && (this.cursorState = 0, this.refresh(this.y, this.y), this.sendFocus && this.send("[O"), g.focus = null)
        }, g.prototype.initGlobal = function() {
            var e = this.document;
            ~ function(e, t) {
                var n = e.length;
                for (; n--;)
                    if (e[n] === t) return n;
                return -1
            }(g._boundDocs = g._boundDocs || [], e) || (g._boundDocs.push(e), g.bindPaste(e), g.bindKeys(e), g.bindCopy(e), this.isMobile && this.fixMobile(e), this.useStyle && g.insertStyle(e, this.colors[256], this.colors[257]))
        }, g.bindPaste = function(e) {
            u(e.defaultView, "paste", function(e) {
                var t = g.focus;
                if (t) return e.clipboardData ? t.send(e.clipboardData.getData("text/plain")) : t.context.clipboardData && t.send(t.context.clipboardData.getData("Text")), t.element.contentEditable = "inherit", d(e)
            })
        }, g.bindKeys = function(e) {
            u(e, "keydown", function(e) {
                if (g.focus) {
                    var t = e.target || e.srcElement;
                    if (t) return t === g.focus.element || t === g.focus.context || t === g.focus.document || t === g.focus.body || t === g._textarea || t === g.focus.parent ? g.focus.keyDown(e) : void 0
                }
            }, !0), u(e, "keypress", function(e) {
                if (g.focus) {
                    var t = e.target || e.srcElement;
                    if (t) return t === g.focus.element || t === g.focus.context || t === g.focus.document || t === g.focus.body || t === g._textarea || t === g.focus.parent ? g.focus.keyPress(e) : void 0
                }
            }, !0), u(e, "mousedown", function(e) {
                if (g.focus) {
                    var t = e.target || e.srcElement;
                    if (t) {
                        do {
                            if (t === g.focus.element) return
                        } while (t = t.parentNode);
                        g.focus.blur()
                    }
                }
            })
        }, g.bindCopy = function(e) {
            u(e.defaultView, "copy", function(e) {
                var t = g.focus;
                if (t && t._selected) {
                    var n = t.getCopyTextarea(),
                        r = t.grabText(t._selected.x1, t._selected.x2, t._selected.y1, t._selected.y2);
                    t.emit("copy", r), n.focus(), n.textContent = r, n.value = r, n.setSelectionRange(0, r.length), o(function() {
                        t.element.focus(), t.focus()
                    }, 1)
                }
            })
        }, g.prototype.fixMobile = function(e) {
            var t = this,
                n = e.createElement("textarea");
            n.style.position = "absolute", n.style.left = "-32000px", n.style.top = "-32000px", n.style.width = "0px", n.style.height = "0px", n.style.opacity = "0", n.style.backgroundColor = "transparent", n.style.borderStyle = "none", n.style.outlineStyle = "none", n.autocapitalize = "none", n.autocorrect = "off", e.getElementsByTagName("body")[0].appendChild(n), g._textarea = n, o(function() {
                n.focus()
            }, 1e3), this.isAndroid && u(n, "change", function() {
                var e = n.textContent || n.value;
                n.value = "", n.textContent = "", t.send(e + "\r")
            })
        }, g.insertStyle = function(e, t, n) {
            if (!(r = e.getElementById("term-style"))) {
                var r, i = e.getElementsByTagName("head")[0];
                if (i)(r = e.createElement("style")).id = "term-style", r.innerHTML = ".terminal {\n  float: left;\n  border: " + t + ' solid 5px;\n  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;\n  font-size: 11px;\n  color: ' + n + ";\n  background: " + t + ";\n}\n\n.terminal-cursor {\n  color: " + t + ";\n  background: " + n + ";\n}\n", i.insertBefore(r, i.firstChild)
            }
        }, g.prototype.open = function(e) {
            var t, n = this,
                r = 0;
            if (this.parent = e || this.parent, !this.parent) throw new Error("Terminal requires a parent element.");
            for (this.context = this.parent.ownerDocument.defaultView, this.document = this.parent.ownerDocument, this.body = this.document.getElementsByTagName("body")[0], this.context.navigator && this.context.navigator.userAgent && (this.isMac = !!~this.context.navigator.userAgent.indexOf("Mac"), this.isIpad = !!~this.context.navigator.userAgent.indexOf("iPad"), this.isIphone = !!~this.context.navigator.userAgent.indexOf("iPhone"), this.isAndroid = !!~this.context.navigator.userAgent.indexOf("Android"), this.isMobile = this.isIpad || this.isIphone || this.isAndroid, this.isMSIE = !!~this.context.navigator.userAgent.indexOf("MSIE")), this.element = this.document.createElement("div"), this.element.className = "terminal", this.element.style.outline = "none", this.element.setAttribute("tabindex", 0), this.element.setAttribute("spellcheck", "false"), this.element.style.backgroundColor = this.colors[256], this.element.style.color = this.colors[257], this.children = []; r < this.rows; r++) t = this.document.createElement("div"), this.element.appendChild(t), this.children.push(t);
            this.parent.appendChild(this.element), this.refresh(0, this.rows - 1), this.initGlobal(), this.focus(), this.startBlink(), u(this.element, "focus", function() {
                n.focus(), n.isMobile && g._textarea.focus()
            }), u(this.element, "mousedown", function() {
                n.focus()
            }), u(this.element, "mousedown", function(e) {
                var t = null != e.button ? +e.button : null != e.which ? e.which - 1 : null;
                n.isMSIE && (t = 1 === t ? 0 : 4 === t ? 1 : t), 2 === t && (n.element.contentEditable = "true", o(function() {
                    n.element.contentEditable = "inherit"
                }, 1))
            }, !0), this.bindMouse(), null == g.brokenBold && (g.brokenBold = function(e) {
                var t = e.getElementsByTagName("body")[0],
                    n = e.createElement("span");
                n.innerHTML = "hello world", t.appendChild(n);
                var r = n.scrollWidth;
                n.style.fontWeight = "bold";
                var i = n.scrollWidth;
                return t.removeChild(n), r !== i
            }(this.document)), o(function() {
                n.element.focus()
            }, 100)
        }, g.prototype.bindMouse = function() {
            var e = this.element,
                s = this,
                r = 32,
                a = "onmousewheel" in this.context ? "mousewheel" : "DOMMouseScroll";

            function n(e) {
                var t, n;
                if (t = function(e) {
                        var t, n, r, i, o;
                        switch (e.type) {
                            case "mousedown":
                                t = null != e.button ? +e.button : null != e.which ? e.which - 1 : null, s.isMSIE && (t = 1 === t ? 0 : 4 === t ? 1 : t);
                                break;
                            case "mouseup":
                                t = 3;
                                break;
                            case "DOMMouseScroll":
                                t = e.detail < 0 ? 64 : 65;
                                break;
                            case "mousewheel":
                                t = 0 < e.wheelDeltaY ? 64 : 65
                        }
                        n = e.shiftKey ? 4 : 0, r = e.metaKey ? 8 : 0, i = e.ctrlKey ? 16 : 0, o = n | r | i, s.vt200Mouse ? o &= i : s.normalMouse || (o = 0);
                        return t = 32 + (o << 2) + t
                    }(e), n = c(e)) switch (l(t, n), e.type) {
                    case "mousedown":
                        r = t;
                        break;
                    case "mouseup":
                        r = 32
                }
            }

            function i(e) {
                var t, n = r;
                (t = c(e)) && l(n += 32, t)
            }

            function o(e, t) {
                if (s.utfMouse) {
                    if (2047 === t) return e.push(0);
                    t < 127 ? e.push(t) : (2047 < t && (t = 2047), e.push(192 | t >> 6), e.push(128 | 63 & t))
                } else {
                    if (255 === t) return e.push(0);
                    127 < t && (t = 127), e.push(t)
                }
            }

            function l(e, t) {
                if (s.vt300Mouse) {
                    e &= 3, t.x -= 32, t.y -= 32;
                    var n = "[24";
                    if (0 === e) n += "1";
                    else if (1 === e) n += "3";
                    else if (2 === e) n += "5";
                    else {
                        if (3 === e) return;
                        n += "0"
                    }
                    return n += "~[" + t.x + "," + t.y + "]\r", void s.send(n)
                }
                return s.decLocator ? (e &= 3, t.x -= 32, t.y -= 32, 0 === e ? e = 2 : 1 === e ? e = 4 : 2 === e ? e = 6 : 3 === e && (e = 3), void s.send("[" + e + ";" + (3 === e ? 4 : 0) + ";" + t.y + ";" + t.x + ";" + (t.page || 0) + "&w")) : s.urxvtMouse ? (t.x -= 32, t.y -= 32, t.x++, t.y++, void s.send("[" + e + ";" + t.x + ";" + t.y + "M")) : s.sgrMouse ? (t.x -= 32, t.y -= 32, void s.send("[<" + (3 == (3 & e) ? -4 & e : e) + ";" + t.x + ";" + t.y + (3 == (3 & e) ? "m" : "M"))) : (o(n = [], e), o(n, t.x), o(n, t.y), void s.send("[M" + f.fromCharCode.apply(f, n)))
            }

            function c(e) {
                var t, n, r, i, o;
                if (null != e.pageX) {
                    for (t = e.pageX, n = e.pageY, o = s.element; o && o !== s.document.documentElement;) t -= o.offsetLeft, n -= o.offsetTop, o = "offsetParent" in o ? o.offsetParent : o.parentNode;
                    return r = s.element.clientWidth, i = s.element.clientHeight, t = Math.round(t / r * s.cols), n = Math.round(n / i * s.rows), t < 0 && (t = 0), t > s.cols && (t = s.cols), n < 0 && (n = 0), n > s.rows && (n = s.rows), {
                        x: t += 32,
                        y: n += 32,
                        type: e.type === a ? "mousewheel" : e.type
                    }
                }
            }
            u(e, "mousedown", function(e) {
                if (s.mouseEvents) return n(e), s.focus(), s.vt200Mouse ? n({
                    __proto__: e,
                    type: "mouseup"
                }) : (s.normalMouse && u(s.document, "mousemove", i), s.x10Mouse || u(s.document, "mouseup", function e(t) {
                    return n(t), s.normalMouse && h(s.document, "mousemove", i), h(s.document, "mouseup", e), d(t)
                })), d(e)
            }), u(e, a, function(e) {
                if (s.mouseEvents && !(s.x10Mouse || s.vt300Mouse || s.decLocator)) return n(e), d(e)
            }), u(e, a, function(e) {
                if (!s.mouseEvents && !s.applicationKeypad) return "DOMMouseScroll" === e.type ? s.scrollDisp(e.detail < 0 ? -5 : 5) : s.scrollDisp(0 < e.wheelDeltaY ? -5 : 5), d(e)
            })
        }, g.prototype.destroy = function() {
            this.readable = !1, this.writable = !1, this._events = {}, this.handler = function() {}, this.write = function() {}, this.element.parentNode && this.element.parentNode.removeChild(this.element)
        }, g.prototype.refresh = function(e, t) {
            var n, r, i, o, s, a, l, c, u, h, d, f, p, m;
            for (t - e >= this.rows / 2 && (m = this.element.parentNode) && m.removeChild(this.element), l = this.cols, r = e, t >= this.lines.length && (this.log("`end` is too large. Most likely a bad CSR."), t = this.lines.length - 1); r <= t; r++) {
                for (p = r + this.ydisp, o = this.lines[p], s = "", n = r !== this.y || !this.cursorState || this.ydisp !== this.ybase && !this.selectMode || this.cursorHidden ? -1 : this.x, u = this.defAttr, i = 0; i < l; i++) {
                    switch (c = o[i][0], a = o[i][1], i === n && (c = -1), c !== u && (u !== this.defAttr && (s += "</span>"), c !== this.defAttr && (-1 === c ? s += '<span class="reverse-video terminal-cursor">' : (s += '<span style="', h = 511 & c, d = c >> 9 & 511, 1 & (f = c >> 18) && (g.brokenBold || (s += "font-weight:bold;"), d < 8 && (d += 8)), 2 & f && (s += "text-decoration:underline;"), 4 & f && (2 & f ? (s = s.slice(0, -1), s += " blink;") : s += "text-decoration:blink;"), 8 & f && (h = c >> 9 & 511, d = 511 & c, 1 & f && d < 8 && (d += 8)), 16 & f && (s += "visibility:hidden;"), 256 !== h && (s += "background-color:" + this.colors[h] + ";"), 257 !== d && (s += "color:" + this.colors[d] + ";"), s += '">'))), a) {
                        case "&":
                            s += "&amp;";
                            break;
                        case "<":
                            s += "&lt;";
                            break;
                        case ">":
                            s += "&gt;";
                            break;
                        default:
                            a <= " " ? s += "&nbsp;" : (v(a) && i++, s += a)
                    }
                    u = c
                }
                u !== this.defAttr && (s += "</span>"), this.children[r].innerHTML = s
            }
            m && m.appendChild(this.element)
        }, g.prototype._cursorBlink = function() {
            g.focus === this && (this.cursorState ^= 1, this.refresh(this.y, this.y))
        }, g.prototype.showCursor = function() {
            this.cursorState || (this.cursorState = 1, this.refresh(this.y, this.y))
        }, g.prototype.startBlink = function() {
            if (this.cursorBlink) {
                var e = this;
                this._blinker = function() {
                    e._cursorBlink()
                }, this._blink = t(this._blinker, 500)
            }
        }, g.prototype.refreshBlink = function() {
            this.cursorBlink && (clearInterval(this._blink), this._blink = t(this._blinker, 500))
        }, g.prototype.scroll = function() {
            var e;
            ++this.ybase === this.scrollback && (this.ybase = this.ybase / 2 | 0, this.lines = this.lines.slice(1 - (this.ybase + this.rows))), this.ydisp = this.ybase, e = this.ybase + this.rows - 1, (e -= this.rows - 1 - this.scrollBottom) === this.lines.length ? this.lines.push(this.blankLine()) : this.lines.splice(e, 0, this.blankLine()), 0 !== this.scrollTop && (0 !== this.ybase && (this.ybase--, this.ydisp = this.ybase), this.lines.splice(this.ybase + this.scrollTop, 1)), this.updateRange(this.scrollTop), this.updateRange(this.scrollBottom)
        }, g.prototype.scrollDisp = function(e) {
            this.ydisp += e, this.ydisp > this.ybase ? this.ydisp = this.ybase : this.ydisp < 0 && (this.ydisp = 0), this.refresh(0, this.rows - 1)
        }, g.prototype.write = function(e) {
            var t, n, r, i = e.length,
                o = 0;
            for (this.refreshStart = this.y, this.refreshEnd = this.y, this.ybase !== this.ydisp && (this.ydisp = this.ybase, this.maxRange()); o < i; o++) switch (r = e[o], this.state) {
                case 0:
                    switch (r) {
                        case "":
                            this.bell();
                            break;
                        case "\n":
                        case "\v":
                        case "\f":
                            this.convertEol && (this.x = 0), this.y++, this.y > this.scrollBottom && (this.y--, this.scroll());
                            break;
                        case "\r":
                            this.x = 0;
                            break;
                        case "\b":
                            0 < this.x && this.x--;
                            break;
                        case "\t":
                            this.x = this.nextStop();
                            break;
                        case "":
                            this.setgLevel(1);
                            break;
                        case "":
                            this.setgLevel(0);
                            break;
                        case "":
                            this.state = 1;
                            break;
                        default:
                            if (" " <= r && (this.charset && this.charset[r] && (r = this.charset[r]), this.x >= this.cols && (this.x = 0, this.y++, this.y > this.scrollBottom && (this.y--, this.scroll())), this.lines[this.y + this.ybase][this.x] = [this.curAttr, r], this.x++, this.updateRange(this.y), v(r))) {
                                if (t = this.y + this.ybase, this.cols < 2 || this.x >= this.cols) {
                                    this.lines[t][this.x - 1] = [this.curAttr, " "];
                                    break
                                }
                                this.lines[t][this.x] = [this.curAttr, " "], this.x++
                            }
                    }
                    break;
                case 1:
                    switch (r) {
                        case "[":
                            this.params = [], this.currentParam = 0, this.state = 2;
                            break;
                        case "]":
                            this.params = [], this.currentParam = 0, this.state = 3;
                            break;
                        case "P":
                            this.params = [], this.currentParam = 0, this.state = 5;
                            break;
                        case "_":
                        case "^":
                            this.state = 6;
                            break;
                        case "c":
                            this.reset();
                            break;
                        case "E":
                            this.x = 0;
                        case "D":
                            this.index();
                            break;
                        case "M":
                            this.reverseIndex();
                            break;
                        case "%":
                            this.setgLevel(0), this.setgCharset(0, g.charsets.US), this.state = 0, o++;
                            break;
                        case "(":
                        case ")":
                        case "*":
                        case "+":
                        case "-":
                        case ".":
                            switch (r) {
                                case "(":
                                    this.gcharset = 0;
                                    break;
                                case ")":
                                    this.gcharset = 1;
                                    break;
                                case "*":
                                    this.gcharset = 2;
                                    break;
                                case "+":
                                    this.gcharset = 3;
                                    break;
                                case "-":
                                    this.gcharset = 1;
                                    break;
                                case ".":
                                    this.gcharset = 2
                            }
                            this.state = 4;
                            break;
                        case "/":
                            this.gcharset = 3, this.state = 4, o--;
                            break;
                        case "N":
                        case "O":
                            break;
                        case "n":
                            this.setgLevel(2);
                            break;
                        case "o":
                        case "|":
                            this.setgLevel(3);
                            break;
                        case "}":
                            this.setgLevel(2);
                            break;
                        case "~":
                            this.setgLevel(1);
                            break;
                        case "7":
                            this.saveCursor(), this.state = 0;
                            break;
                        case "8":
                            this.restoreCursor(), this.state = 0;
                            break;
                        case "#":
                            this.state = 0, o++;
                            break;
                        case "H":
                            this.tabSet();
                            break;
                        case "=":
                            this.log("Serial port requested application keypad."), this.applicationKeypad = !0, this.state = 0;
                            break;
                        case ">":
                            this.log("Switching back to normal keypad."), this.applicationKeypad = !1, this.state = 0;
                            break;
                        default:
                            this.state = 0, this.error("Unknown ESC control: %s.", r)
                    }
                    break;
                case 4:
                    switch (r) {
                        case "0":
                            n = g.charsets.SCLD;
                            break;
                        case "A":
                            n = g.charsets.UK;
                            break;
                        case "B":
                            n = g.charsets.US;
                            break;
                        case "4":
                            n = g.charsets.Dutch;
                            break;
                        case "C":
                        case "5":
                            n = g.charsets.Finnish;
                            break;
                        case "R":
                            n = g.charsets.French;
                            break;
                        case "Q":
                            n = g.charsets.FrenchCanadian;
                            break;
                        case "K":
                            n = g.charsets.German;
                            break;
                        case "Y":
                            n = g.charsets.Italian;
                            break;
                        case "E":
                        case "6":
                            n = g.charsets.NorwegianDanish;
                            break;
                        case "Z":
                            n = g.charsets.Spanish;
                            break;
                        case "H":
                        case "7":
                            n = g.charsets.Swedish;
                            break;
                        case "=":
                            n = g.charsets.Swiss;
                            break;
                        case "/":
                            n = g.charsets.ISOLatin, o++;
                            break;
                        default:
                            n = g.charsets.US
                    }
                    this.setgCharset(this.gcharset, n), this.gcharset = null, this.state = 0;
                    break;
                case 3:
                    if ("" === r || "" === r) {
                        switch ("" === r && o++, this.params.push(this.currentParam), this.params[0]) {
                            case 0:
                            case 1:
                            case 2:
                                this.params[1] && (this.title = this.params[1], this.handleTitle(this.title))
                        }
                        this.params = [], this.currentParam = 0, this.state = 0
                    } else this.params.length ? this.currentParam += r : "0" <= r && r <= "9" ? this.currentParam = 10 * this.currentParam + r.charCodeAt(0) - 48 : ";" === r && (this.params.push(this.currentParam), this.currentParam = "");
                    break;
                case 2:
                    if ("?" === r || ">" === r || "!" === r) {
                        this.prefix = r;
                        break
                    }
                    if ("0" <= r && r <= "9") {
                        this.currentParam = 10 * this.currentParam + r.charCodeAt(0) - 48;
                        break
                    }
                    if ("$" === r || '"' === r || " " === r || "'" === r) {
                        this.postfix = r;
                        break
                    }
                    if (this.params.push(this.currentParam), this.currentParam = 0, ";" === r) break;
                    switch (this.state = 0, r) {
                        case "A":
                            this.cursorUp(this.params);
                            break;
                        case "B":
                            this.cursorDown(this.params);
                            break;
                        case "C":
                            this.cursorForward(this.params);
                            break;
                        case "D":
                            this.cursorBackward(this.params);
                            break;
                        case "H":
                            this.cursorPos(this.params);
                            break;
                        case "J":
                            this.eraseInDisplay(this.params);
                            break;
                        case "K":
                            this.eraseInLine(this.params);
                            break;
                        case "m":
                            this.prefix || this.charAttributes(this.params);
                            break;
                        case "n":
                            this.prefix || this.deviceStatus(this.params);
                            break;
                        case "@":
                            this.insertChars(this.params);
                            break;
                        case "E":
                            this.cursorNextLine(this.params);
                            break;
                        case "F":
                            this.cursorPrecedingLine(this.params);
                            break;
                        case "G":
                            this.cursorCharAbsolute(this.params);
                            break;
                        case "L":
                            this.insertLines(this.params);
                            break;
                        case "M":
                            this.deleteLines(this.params);
                            break;
                        case "P":
                            this.deleteChars(this.params);
                            break;
                        case "X":
                            this.eraseChars(this.params);
                            break;
                        case "`":
                            this.charPosAbsolute(this.params);
                            break;
                        case "a":
                            this.HPositionRelative(this.params);
                            break;
                        case "c":
                            this.sendDeviceAttributes(this.params);
                            break;
                        case "d":
                            this.linePosAbsolute(this.params);
                            break;
                        case "e":
                            this.VPositionRelative(this.params);
                            break;
                        case "f":
                            this.HVPosition(this.params);
                            break;
                        case "h":
                            this.setMode(this.params);
                            break;
                        case "l":
                            this.resetMode(this.params);
                            break;
                        case "r":
                            this.setScrollRegion(this.params);
                            break;
                        case "s":
                            this.saveCursor(this.params);
                            break;
                        case "u":
                            this.restoreCursor(this.params);
                            break;
                        case "I":
                            this.cursorForwardTab(this.params);
                            break;
                        case "S":
                            this.scrollUp(this.params);
                            break;
                        case "T":
                            this.params.length < 2 && !this.prefix && this.scrollDown(this.params);
                            break;
                        case "Z":
                            this.cursorBackwardTab(this.params);
                            break;
                        case "b":
                            this.repeatPrecedingCharacter(this.params);
                            break;
                        case "g":
                            this.tabClear(this.params);
                            break;
                        case "p":
                            switch (this.prefix) {
                                case "!":
                                    this.softReset(this.params)
                            }
                            break;
                        default:
                            this.error("Unknown CSI code: %s.", r)
                    }
                    this.prefix = "", this.postfix = "";
                    break;
                case 5:
                    if ("" === r || "" === r) {
                        switch ("" === r && o++, this.prefix) {
                            case "":
                                break;
                            case "$q":
                                var s = !1;
                                switch (a = this.currentParam) {
                                    case '"q':
                                        a = '0"q';
                                        break;
                                    case '"p':
                                        a = '61"p';
                                        break;
                                    case "r":
                                        a = this.scrollTop + 1 + ";" + (this.scrollBottom + 1) + "r";
                                        break;
                                    case "m":
                                        a = "0m";
                                        break;
                                    default:
                                        this.error("Unknown DCS Pt: %s.", a), a = ""
                                }
                                this.send("P" + +s + "$r" + a + "\\");
                                break;
                            case "+p":
                                break;
                            case "+q":
                                var a = this.currentParam;
                                s = !1;
                                this.send("P" + +s + "+r" + a + "\\");
                                break;
                            default:
                                this.error("Unknown DCS prefix: %s.", this.prefix)
                        }
                        this.currentParam = 0, this.prefix = "", this.state = 0
                    } else this.currentParam ? this.currentParam += r : this.prefix || "$" === r || "+" === r ? 2 === this.prefix.length ? this.currentParam = r : this.prefix += r : this.currentParam = r;
                    break;
                case 6:
                    "" !== r && "" !== r || ("" === r && o++, this.state = 0)
            }
            this.updateRange(this.y), this.refresh(this.refreshStart, this.refreshEnd)
        }, g.prototype.writeln = function(e) {
            this.write(e + "\r\n")
        }, g.prototype.keyDown = function(e) {
            var t, n = this;
            switch (e.keyCode) {
                case 8:
                    if (e.shiftKey) {
                        t = "\b";
                        break
                    }
                    t = "";
                    break;
                case 9:
                    if (e.shiftKey) {
                        t = "[Z";
                        break
                    }
                    t = "\t";
                    break;
                case 13:
                    t = "\r";
                    break;
                case 27:
                    t = "";
                    break;
                case 37:
                    if (this.applicationCursor) {
                        t = "OD";
                        break
                    }
                    t = "[D";
                    break;
                case 39:
                    if (this.applicationCursor) {
                        t = "OC";
                        break
                    }
                    t = "[C";
                    break;
                case 38:
                    if (this.applicationCursor) {
                        t = "OA";
                        break
                    }
                    if (e.ctrlKey) return this.scrollDisp(-1), d(e);
                    t = "[A";
                    break;
                case 40:
                    if (this.applicationCursor) {
                        t = "OB";
                        break
                    }
                    if (e.ctrlKey) return this.scrollDisp(1), d(e);
                    t = "[B";
                    break;
                case 46:
                    t = "[3~";
                    break;
                case 45:
                    t = "[2~";
                    break;
                case 36:
                    if (this.applicationKeypad) {
                        t = "OH";
                        break
                    }
                    t = "OH";
                    break;
                case 35:
                    if (this.applicationKeypad) {
                        t = "OF";
                        break
                    }
                    t = "OF";
                    break;
                case 33:
                    if (e.shiftKey) return this.scrollDisp(-(this.rows - 1)), d(e);
                    t = "[5~";
                    break;
                case 34:
                    if (e.shiftKey) return this.scrollDisp(this.rows - 1), d(e);
                    t = "[6~";
                    break;
                case 112:
                    t = "OP";
                    break;
                case 113:
                    t = "OQ";
                    break;
                case 114:
                    t = "OR";
                    break;
                case 115:
                    t = "OS";
                    break;
                case 116:
                    t = "[15~";
                    break;
                case 117:
                    t = "[17~";
                    break;
                case 118:
                    t = "[18~";
                    break;
                case 119:
                    t = "[19~";
                    break;
                case 120:
                    t = "[20~";
                    break;
                case 121:
                    t = "[21~";
                    break;
                case 122:
                    t = "[23~";
                    break;
                case 123:
                    t = "[24~";
                    break;
                default:
                    if (e.ctrlKey)
                        if (65 <= e.keyCode && e.keyCode <= 90) {
                            if (this.screenKeys && !this.prefixMode && !this.selectMode && 65 === e.keyCode) return this.enterPrefix(), d(e);
                            if (this.prefixMode && 86 === e.keyCode) return void this.leavePrefix();
                            if ((this.prefixMode || this.selectMode) && 67 === e.keyCode) return void(this.visualMode && o(function() {
                                n.leaveVisual()
                            }, 1));
                            t = f.fromCharCode(e.keyCode - 64)
                        } else 32 === e.keyCode ? t = f.fromCharCode(0) : 51 <= e.keyCode && e.keyCode <= 55 ? t = f.fromCharCode(e.keyCode - 51 + 27) : 56 === e.keyCode ? t = f.fromCharCode(127) : 219 === e.keyCode ? t = f.fromCharCode(27) : 221 === e.keyCode && (t = f.fromCharCode(29));
                    else(!this.isMac && e.altKey || this.isMac && e.metaKey) && (65 <= e.keyCode && e.keyCode <= 90 ? t = "" + f.fromCharCode(e.keyCode + 32) : 192 === e.keyCode ? t = "`" : 48 <= e.keyCode && e.keyCode <= 57 && (t = "" + (e.keyCode - 48)))
            }
            return !t || (this.prefixMode ? this.leavePrefix() : this.selectMode ? this.keySelect(e, t) : (this.emit("keydown", e), this.emit("key", t, e), this.showCursor(), this.handler(t)), d(e))
        }, g.prototype.setgLevel = function(e) {
            this.glevel = e, this.charset = this.charsets[e]
        }, g.prototype.setgCharset = function(e, t) {
            this.charsets[e] = t, this.glevel === e && (this.charset = t)
        }, g.prototype.keyPress = function(e) {
            var t;
            if (d(e), e.charCode) t = e.charCode;
            else if (null == e.which) t = e.keyCode;
            else {
                if (0 === e.which || 0 === e.charCode) return !1;
                t = e.which
            }
            return !(!t || e.ctrlKey || e.altKey || e.metaKey) && (t = f.fromCharCode(t), this.prefixMode ? (this.leavePrefix(), this.keyPrefix(e, t)) : this.selectMode ? this.keySelect(e, t) : (this.emit("keypress", t, e), this.emit("key", t, e), this.showCursor(), this.handler(t)), !1)
        }, g.prototype.send = function(e) {
            var t = this;
            this.queue || o(function() {
                t.handler(t.queue), t.queue = ""
            }, 1), this.queue += e
        }, g.prototype.bell = function() {
            if (this.emit("bell"), this.visualBell) {
                var e = this;
                this.element.style.borderColor = "white", o(function() {
                    e.element.style.borderColor = ""
                }, 10), this.popOnBell && this.focus()
            }
        }, g.prototype.log = function() {
            if (this.debug && this.context.console && this.context.console.log) {
                var e = Array.prototype.slice.call(arguments);
                this.context.console.log.apply(this.context.console, e)
            }
        }, g.prototype.error = function() {
            if (this.debug && this.context.console && this.context.console.error) {
                var e = Array.prototype.slice.call(arguments);
                this.context.console.error.apply(this.context.console, e)
            }
        }, g.prototype.resize = function(e, t) {
            var n, r, i, o, s;
            if (e < 1 && (e = 1), t < 1 && (t = 1), (o = this.cols) < e)
                for (s = [this.defAttr, " "], i = this.lines.length; i--;)
                    for (; this.lines[i].length < e;) this.lines[i].push(s);
            else if (e < o)
                for (i = this.lines.length; i--;)
                    for (; this.lines[i].length > e;) this.lines[i].pop();
            if (this.setupStops(o), this.cols = e, (o = this.rows) < t)
                for (r = this.element; o++ < t;) this.lines.length < t + this.ybase && this.lines.push(this.blankLine()), this.children.length < t && (n = this.document.createElement("div"), r.appendChild(n), this.children.push(n));
            else if (t < o)
                for (; o-- > t;)
                    if (this.lines.length > t + this.ybase && this.lines.pop(), this.children.length > t) {
                        if (!(r = this.children.pop())) continue;
                        r.parentNode.removeChild(r)
                    } this.rows = t, this.y >= t && (this.y = t - 1), this.x >= e && (this.x = e - 1), this.scrollTop = 0, this.scrollBottom = t - 1, this.refresh(0, this.rows - 1), this.normal = null
        }, g.prototype.updateRange = function(e) {
            e < this.refreshStart && (this.refreshStart = e), e > this.refreshEnd && (this.refreshEnd = e)
        }, g.prototype.maxRange = function() {
            this.refreshStart = 0, this.refreshEnd = this.rows - 1
        }, g.prototype.setupStops = function(e) {
            for (null != e ? this.tabs[e] || (e = this.prevStop(e)) : (this.tabs = {}, e = 0); e < this.cols; e += 8) this.tabs[e] = !0
        }, g.prototype.prevStop = function(e) {
            for (null == e && (e = this.x); !this.tabs[--e] && 0 < e;);
            return e >= this.cols ? this.cols - 1 : e < 0 ? 0 : e
        }, g.prototype.nextStop = function(e) {
            for (null == e && (e = this.x); !this.tabs[++e] && e < this.cols;);
            return e >= this.cols ? this.cols - 1 : e < 0 ? 0 : e
        }, g.prototype.eraseRight = function(e, t) {
            for (var n = this.lines[this.ybase + t], r = [this.eraseAttr(), " "]; e < this.cols; e++) n[e] = r;
            this.updateRange(t)
        }, g.prototype.eraseLeft = function(e, t) {
            var n = this.lines[this.ybase + t],
                r = [this.eraseAttr(), " "];
            for (e++; e--;) n[e] = r;
            this.updateRange(t)
        }, g.prototype.eraseLine = function(e) {
            this.eraseRight(0, e)
        }, g.prototype.blankLine = function(e) {
            for (var t = [e ? this.eraseAttr() : this.defAttr, " "], n = [], r = 0; r < this.cols; r++) n[r] = t;
            return n
        }, g.prototype.ch = function(e) {
            return e ? [this.eraseAttr(), " "] : [this.defAttr, " "]
        }, g.prototype.is = function(e) {
            return 0 === (this.termName + "").indexOf(e)
        }, g.prototype.handler = function(e) {
            this.emit("data", e)
        }, g.prototype.handleTitle = function(e) {
            this.emit("title", e)
        }, g.prototype.index = function() {
            this.y++, this.y > this.scrollBottom && (this.y--, this.scroll()), this.state = 0
        }, g.prototype.reverseIndex = function() {
            var e;
            this.y--, this.y < this.scrollTop && (this.y++, this.lines.splice(this.y + this.ybase, 0, this.blankLine(!0)), e = this.rows - 1 - this.scrollBottom, this.lines.splice(this.rows - 1 + this.ybase - e + 1, 1), this.updateRange(this.scrollTop), this.updateRange(this.scrollBottom)), this.state = 0
        }, g.prototype.reset = function() {
            this.options.rows = this.rows, this.options.cols = this.cols, g.call(this, this.options), this.refresh(0, this.rows - 1)
        }, g.prototype.tabSet = function() {
            this.tabs[this.x] = !0, this.state = 0
        }, g.prototype.cursorUp = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.y -= t, this.y < 0 && (this.y = 0)
        }, g.prototype.cursorDown = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.y += t, this.y >= this.rows && (this.y = this.rows - 1)
        }, g.prototype.cursorForward = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.x += t, this.x >= this.cols && (this.x = this.cols - 1)
        }, g.prototype.cursorBackward = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.x -= t, this.x < 0 && (this.x = 0)
        }, g.prototype.cursorPos = function(e) {
            var t, n;
            t = e[0] - 1, n = 2 <= e.length ? e[1] - 1 : 0, t < 0 ? t = 0 : t >= this.rows && (t = this.rows - 1), n < 0 ? n = 0 : n >= this.cols && (n = this.cols - 1), this.x = n, this.y = t
        }, g.prototype.eraseInDisplay = function(e) {
            var t;
            switch (e[0]) {
                case 0:
                    for (this.eraseRight(this.x, this.y), t = this.y + 1; t < this.rows; t++) this.eraseLine(t);
                    break;
                case 1:
                    for (this.eraseLeft(this.x, this.y), t = this.y; t--;) this.eraseLine(t);
                    break;
                case 2:
                    for (t = this.rows; t--;) this.eraseLine(t)
            }
        }, g.prototype.eraseInLine = function(e) {
            switch (e[0]) {
                case 0:
                    this.eraseRight(this.x, this.y);
                    break;
                case 1:
                    this.eraseLeft(this.x, this.y);
                    break;
                case 2:
                    this.eraseLine(this.y)
            }
        }, g.prototype.charAttributes = function(e) {
            if (1 !== e.length || 0 !== e[0]) {
                for (var t, n = e.length, r = 0, i = this.curAttr >> 18, o = this.curAttr >> 9 & 511, s = 511 & this.curAttr; r < n; r++) 30 <= (t = e[r]) && t <= 37 ? o = t - 30 : 40 <= t && t <= 47 ? s = t - 40 : 90 <= t && t <= 97 ? o = (t += 8) - 90 : 100 <= t && t <= 107 ? s = (t += 8) - 100 : 0 === t ? (i = this.defAttr >> 18, o = this.defAttr >> 9 & 511, s = 511 & this.defAttr) : 1 === t ? i |= 1 : 4 === t ? i |= 2 : 5 === t ? i |= 4 : 7 === t ? i |= 8 : 8 === t ? i |= 16 : 22 === t ? i &= -2 : 24 === t ? i &= -3 : 25 === t ? i &= -5 : 27 === t ? i &= -9 : 28 === t ? i &= -17 : 39 === t ? o = this.defAttr >> 9 & 511 : 49 === t ? s = 511 & this.defAttr : 38 === t ? 2 === e[r + 1] ? (-1 === (o = p(255 & e[r += 2], 255 & e[r + 1], 255 & e[r + 2])) && (o = 511), r += 2) : 5 === e[r + 1] && (o = t = 255 & e[r += 2]) : 48 === t ? 2 === e[r + 1] ? (-1 === (s = p(255 & e[r += 2], 255 & e[r + 1], 255 & e[r + 2])) && (s = 511), r += 2) : 5 === e[r + 1] && (s = t = 255 & e[r += 2]) : 100 === t ? (o = this.defAttr >> 9 & 511, s = 511 & this.defAttr) : this.error("Unknown SGR attribute: %d.", t);
                this.curAttr = i << 18 | o << 9 | s
            } else this.curAttr = this.defAttr
        }, g.prototype.deviceStatus = function(e) {
            if (this.prefix) {
                if ("?" === this.prefix) switch (e[0]) {
                    case 6:
                        this.send("[?" + (this.y + 1) + ";" + (this.x + 1) + "R")
                }
            } else switch (e[0]) {
                case 5:
                    this.send("[0n");
                    break;
                case 6:
                    this.send("[" + (this.y + 1) + ";" + (this.x + 1) + "R")
            }
        }, g.prototype.insertChars = function(e) {
            var t, n, r, i;
            for ((t = e[0]) < 1 && (t = 1), n = this.y + this.ybase, r = this.x, i = [this.eraseAttr(), " "]; t-- && r < this.cols;) this.lines[n].splice(r++, 0, i), this.lines[n].pop()
        }, g.prototype.cursorNextLine = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.y += t, this.y >= this.rows && (this.y = this.rows - 1), this.x = 0
        }, g.prototype.cursorPrecedingLine = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.y -= t, this.y < 0 && (this.y = 0), this.x = 0
        }, g.prototype.cursorCharAbsolute = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.x = t - 1
        }, g.prototype.insertLines = function(e) {
            var t, n, r;
            for ((t = e[0]) < 1 && (t = 1), n = this.y + this.ybase, r = this.rows - 1 - this.scrollBottom, r = this.rows - 1 + this.ybase - r + 1; t--;) this.lines.splice(n, 0, this.blankLine(!0)), this.lines.splice(r, 1);
            this.updateRange(this.y), this.updateRange(this.scrollBottom)
        }, g.prototype.deleteLines = function(e) {
            var t, n, r;
            for ((t = e[0]) < 1 && (t = 1), n = this.y + this.ybase, r = this.rows - 1 - this.scrollBottom, r = this.rows - 1 + this.ybase - r; t--;) this.lines.splice(r + 1, 0, this.blankLine(!0)), this.lines.splice(n, 1);
            this.updateRange(this.y), this.updateRange(this.scrollBottom)
        }, g.prototype.deleteChars = function(e) {
            var t, n, r;
            for ((t = e[0]) < 1 && (t = 1), n = this.y + this.ybase, r = [this.eraseAttr(), " "]; t--;) this.lines[n].splice(this.x, 1), this.lines[n].push(r)
        }, g.prototype.eraseChars = function(e) {
            var t, n, r, i;
            for ((t = e[0]) < 1 && (t = 1), n = this.y + this.ybase, r = this.x, i = [this.eraseAttr(), " "]; t-- && r < this.cols;) this.lines[n][r++] = i
        }, g.prototype.charPosAbsolute = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.x = t - 1, this.x >= this.cols && (this.x = this.cols - 1)
        }, g.prototype.HPositionRelative = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.x += t, this.x >= this.cols && (this.x = this.cols - 1)
        }, g.prototype.sendDeviceAttributes = function(e) {
            0 < e[0] || (this.prefix ? ">" === this.prefix && (this.is("xterm") ? this.send("[>0;276;0c") : this.is("rxvt-unicode") ? this.send("[>85;95;0c") : this.is("linux") ? this.send(e[0] + "c") : this.is("screen") && this.send("[>83;40003;0c")) : this.is("xterm") || this.is("rxvt-unicode") || this.is("screen") ? this.send("[?1;2c") : this.is("linux") && this.send("[?6c"))
        }, g.prototype.linePosAbsolute = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.y = t - 1, this.y >= this.rows && (this.y = this.rows - 1)
        }, g.prototype.VPositionRelative = function(e) {
            var t = e[0];
            t < 1 && (t = 1), this.y += t, this.y >= this.rows && (this.y = this.rows - 1)
        }, g.prototype.HVPosition = function(e) {
            e[0] < 1 && (e[0] = 1), e[1] < 1 && (e[1] = 1), this.y = e[0] - 1, this.y >= this.rows && (this.y = this.rows - 1), this.x = e[1] - 1, this.x >= this.cols && (this.x = this.cols - 1)
        }, g.prototype.setMode = function(e) {
            if ("object" != typeof e)
                if (this.prefix) {
                    if ("?" === this.prefix) switch (e) {
                        case 1:
                            this.applicationCursor = !0;
                            break;
                        case 2:
                            this.setgCharset(0, g.charsets.US), this.setgCharset(1, g.charsets.US), this.setgCharset(2, g.charsets.US), this.setgCharset(3, g.charsets.US);
                            break;
                        case 3:
                            this.savedCols = this.cols, this.resize(132, this.rows);
                            break;
                        case 6:
                            this.originMode = !0;
                            break;
                        case 7:
                            this.wraparoundMode = !0;
                            break;
                        case 12:
                            break;
                        case 66:
                            this.log("Serial port requested application keypad."), this.applicationKeypad = !0;
                            break;
                        case 9:
                        case 1e3:
                        case 1002:
                        case 1003:
                            this.x10Mouse = 9 === e, this.vt200Mouse = 1e3 === e, this.normalMouse = 1e3 < e, this.mouseEvents = !0, this.element.style.cursor = "default", this.log("Binding to mouse events.");
                            break;
                        case 1004:
                            this.sendFocus = !0;
                            break;
                        case 1005:
                            this.utfMouse = !0;
                            break;
                        case 1006:
                            this.sgrMouse = !0;
                            break;
                        case 1015:
                            this.urxvtMouse = !0;
                            break;
                        case 25:
                            this.cursorHidden = !1;
                            break;
                        case 1049:
                        case 47:
                        case 1047:
                            if (!this.normal) {
                                var t = {
                                    lines: this.lines,
                                    ybase: this.ybase,
                                    ydisp: this.ydisp,
                                    x: this.x,
                                    y: this.y,
                                    scrollTop: this.scrollTop,
                                    scrollBottom: this.scrollBottom,
                                    tabs: this.tabs
                                };
                                this.reset(), this.normal = t, this.showCursor()
                            }
                    }
                } else switch (e) {
                    case 4:
                        this.insertMode = !0
                } else
                    for (var n = e.length, r = 0; r < n; r++) this.setMode(e[r])
        }, g.prototype.resetMode = function(e) {
            if ("object" != typeof e)
                if (this.prefix) {
                    if ("?" === this.prefix) switch (e) {
                        case 1:
                            this.applicationCursor = !1;
                            break;
                        case 3:
                            132 === this.cols && this.savedCols && this.resize(this.savedCols, this.rows), delete this.savedCols;
                            break;
                        case 6:
                            this.originMode = !1;
                            break;
                        case 7:
                            this.wraparoundMode = !1;
                            break;
                        case 12:
                            break;
                        case 66:
                            this.log("Switching back to normal keypad."), this.applicationKeypad = !1;
                            break;
                        case 9:
                        case 1e3:
                        case 1002:
                        case 1003:
                            this.x10Mouse = !1, this.vt200Mouse = !1, this.normalMouse = !1, this.mouseEvents = !1, this.element.style.cursor = "";
                            break;
                        case 1004:
                            this.sendFocus = !1;
                            break;
                        case 1005:
                            this.utfMouse = !1;
                            break;
                        case 1006:
                            this.sgrMouse = !1;
                            break;
                        case 1015:
                            this.urxvtMouse = !1;
                            break;
                        case 25:
                            this.cursorHidden = !0;
                            break;
                        case 1049:
                        case 47:
                        case 1047:
                            this.normal && (this.lines = this.normal.lines, this.ybase = this.normal.ybase, this.ydisp = this.normal.ydisp, this.x = this.normal.x, this.y = this.normal.y, this.scrollTop = this.normal.scrollTop, this.scrollBottom = this.normal.scrollBottom, this.tabs = this.normal.tabs, this.normal = null, this.refresh(0, this.rows - 1), this.showCursor())
                    }
                } else switch (e) {
                    case 4:
                        this.insertMode = !1
                } else
                    for (var t = e.length, n = 0; n < t; n++) this.resetMode(e[n])
        }, g.prototype.setScrollRegion = function(e) {
            this.prefix || (this.scrollTop = (e[0] || 1) - 1, this.scrollBottom = (e[1] || this.rows) - 1, this.x = 0, this.y = 0)
        }, g.prototype.saveCursor = function(e) {
            this.savedX = this.x, this.savedY = this.y
        }, g.prototype.restoreCursor = function(e) {
            this.x = this.savedX || 0, this.y = this.savedY || 0
        }, g.prototype.cursorForwardTab = function(e) {
            for (var t = e[0] || 1; t--;) this.x = this.nextStop()
        }, g.prototype.scrollUp = function(e) {
            for (var t = e[0] || 1; t--;) this.lines.splice(this.ybase + this.scrollTop, 1), this.lines.splice(this.ybase + this.scrollBottom, 0, this.blankLine());
            this.updateRange(this.scrollTop), this.updateRange(this.scrollBottom)
        }, g.prototype.scrollDown = function(e) {
            for (var t = e[0] || 1; t--;) this.lines.splice(this.ybase + this.scrollBottom, 1), this.lines.splice(this.ybase + this.scrollTop, 0, this.blankLine());
            this.updateRange(this.scrollTop), this.updateRange(this.scrollBottom)
        }, g.prototype.initMouseTracking = function(e) {}, g.prototype.resetTitleModes = function(e) {}, g.prototype.cursorBackwardTab = function(e) {
            for (var t = e[0] || 1; t--;) this.x = this.prevStop()
        }, g.prototype.repeatPrecedingCharacter = function(e) {
            for (var t = e[0] || 1, n = this.lines[this.ybase + this.y], r = n[this.x - 1] || [this.defAttr, " "]; t--;) n[this.x++] = r
        }, g.prototype.tabClear = function(e) {
            var t = e[0];
            t <= 0 ? delete this.tabs[this.x] : 3 === t && (this.tabs = {})
        }, g.prototype.mediaCopy = function(e) {}, g.prototype.setResources = function(e) {}, g.prototype.disableModifiers = function(e) {}, g.prototype.setPointerMode = function(e) {}, g.prototype.softReset = function(e) {
            this.cursorHidden = !1, this.insertMode = !1, this.originMode = !1, this.wraparoundMode = !1, this.applicationKeypad = !1, this.applicationCursor = !1, this.scrollTop = 0, this.scrollBottom = this.rows - 1, this.curAttr = this.defAttr, this.x = this.y = 0, this.charset = null, this.glevel = 0, this.charsets = [null]
        }, g.prototype.requestAnsiMode = function(e) {}, g.prototype.requestPrivateMode = function(e) {}, g.prototype.setConformanceLevel = function(e) {}, g.prototype.loadLEDs = function(e) {}, g.prototype.setCursorStyle = function(e) {}, g.prototype.setCharProtectionAttr = function(e) {}, g.prototype.restorePrivateValues = function(e) {}, g.prototype.setAttrInRectangle = function(e) {
            for (var t, n, r = e[0], i = e[1], o = e[2], s = e[3], a = e[4]; r < o + 1; r++)
                for (t = this.lines[this.ybase + r], n = i; n < s; n++) t[n] = [a, t[n][1]];
            this.updateRange(e[0]), this.updateRange(e[2])
        }, g.prototype.savePrivateValues = function(e) {}, g.prototype.manipulateWindow = function(e) {}, g.prototype.reverseAttrInRectangle = function(e) {}, g.prototype.setTitleModeFeature = function(e) {}, g.prototype.setWarningBellVolume = function(e) {}, g.prototype.setMarginBellVolume = function(e) {}, g.prototype.copyRectangle = function(e) {}, g.prototype.enableFilterRectangle = function(e) {}, g.prototype.requestParameters = function(e) {}, g.prototype.selectChangeExtent = function(e) {}, g.prototype.fillRectangle = function(e) {
            for (var t, n, r = e[0], i = e[1], o = e[2], s = e[3], a = e[4]; i < s + 1; i++)
                for (t = this.lines[this.ybase + i], n = o; n < a; n++) t[n] = [t[n][0], f.fromCharCode(r)];
            this.updateRange(e[1]), this.updateRange(e[3])
        }, g.prototype.enableLocatorReporting = function(e) {
            e[0]
        }, g.prototype.eraseRectangle = function(e) {
            var t, n, r, i = e[0],
                o = e[1],
                s = e[2],
                a = e[3];
            for (r = [this.eraseAttr(), " "]; i < s + 1; i++)
                for (t = this.lines[this.ybase + i], n = o; n < a; n++) t[n] = r;
            this.updateRange(e[0]), this.updateRange(e[2])
        }, g.prototype.setLocatorEvents = function(e) {}, g.prototype.selectiveEraseRectangle = function(e) {}, g.prototype.requestLocatorPosition = function(e) {}, g.prototype.insertColumns = function() {
            for (var e, t = params[0], n = this.ybase + this.rows, r = [this.eraseAttr(), " "]; t--;)
                for (e = this.ybase; e < n; e++) this.lines[e].splice(this.x + 1, 0, r), this.lines[e].pop();
            this.maxRange()
        }, g.prototype.deleteColumns = function() {
            for (var e, t = params[0], n = this.ybase + this.rows, r = [this.eraseAttr(), " "]; t--;)
                for (e = this.ybase; e < n; e++) this.lines[e].splice(this.x, 1), this.lines[e].push(r);
            this.maxRange()
        }, g.prototype.enterPrefix = function() {
            this.prefixMode = !0
        }, g.prototype.leavePrefix = function() {
            this.prefixMode = !1
        }, g.prototype.enterSelect = function() {
            this._real = {
                x: this.x,
                y: this.y,
                ydisp: this.ydisp,
                ybase: this.ybase,
                cursorHidden: this.cursorHidden,
                lines: this.copyBuffer(this.lines),
                write: this.write
            }, this.write = function() {}, this.selectMode = !0, this.visualMode = !1, this.cursorHidden = !1, this.refresh(this.y, this.y)
        }, g.prototype.leaveSelect = function() {
            this.x = this._real.x, this.y = this._real.y, this.ydisp = this._real.ydisp, this.ybase = this._real.ybase, this.cursorHidden = this._real.cursorHidden, this.lines = this._real.lines, this.write = this._real.write, delete this._real, this.selectMode = !1, this.visualMode = !1, this.refresh(0, this.rows - 1)
        }, g.prototype.enterVisual = function() {
            this._real.preVisual = this.copyBuffer(this.lines), this.selectText(this.x, this.x, this.ydisp + this.y, this.ydisp + this.y), this.visualMode = !0
        }, g.prototype.leaveVisual = function() {
            this.lines = this._real.preVisual, delete this._real.preVisual, delete this._selected, this.visualMode = !1, this.refresh(0, this.rows - 1)
        }, g.prototype.enterSearch = function(e) {
            this.entry = "", this.searchMode = !0, this.searchDown = e, this._real.preSearch = this.copyBuffer(this.lines), this._real.preSearchX = this.x, this._real.preSearchY = this.y;
            for (var t = this.ydisp + this.rows - 1, n = 0; n < this.entryPrefix.length; n++) this.lines[t][n] = [-512 & this.defAttr | 4, this.entryPrefix[n]];
            this.y = this.rows - 1, this.x = this.entryPrefix.length, this.refresh(this.rows - 1, this.rows - 1)
        }, g.prototype.leaveSearch = function() {
            this.searchMode = !1, this._real.preSearch && (this.lines = this._real.preSearch, this.x = this._real.preSearchX, this.y = this._real.preSearchY, delete this._real.preSearch, delete this._real.preSearchX, delete this._real.preSearchY), this.refresh(this.rows - 1, this.rows - 1)
        }, g.prototype.copyBuffer = function(e) {
            e = e || this.lines;
            for (var t = [], n = 0; n < e.length; n++) {
                t[n] = [];
                for (var r = 0; r < e[n].length; r++) t[n][r] = [e[n][r][0], e[n][r][1]]
            }
            return t
        }, g.prototype.getCopyTextarea = function(e) {
            var t = this._copyTextarea,
                n = this.document;
            return t || ((t = n.createElement("textarea")).style.position = "absolute", t.style.left = "-32000px", t.style.top = "-32000px", t.style.width = "0px", t.style.height = "0px", t.style.opacity = "0", t.style.backgroundColor = "transparent", t.style.borderStyle = "none", t.style.outlineStyle = "none", n.getElementsByTagName("body")[0].appendChild(t), this._copyTextarea = t), t
        }, g.prototype.copyText = function(e) {
            var t = this,
                n = this.getCopyTextarea();
            this.emit("copy", e), n.focus(), n.textContent = e, n.value = e, n.setSelectionRange(0, e.length), o(function() {
                t.element.focus(), t.focus()
            }, 1)
        }, g.prototype.selectText = function(e, t, n, r) {
            var i, o, s, a, l, c, u, h, d;
            if (this._selected) {
                for (i = this._selected.x1, o = this._selected.x2, s = this._selected.y1, (a = this._selected.y2) < s && (l = o, o = i, i = l, l = a, a = s, s = l), o < i && s === a && (l = o, o = i, i = l), u = s; u <= a; u++)
                    for (c = 0, h = this.cols - 1, u === s && (c = i), u === a && (h = o); c <= h; c++) null != this.lines[u][c].old && (d = this.lines[u][c].old, delete this.lines[u][c].old, this.lines[u][c] = [d, this.lines[u][c][1]]);
                n = this._selected.y1, e = this._selected.x1
            }
            for (n = Math.max(n, 0), n = Math.min(n, this.ydisp + this.rows - 1), r = Math.max(r, 0), r = Math.min(r, this.ydisp + this.rows - 1), this._selected = {
                    x1: e,
                    x2: t,
                    y1: n,
                    y2: r
                }, r < n && (l = t, t = e, e = l, l = r, r = n, n = l), t < e && n === r && (l = t, t = e, e = l), u = n; u <= r; u++)
                for (c = 0, h = this.cols - 1, u === n && (c = e), u === r && (h = t); c <= h; c++) d = this.lines[u][c][0], this.lines[u][c] = [-512 & d | 261636, this.lines[u][c][1]], this.lines[u][c].old = d;
            n -= this.ydisp, r -= this.ydisp, n = Math.max(n, 0), n = Math.min(n, this.rows - 1), r = Math.max(r, 0), r = Math.min(r, this.rows - 1), this.refresh(0, this.rows - 1)
        }, g.prototype.grabText = function(e, t, n, r) {
            var i, o, s, a, l, c = "",
                u = "";
            for (r < n && (l = t, t = e, e = l, l = r, r = n, n = l), t < e && n === r && (l = t, t = e, e = l), s = n; s <= r; s++) {
                for (o = 0, a = this.cols - 1, s === n && (o = e), s === r && (a = t); o <= a; o++) " " !== (i = this.lines[s][o][1]) ? (u && (c += u, u = ""), c += i, v(i) && o++) : u += i;
                u = "", c += "\n"
            }
            for (o = t, s = r; o < this.cols; o++)
                if (" " !== this.lines[s][o][1]) {
                    c = c.slice(0, -1);
                    break
                } return c
        }, g.prototype.keyPrefix = function(e, t) {
            "k" === t || "&" === t ? this.destroy() : "p" === t || "]" === t ? this.emit("request paste") : "c" === t ? this.emit("request create") : "0" <= t && t <= "9" ? (~(t = +t - 1) || (t = 9), this.emit("request term", t)) : "n" === t ? this.emit("request term next") : "P" === t ? this.emit("request term previous") : ":" === t ? this.emit("request command mode") : "[" === t && this.enterSelect()
        }, g.prototype.keySelect = function(e, t) {
            if (this.showCursor(), this.searchMode || "n" === t || "N" === t) return this.keySearch(e, t);
            if ("" === t) {
                var n = this.ydisp + this.y;
                return this.ydisp === this.ybase ? (this.y = Math.min(this.y + (this.rows - 1) / 2 | 0, this.rows - 1), this.refresh(0, this.rows - 1)) : this.scrollDisp((this.rows - 1) / 2 | 0), void(this.visualMode && this.selectText(this.x, this.x, n, this.ydisp + this.y))
            }
            if ("" === t) {
                n = this.ydisp + this.y;
                return 0 === this.ydisp ? (this.y = Math.max(this.y - (this.rows - 1) / 2 | 0, 0), this.refresh(0, this.rows - 1)) : this.scrollDisp(-(this.rows - 1) / 2 | 0), void(this.visualMode && this.selectText(this.x, this.x, n, this.ydisp + this.y))
            }
            if ("" === t) {
                n = this.ydisp + this.y;
                return this.scrollDisp(this.rows - 1), void(this.visualMode && this.selectText(this.x, this.x, n, this.ydisp + this.y))
            }
            if ("" === t) {
                n = this.ydisp + this.y;
                return this.scrollDisp(-(this.rows - 1)), void(this.visualMode && this.selectText(this.x, this.x, n, this.ydisp + this.y))
            }
            if ("k" === t || "[A" === t) {
                n = this.ydisp + this.y;
                return this.y--, this.y < 0 && (this.y = 0, this.scrollDisp(-1)), void(this.visualMode ? this.selectText(this.x, this.x, n, this.ydisp + this.y) : this.refresh(this.y, this.y + 1))
            }
            if ("j" === t || "[B" === t) {
                n = this.ydisp + this.y;
                return this.y++, this.y >= this.rows && (this.y = this.rows - 1, this.scrollDisp(1)), void(this.visualMode ? this.selectText(this.x, this.x, n, this.ydisp + this.y) : this.refresh(this.y - 1, this.y))
            }
            if ("h" === t || "[D" === t) {
                var r = this.x;
                return this.x--, this.x < 0 && (this.x = 0), void(this.visualMode ? this.selectText(r, this.x, this.ydisp + this.y, this.ydisp + this.y) : this.refresh(this.y, this.y))
            }
            if ("l" === t || "[C" === t) {
                r = this.x;
                return this.x++, this.x >= this.cols && (this.x = this.cols - 1), void(this.visualMode ? this.selectText(r, this.x, this.ydisp + this.y, this.ydisp + this.y) : this.refresh(this.y, this.y))
            }
            if ("v" !== t && " " !== t) {
                if ("y" !== t)
                    if ("q" !== t && "" !== t) {
                        if ("w" === t || "W" === t) {
                            for (var i = this.x, o = this.y, s = this.ydisp, a = (r = this.x, n = this.y, this.ydisp), l = !1;;) {
                                for (var c = this.lines[a + n]; r < this.cols;) {
                                    if (c[r][1] <= " ") l = !0;
                                    else if (l) break;
                                    r++
                                }
                                if (r >= this.cols && (r = this.cols - 1), !(r === this.cols - 1 && c[r][1] <= " ")) break;
                                if (r = 0, ++n >= this.rows && (n--, ++a > this.ybase)) {
                                    a = this.ybase, r = this.x;
                                    break
                                }
                            }
                            return this.x = r, this.y = n, this.scrollDisp(-this.ydisp + a), void(this.visualMode && this.selectText(i, this.x, o + s, this.ydisp + this.y))
                        }
                        if ("b" === t || "B" === t) {
                            for (i = this.x, o = this.y, s = this.ydisp, r = this.x, n = this.y, a = this.ydisp;;) {
                                for (c = this.lines[a + n], l = 0 < r && " " < c[r][1] && " " < c[r - 1][1]; 0 <= r;) {
                                    if (c[r][1] <= " ") {
                                        if (l && r + 1 < this.cols && " " < c[r + 1][1]) {
                                            r++;
                                            break
                                        }
                                        l = !0
                                    }
                                    r--
                                }
                                if (r < 0 && (r = 0), 0 !== r || !(c[r][1] <= " ") && l) break;
                                if (r = this.cols - 1, --n < 0 && (n++, --a < 0)) {
                                    a++, r = 0;
                                    break
                                }
                            }
                            return this.x = r, this.y = n, this.scrollDisp(-this.ydisp + a), void(this.visualMode && this.selectText(i, this.x, o + s, this.ydisp + this.y))
                        }
                        if ("e" === t || "E" === t) {
                            r = this.x + 1, n = this.y, a = this.ydisp;
                            for (r >= this.cols && r--;;) {
                                for (c = this.lines[a + n]; r < this.cols && c[r][1] <= " ";) r++;
                                for (; r < this.cols;) {
                                    if (c[r][1] <= " " && 0 <= r - 1 && " " < c[r - 1][1]) {
                                        r--;
                                        break
                                    }
                                    r++
                                }
                                if (r >= this.cols && (r = this.cols - 1), !(r === this.cols - 1 && c[r][1] <= " ")) break;
                                if (r = 0, ++n >= this.rows && (n--, ++a > this.ybase)) {
                                    a = this.ybase;
                                    break
                                }
                            }
                            return this.x = r, this.y = n, this.scrollDisp(-this.ydisp + a), void(this.visualMode && this.selectText(i, this.x, o + s, this.ydisp + this.y))
                        }
                        if ("^" !== t && "0" !== t) {
                            if ("$" === t) {
                                for (i = this.x, c = this.lines[this.ydisp + this.y], r = this.cols - 1; 0 <= r;) {
                                    if (" " < c[r][1]) {
                                        this.visualMode && r < this.cols - 1 && r++;
                                        break
                                    }
                                    r--
                                }
                                return r < 0 && (r = 0), this.x = r, void(this.visualMode ? this.selectText(i, this.x, this.ydisp + this.y, this.ydisp + this.y) : this.refresh(this.y, this.y))
                            }
                            if ("g" === t || "G" === t) {
                                i = this.x, o = this.y, s = this.ydisp;
                                return "g" === t ? (this.x = 0, this.y = 0, this.scrollDisp(-this.ydisp)) : "G" === t && (this.x = 0, this.y = this.rows - 1, this.scrollDisp(this.ybase)), void(this.visualMode && this.selectText(i, this.x, o + s, this.ydisp + this.y))
                            }
                            if ("H" === t || "M" === t || "L" === t) {
                                i = this.x, o = this.y;
                                return "H" === t ? (this.x = 0, this.y = 0) : "M" === t ? (this.x = 0, this.y = this.rows / 2 | 0) : "L" === t && (this.x = 0, this.y = this.rows - 1), void(this.visualMode ? this.selectText(i, this.x, this.ydisp + o, this.ydisp + this.y) : (this.refresh(o, o), this.refresh(this.y, this.y)))
                            }
                            if ("{" === t || "}" === t) {
                                i = this.x, o = this.y, s = this.ydisp;
                                var u, h = !1,
                                    d = !1,
                                    f = -1;
                                n = this.y + ("{" === t ? -1 : 1), a = this.ydisp;
                                for ("{" === t ? n < 0 && (n++, 0 < a && a--) : "}" === t && n >= this.rows && (n--, a < this.ybase && a++);;) {
                                    for (c = this.lines[a + n], u = 0; u < this.cols; u++) {
                                        if (" " < c[u][1]) {
                                            -1 === f && (f = 0), h = !0;
                                            break
                                        }
                                        if (u === this.cols - 1) {
                                            -1 === f ? f = 1 : 0 === f ? d = !0 : 1 === f && h && (d = !0);
                                            break
                                        }
                                    }
                                    if (d) break;
                                    if ("{" === t) {
                                        if (--n < 0) {
                                            if (n++, !(0 < a)) break;
                                            a--
                                        }
                                    } else if ("}" === t && ++n >= this.rows) {
                                        if (n--, !(a < this.ybase)) break;
                                        a++
                                    }
                                }
                                return d || ("{" === t ? a = n = 0 : "}" === t && (n = this.rows - 1, a = this.ybase)), this.x = 0, this.y = n, this.scrollDisp(-this.ydisp + a), void(this.visualMode && this.selectText(i, this.x, o + s, this.ydisp + this.y))
                            }
                            if ("/" !== t && "?" !== t) return !1;
                            this.visualMode || this.enterSearch("/" === t)
                        } else {
                            var i = this.x;
                            if ("0" === t) this.x = 0;
                            else if ("^" === t) {
                                for (var c = this.lines[this.ydisp + this.y], r = 0; r < this.cols && !(" " < c[r][1]);) r++;
                                r >= this.cols && (r = this.cols - 1), this.x = r
                            }
                            this.visualMode ? this.selectText(i, this.x, this.ydisp + this.y, this.ydisp + this.y) : this.refresh(this.y, this.y)
                        }
                    } else this.visualMode ? this.leaveVisual() : this.leaveSelect();
                else if (this.visualMode) {
                    var p = this.grabText(this._selected.x1, this._selected.x2, this._selected.y1, this._selected.y2);
                    this.copyText(p), this.leaveVisual()
                }
            } else this.visualMode ? this.leaveVisual() : this.enterVisual()
        }, g.prototype.keySearch = function(e, t) {
            if ("" !== t) {
                if ("\r" === t || !this.searchMode && ("n" === t || "N" === t)) {
                    this.leaveSearch();
                    var n = this.entry;
                    if (!n) return void this.refresh(0, this.rows - 1);
                    for (var r, i, o = this.x, s = this.y, a = this.ydisp, l = !1, c = !1, u = this.x + 1, h = this.ydisp + this.y, d = "N" === t ? this.searchDown : !this.searchDown;;) {
                        for (r = this.lines[h]; u < this.cols;) {
                            for (p = 0; p < n.length && !(u + p >= this.cols) && r[u + p][1] === n[p]; p++)
                                if (r[u + p][1] === n[p] && p === n.length - 1) {
                                    l = !0;
                                    break
                                } if (l) break;
                            u += p + 1
                        }
                        if (l) break;
                        if (u = 0, d) {
                            if (--h < 0) {
                                if (c) break;
                                c = !0, h = this.ybase + this.rows - 1
                            }
                        } else if (++h > this.ybase + this.rows - 1) {
                            if (c) break;
                            c = !0, h = 0
                        }
                    }
                    return l ? (h - this.ybase < 0 ? (i = h, h = 0, i > this.ybase && (h = i - this.ybase, i = this.ybase)) : (i = this.ybase, h -= this.ybase), this.x = u, this.y = h, this.scrollDisp(-this.ydisp + i), void(this.visualMode && this.selectText(o, this.x, s + a, this.ydisp + this.y))) : void this.refresh(0, this.rows - 1)
                }
                if ("\b" === t || "" === t) {
                    if (0 === this.entry.length) return;
                    var f = this.ydisp + this.rows - 1;
                    this.entry = this.entry.slice(0, -1);
                    var p = this.entryPrefix.length + this.entry.length;
                    return this.lines[f][p] = [this.lines[f][p][0], " "], this.x--, this.refresh(this.rows - 1, this.rows - 1), void this.refresh(this.y, this.y)
                }
                if (1 === t.length && " " <= t && t <= "~") {
                    f = this.ydisp + this.rows - 1;
                    this.entry += t;
                    p = this.entryPrefix.length + this.entry.length - 1;
                    return this.lines[f][p] = [-512 & this.defAttr | 4, t], this.x++, this.refresh(this.rows - 1, this.rows - 1), void this.refresh(this.y, this.y)
                }
                return !1
            }
            this.leaveSearch()
        }, (g.charsets = {}).SCLD = {
            "`": "â—†",
            a: "â–’",
            b: "\t",
            c: "\f",
            d: "\r",
            e: "\n",
            f: "Â°",
            g: "Â±",
            h: "â¤",
            i: "\v",
            j: "â”˜",
            k: "â”",
            l: "â”Œ",
            m: "â””",
            n: "â”¼",
            o: "âŽº",
            p: "âŽ»",
            q: "â”€",
            r: "âŽ¼",
            s: "âŽ½",
            t: "â”œ",
            u: "â”¤",
            v: "â”´",
            w: "â”¬",
            x: "â”‚",
            y: "â‰¤",
            z: "â‰¥",
            "{": "Ï€",
            "|": "â‰ ",
            "}": "Â£",
            "~": "Â·"
        }, g.charsets.UK = null, g.charsets.US = null, g.charsets.Dutch = null, g.charsets.Finnish = null, g.charsets.French = null, g.charsets.FrenchCanadian = null, g.charsets.German = null, g.charsets.Italian = null, g.charsets.NorwegianDanish = null, g.charsets.Spanish = null, g.charsets.Swedish = null, g.charsets.Swiss = null, g.charsets.ISOLatin = null;
        var f = this.String,
            o = this.setTimeout,
            t = this.setInterval;

        function v(e) {
            return !(e <= "ï¼€") && ("ï¼" <= e && e <= "ï¾¾" || "ï¿‚" <= e && e <= "ï¿‡" || "ï¿Š" <= e && e <= "ï¿" || "ï¿’" <= e && e <= "ï¿—" || "ï¿š" <= e && e <= "ï¿œ" || "ï¿ " <= e && e <= "ï¿¦" || "ï¿¨" <= e && e <= "ï¿®")
        }

        function p(e, t, n) {
            var r = e << 16 | t << 8 | n;
            if (null != p._cache[r]) return p._cache[r];
            for (var i, o, s, a, l, c = 1 / 0, u = -1, h = 0; h < g.vcolors.length; h++) {
                if (o = (i = g.vcolors[h])[0], s = i[1], a = i[2], 0 === (l = p.distance(e, t, n, o, s, a))) {
                    u = h;
                    break
                }
                l < c && (c = l, u = h)
            }
            return p._cache[r] = u
        }

        function s(e, t, n) {
            if (e.forEach) return e.forEach(t, n);
            for (var r = 0; r < e.length; r++) t.call(n, e[r], r, e)
        }

        function a(e) {
            if (Object.keys) return Object.keys(e);
            var t, n = [];
            for (t in e) Object.prototype.hasOwnProperty.call(e, t) && n.push(t);
            return n
        }
        p._cache = {}, p.distance = function(e, t, n, r, i, o) {
            return Math.pow(30 * (e - r), 2) + Math.pow(59 * (t - i), 2) + Math.pow(11 * (n - o), 2)
        }, g.EventEmitter = i, g.inherits = e, g.on = u, g.off = h, g.cancel = d, "undefined" != typeof module ? module.exports = g : this.Terminal = g
    }.call(function() {
        return this || ("undefined" != typeof window ? window : global)
    }()),
    function() {
        var r;
        Terminal.prototype.oldScrollDisp = Terminal.prototype.scrollDisp, Terminal.prototype.scrollDisp = function(e) {
            var t, n;
            return this.termWrap || (this.termWrap = $(this.element).parent()), void 0 === this.lineBottom && (this.lineBottom = 0), t = this.termWrap.scrollTop(), n = this.termWrap.height(), e < 0 && 0 < t ? this.termWrap.scrollTop(Math.max(t - 2 * r, 0)) : 0 < e && t < this.lineBottom - n ? this.termWrap.scrollTop(Math.min(t + 2 * r, this.lineBottom - n)) : this.oldScrollDisp(0 < e ? 2 : -2)
        }, Terminal.prototype.oldKeyDown = Terminal.prototype.keyDown, Terminal.prototype.keyDown = function(e) {
            return !(!this.isMac || !e.metaKey || 67 !== e.keyCode && 86 !== e.keyCode) || this.oldKeyDown(e)
        }, r = null, Terminal.prototype.rescroll = function() {
            var e, t, n;
            if (void 0 === this.lineBottom && (this.lineBottom = 0), this.divs || (this.divs = $(this.element).children()), this.termWrap || (this.termWrap = $(this.element).parent()), 0 !== (t = this.divs.filter(function() {
                    return 0 < $(this).text().trim().length
                })).length) return e = $(t[t.length - 1]), r = r || e.height(), this.lineBottom = Math.max(e.position().top + r + this.termWrap.scrollTop(), this.lineBottom), n = this.termWrap.height(), this.lineBottom > n ? this.termWrap.scrollTop(this.lineBottom - n) : void 0
        }
    }(), Paginator.prototype = {
        nextPage: function(n) {
            if (this.isLastPage()) n(this.allData[this.pageNumber - 1]);
            else {
                if (this.pageNumber < this.allData.length) {
                    if (0 == this.pageNumber) return;
                    return this.pageNumber += 1, void n(this.allData[this.pageNumber - 1])
                }
                var e = getLastPriority(this.snap);
                this.lastKey = getLastKey(this.snap);
                var r = this;
                this.ref.startAt(e, this.lastKey).limitToFirst(this.limit + (this.lastKey ? 1 : 0)).once("value", function(e) {
                    r.snap = e;
                    var t = r.sorted(r.snap.exportVal(), r.lastKey);
                    if (0 == t.length) return r.lastPageNumber = r.pageNumber, void n(void 0);
                    r.allData.push(t), r.pageNumber += 1, t.length < r.limit && (r.lastPageNumber = r.pageNumber), n(r.allData[r.pageNumber - 1])
                })
            }
        },
        sorted: function(e, t) {
            var n = [];
            for (key in e)
                if (key != t) {
                    var r = e[key];
                    r.key = key, n.push(r)
                } return n.sort(function(e, t) {
                return e[".priority"] > t[".priority"]
            })
        },
        prevPage: function(e) {
            this.isFirstPage() || (this.pageNumber -= 1, e(this.allData[this.pageNumber - 1]))
        },
        isFirstPage: function() {
            return 1 === this.pageNumber
        },
        isLastPage: function() {
            return this.pageNumber === this.lastPageNumber
        }
    };
var LANG_MAP = {
    vb: {
        name: "Visual Basic",
        tab_size: 4,
        value: "vb",
        sample: 'Imports System\n\nPublic Module mymodule\n   Sub Main()\n     Console.WriteLine ("Hello World!")\n   End Sub\nEnd Module\n',
        repl: !1,
        mode: "vb"
    },
    csharp: {
        name: "C#",
        tab_size: 4,
        value: "clike",
        sample: '// Entry point name must be "Solution"\nusing System;\n\npublic static class Solution\n{\n    private static void Main()\n    {\n        Console.WriteLine("Hello, world!");\n    }\n}\n',
        repl: !1,
        mode: "text/x-csharp"
    },
    julia: {
        name: "Julia",
        tab_size: 4,
        value: "julia",
        sample: 'println("Hello, world!")\n',
        repl: !0,
        mode: "julia"
    },
    haskell: {
        name: "Haskell",
        tab_size: 4,
        value: "haskell",
        sample: '-- Included libs:\n-- bytestring hashtables parsec split text unordered-containers vector vector-algorithms hunit hspec\n--\n-- Code is run with runghc\n\nmain = putStrLn "Hello, world!"\n',
        repl: !0,
        mode: "haskell"
    },
    mysql: {
        name: "MySQL",
        tab_size: 4,
        value: "sql",
        sample: "/*\nView the Database Scheme here: https://s3-us-west-2.amazonaws.com/cbunkstatic/Schema.png\n*/\n\nSELECT 'Hello, world!';\n",
        repl: !0,
        mode: "text/x-mysql"
    },
    go: {
        name: "Go",
        tab_size: 4,
        value: "go",
        sample: 'package main\n\nimport "fmt"\n\nfunc main() {\n    fmt.Println("Hello, world!")\n}\n',
        repl: !1,
        mode: "go"
    },
    "ruby1.9": {
        name: "Ruby",
        tab_size: 4,
        value: "ruby",
        sample: "# Include libs: Rspec\n\nputs 'Hello, world!'\n",
        repl: !0,
        mode: "ruby"
    },
    java: {
        autocomplete: !0,
        name: "Java",
        tab_size: 4,
        value: "clike",
        sample: '// Class name must be "Main"\n// Libraries included:\n// json simple, guava, apache commons lang3, junit, jmock\n\nclass Main {\n    public static void main(String[] args) {\n        System.out.println("Hello, world!");\n    }\n}\n',
        repl: !1,
        mode: "text/x-java"
    },
    coffeescript: {
        name: "Coffeescript",
        tab_size: 4,
        value: "coffeescript",
        sample: "# Libs included:\n#     underscore lodash chai sinon sinon-chai mocha async request q bluebird jsdom\n\nconsole.log 'Hello, world!'\n",
        repl: !0,
        mode: "coffeescript"
    },
    swift: {
        name: "Swift",
        tab_size: 4,
        value: "swift",
        sample: 'print("Hello, world!")\n',
        repl: !0,
        mode: "text/x-swift"
    },
    perl: {
        name: "Perl",
        tab_size: 4,
        value: "perl",
        sample: 'print "Hello, world!\\n";\n',
        repl: !1,
        mode: "perl"
    },
    "ruby1.8": {
        name: "Ruby",
        tab_size: 4,
        value: "ruby",
        sample: "# Include libs: Rspec\n\nputs 'Hello, world!'\n",
        repl: !0,
        mode: "ruby"
    },
    lua: {
        name: "Lua",
        tab_size: 4,
        value: "lua",
        sample: 'print("Hello, world")\n',
        repl: !0,
        mode: "lua"
    },
    erlang: {
        name: "Erlang",
        tab_size: 4,
        value: "erlang",
        sample: "%% Name your module 'prog' and export 'start/0'\n\n-module(prog).\n\n-export([start/0]).\n\nstart() ->\n     io:format(\"Hello, world!~n\").\n",
        repl: !0,
        mode: "erlang"
    },
    shell: {
        name: "Shell",
        tab_size: 4,
        value: "shell",
        sample: '#!/bin/sh\n\necho "Hello World!"\n',
        repl: !0,
        mode: "text/x-sh"
    },
    python: {
        name: "Python 2",
        tab_size: 4,
        value: "python",
        sample: '# Libraries Included:\n# Numpy, Scipy, Scikit, Pandas\n\nprint "Hello, world!"\n',
        repl: !0,
        mode: "python"
    },
    javascript: {
        name: "Javascript",
        tab_size: 4,
        value: "javascript",
        sample: "/*\nLibs included:\n    underscore lodash chai sinon sinon-chai mocha async request q bluebird jsdom\n*/\n\nconsole.log('Hello, world!');\n",
        repl: !0,
        mode: "javascript"
    },
    php: {
        name: "PHP",
        tab_size: 4,
        value: "php",
        sample: "<?php\n    echo 'Hello, world!';\n?>\n",
        repl: !1,
        mode: "php"
    },
    ruby: {
        name: "Ruby",
        tab_size: 4,
        value: "ruby",
        sample: "# Include libs: Rspec\n\nputs 'Hello, world!'\n",
        repl: !0,
        mode: "ruby"
    },
    python3: {
        name: "Python 3",
        tab_size: 4,
        value: "python",
        sample: '# Libraries Included:\n# Numpy, Scipy, Scikit, Pandas\n\nprint("Hello, world!")\n',
        repl: !0,
        mode: "python"
    },
    c: {
        name: "C",
        tab_size: 4,
        value: "clike",
        sample: '// Compiled with: gcc -std=c11 -Wall -pthread -lm\n\n#include <stdio.h>\n\nint main(void)\n{\n    printf("Hello, world!\\n");\n    return 0;\n}\n',
        repl: !1,
        mode: "text/x-csrc"
    },
    kotlin: {
        name: "Kotlin",
        tab_size: 4,
        value: "kotlin",
        sample: '// You should have a top level function called main\n\nfun main(args: Array<String>) {\n  println("Hello, World!")\n}\n',
        repl: !1,
        mode: "kotlin"
    },
    scala: {
        name: "Scala",
        tab_size: 4,
        value: "clike",
        sample: 'object HelloWorld {\n    def main(args: Array[String]): Unit = {\n        println("Hello, world!")\n    }\n}\n',
        repl: !0,
        mode: "text/x-scala"
    },
    ocaml: {
        name: "OCaml",
        tab_size: 4,
        value: "text/x-ocaml",
        sample: 'print_endline "Hello, world!" ;;\n',
        repl: !0,
        mode: "mllike"
    },
    "c++": {
        name: "C++",
        tab_size: 4,
        value: "clike",
        sample: '// Compiled with: g++ -Wall -std=c++14 -pthread\n\n#include <iostream>\n\nusing namespace std;\n\nint main(){\n    cout << "Hello, World!" << endl;\n    return 0;\n}\n',
        repl: !1,
        mode: "text/x-c++src"
    },
    r: {
        name: "R",
        tab_size: 4,
        value: "r",
        sample: 'print("Hello, world!")\n',
        repl: !0,
        mode: "r"
    },
    plain: {
        name: "Plain Text",
        tab_size: 4,
        value: "null",
        sample: "",
        repl: !1,
        mode: "text/plain"
    },
    clojure: {
        name: "Cloure",
        tab_size: 4,
        value: "clojure",
        sample: '(println "Hello, world!")\n',
        repl: !0,
        mode: "clojure"
    },
    rust: {
        name: "Rust",
        tab_size: 4,
        value: "rust",
        sample: 'fn main() {\n    println!("Hello World!");\n}\n',
        repl: !1,
        mode: "rust"
    }
};
! function(e) {
    "object" == typeof exports && "object" == typeof module ? e(require("../../lib/codemirror")) : "function" == typeof define && define.amd ? define(["../../lib/codemirror"], e) : e(CodeMirror)
}(function(t) {
    "use strict";
    t.overlayMode = function(n, r, i) {
        return {
            startState: function() {
                return {
                    base: t.startState(n),
                    overlay: t.startState(r),
                    basePos: 0,
                    baseCur: null,
                    overlayPos: 0,
                    overlayCur: null,
                    lineSeen: null
                }
            },
            copyState: function(e) {
                return {
                    base: t.copyState(n, e.base),
                    overlay: t.copyState(r, e.overlay),
                    basePos: e.basePos,
                    baseCur: null,
                    overlayPos: e.overlayPos,
                    overlayCur: null
                }
            },
            token: function(e, t) {
                return (e.sol() || e.string != t.lineSeen || Math.min(t.basePos, t.overlayPos) < e.start) && (t.lineSeen = e.string, t.basePos = t.overlayPos = e.start), e.start == t.basePos && (t.baseCur = n.token(e, t.base), t.basePos = e.pos), e.start == t.overlayPos && (e.pos = e.start, t.overlayCur = r.token(e, t.overlay), t.overlayPos = e.pos), e.pos = Math.min(t.basePos, t.overlayPos), null == t.overlayCur ? t.baseCur : null != t.baseCur && t.overlay.combineTokens || i && null == t.overlay.combineTokens ? t.baseCur + " " + t.overlayCur : t.overlayCur
            },
            indent: n.indent && function(e, t) {
                return n.indent(e.base, t)
            },
            electricChars: n.electricChars,
            innerMode: function(e) {
                return {
                    state: e.base,
                    mode: n
                }
            },
            blankLine: function(e) {
                n.blankLine && n.blankLine(e.base), r.blankLine && r.blankLine(e.overlay)
            }
        }
    }
}), $(function() {
    var e = navigator.userAgent.toLowerCase();
    jQuery.browser = {
        version: (e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/) || [0, "0"])[1],
        safari: /webkit/.test(e),
        opera: /opera/.test(e),
        msie: /msie/.test(e) && !/opera/.test(e),
        mozilla: /mozilla/.test(e) && !/(compatible|webkit)/.test(e)
    };
    var l, c, i, t, r, u, o, s, n, h = "",
        d = null,
        f = void 0,
        p = {},
        m = 0,
        g = !1,
        v = !1,
        y = !1,
        b = void 0,
        x = 72e5,
        w = !1,
        C = ["#1abc9c", "#e74c3c", "#8e44ad", "#c0392b", "#f39c12", "#27ae60", "#f1c40f", "#03A678", "#1E8BC3", "#1E824C"],
        S = null,
        T = !1,
        M = !1,
        A = "python",
        L = !1,
        E = {
            20: 30,
            50: 68,
            100: 120,
            250: 260
        };

    function N(e, t, n) {
        var r, i, o, s, a, l, c, u, h;
        for (o = "", l = null, s = a = 0, c = (u = n.text).length; a < c; s = ++a) r = u[s], l !== (i = !!(n.matchMask & 1 << s)) && (o += i ? '<span class="highlight">' : "</span>", l = i), o += _.escape(r);
        return l && (o += "</span>"), n.data && (h = n.data.substr(0, 50)) != n.text && (o += '<span class="info">' + _.escape(h), h.length < n.data.length && (o += "&hellip;"), o += "</span>"), e.innerHTML = o
    }

    function I(e, t, n) {
        return n({
            list: function(e, t) {
                var n = [],
                    r = t.toUpperCase(),
                    i = t.toLowerCase();
                e: for (var o, s = 0; o = e[s]; s++) {
                    var a = o.text;
                    if (a) {
                        for (var l, c, u = -1, h = 0, d = 0, f = 0; f < t.length; f++) {
                            var p = a.indexOf(i[f], u + 1),
                                m = a.indexOf(r[f], u + 1);
                            if ((l = 0 <= p && (m < 0 || p < m) ? p : m) < 0) continue e;
                            0 < (c = l - u - 1) && (-1 === u && (d += 10), d += c), h |= 1 << l, u = l
                        }
                        o.matchMask = h, o.exactMatch = d ? 0 : 1, o.score = -d, n.push(o)
                    }
                }
                return n.sort(function(e, t) {
                    return aSym = e.text.charAt(0).toLowerCase() == e.text.charAt(0).toUpperCase() ? 1 : 0, bSym = t.text.charAt(0).toLowerCase() == t.text.charAt(0).toUpperCase() ? 1 : 0, t.exactMatch - e.exactMatch || t.score - e.score || aSym - bSym || e.text.localeCompare(t.text)
                })
            }(t.list, e),
            from: t.from,
            to: t.to
        })
    }

    function O(e) {
        return h + "namespace-questions/" + e + "/"
    }

    function R() {
        $("#menu-home").click(function() {
            window.location = "/db"
        }), $("#menu-avchat").click(function() {
            $(this).hasClass("selected") ? (! function() {
                _gaq.push(["_trackEvent", "Video", "Stop", HASH]);
                try {
                    Fe && session.unpublish(Fe), He && session.unsubscribe(He), session.disconnect()
                } catch (e) {
                    console.log(e), _gaq.push(["_trackEvent", "Video", "Stop-Failure", HASH])
                }
                var e = $("#stream").height();
                $("#stream").hide(), $(".panes").height($(".panes").height() + e);
                var t = $(l.getWrapperElement());
                l.setSize(t.width(), t.height() + e);
                var n = $(i.getWrapperElement());
                $("#logeditor").height($("#logeditor").height() + e), i.setSize(n.width(), n.height() + e), $("#result").height($("#result").height() + e), $("#editor").height($("#editor").height() + e), $("body>object").css("display", "none")
            }(), $(this).removeClass("selected")) : (! function() {
                _gaq.push(["_trackEvent", "Video", "Start", HASH]),
                    function() {
                        try {
                            T || (session = OT.initSession(apiKey, sessId)), session.connect(token, function(e) {
                                e || ($("#mystream-parent").html('<div  id="mystream"></div>'), Fe = OT.initPublisher("mystream", {
                                    height: 200,
                                    width: "100%"
                                }), session.publish(Fe))
                            }), session.on("streamCreated", function(e) {
                                var t = document.createElement("div");
                                t.setAttribute("id", "stream" + e.stream.streamId), document.getElementById("otherstream").appendChild(t);
                                He = e.stream, session.subscribe(e.stream, t.id, {
                                    height: 200
                                })
                            }), T = !0
                        } catch (e) {
                            console.log(e), _gaq.push(["_trackEvent", "Video", "Init-Failure", HASH])
                        }
                    }(), $("body>object").css("display", "block"), $("#stream").show();
                var e = $("#stream").height();
                $(".panes").height($(".panes").height() - e);
                var t = $(l.getWrapperElement());
                l.setSize(t.width(), t.height() - e);
                var n = $(i.getWrapperElement());
                $("#logeditor").height($("#logeditor").height() - e), i.setSize(n.width(), n.height() - e), $("#result").height($("#result").height() - e), $("#editor").height($("#editor").height() - e)
            }(), $(this).addClass("selected"))
        }), $("#menu-playback").click(function() {
            window.location = "/pb/" + HASH
        }), $("#menu-private").click(function() {
            ae()
        }), $("#menu-newbunk").click(function() {
            window.location = "/b"
        }), $("#menu-fork").click(function() {
            ne()
        }), $("#menu-keymap").click(function() {
            ! function() {
                $("#save-dn").unbind(), $("#dn-modal .close").show(), $("#dn-modal h3").text("Select Editor");
                var e = p.keymap || "default",
                    t = '<ul class="nav nav-list">';
                t += '<li data-id="default" ' + ("default" == e ? 'class="selected"' : "") + "><a>Default</a></li>", t += '<li data-id="emacs" ' + ("emacs" == e ? 'class="selected"' : "") + "><a>Emacs</a></li>", t += '<li data-id="sublime" ' + ("sublime" == e ? 'class="selected"' : "") + "><a>Sublime</a></li>", t += '<li data-id="vim" ' + ("vim" == e ? 'class="selected"' : "") + "><a>Vim</a></li>", t += "</ul>", $("#dn-modal .modal-body").html(t), $("#dn-modal .modal-footer").hide(), $("#dn-modal li").click(function() {
                    var e = $(this).attr("data-id");
                    $("#dn-modal").modal("hide"), H(e), _gaq.push(["_trackEvent", "User", "SetKeyMap", e])
                }), $("#dn-modal").modal()
            }()
        }), $("#menu-logout").click(function() {
            q()
        }), $("#menu-playback").hide(), z() && ($("#menu-logout").hide(), $("#menu-private").hide()), M || $("#menu-private").hide(), w && $("#menu-private").addClass("selected"), $("#fork").click(ne)
    }

    function D(e, t) {
        if (l.options.readOnly) Be("You cannot change the Language of this Bunk");
        else {
            firebase.database().ref(HASH + "/output").remove();
            e = $("#lang_select").val();
            var n = A;
            ! function(e) {
                if (l.options.readOnly) return Be("You cannot change the Language of this Bunk");
                var t = HASH,
                    n = BUNKOWNER,
                    r = W(),
                    i = firebase.database().ref(h + t);
                i.update({
                    lang: e
                }), ke(n) || ((i = null == b ? firebase.database().ref(h + "users/" + n + "/" + t) : firebase.database().ref(h + "user-bunks/" + n + "/" + t)).update({
                    lang: e
                }), i.setPriority(-u));
                if (n != r) {
                    if (ke(n) || ((i = firebase.database().ref(h + "userdata-bunks/" + n + "/" + r + "/" + t)).update({
                            lang: e
                        }), i.setPriority(-u)), i = firebase.database().ref(h + "namespace-bunks/" + r), !ke(n)) {
                        var o = i.child("bymember/" + n + "/" + t);
                        o.update({
                            lang: e
                        }), o.setPriority(-u)
                    }
                    var o = i.child("all/" + t);
                    o.update({
                        lang: e
                    }), o.setPriority(-u)
                }
            }(e), Te(e, !1), P(e, n)
        }
    }

    function P(e, t) {
        var n = LANG_MAP[e];
        return "" === l.getValue() || l.getValue() === LANG_MAP[t].sample ? l.setValue(n.sample) : (l.setValue("\nOld Content below(" + LANG_MAP[t].name + "):\n\n" + l.getValue() + "\n"), l.blockComment(CodeMirror.Pos(0, 0), CodeMirror.Pos(l.lastLine(), 0), {
            commentBlankLines: !0,
            indent: !1
        }), l.setValue(n.sample + "\n\n" + l.getValue()))
    }

    function H(e) {
        -1 != ["emacs", "vim", "sublime", "default"].indexOf(e) && (l.setOption("keyMap", e), p.keymap = e, z() || firebase.database().ref(h + "userdata/" + j()).update({
            keymap: e
        }))
    }

    function F() {
        M && z() && Be("This Bunk is editable by you alone. Please login if you want to create Collaborative Bunks."), l.setOption("readOnly", !1), n.setReadOnly(!1), $("#clear-repl").css("visibility", "visible")
    }

    function B() {
        l.setOption("readOnly", !0), $("#clear-repl").css("visibility", "hidden"), n.setReadOnly(!0), Be("This Bunk is Read only. Only owner of the Bunk can make changes to it.")
    }

    function z() {
        return "anon" == f.provider
    }

    function q() {
        t.signOut(), window.location = "/"
    }

    function j() {
        return f.id
    }

    function W() {
        return r
    }

    function U(e, t) {
        var n = function() {
            var e = $("#dn-inp").val();
            "" != e && null != e && ($("#dn-modal").modal("hide"), firebase.database().ref(h + "userdata/" + j()).update({
                name: e
            }), p.name = e.replace(/#|\]|\[|\$|\.|\//g, "-"), t(e.replace(/#|\]|\[|\$|\.|\//g, "-")))
        };
        $("#save-dn").click(n), $("#dn-inp").val(e), $("#dn-inp").on("keyup", function(e) {
            if (e || (e = window.event), "13" == (e.keyCode || e.which)) return n(), !1
        }), $("#dn-modal .modal-header button").hide(), $("#dn-modal").on("shown", function() {
            $("#dn-inp").focus(), $("#dn-modal").off("shown")
        }), $("#dn-modal").modal({
            backdrop: "static"
        })
    }

    function K(r) {
        Pe(), setTimeout(function() {
            $("#result").splitter({
                splitHorizontal: !0,
                outline: !0,
                sizeTop: $(".terminal").height() + 20
            }), $(".panes").splitter({
                sizeRight: $(".terminal").width() + 10
            });
            var e = r.lang;
            "ruby" == e && (e = "ruby1.9"), z() && M && Be("This Bunk is editable by you alone. Please login if you want to create Collaborative Bunks.");
            var t = j(),
                n = r.nsid;
            n == t || n == r.owner ? De() : De(n), setTimeout(function() {
                $e(HASH, e), firebase.database().ref(h + HASH + "/output").limitToLast(100).on("child_added", function(e) {
                    var t = e.val();
                    S.write(t)
                }), new je(firebase.database().ref(h + HASH + "/execute"), function(e, t) {
                    Ie(e, !0), t()
                }), $("#page-loader").hide()
            }, 100)
        }, 100), $("#chatbox").width($("#result").width() + 30), $("#editor").bind("resize", function(e) {
            l.setSize($(this).width(), $(this).height())
        }), $("#logwrap").bind("resize", function(e) {
            $("#logeditor").height($(this).height() - 42), i.setSize($(this).width(), $("#logeditor").height()), $("#chatbox").width($(this).width() + 30), i.scrollIntoView(i.lastLine())
        }), y && History.pushState(null, null, HASH + "/"), $("#runbtn").click(ze), $("#clear-repl").click(Se), $("#rate-candidate").click(de), $("#end-interview").click(ue), Mousetrap.bind(["command+r", "ctrl+r"], ze);
        var e = j();
        z() && (e = Math.floor(9999999999 * Math.random()).toString(), s = e), o = oe(r.users || {});
        var t = function(n) {
            var e = o;
            z() && (n = s);
            if (null == e) return C[parseInt(10 * Math.random())];
            var r = [];
            return $.each(e, function(e, t) {
                if (e.split("||")[0] == n) return t.color;
                r.push(t.color)
            }), 0 == (r = $(C).not(r).get()).length ? C[parseInt(10 * Math.random())] : r[Math.floor(Math.random() * r.length)]
        }(e);
        n = Firepad.fromCodeMirror(d, l, {
                userId: e + "||" + p.name,
                userColor: t
            }),
            function() {
                var e = $("#logwrap").height(),
                    t = $("#chatbox").height();
                $("#logeditor").height(e - t + 1), i.setSize($("#logeditor").width(), $("#logeditor").height());
                var n = firebase.database().ref(h + d.key + "-log");
                Firepad.fromCodeMirror(n, i, {
                    userId: j()
                }), $("#chatbox textarea").autosize({
                    callback: function() {
                        $("#chatbox").height();
                        var e = $("#logwrap").height(),
                            t = $("#chatbox").height();
                        $("#logeditor").height(e - t + 1), i.setSize($("#logeditor").width(), $("#logeditor").height())
                    }
                }).keydown(function(e) {
                    return 13 != e.which
                }).keyup(function(e) {
                    if (13 == e.which) {
                        if (l.options.readOnly) return;
                        var t = p.name + " said: " + $("#chatbox textarea").val();
                        Ie(t), $("#chatbox textarea").val("")
                    }
                }), i.on("change", function() {
                    i.scrollIntoView(i.lastLine())
                })
            }(), R(), hasStartTS && $("#menu-playback").show(), d.child("users").on("value", function(e) {
                o = oe(e.val()),
                    function() {
                        var e = '<div id="menu-roster">',
                            t = 0;
                        for (k in o) e += '<div class="menu-roster-item menu-item"><i class="icon icon-user" style="color:' + o[k].color + '"></i><span>' + o[k].name + "</span></div>", t += 1;
                        e += "</div>", $("#menu-roster").remove(), $("#menu").append(e), 1 < t && 0 == se && (_gaq.push(["_trackEvent", "Session", "UserCount", HASH, t]), se = !0)
                    }()
            }), d.child("lang").on("value", function(e) {
                var t = e.val();
                null != t && ($e(HASH, t), Te(t))
            }), d.child("title").on("value", function(e) {
                var t = e.val();
                null != t && _e(t)
            }), d.child("private").on("value", function(e) {
                var t = e.val();
                if (null != t) return M ? (t ? ($("#menu-private").addClass("selected"), $("#end-interview").hide()) : ($("#menu-private").removeClass("selected"), z() || ce()), void(w = t)) : void(1 == t && alert("End of Interview", "Thank You for interviewing with us. We will get back to you soon.", function() {
                    window.location = "https://" + window.location.hostname + "/db/"
                }))
            }), n.on("ready", function() {
                var e, t;
                r.qid && 0 < r.qid.length && (e = r.nsid, t = r.qid, firebase.database().ref(O(e)).child(t).once("value", function(e) {
                    n.setText(e.val().text)
                }), d.update({
                    qid: "",
                    origqid: r.qid
                }))
            })
    }

    function V() {
        H(p.keymap || "default");
        var e = window.location.hash.replace(/#/g, "");
        e ? G(HASH = e) : HASH ? G(HASH) : function(i) {
            if (null != p.namespaces) {
                $("#save-dn").unbind(), $("#dn-modal h3").text("Select Team");
                var e = j(),
                    t = '<ul class="nav nav-list">';
                for (key in t += '<li data-id="' + e + '"><a>Personal</a></li>', p.namespaces)
                    if (p.namespaces.hasOwnProperty(key)) {
                        if (key == e) continue;
                        t += '<li data-id="' + key + '"><a>' + p.namespaces[key].name + "</a></li>"
                    } t += "</ul>", $("#dn-modal .modal-body").html(t), $("#dn-modal .modal-footer").hide(), $("#dn-modal .modal-header button").hide(), $("#dn-modal li").click(function() {
                    var t = $(this).attr("data-id"),
                        n = $(this).find("a").text();
                    if (t == e) return i(t, n), void $("#dn-modal").modal("hide");
                    var r = this;
                    ie(t, function(e) {
                        0 < e.numbunks ? (i(t, n), $("#dn-modal").modal("hide")) : $(r).unbind().find("a").text($(r).unbind().find("a").text() + " (No Bunks Left. Choose other.)")
                    })
                }), $("#dn-modal").modal({
                    backdrop: "static"
                })
            } else i(j(), "Personal")
        }(function(e, t) {
            Y(X, e, t)
        })
    }

    function G(e) {
        (d = d.child(e)).once("value", function(e) {
            var t = e.val();
            null != t ? function(e) {
                if (w = e.private, v = function(e) {
                        if (j() == e) return !0;
                        var t = f.provider,
                            n = f.id;
                        return t + "-" + n == e || t + "/" + n == e
                    }(e.owner), b = e.version, u = e.created + TSDIFF, BUNKOWNER = e.owner, r = e.nsid, M = v || Z(r), w && !M) return alert("Private Bunk", "You do not have access to this Bunk", function() {
                    window.location = "/db"
                });
                apiKey = e.api_key || apiKey, sessId = e.sessId || sessId, token = e.token || token, 1 == e.withPlayback && (hasStartTS = !0);
                _e(e.title);
                var t = e.lang;
                "ruby" == t && (t = "ruby1.9", d.update({
                    lang: t
                }));
                t != $("#lang_select").val() && Te(t);
                if (K(e), e.nsid == e.owner && 0 == e.readonly) {
                    var n = e.validTill - ((new Date).getTime() + TSDIFF);
                    n < 0 && (d.update({
                        readonly: !0
                    }), e.readonly = !0)
                }
                if (M) {
                    if (z()) return Me() ? (F(), v = !0) : B(), le();
                    F(), he(), w || ce(), r = null == e.nsid ? e.owner : e.nsid, e.nsid == e.owner || null == e.nsid ? ee(e) : te(e)
                } else we(), ge(), ve(), $("#questions").hide();
                le()
            }(t) : alert("Uh Oh!", "Unable to fetch bunk data.")
        })
    }

    function Y(s, a, l) {
        r = a, BUNKOWNER = j(), firebase.database().ref(h + "maxid/").transaction(function(e) {
            return (e || 0) + 1
        }, function(e, t, n) {
            if (t) {
                var r = (i = 100, o = 999, Math.floor(Math.random() * (o - i + 1) + i));
                s(r + "" + n.val(), a, l)
            }
            var i, o
        })
    }

    function X(e, t, n) {
        HASH = e, _gaq.push(["_trackEvent", "Bunk", "New"]), d = d.child(e), M = v = !0;
        var r = j(),
            i = (new Date).getTime();
        u = i + TSDIFF;
        var o = !1;
        (t == r || z()) && (o = !0);
        var s = {
            owner: r,
            owner_name: p.name || "No Name",
            nsid: t || r,
            nsname: n || "Personal",
            lang: "python",
            readonly: o,
            created: i,
            api_key: apiKey,
            sessId: sessId,
            token: token,
            validTill: -1,
            sessUpdate: 0,
            paid: !1,
            withPlayback: !0,
            version: 1,
            private: !1
        };
        b = 1, d.update(s, function(e) {
            ! function(e, t, n, r) {
                if (null != e) return alert("Uh Oh!", "Unable to create bunk. Please try again.");
                hasStartTS = !0, y = !0, K(r),
                    function(e, t, n) {
                        if (z()) Ae(), ee(n);
                        else {
                            var r = j(),
                                i = {
                                    created: (new Date).getTime(),
                                    lang: "python",
                                    username: p.name,
                                    userid: r,
                                    nsid: e,
                                    nsname: t
                                },
                                o = firebase.database().ref(h + "user-bunks/" + r);
                            o = o.child(d.key).setWithPriority(i, -u), e != r ? (J(d.key, e, r, i), te(n)) : Q()
                        }
                    }(t, n, r), le(), _e(), z() || (he(), w || ce());
                P("python", "plain")
            }(e, t, n, s)
        })
    }

    function Q() {
        pe(), $("#usesession-yes").click(ye), $("#buysession span").click(function() {
            var e = parseInt($(this).attr("data-id"));
            ! function(n, i) {
                $("#page-loader").addClass("trans"), $("#page-loader").show();
                StripeCheckout.open({
                    key: STRIPE_KEY,
                    amount: n,
                    currency: "usd",
                    name: "CodeBunk",
                    description: "Buy " + i + " Sessions",
                    panelLabel: "Buy",
                    token: function(e) {
                        $("#page-loader").addClass("trans"), $("#page-loader").show();
                        var t = j();
                        $.post("/charge", {
                            token: e.id,
                            amount: n,
                            user: t
                        }, function(e) {
                            var r;
                            $("#page-loader").removeClass("trans"), $("#page-loader").hide(), e.success ? (r = i, pe(function() {
                                var e = firebase.database().ref(h + "sessions/" + j());
                                e.update({
                                    remaining: m + r
                                }), m += r;
                                var t = new Date,
                                    n = e.child("buy-" + t.getTime());
                                n.set({
                                    created: t.toUTCString(),
                                    num: r
                                })
                            }), _gaq.push(["_trackEvent", "charged", "success", i]), alert("Congratulations!", i + " Collaborative Sessions added to your account")) : (_gaq.push(["_trackEvent", "charged", "failure", e.reason]), alert("Failure!", e.reason))
                        })
                    },
                    closed: function() {
                        $("#page-loader").removeClass("trans"), $("#page-loader").hide()
                    }
                })
            }(100 * E[e], e)
        }), me()
    }

    function J(e, t, n, r, i, o) {
        null == i && (i = u);
        (new Date).getTime();
        firebase.database().ref(h + "userdata-bunks/" + n + "/" + t).child(e).setWithPriority(r, -i);
        var s = firebase.database().ref(h + "namespace-bunks/" + t);
        s.child("bymember/" + n).child(e).setWithPriority(r, -i), s.child("all").child(e).setWithPriority(r, -i), ie(t, function(e) {
            firebase.database().ref(h + "namespace/" + t).update({
                numbunks: e.numbunks - 1
            }, function(e) {
                o && o()
            })
        })
    }

    function Z(e) {
        return v || p.namespaces && null != p.namespaces[e]
    }

    function ee(e) {
        null != e.version && (!z() && v && me(), we(), !z() && v && ($("#buysession").parents(".span2").show(), Q(), be(e.validTill)))
    }

    function te(e) {
        _gaq.push(["_trackEvent", "Bunk", "Team", e.nsid]), ve(), $("#readonly").removeClass("disabled").unbind().click(function() {
            $("#readonly i").hasClass("icon-check-empty") ? $("#readonly i").removeClass("icon-check-empty").addClass("icon-check") : $("#readonly i").removeClass("icon-check").addClass("icon-check-empty")
        }), ge(), xe()
    }

    function ne() {
        _gaq.push(["_trackEvent", "fork", "click"]), $("#page-loader").show(), d.once("value", function(e) {
            var t, n, r = e.val();
            return null == r ? ($("#page-loader").hide(), void alert("Error in Forking the Bunk. Try again.")) : r.history ? (_gaq.push(["_trackEvent", "fork", "success"]), void(Z(r.nsid) && j() != r.nsid ? (t = r.nsid, n = function() {
                Y(re, r)
            }, ie(t, function(e) {
                0 < e.numbunks ? n() : ($("#page-loader").hide(), _gaq.push(["_trackEvent", "fork", "nosessions"]), alert("Sorry", "Unable to Fork. No more Interview Sessions left."))
            })) : Y(re, r))) : (_gaq.push(["_trackEvent", "fork", "nohistory"]), $("#page-loader").hide(), void alert("Sorry", "No data to Fork."))
        })
    }

    function re(r, i) {
        NREF = firebase.database().ref(r);
        var o = (new Date).getTime(),
            s = j(),
            a = i.nsid || s,
            l = i.nsname || "Personal",
            e = i.readonly;
        Z(i.nsid) || (a = s, l = "Personal"), a == s && (e = !0), NREF.update({
            owner: s,
            owner_name: p.name,
            created: o,
            history: i.history,
            lang: i.lang,
            nsid: a,
            nsname: l,
            sessStart: 0,
            sessUpdate: 0,
            readonly: e,
            charged: !1,
            withPlayback: i.withPlayback,
            paid: !1,
            title: $("#bunktitle span").html(),
            private: !1,
            validTill: -1,
            version: 1,
            api_key: apiKey2,
            sessId: sessId2,
            token: token2
        }, function(e) {
            if (z()) return Ae(r), void(window.location = "https://" + window.location.hostname + "/b/" + r);
            var t = {
                    created: o,
                    lang: i.lang,
                    username: p.name,
                    userid: s,
                    nsid: a,
                    nsname: l,
                    title: $("#bunktitle span").html()
                },
                n = firebase.database().ref(h + "user-bunks/" + j());
            n = n.child(r).setWithPriority(t, -o, function() {
                a != s ? J(r, a, s, t, o, function() {
                    window.location = "https://" + window.location.hostname + "/b/" + r
                }) : window.location = "https://" + window.location.hostname + "/b/" + r
            })
        })
    }

    function ie(e, n) {
        firebase.database().ref(h + "namespace/" + e).once("value", function(e) {
            var t = e.val();
            null != t && n && n(t)
        })
    }

    function oe(e) {
        if (null == e) return {};
        var r = {};
        return $.each(e, function(e, t) {
            var n = e.split("||");
            r[n[0]] = {
                color: t.color,
                name: n[1]
            }
        }), r
    }
    hasStartTS = !1, CodeMirror.defineMode("chat", function(e, t) {
        var n = {
            token: function(e, t) {
                if (0 == e.pos)
                    for (k in o) {
                        var n = o[k];
                        if (e.match(n.name + " said:")) return "" + C.indexOf(n.color)
                    }
                for (; null != e.next(););
                return null
            }
        };
        return CodeMirror.overlayMode(CodeMirror.getMode(e, t.backdrop || "text/plain"), n)
    }), CodeMirror.registerHelper("hint", "magic", function(o, s) {
        var l = o.getCursor(),
            e = o.getValue(),
            c = o.getTokenAt(l),
            u = o.state.completionActive;
        if (u.list) {
            var t = o.getRange(u.from, l);
            return u.to.ch = Math.max(u.to.ch, l.ch), I(t, u, s)
        }
        return u.inflight || (u.inflight = $.post("https://complete.codebunk.com/complete/", {
            line: l.line,
            char: l.ch,
            lang: window.lang,
            bunk: HASH,
            code: e
        })), u.inflight.done(function(e) {
            var t, n, r, i;
            if (!(e = JSON.parse(e)).error && 0 < e.completions.length) {
                for ((n = parseInt(e.offset)) || (n = null === c.type || "." === c.string ? c.end : c.start), r = 0, i = (t = e.completions).length; r < i; r++) t[r].render = N;
                return u.from = CodeMirror.Pos(l.line, n), u.to = CodeMirror.Pos(l.line, Math.max(c.end, e.startCol || 0)), u.list = t, a = o.getRange(u.from, l), I(a, u, s)
            }
        })
    }), CodeMirror.commands.autocomplete = function(e) {
        if (LANG_MAP[window.lang].autocomplete && L) return CodeMirror.showHint(e, CodeMirror.hint.magic, {
            async: !0,
            completeSingle: !1,
            closeOnUnfocus: !1
        })
    };
    var se = !(window.init = function() {
        $("#save-title").click(Ce), $("#title-modal").on("show", function() {
            $("#title-inp").val($("#bunktitle span").text())
        }), $(".panes").height(window.innerHeight - 40).width(window.innerWidth - 30), $("select").dropkick({
            change: D
        }), $("#questions").click(Ne), $("#vidvis").bind("click", function() {
            g = g ? ($("#stream").hide(), $("#editor").height(window.innerHeight - 63), $("#result").height(window.innerHeight - 86), $(this).css("bottom", 0), $(".vidtext").html("Show Chat"), !1) : ($("#stream").show(), $("#editor").height(window.innerHeight - 250), $("#result").height(window.innerHeight - 298), $(this).css("bottom", 205), $(".vidtext").html("Hide Chat"), !0)
        }), CodeMirror.modeURL = "/static/codemirror/mode/%N/%N.js", c = CodeMirror.fromTextArea(document.getElementById("playback")), (l = CodeMirror(document.getElementById("editor"), {
            lineNumbers: !0,
            mode: "python",
            tabSize: 4,
            indentUnit: 4,
            lineWrapping: !0,
            extraKeys: {
                Tab: function(e) {
                    e.getSelection().length ? CodeMirror.commands.indentMore(e) : e.replaceSelection("    ", "end")
                },
                "Ctrl-Space": "autocomplete"
            }
        })).on("keyup", function(e, t) {
            if (190 === (t.keyCode || t.which)) return l.execCommand("autocomplete")
        }), (i = CodeMirror(document.getElementById("logeditor"), {
            lineNumbers: !1,
            mode: "null",
            tabSize: 4,
            indentUnit: 4,
            lineWrapping: !0,
            mode: "chat"
        })).setOption("readOnly", !0), $("#authbtn, #dbparent").hide(), ve(), firebase.initializeApp(FBCONFIG), firebase.authMigrator().migrate().then(function(e) {
            e ? console.log("user logged in") : console.log("no user to migrate")
        }).catch(function(e) {
            console.log("error")
        }), t = firebase.auth(), d = firebase.database().ref(), t.onAuthStateChanged(function(e) {
            if ($("#page-loader").hide(), e) {
                firebase.authMigrator().clearLegacyAuth(), f = {};
                var t = e.providerData[0];
                f.provider = t.providerId.split(".")[0], "password" == t.providerId ? (f.provider = "persona", f.id = "persona-" + t.email.replace(/\./g, ",")) : f.id = f.provider + "-" + t.uid, $("#logout, #home").show(), $("#logout").unbind().click(q), n = j(), r = function(e) {
                    p = e, V()
                }, firebase.database().ref(h + "userdata/" + n).once("value", function(e) {
                    var t = e.val();
                    if (null == t) return p = {}, void U("", function(e) {
                        t = {
                            name: e
                        }, r && r(t)
                    });
                    r && r(t)
                })
            } else f = {
                provider: "anon",
                id: "anon",
                username: "anon"
            }, U("", function(e) {
                val = {
                    name: e
                }, p = val, V()
            }), $("#questions").hide();
            var n, r
        })
    });

    function ae() {
        d.once("value", function(e) {
            var t = e.val();
            if (null != t) {
                var n = t.private;
                w = !n, $("#menu-private").toggleClass("selected"), d.update({
                    private: !n
                })
            } else alert("Uh Oh!", "Unable to complete the request")
        })
    }

    function le() {
        d.child("readonly").on("value", function(e) {
            var t = e.val();
            null != t ? 1 == t ? ($("#readonly i").removeClass("icon-check-empty").addClass("icon-check"), M || B()) : ($("#readonly i").removeClass("icon-check").addClass("icon-check-empty"), M || F()) : setTimeout(le, 1e3)
        })
    }

    function ce() {
        $("#end-interview").show()
    }

    function ue() {
        $("#end-interview-modal").modal(), $("#end-interview-yes").unbind().bind("click", ae)
    }

    function he() {
        $("#rate-candidate").show()
    }

    function de() {
        $("#rate-candidate-modal .error").text(""), $("#rate-candidate-modal #save-rating").unbind().bind("click", fe), $("#rate-candidate-modal").modal()
    }

    function fe() {
        var r = $('#rate-candidate-modal form input[name="rating"]:checked').val();
        if (null != r) {
            var i = $("#rate-candidate-modal form textarea").val();
            d.once("value", function(e) {
                var t = e.val();
                if (null != t) {
                    var n = t.ratings || {};
                    n[j()] = [p.name, r, i], $("#rate-candidate-modal").modal("hide"), d.update({
                        ratings: n
                    })
                } else $("#rate-candidate-modal .error").text("Unable to save rating!")
            })
        } else $("#rate-candidate-modal .error").text("Please choose a rating!")
    }

    function pe(n) {
        "anon" != f.provider && firebase.database().ref(h + "sessions/" + j()).once("value", function(e) {
            var t = e.val();
            m = null == t ? 5 : t.remaining, n && n(), $("#use-session").html("Use Session (" + m + ")")
        })
    }

    function me() {
        $("#use-session").show().css("display", "inline-block").removeClass("disabled").unbind().click(function() {
            $("#usesession-modal").modal()
        })
    }

    function ge() {
        $("#use-session").addClass("disabled").unbind()
    }

    function ve() {
        $("#buysession").parents(".span2").hide()
    }

    function ye() {
        pe(function() {
            if (!m) return alert("No Sessions!", "No more sessions left. Please buy some sessions."), void _gaq.push(["_trackEvent", "usesession", "fail"]);
            var e = (new Date).getTime() + x + TSDIFF;
            be(e), d.update({
                validTill: e,
                readonly: !1
            }), firebase.database().ref(h + "sessions/" + j()).update({
                remaining: m - 1
            }), m -= 1, isCharged = !0, _gaq.push(["_trackEvent", "usesession", "success"])
        })
    }

    function be(e) {
        var t = e - ((new Date).getTime() + TSDIFF);
        if (t < 0) d.update({
            readonly: !0
        });
        else {
            j();
            ge(), xe(), setTimeout(function() {
                    d.update({
                        readonly: !0
                    }), $("#readonly").addClass("disabled").unbind(), $("#readonly i").removeClass("icon-check-empty").addClass("icon-check"), me()
                }, t), $(".timer").show(),
                function(e) {
                    function t(e) {
                        var t = e + "";
                        return t.length < 2 ? "0" + t : t
                    }
                    totalSeconds = parseInt(e / 1e3), interval = setInterval(function() {
                        if ($("#seconds").text(t(parseInt(totalSeconds % 60))), $("#minutes").text(t(parseInt(totalSeconds / 60))), 0 == totalSeconds) return alert("Session's over!", "Current session is over. Your bunk is no more collaborative."), void clearInterval(interval);
                        totalSeconds--
                    }, 1e3)
                }(t)
        }
    }

    function xe() {
        $("#readonly i").removeClass("icon-check").addClass("icon-check-empty"), $("#readonly").removeClass("disabled").unbind().click(function() {
            $("#readonly i").hasClass("icon-check-empty") ? d.update({
                readonly: !0
            }) : d.update({
                readonly: !1
            })
        })
    }

    function we() {
        $("#readonly").addClass("disabled").unbind()
    }

    function ke(e) {
        return null != e.match(/cbapiv\d+/)
    }

    function _e(e) {
        $("#title-inp").val(e || "Untitled Bunk"), $("#bunktitle span").text(e || "Untitled Bunk"), e ? $("title").text("CodeBunk: " + e) : $("title").text("CodeBunk: Untitled Bunk")
    }

    function Ce() {
        _gaq.push(["_trackEvent", "Title", "Set"]);
        var e = $("#title-inp").val(),
            t = W();
        if (0 < e.length) {
            if (l.options.readOnly && !M) return;
            $("#bunktitle span").text(e), $("title").text("CodeBunk: " + e);
            var n = HASH,
                r = BUNKOWNER,
                i = firebase.database().ref(h + n);
            if (i.update({
                    title: e
                }), ke(r) || ((i = null == b ? firebase.database().ref(h + "users/" + r + "/" + n) : firebase.database().ref(h + "user-bunks/" + r + "/" + n)).update({
                    title: e
                }), i.setPriority(-u)), r != t) {
                var o;
                if (ke(r) || ((i = firebase.database().ref(h + "userdata-bunks/" + r + "/" + t + "/" + n)).update({
                        title: e
                    }), i.setPriority(-u)), i = firebase.database().ref(h + "namespace-bunks/" + t), !ke(r))(o = i.child("bymember/" + r + "/" + n)).update({
                    title: e
                }), o.setPriority(-u);
                (o = i.child("all/" + n)).update({
                    title: e
                }), o.setPriority(-u)
            }
        }
    }

    function Se() {
        S && (S.reset(), S.send("\n"))
    }

    function Te(e, t) {
        var n, r, i;
        window.lang = e, A = e, $("#lang_select").val(e), !LANG_MAP[e].repl || l.options.readOnly ? $("#clear-repl").css("visibility", "hidden") : $("#clear-repl").css("visibility", "visible"), 0 != t && (n = e, r = $("#lang_select"), i = r.prev(".dk_container"), r.val(n), i.find(".dk_options_inner").children("li").each(function() {
            var e = $(this),
                t = e.children("a");
            e.removeClass("dk_option_current"), t.data("dk-dropdown-value") == n && (e.addClass("dk_option_current"), i.find(".dk_label").text(t.text()))
        })), "java" == e && Be("Class name must be <b>Main</b>"), "csharp" == e && Be('Entry point class must be named <b>Solution</b> ("static void Main" should be defined in class Solution) '), "vb" == e && Be('Define "Sub Main" on the top level module'), "erlang" == e && Be("Name your module 'prog' and export 'start/0'. <br/><b> -module(prog).<br/>-export([start/0]).</b>"), "mysql" == e && Be("View the <a target='_blank' href='https://s3-us-west-2.amazonaws.com/cbunkstatic/Schema.png'>Database Schema</a>");
        var o = LANG_MAP[e].value,
            s = LANG_MAP[e].mode;
        l.setOption("mode", s), CodeMirror.autoLoadMode(l, o), c.setOption("mode", s), CodeMirror.autoLoadMode(c, o)
    }

    function Me(e) {
        e = e || HASH, $.cookie.json = !0;
        var t = $.cookie() || {};
        t = t.__CB_SESS_H || [];
        for (var n = 0; n < t.length; n++)
            if (t[n] == e) return !0;
        return !1
    }

    function Ae(e) {
        if ($.cookie.defaults = {
                path: "/"
            }, !Me(e = e || HASH)) {
            $.cookie.json = !0;
            var t = $.cookie() || {};
            (t = t.__CB_SESS_H || []).push(e), 50 < t.length && t.shift(), $.cookie("__CB_SESS_H", t)
        }
    }

    function Le(e, t) {
        t.html("");
        var n, r = function(e) {
                ! function(e, t) {
                    if ($("#qspinner").remove(), null == e) return;
                    var c = t.find(".qlist");
                    c.html("");
                    var u = e.slice().reverse();
                    $.each(u, function(e, t) {
                        var n = t.title,
                            r = t.key,
                            i = t.userid,
                            o = t.username || "Me";
                        i == j() && (o = "Me");
                        var s = t.nsid || j(),
                            a = t.nsname || "Personal",
                            l = t.text;
                        Ee(c, r, n, l, i, o, s, a, u[e].created - TSDIFF)
                    }), t.show()
                }(e, t)
            },
            i = j();
        n = e == i ? firebase.database().ref(h + "user-questions/" + i + "/") : firebase.database().ref(O(e)), paginator = new Paginator(n, 25), paginator.nextPage(r), t.append('<div class="paginator"><div class="btn btn-mini btn-default next">Next<i class="icon icon-chevron-right"></i></div><div class="btn btn-mini btn-default prev"><i class="icon icon-chevron-left"></i>Prev</div></div>'), t.find(".prev").click(function() {
            paginator.prevPage(r)
        }), t.find(".next").click(function() {
            paginator.nextPage(r)
        }), t.append('<div class="qlist"></div>'), t.find(".qlist").parent().append('<div id="qspinner"><i class="icon-spinner icon-spin icon-2x"></i></div>')
    }

    function Ee(e, t, n, r, i, o, s, a, l) {
        e.prepend('<div class="qitem"><div class="heading"></div><div class="sub-heading"></div></div>');
        var c = e.find(".qitem:first-child");
        c.find(".heading").text(n), c.find(".sub-heading").text(r)
    }

    function Ne() {
        var e = '<li><span data-id="' + j() + '">Personal</span></li>';
        if (null != p.namespaces)
            for (key in p.namespaces)
                if (p.namespaces.hasOwnProperty(key)) {
                    if (key == j()) continue;
                    e += '<li><span data-id="' + key + '">' + p.namespaces[key].name + "</span></li>"
                } $("#question-ns").html(e);
        var t = j();
        $("#question-ns span").click(function() {
            t = $(this).attr("data-id"), $("#question-modal .dropdown-toggle").html($(this).text() + '&nbsp;<span class="caret"></span>'), Le(t, $("#question-list"))
        }), Le(j(), $("#question-list")), $("#question-modal").modal(), _gaq.push(["_trackEvent", "Question", "Display", HASH])
    }

    function Ie(e, t) {
        null == t && (e += "\n"), i.replaceRange(e, CodeMirror.Pos(i.lastLine()))
    }
    var Oe = !1;

    function Re(e) {
        var t = firebase.database().ref(h + ".info/connected"),
            n = firebase.database().ref(h + e + "/" + HASH);
        t.on("value", function(e) {
            e.val() ? (n.push(!0).onDisconnect().remove(), Oe = !0) : Oe = !1
        })
    }

    function De(e) {
        null != e ? ie(e, function(e) {
            -1 == e.sid ? Re("presence") : (L = !0, Re("presence_paid"))
        }) : Re("presence")
    }

    function Pe() {
        (S = new Terminal({
            cols: 80,
            rows: 24
        })).open($("#terminal").empty()[0])
    }

    function $e(e, t) {
        S && (S.destroy(), Pe()), -1 != t.indexOf("ruby") && (t = "ruby"), !1 === LANG_MAP[t].repl ? $("#result").trigger("resize", [0]) : $("#result").trigger("resize", [$(".terminal").height() + 20]), setTimeout(function() {
            return $("#terminal").scrollTop(0)
        }, 1);
        var n = firebase.database().ref(h + HASH + "/input");
        n.push({
            control: "start",
            lang: t,
            bunkid: HASH
        }), S.off("data"), S.on("data", function(e) {
            l.options.readOnly || Oe && n.push({
                code: e,
                lang: t,
                bunkid: HASH
            })
        })
    }
    var He = void 0,
        Fe = void 0;

    function Be(e, t) {
        $("#notification .msg").html(e), $("#notification").miniNotification({
            position: "bottom",
            hideOnClick: !0,
            autoHide: !1,
            closeButton: !0
        }), $("#notification").width($("#editor").width())
    }

    function ze() {
        var e = $("#lang_select").val();
        if ("plain" != e)
            if (l.options.readOnly) Be("You do not have the permission to execute code on this Bunk.");
            else {
                var t = l.doc.getValue();
                if (0 != t.length) {
                    Ie("\n------------------------------------------"), Ie(p.name + " is running the code"), Ie("------------------------------------------\n");
                    window.location.hash.replace(/#/g, "") || HASH;
                    return -1 != e.indexOf("ruby") && (e = "ruby"), firebase.database().ref(h + HASH + "/input").push({
                        control: "execute",
                        lang: e,
                        bunkid: HASH,
                        code: t
                    }), _gaq.push(["_trackEvent", "run", e]), !1
                }
            }
    }
    window.exceptionHandler = function(e) {
        1013 == e.code && alert("Problem!", "This page is trying to connect a third client to an peer-to-peer session. Only two clients can connect to peer-to-peer sessions.")
    }, window._originalAlert = window.alert;
    var qe = function() {};

    function je(e, t) {
        this.processingCallback = t, this.busy = !1, e.limitToLast(1).on("child_added", function(e) {
            this.currentItem = e.ref, this.tryToProcess()
        }, this)
    }
    window.alert = function(e, t, n) {
        $.fn.modal.Constructor && 1 == $("#windowAlertModal").length ? (qe = function() {
            n && n(), qe = function() {}
        }, $("#windowAlertModal .modal-header h3").text(e), $("#windowAlertModal .modal-body p").html(t), $("#windowAlertModal").modal(), $("#windowAlertModal").off("hidden").on("hidden", qe)) : window._originalAlert(t)
    }, je.prototype.readyToProcess = function() {
        this.busy = !1, this.tryToProcess()
    }, je.prototype.tryToProcess = function() {
        if (!this.busy && this.currentItem) {
            this.busy = !0;
            var i = null,
                o = this,
                e = this.currentItem;
            this.currentItem = null, e.transaction(function(e) {
                return (i = e) ? null : void 0
            }, function(e, t, n, r) {
                if (e) throw e;
                t ? o.processingCallback(i, function() {
                    o.readyToProcess()
                }) : o.readyToProcess()
            })
        }
    }
}), $(function() {
    return $.miniNotification = function(t, n) {
        var r, i, o, s, a, l, c = this;
        return this.defaults = {
            autoHide: !0,
            position: "top",
            show: !0,
            effect: "slide",
            opacity: .95,
            time: 4e3,
            showSpeed: 600,
            hideSpeed: 450,
            showEasing: "",
            hideEasing: "",
            innerDivClass: "inner",
            closeButton: !1,
            closeButtonText: "&times",
            closeButtonClass: "close",
            hideOnClick: !0,
            onLoad: function() {},
            onVisible: function() {
                var e = $("#notification .inner").height(),
                    t = $("#notification i").height();
                $("#notification i").css("margin-top", (e - t) / 2)
            },
            onHide: function() {},
            onHidden: function() {}
        }, a = "", this.settings = {}, this.$element = $(t), s = function(e) {
            return a = e
        }, i = function() {
            var e, t;
            return t = "slide" === c.getSetting("effect") ? 0 - c.$element.outerHeight() : 0, e = {}, "bottom" === c.getSetting("position") ? e.bottom = t : e.top = t, "fade" === c.getSetting("effect") && (e.opacity = 0), e
        }, o = function() {
            var e;
            return e = {
                opacity: c.getSetting("opacity")
            }, "bottom" === c.getSetting("position") ? e.bottom = 0 : e.top = "40px", e["font-size"] = "16px", e
        }, l = function() {
            return c.$elementInner = $("<div />", {
                class: c.getSetting("innerDivClass")
            }), c.$element.wrapInner(c.$elementInner)
        }, r = function() {
            var e;
            return e = $("<a />", {
                class: c.getSetting("closeButtonClass"),
                html: c.getSetting("closeButtonText")
            }), c.$element.children().append(e), e.bind("click", function() {
                return c.hide()
            })
        }, this.getState = function() {
            return a
        }, this.getSetting = function(e) {
            return this.settings[e]
        }, this.callSettingFunction = function(e) {
            return this.settings[e](t)
        }, this.init = function() {
            var e = this;
            if (s("hidden"), this.settings = $.extend({}, this.defaults, n), this.$element.length && (l(), this.getSetting("closeButton") && r(), this.$element.css(i()).css({
                    display: "inline"
                }), this.getSetting("show") && this.show(), this.getSetting("hideOnClick"))) return this.$element.bind("click", function() {
                if ("hiding" !== e.getState()) return e.hide()
            })
        }, this.show = function() {
            var e = this;
            if ("showing" !== this.getState() && "visible" !== this.getState()) return s("showing"), this.callSettingFunction("onLoad"), this.$element.animate(o(), this.getSetting("showSpeed"), this.getSetting("showEasing"), function() {
                if (s("visible"), e.callSettingFunction("onVisible"), e.getSetting("autoHide")) return setTimeout(function() {
                    return e.hide()
                }, e.settings.time)
            })
        }, this.hide = function() {
            var e = this;
            if ("hiding" !== this.getState() && "hidden" !== this.getState()) return s("hiding"), this.callSettingFunction("onHide"), this.$element.animate(i(), this.getSetting("hideSpeed"), this.getSetting("hideEasing"), function() {
                return s("hidden"), e.callSettingFunction("onHidden")
            })
        }, this.init(), this
    }, $.fn.miniNotification = function(t) {
        return this.each(function() {
            var e;
            return void 0 === (e = $(this).data("miniNotification")) ? (e = new $.miniNotification(this, t), $(this).data("miniNotification", e)) : e.show()
        })
    }
});